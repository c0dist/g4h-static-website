<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html dir="ltr" id="vbulletin_html" lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://www.facebook.com/2008/fbml"><!-- Mirrored from garage4hackers.com/showthread.php?t=1862&p=6758 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 18:09:45 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

	<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="index.html" id="e_vb_meta_bburl" name="vb_meta_bburl"/>
<base/><!--[if IE]></base><![endif]-->
<meta content="vBulletin 4.2.1" name="generator"/>
<meta content="IE=9" http-equiv="X-UA-Compatible"/>

	<link href="favicon.ico" rel="Shortcut Icon" type="image/x-icon"/>






	<meta content="170793809601191" property="fb:app_id"/>
<meta content="Garage4hackers Forum" property="og:site_name"/>
<meta content="Garage4Hackers(G4H) is an open security community for Information Security enthusiasts, gurus and aspirants.Members of the team dedicate time and resources towards helping other information security aspirants, sharing knowledge,spreading security awareness and promoting research." property="og:description"/>
<meta content="showthread3577-2.html?t=1862" property="og:url"/>
<meta content="article" property="og:type"/>




	
		<script src="../yui.yahooapis.com/comboaa66?2.9.0/build/yuiloader-dom-event/yuiloader-dom-event.js&amp;2.9.0/build/connection/connection-min.js" type="text/javascript"></script>
	

<script type="text/javascript">
<!--
	if (typeof YAHOO === 'undefined') // Load ALL YUI Local
	{
		document.write('<script type="text/javascript" src="clientscript/yui/yuiloader-dom-event/yuiloader-dom-event6719.html?v=421"><\/script>');
		document.write('<script type="text/javascript" src="clientscript/yui/connection/connection-min6719.html?v=421"><\/script>');
		var yuipath = 'clientscript/yui';
		var yuicombopath = '';
		var remoteyui = false;
	}
	else	// Load Rest of YUI remotely (where possible)
	{
		var yuipath = 'http://yui.yahooapis.com/2.9.0/build';
		var yuicombopath = 'http://yui.yahooapis.com/combo';
		var remoteyui = true;
		if (!yuicombopath)
		{
			document.write('<script type="text/javascript" src="../yui.yahooapis.com/2.9.0/build/connection/connection-min6719.js?v=421"><\/script>');
		}
	}
	var SESSIONURL = "";
	var SECURITYTOKEN = "guest";
	var IMGDIR_MISC = "images/misc";
	var IMGDIR_BUTTON = "images/buttons";
	var vb_disable_ajax = parseInt("0", 10);
	var SIMPLEVERSION = "421";
	var BBURL = "index.html";
	var LOGGEDIN = 0 > 0 ? true : false;
	var THIS_SCRIPT = "showthread";
	var RELPATH = "showthread95e4.html?t=1862&amp;p=6758";
	var PATHS = {
		forum : "",
		cms   : "",
		blog  : ""
	};
	var AJAXBASEURL = "index.html";
// -->
</script>
<script src="clientscript/vbulletin-core6719.js?v=421" type="text/javascript"></script>



	<link href="external9476.php?type=RSS2" rel="alternate" title="Garage4hackers Forum RSS Feed" type="application/rss+xml"/>
	
		<link href="external2471.php?type=RSS2&amp;forumids=24" rel="alternate" title="Garage4hackers Forum - Reverse Engineering and Application Cracking - RSS Feed" type="application/rss+xml"/>
	



	<link href="css30f2.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=bbcode.css,editor.css,popupmenu.css,reset-fonts.css,vbulletin.css,vbulletin-chrome.css,vbulletin-formcontrols.css," rel="stylesheet" type="text/css"/>

	<!--[if lt IE 8]>
	<link rel="stylesheet" type="text/css" href="css.php?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=popupmenu-ie.css,vbulletin-ie.css,vbulletin-chrome-ie.css,vbulletin-formcontrols-ie.css,editor-ie.css" />
	<![endif]-->


	<meta content="windbg, function, address, array, script, expression, addressofnames, names, gdi32.dll, current, string, image_export_directory, 0x77f12650, evaluator, 00002650, pointer, structure, table, 000034a6, tedious, exported, means, manually, microsoft, element, obtained, adding, gdi32+@@c++@$t0[@$t1], 0x77f10000, execute, cscriptsparser.wds, parser.wds, write, evaulator, expressions, assembler, .expr, iterate, check, 00003537, 00003546, 00003555, 0000352e, 77f12670, 00003505, 0000351d, 77f12680, 00003559, 000035a7, 000035c0" name="keywords"/>
	<meta content="We are going to understand the Portable Executable structure, the concepts and various data directories inside it. To summarize, I will explain the OS internals with the help of Windbg. 
 
At first, set the Symbols of your Windbg to point to the Microsoft Symbols Server. 
 
You can set the Environment Variable _NT_SYMBOL_PATH to symsrv*symsrv.dll*C:\Symbols*http://msdl.microsoft.com/download/symbols 
 
where, C:\Symbols is the folder on my file system where these symbols are cached as and when" name="description"/>

	<title> PE's Import Address Table and Export Table Walkthrough using Windbg</title>
	<link href="showthread3577-2.html?t=1862" rel="canonical"/>
	
	<script src="clientscript/vbulletin_textedit6719.html?v=421" type="text/javascript"></script>
	<script src="clientscript/vbulletin_post_loader6719.html?v=421" type="text/javascript"></script>
	
	
	
	
	
	

	
		<link href="css8d9b.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=postlist.css,showthread.css,postbit.css,attachment.css,poll.css,lightbox.css" rel="stylesheet" type="text/css"/>
	

<link href="css657d.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=additional.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<div class="above_body"> <!-- closing tag is in template navbar -->
<div class="floatcontainer doc_header" id="header">
	<div><a class="logo-image" href="forum.html" name="top"><img alt="Garage4hackers Forum" src="images/misc/vbulletin4_logo.png"/></a></div>
	<div class="toplinks" id="toplinks">
		
			<ul class="nouser">
			
				<li><a href="register.html" rel="nofollow">Register</a></li>
			
				<li><a href="faq.html" rel="help">Help</a></li>
				<li>
			<script src="clientscript/vbulletin_md56719.html?v=421" type="text/javascript"></script>
			<form action="../external.html?link=http://garage4hackers.com/login.php?do=login" id="navbar_loginform" method="post" onsubmit="md5hash(vb_login_password, vb_login_md5password, vb_login_md5password_utf, 0)">
				<fieldset class="logindetails" id="logindetails">
					<div>
						<div>
					<input accesskey="u" class="textbox default-value" id="navbar_username" name="vb_login_username" size="10" tabindex="101" type="text" value="User Name"/>
					<input class="textbox" id="navbar_password" name="vb_login_password" size="10" tabindex="102" type="password"/>
					<input class="textbox default-value" id="navbar_password_hint" name="vb_login_password_hint" size="10" style="display:none;" tabindex="102" type="text" value="Password"/>
					<input accesskey="s" class="loginbutton" tabindex="104" title="Enter your username and password in the boxes provided to login, or click the 'register' button to create a profile for yourself." type="submit" value="Log in"/>
						</div>
					</div>
				</fieldset>
				<div class="remember" id="remember">
					<label for="cb_cookieuser_navbar"><input accesskey="c" class="cb_cookieuser_navbar" id="cb_cookieuser_navbar" name="cookieuser" tabindex="103" type="checkbox" value="1"/> Remember Me?</label>
				</div>

				<input name="s" type="hidden" value=""/>
				<input name="securitytoken" type="hidden" value="guest"/>
				<input name="do" type="hidden" value="login"/>
				<input name="vb_login_md5password" type="hidden"/>
				<input name="vb_login_md5password_utf" type="hidden"/>
			</form>
			<script type="text/javascript">
			YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "inline");
			YAHOO.util.Dom.setStyle('navbar_password', "display", "none");
			vB_XHTML_Ready.subscribe(function()
			{
			//
				YAHOO.util.Event.on('navbar_username', "focus", navbar_username_focus);
				YAHOO.util.Event.on('navbar_username', "blur", navbar_username_blur);
				YAHOO.util.Event.on('navbar_password_hint', "focus", navbar_password_hint);
				YAHOO.util.Event.on('navbar_password', "blur", navbar_password);
			});
			
			function navbar_username_focus(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				if (textbox.value == 'User Name')
				{
				//
					textbox.value='';
					textbox.style.color='#000000';
				}
			}

			function navbar_username_blur(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				if (textbox.value == '')
				{
				//
					textbox.value='User Name';
					textbox.style.color='#777777';
				}
			}
			
			function navbar_password_hint(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				
				YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "none");
				YAHOO.util.Dom.setStyle('navbar_password', "display", "inline");
				YAHOO.util.Dom.get('navbar_password').focus();
			}

			function navbar_password(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				
				if (textbox.value == '')
				{
					YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "inline");
					YAHOO.util.Dom.setStyle('navbar_password', "display", "none");
				}
			}
			</script>
				</li>
				
					<li class="hidden" id="fb_headerbox">

	<a href="#" id="fb_loginbtn"><img alt="The Facebook Platform" src="images/misc/facebook_login.gif"/></a>

</li>

				
			</ul>
		
	</div>
	<div class="ad_global_header">
		 
		 
	</div>
	<hr/>
</div>
<div class="navbar" id="navbar">
	<ul class="navtabs floatcontainer" id="navtabs">
		
		
	
		<li id="vbtab_whatsnew">
			<a class="navtab" href="activity.html">What's New?</a>
		</li>
		
		

	
		<li id="vbtab_cms">
			<a class="navtab" href="content.html">Articles</a>
		</li>
		
		

	
		<li class="selected" id="vbtab_forum">
			<a class="navtab" href="forum.html">Forum</a>
		</li>
		
		
			<ul class="floatcontainer">
				
					
						
							<li id="vbflink_newposts"><a href="search8427.html?do=getnew&amp;contenttype=vBForum_Post">New Posts</a></li>
						
					
				
					
						
							<li id="vbflink_faq"><a href="faq.html">FAQ</a></li>
						
					
				
					
						
							<li id="vbflink_calendar"><a href="calendar.html">Calendar</a></li>
						
					
				
					
						<li class="popupmenu" id="vbmenu_community">
							<a class="popupctrl" href="javascript://">Community</a>
							<ul class="popupbody popuphover">
								
									<li id="vbclink_members"><a href="memberlist.html">Member List</a></li>
								
							</ul>
						</li>
					
				
					
						<li class="popupmenu" id="vbmenu_actions">
							<a class="popupctrl" href="javascript://">Forum Actions</a>
							<ul class="popupbody popuphover">
								
									<li id="vbalink_mfr"><a href="forum.html?do=markread&amp;markreadhash=guest">Mark Forums Read</a></li>
								
							</ul>
						</li>
					
				
					
						<li class="popupmenu" id="vbmenu_qlinks">
							<a class="popupctrl" href="javascript://">Quick Links</a>
							<ul class="popupbody popuphover">
								
									<li id="vbqlink_posts"><a href="search2791.html?do=getdaily&amp;contenttype=vBForum_Post">Today's Posts</a></li>
								
									<li id="vbqlink_leaders"><a href="showgroups.html">View Site Leaders</a></li>
								
							</ul>
						</li>
					
				
			</ul>
		

	
		<li id="vbtab_blog">
			<a class="navtab" href="blog.html">Blogs</a>
		</li>
		
		

	
		<li id="tab_nja4_357">
			<a class="navtab" href="pages7b82.html?pageid=2">G4H Team</a>
		</li>
		
		

	
		<li id="tab_nta0_579">
			<a class="navtab" href="pages8782.html?pageid=3">IRC</a>
		</li>
		
		

	
		<li id="tab_nta0_442">
			<a class="navtab" href="pagesdbe0.html?pageid=4">Ranchoddas</a>
		</li>
		
		

		<li>
            <a class="navtab" href="pages.html">Events and Conferences</a></li>
	</ul>
	
		<div class="globalsearch" id="globalsearch">
			<form action="../external.html?link=http://garage4hackers.com/search.php?do=process" class="navbar_search" id="navbar_search" method="post">
				
				<input name="securitytoken" type="hidden" value="guest"/>
				<input name="do" type="hidden" value="process"/>
				<span class="textboxcontainer"><span><input class="textbox" name="query" tabindex="99" type="text" value=""/></span></span>
				<span class="buttoncontainer"><span><input class="searchbutton" name="submit" onclick="document.getElementById('navbar_search').submit;" src="images/buttons/search.html" tabindex="100" type="image"/></span></span>
			</form>
			<ul class="navbar_advanced_search">
				<li><a accesskey="4" href="search.html">Advanced Search</a></li>
				
			</ul>
		</div>
	
</div>
</div><!-- closing div for above_body -->

<div class="body_wrapper">
<div class="breadcrumb" id="breadcrumb">
	<ul class="floatcontainer">
		<li class="navbithome"><a accesskey="1" href="content.html"><img alt="Home" src="images/misc/navbit-home.png"/></a></li>
		
	<li class="navbit"><a href="forum.html">Forum</a></li>

	<li class="navbit"><a href="forumdisplayffeb.html?f=20">Experts Forum</a></li>

	<li class="navbit"><a href="forumdisplay345c.html?f=24">Reverse Engineering and Application Cracking</a></li>

		
	<li class="navbit lastnavbit"><span> PE's Import Address Table and Export Table Walkthrough using Windbg</span></li>

	</ul>
	<hr/>
</div>


<div style="width:728px; margin:0 auto; padding-bottom:1em">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6847984837250662";
google_ad_host = "ca-host-pub-2606800903002383";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al_s";
google_ad_channel = "";
google_color_border = "";
google_color_bg = "";
google_color_link = "";
google_color_text = "";
google_color_url = "";
google_ui_features = "rc:6";
//-->
</script>
<script src="../pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>
</div>

<div id="ad_global_below_navbar"><script async="" src="../pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- garage1 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-6847984837250662" data-ad-slot="4036513682" style="display:inline-block;width:728px;height:90px"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>


	<form action="../external.html?link=http://garage4hackers.com/profile.php?do=dismissnotice" class="notices" id="notices" method="post">
		<input name="do" type="hidden" value="dismissnotice"/>
		<input name="s" type="hidden" value=""/>
		<input name="securitytoken" type="hidden" value="guest"/>
		<input id="dismiss_notice_hidden" name="dismiss_noticeid" type="hidden" value=""/>
		<input name="url" type="hidden" value=""/>
		<ol>
			<li class="restore" id="navbar_notice_2">
	
	
<h2>
The forum is <a href="showthread1180.html?t=7049&amp;p=14985#post14985">frozen forever</a> - but it won't die; it'll stay for long in search engine results and we hope it would keep helping newbies in some way or other - cheers! 


</h2>

<!-- Mirrored from garage4hackers.com/showthread.php?t=1862&p=6758 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 18:09:45 GMT -->

</li>
		</ol>
	</form>





	<div class="above_postlist" id="above_postlist">
		

		<div class="pagination_top" id="pagination_top">
		
			<div class="postpagestats" id="postpagestats_above">
				Results 1 to 5 of 5
			</div>
		</div>
	</div>
<div class="pagetitle" id="pagetitle">
	<h1>
		Thread: <span class="threadtitle"><a href="showthread3577-2.html?t=1862" title="Reload this Page">PE's Import Address Table and Export Table Walkthrough using Windbg</a></span>

<a class="a2a_dd" href="http://www.addtoany.com/share_save"><img alt="Share/Save - My123World.Com!" border="0" height="16" src="../static.addtoany.com/buttons/share_save_171_16.png" width="171"/></a><script type="text/javascript">a2a_show_title=1;a2a_num_services=14;</script><script src="../static.addtoany.com/menu/page.js" type="text/javascript"></script>

		
			
<fb:like action="../external.html?link=http://garage4hackers.com/like" colorscheme="light" font="tahoma" href="showthread3577-2.html?t=1862" layout="standard" show_faces="false" width="260"></fb:like>
		
	</h1>
</div>
	<div class="thread_controls" id="thread_controls">
		<div>
		<ul class="postlist_popups popupgroup" id="postlist_popups">
			
			<li class="popupmenu" id="threadtools">
				<h6><a class="popupctrl" href="javascript://">Thread Tools</a></h6>
				<ul class="popupbody popuphover">
					<li><a accesskey="3" href="printthread45de.html?t=1862&amp;pp=10&amp;page=1" rel="nofollow">Show Printable Version</a></li>
					<li><a href="sendmessagecf7c.html?do=sendtofriend&amp;t=1862" rel="nofollow">Email this Page…</a></li>
					<li>
						
							<a href="subscription6033.html?do=addsubscription&amp;t=1862" rel="nofollow">Subscribe to this Thread…</a>
											
					</li>
					
				</ul>
			</li>

			

			
				<li class="popupmenu searchthread" id="searchthread">
					<h6><a class="popupctrl" href="javascript://">Search Thread</a></h6>
					<form action="../external.html?link=http://garage4hackers.com/search.php" method="post">
						<ul class="popupbody popuphover">
							<li>
								<input class="searchbox" name="query" tabindex="13" type="text" value="Search..."/>
								<input class="button" tabindex="14" type="submit" value="Search"/>
							</li>
							<li class="formsubmit">
								<div><a class="advancedsearchlink" href="search3d50.html?search_type=1&amp;searchthreadid=1862&amp;contenttype=vBForum_Post">Advanced Search</a></div>
							</li>
						</ul>
						<input name="s" type="hidden" value=""/>
						<input name="securitytoken" type="hidden" value="guest"/>
						<input name="do" type="hidden" value="process"/>
						<input name="searchthreadid" type="hidden" value="1862"/>
						<input name="search_type" type="hidden" value="1"/>
						<input name="contenttype" type="hidden" value="vBForum_Post"/>

					</form>
				</li>
			

			

			
				<li class="popupmenu" id="displaymodes">
					<h6><a class="popupctrl" href="javascript://">Display</a></h6>
					<ul class="popupbody popuphover">
						<li><a href="showthread871d.html?t=1862&amp;p=6758&amp;mode=linear#post6758"> Switch to Linear Mode</a></li>
						<li><a href="showthread4f23-2.html?t=1862&amp;mode=hybrid"> Switch to Hybrid Mode</a></li>
						<li><label>Threaded Mode</label></li>
					</ul>
				</li>
			

			
		</ul>
		</div>
	</div>

<div class="postlist restrain" id="postlist">
	
		<script type="text/javascript">
<!--
var imgdir_statusicon = "images/statusicon";
var imgdir_misc = "images/misc";
var cleargifurl = "clear.gif";
var guestphrase = "Guest";
var morephrase = "More replies below current depth...";
var highlightwords = "";
//-->
</script>

<script src="clientscript/vbulletin_thrdpostlist6719.html?v=421" type="text/javascript"></script>

<script type="text/javascript">
<!--
// initialize some variables
var curpostid = 6758;
var quickreply = false;

// cached posts (no page reload required to view)
pd[6754] = '\r\n<li class="postbitlegacy postbitim postcontainer old" id="post_6754">\r\n<!-' + '- see bottom of postbit.css for .userinfo .popupmenu styles -' + '->\r\n\r\n	<div class="posthead">\r\n			<span class="postdate old">\r\n				\r\n					<span class="date">12-29-2011,&nbsp;<span class="time">12:01 PM</span></span>\r\n				\r\n			</span>\r\n			<span class="nodecontrols">\r\n				\r\n					<a name="post6754" href="showthread.php?t=1862&amp;p=6754&amp;viewfull=1#post6754" class="postcounter">#1</a><a id="postcount6754" name="1"></a>\r\n				\r\n				\r\n				\r\n			</span>\r\n	</div>\r\n	<div class="postdetails">\r\n		<div class="userinfo">\r\n			<div class="username_container">\r\n			\r\n				<div class="popupmenu memberaction">\r\n	<a class="username offline popupctrl" href="member.php?u=311" title="c0d3inj3cT is offline"><strong>c0d3inj3cT</strong></a>\r\n	<ul class="popupbody popuphover memberaction_body">\r\n		<li class="left">\r\n			<a href="member.php?u=311" class="siteicon_profile">\r\n				View Profile\r\n			</a>\r\n		</li>\r\n		\r\n		<li class="right">\r\n			<a href="search.php?do=finduser&amp;userid=311&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">\r\n				View Forum Posts\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="private.php?do=newpm&amp;u=311" class="siteicon_message" rel="nofollow">\r\n				Private Message\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="blog.php?u=311" class="siteicon_blog" rel="nofollow">\r\n				View Blog Entries\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="http://garage4hackers.com/list.php?r=author/311-c0d3inj3cT" class="siteicon_article" rel="nofollow">\r\n				View Articles\r\n			</a>\r\n		</li>\r\n		\r\n\r\n		\r\n\r\n		\r\n		\r\n	</ul>\r\n</div>\r\n				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.png" alt="c0d3inj3cT is offline" border="0" />\r\n\r\n			\r\n			</div>\r\n			<span class="usertitle">\r\n				Garage Member\r\n			</span>\r\n			\r\n			\r\n			\r\n				<span class="postbit_reputation" id="repdisplay_6754_311" title="c0d3inj3cT will become famous soon enough">\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n				</span>\r\n			\r\n			 \r\n			\r\n				<hr />\r\n				<dl class="userinfo_extra">\r\n					<dt>Join Date</dt> <dd>Dec 2010</dd>\r\n					\r\n					\r\n					<dt>Posts</dt> <dd>67</dd>	\r\n					<dt>Blog Entries</dt><dd><a href="blog.php?u=311">2</a></dd>\r\n				</dl>\r\n				\r\n				\r\n				<div class="imlinks">\r\n					    \r\n				</div>\r\n			\r\n		</div>\r\n		<div class="postbody">\r\n			<div class="postrow">\r\n				\r\n				\r\n				<h2 class="title icon">\r\n					PE\'s Import Address Table and Export Table Walkthrough using Windbg\r\n				</h2>\r\n				\r\n\r\n\r\n						\r\n						\r\n				<div class="content">\r\n					<div id="post_message_6754">\r\n						<blockquote class="postcontent restore ">\r\n							We are going to understand the Portable Executable structure, the concepts and various data directories inside it. To summarize, I will explain the OS internals with the help of <b>Windbg</b>.<br />\r\n<br />\r\nAt first, set the Symbols of your Windbg to point to the Microsoft Symbols Server.<br />\r\n<br />\r\nYou can set the Environment Variable <b>_NT_SYMBOL_PATH</b> to <b>symsrv*symsrv.dll*C:\\Symbols*<a href="http://msdl.microsoft.com/download/symbols" target="_blank">http://msdl.microsoft.com/download/symbols</a></b><br />\r\n<br />\r\nwhere, C:\\Symbols is the folder on my file system where these symbols are cached as and when they are downloaded.<br />\r\n<br />\r\nLet\'s open up an executable like notepad.exe in windbg.<br />\r\n<br />\r\nGo to File-&gt;Open Executable and open up notepad.exe from %systemroot%\\system32 folder.<br />\r\n<br />\r\nOnce this is done, windbg will present a list of all the modules which were loaded along with the main module, notepad.exe<br />\r\n<br />\r\nLet\'s take a look at this output and try to make some sense out of it <img src="images/smilies/smile.png" border="0" alt="" title="Smile" class="inlineimg" /><br />\r\n<br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:204px;">ModLoad: 01000000 01014000   notepad.exe\r\nModLoad: 7c900000 7c9b2000   ntdll.dll\r\nModLoad: 7c800000 7c8f6000   C:\\WINXP\\system32\\kernel32.dll\r\nModLoad: 763b0000 763f9000   C:\\WINXP\\system32\\comdlg32.dll\r\nModLoad: 77dd0000 77e6b000   C:\\WINXP\\system32\\ADVAPI32.dll\r\nModLoad: 77e70000 77f03000   C:\\WINXP\\system32\\RPCRT4.dll\r\nModLoad: 77fe0000 77ff1000   C:\\WINXP\\system32\\Secur32.dll\r\nModLoad: 773d0000 774d3000   C:\\WINXP\\WinSxS\\x86_Microsoft.Windows.Common-Controls_6595b64144ccf1df_6.0.2600.6028_x-ww_61e65202\\COMCTL32.dll\r\nModLoad: 77c10000 77c68000   C:\\WINXP\\system32\\msvcrt.dll\r\nModLoad: 77f10000 77f59000   C:\\WINXP\\system32\\GDI32.dll\r\nModLoad: 7e410000 7e4a1000   C:\\WINXP\\system32\\USER32.dll\r\nModLoad: 77f60000 77fd6000   C:\\WINXP\\system32\\SHLWAPI.dll\r\nModLoad: 7c9c0000 7d1d8000   C:\\WINXP\\system32\\SHELL32.dll\r\nModLoad: 73000000 73026000   C:\\WINXP\\system32\\WINSPOOL.DRV\r\n(15c.ab8): Break instruction exception - code 80000003 (first chance)</pre>\r\n</div>When a PE is opened up, the OS loader will load the modules from which our executable imports the functions. Each of these DLLs will occupy a specific memory address range.<br />\r\n<br />\r\nFor instance, notepad.exe makes use of some Windows API functions exported by ntdll.dll. So, ntdll.dll was loaded along with notepad.exe. Also, this dll will occupy the address range: 7c900000 to 7c9b2000<br />\r\n<br />\r\nBy looking at this range, we get the Base Address of ntdll.dll<br />\r\n<br />\r\nIt\'s important to know the base address since as we investigate further into the internal structures of the operating system, we will discover that usually the value at hand is an RVA which must be added to the image base address to fetch the values.<br />\r\n<br />\r\nnext, enter .cls to clear the screen <img src="images/smilies/smile.png" border="0" alt="" title="Smile" class="inlineimg" /><br />\r\n<br />\r\nnow, we will display the list of all loaded modules using lm command.<br />\r\n<br />\r\nlm give us the same output as above with the address range of each module.\r\n						</blockquote>\r\n					</div>\r\n\r\n					\r\n				</div>\r\n			</div>\r\n			\r\n			<div class="cleardiv"></div>\r\n		</div>\r\n	</div>\r\n		<div class="postfoot">\r\n			<!-' + '- <div class="postfoot_container"> -' + '->\r\n			<div class="textcontrols floatcontainer">\r\n				<span class="postcontrols">\r\n					<img style="display:none" id="progress_6754" src="images/misc/progress.gif" alt="" />\r\n					\r\n					\r\n					\r\n						<a id="qrwq_6754" class="newreply" href="newreply.php?do=newreply&amp;p=6754" rel="nofollow" title="Reply With Quote"><img id="quoteimg_6754" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> \r\n					\r\n					\r\n					\r\n				</span>\r\n				<span class="postlinking">\r\n					\r\n						\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n\r\n					\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n					\r\n				</span>\r\n			<!-' + '- </div> -' + '->\r\n			</div>\r\n		</div>\r\n	<hr />\r\n</li>\r\n';
pd[6755] = '\r\n<li class="postbitlegacy postbitim postcontainer old" id="post_6755">\r\n<!-' + '- see bottom of postbit.css for .userinfo .popupmenu styles -' + '->\r\n\r\n	<div class="posthead">\r\n			<span class="postdate old">\r\n				\r\n					<span class="date">12-29-2011,&nbsp;<span class="time">12:04 PM</span></span>\r\n				\r\n			</span>\r\n			<span class="nodecontrols">\r\n				\r\n					<a name="post6755" href="showthread.php?t=1862&amp;p=6755&amp;viewfull=1#post6755" class="postcounter">#2</a><a id="postcount6755" name="2"></a>\r\n				\r\n				\r\n				\r\n			</span>\r\n	</div>\r\n	<div class="postdetails">\r\n		<div class="userinfo">\r\n			<div class="username_container">\r\n			\r\n				<div class="popupmenu memberaction">\r\n	<a class="username offline popupctrl" href="member.php?u=311" title="c0d3inj3cT is offline"><strong>c0d3inj3cT</strong></a>\r\n	<ul class="popupbody popuphover memberaction_body">\r\n		<li class="left">\r\n			<a href="member.php?u=311" class="siteicon_profile">\r\n				View Profile\r\n			</a>\r\n		</li>\r\n		\r\n		<li class="right">\r\n			<a href="search.php?do=finduser&amp;userid=311&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">\r\n				View Forum Posts\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="private.php?do=newpm&amp;u=311" class="siteicon_message" rel="nofollow">\r\n				Private Message\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="blog.php?u=311" class="siteicon_blog" rel="nofollow">\r\n				View Blog Entries\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="http://garage4hackers.com/list.php?r=author/311-c0d3inj3cT" class="siteicon_article" rel="nofollow">\r\n				View Articles\r\n			</a>\r\n		</li>\r\n		\r\n\r\n		\r\n\r\n		\r\n		\r\n	</ul>\r\n</div>\r\n				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.png" alt="c0d3inj3cT is offline" border="0" />\r\n\r\n			\r\n			</div>\r\n			<span class="usertitle">\r\n				Garage Member\r\n			</span>\r\n			\r\n			\r\n			\r\n				<span class="postbit_reputation" id="repdisplay_6755_311" title="c0d3inj3cT will become famous soon enough">\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n				</span>\r\n			\r\n			 \r\n			\r\n				<hr />\r\n				<dl class="userinfo_extra">\r\n					<dt>Join Date</dt> <dd>Dec 2010</dd>\r\n					\r\n					\r\n					<dt>Posts</dt> <dd>67</dd>	\r\n					<dt>Blog Entries</dt><dd><a href="blog.php?u=311">2</a></dd>\r\n				</dl>\r\n				\r\n				\r\n				<div class="imlinks">\r\n					    \r\n				</div>\r\n			\r\n		</div>\r\n		<div class="postbody">\r\n			<div class="postrow">\r\n				\r\n				\r\n\r\n\r\n						\r\n						\r\n				<div class="content">\r\n					<div id="post_message_6755">\r\n						<blockquote class="postcontent restore ">\r\n							<b>PE Header:</b> Let\'s see how the PE header of our main executable, notepad.exe looks like.<br />\r\n<br />\r\nthe basic syntax is: <b>!dh &lt;image base address&gt; &lt;options&gt;</b><br />\r\n<br />\r\nIn our case, image base address of notepad.exe is 01000000<br />\r\n<br />\r\nI use the option -f along with this command, so that it does not display the Section Headers for .data, .text, .rsrc, .reloc and various other sections which might be present.<br />\r\n<br />\r\nwhat I want to look into right now is something called as Data Directories, let\'s see what it is:<br />\r\n<br />\r\n<b>!dh 01000000 -f</b><br />\r\n<br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:372px;">File Type: EXECUTABLE IMAGE\r\nFILE HEADER VALUES\r\n     14C machine (i386)\r\n       3 number of sections\r\n48025287 time date stamp Mon Apr 14 00:05:51 2008\r\n\r\n       0 file pointer to symbol table\r\n       0 number of symbols\r\n      E0 size of optional header\r\n     10F characteristics\r\n            Relocations stripped\r\n            Executable\r\n            Line numbers stripped\r\n            Symbols stripped\r\n            32 bit word machine\r\n\r\nOPTIONAL HEADER VALUES\r\n     10B magic #\r\n    7.10 linker version\r\n    7800 size of code\r\n    A600 size of initialized data\r\n       0 size of uninitialized data\r\n    739D address of entry point\r\n    1000 base of code\r\n         -' + '-' + '-' + '-' + '- new -' + '-' + '-' + '-' + '-\r\n01000000 image base\r\n    1000 section alignment\r\n     200 file alignment\r\n       2 subsystem (Windows GUI)\r\n    5.01 operating system version\r\n    5.01 image version\r\n    4.00 subsystem version\r\n   14000 size of image\r\n     400 size of headers\r\n   18700 checksum\r\n00040000 size of stack reserve\r\n00011000 size of stack commit\r\n00100000 size of heap reserve\r\n00001000 size of heap commit\r\n    8000  DLL characteristics\r\n            Terminal server aware\r\n       0 [       0] address [size] of Export Directory\r\n    7604 [      C8] address [size] of Import Directory\r\n    B000 [    8948] address [size] of Resource Directory\r\n       0 [       0] address [size] of Exception Directory\r\n       0 [       0] address [size] of Security Directory\r\n       0 [       0] address [size] of Base Relocation Directory\r\n    1350 [      1C] address [size] of Debug Directory\r\n       0 [       0] address [size] of Description Directory\r\n       0 [       0] address [size] of Special Directory\r\n       0 [       0] address [size] of Thread Storage Directory\r\n    18A8 [      40] address [size] of Load Configuration Directory\r\n     250 [      D0] address [size] of Bound Import Directory\r\n    1000 [     348] address [size] of Import Address Table Directory\r\n       0 [       0] address [size] of Delay Import Directory\r\n       0 [       0] address [size] of COR20 Header Directory\r\n       0 [       0] address [size] of Reserved Directory</pre>\r\n</div>Do you see the array of directories at the bottom?<br />\r\n<br />\r\nThis is the data directory array. It\'s an array of structures of <b>IMAGE_DATA_DIRECTORY</b> each having two fields:<br />\r\n<br />\r\nVirtualAddress and Size.<br />\r\n<br />\r\nThe Virtual Address is going to give the Relative Virtual Address (RVA) corresponding to the image base address. This RVA will point to another structure.\r\n						</blockquote>\r\n					</div>\r\n\r\n					\r\n				</div>\r\n			</div>\r\n			\r\n			<div class="cleardiv"></div>\r\n		</div>\r\n	</div>\r\n		<div class="postfoot">\r\n			<!-' + '- <div class="postfoot_container"> -' + '->\r\n			<div class="textcontrols floatcontainer">\r\n				<span class="postcontrols">\r\n					<img style="display:none" id="progress_6755" src="images/misc/progress.gif" alt="" />\r\n					\r\n					\r\n					\r\n						<a id="qrwq_6755" class="newreply" href="newreply.php?do=newreply&amp;p=6755" rel="nofollow" title="Reply With Quote"><img id="quoteimg_6755" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> \r\n					\r\n					\r\n					\r\n				</span>\r\n				<span class="postlinking">\r\n					\r\n						\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n\r\n					\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n					\r\n				</span>\r\n			<!-' + '- </div> -' + '->\r\n			</div>\r\n		</div>\r\n	<hr />\r\n</li>\r\n';
pd[6756] = '\r\n<li class="postbitlegacy postbitim postcontainer old" id="post_6756">\r\n<!-' + '- see bottom of postbit.css for .userinfo .popupmenu styles -' + '->\r\n\r\n	<div class="posthead">\r\n			<span class="postdate old">\r\n				\r\n					<span class="date">12-29-2011,&nbsp;<span class="time">12:10 PM</span></span>\r\n				\r\n			</span>\r\n			<span class="nodecontrols">\r\n				\r\n					<a name="post6756" href="showthread.php?t=1862&amp;p=6756&amp;viewfull=1#post6756" class="postcounter">#3</a><a id="postcount6756" name="3"></a>\r\n				\r\n				\r\n				\r\n			</span>\r\n	</div>\r\n	<div class="postdetails">\r\n		<div class="userinfo">\r\n			<div class="username_container">\r\n			\r\n				<div class="popupmenu memberaction">\r\n	<a class="username offline popupctrl" href="member.php?u=311" title="c0d3inj3cT is offline"><strong>c0d3inj3cT</strong></a>\r\n	<ul class="popupbody popuphover memberaction_body">\r\n		<li class="left">\r\n			<a href="member.php?u=311" class="siteicon_profile">\r\n				View Profile\r\n			</a>\r\n		</li>\r\n		\r\n		<li class="right">\r\n			<a href="search.php?do=finduser&amp;userid=311&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">\r\n				View Forum Posts\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="private.php?do=newpm&amp;u=311" class="siteicon_message" rel="nofollow">\r\n				Private Message\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="blog.php?u=311" class="siteicon_blog" rel="nofollow">\r\n				View Blog Entries\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="http://garage4hackers.com/list.php?r=author/311-c0d3inj3cT" class="siteicon_article" rel="nofollow">\r\n				View Articles\r\n			</a>\r\n		</li>\r\n		\r\n\r\n		\r\n\r\n		\r\n		\r\n	</ul>\r\n</div>\r\n				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.png" alt="c0d3inj3cT is offline" border="0" />\r\n\r\n			\r\n			</div>\r\n			<span class="usertitle">\r\n				Garage Member\r\n			</span>\r\n			\r\n			\r\n			\r\n				<span class="postbit_reputation" id="repdisplay_6756_311" title="c0d3inj3cT will become famous soon enough">\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n				</span>\r\n			\r\n			 \r\n			\r\n				<hr />\r\n				<dl class="userinfo_extra">\r\n					<dt>Join Date</dt> <dd>Dec 2010</dd>\r\n					\r\n					\r\n					<dt>Posts</dt> <dd>67</dd>	\r\n					<dt>Blog Entries</dt><dd><a href="blog.php?u=311">2</a></dd>\r\n				</dl>\r\n				\r\n				\r\n				<div class="imlinks">\r\n					    \r\n				</div>\r\n			\r\n		</div>\r\n		<div class="postbody">\r\n			<div class="postrow">\r\n				\r\n				\r\n\r\n\r\n						\r\n						\r\n				<div class="content">\r\n					<div id="post_message_6756">\r\n						<blockquote class="postcontent restore ">\r\n							The data directories I am interested in are:<br />\r\n<br />\r\nExport Directory<br />\r\nImport Address Table Directory.<br />\r\n<br />\r\nLet\'s begin with IAT.<br />\r\n<br />\r\nIf we look at the theory, it can be quite a complicated task to visualize. But why visualize, when we have windbg? <img src="images/smilies/smile.png" border="0" alt="" title="Smile" class="inlineimg" /><br />\r\n<br />\r\nIAT is the Import Address Table which consists of the mappings between the absolute virtual addresses and the function names which are exported from different loaded modules.<br />\r\n<br />\r\nAs we saw in starting, there are various DLLs which are loaded along with notepad.exe. IAT gives us a list of function names which are imported from these loaded modules.<br />\r\n<br />\r\nQuite an interesting piece of information <img src="images/smilies/smile.png" border="0" alt="" title="Smile" class="inlineimg" /><br />\r\n<br />\r\nLet\'s see how I can grab that info. Looking at the above data directory we can see the following line:<br />\r\n<br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:36px;">1000 [     348] address [size] of Import Address Table Directory</pre>\r\n</div>Here, 1000 is the RVA which is the offset from the image base address of notepad.exe<br />\r\n<br />\r\nimage base address + RVA is going to point to the Import Address Table. We also have the size of this structure as 348 bytes.<br />\r\n<br />\r\nI will display this structure as follows:<br />\r\n<br />\r\n<b>dps 01000000+1000 L348/4</b><br />\r\n<br />\r\nHere, the L parameter to the dps command is used to denote the size and I have divided by 4 to take steps of 4 bytes while displaying the addresses.<br />\r\n<br />\r\nA subsection of the output is shown below:<br />\r\n<br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:372px;">01001000  77dd6fff ADVAPI32!RegQueryValueExW\r\n01001004  77dd6c27 ADVAPI32!RegCloseKey\r\n01001008  77dfba55 ADVAPI32!RegCreateKeyW\r\n0100100c  77dfbd35 ADVAPI32!IsTextUnicode\r\n01001010  77dd7abb ADVAPI32!RegQueryValueExA\r\n01001014  77dd7852 ADVAPI32!RegOpenKeyExA\r\n01001018  77ddd767 ADVAPI32!RegSetValueExW\r\n0100101c  00000000\r\n01001020  773dd270 COMCTL32!CreateStatusWindowW\r\n01001024  00000000\r\n01001028  77f2dc61 GDI32!EndPage\r\n0100102c  77f44cd2 GDI32!AbortDoc\r\n01001030  77f2def1 GDI32!EndDoc\r\n01001034  77f16e5f GDI32!DeleteDC\r\n01001038  77f2f49e GDI32!StartPage\r\n0100103c  77f17f9d GDI32!GetTextExtentPoint32W\r\n01001040  77f1be38 GDI32!CreateDCW\r\n01001044  77f44df2 GDI32!SetAbortProc\r\n01001048  77f1a5cb GDI32!GetTextFaceW\r\n0100104c  77f17eac GDI32!TextOutW\r\n01001050  77f45962 GDI32!StartDocW\r\n01001054  77f3fe18 GDI32!EnumFontsW\r\n01001058  77f161c1 GDI32!GetStockObject\r\n0100105c  77f183b3 GDI32!GetObjectW\r\n01001060  77f15a71 GDI32!GetDeviceCaps\r\n01001064  77f1939e GDI32!CreateFontIndirectW\r\n01001068  77f16bfa GDI32!DeleteObject\r\n0100106c  77f17db9 GDI32!GetTextMetricsW\r\n01001070  77f15edb GDI32!SetBkMode\r\n01001074  77f1d4c7 GDI32!LPtoDP\r\n01001078  77f272d4 GDI32!SetWindowExtEx\r\n0100107c  77f2737d GDI32!SetViewportExtEx\r\n01001080  77f1941f GDI32!SetMapMode\r\n01001084  77f15b70 GDI32!SelectObject\r\n01001088  00000000\r\n0100108c  7c8097d0 kernel32!GetCurrentThreadId\r\n01001090  7c80934a kernel32!GetTickCount\r\n01001094  7c80a4c7 kernel32!QueryPerformanceCounter\r\n01001098  7c80a874 kernel32!GetLocalTime\r\n0100109c  7c809fb0 kernel32!GetUserDefaultLCID\r\n010010a0  7c833775 kernel32!GetDateFormatW\r\n010010a4  7c833fd3 kernel32!GetTimeFormatW\r\n010010a8  7c80ffb9 kernel32!GlobalLock\r\n010010ac  7c80ff22 kernel32!GlobalUnlock\r\n010010b0  7c810d0d kernel32!GetFileInformationByHandle\r\n010010b4  7c80943c kernel32!CreateFileMappingW\r\n010010b8  7c8017e9 kernel32!GetSystemTimeAsFileTime\r\n010010bc  7c801e1a kernel32!TerminateProcess\r\n010010c0  7c80de95 kernel32!GetCurrentProcess\r\n010010c4  7c844935 kernel32!SetUnhandledExceptionFilter\r\n010010c8  7c801d7b kernel32!LoadLibraryA\r\n010010cc  7c80b741 kernel32!GetModuleHandleA\r\n010010d0  7c801ef2 kernel32!GetStartupInfoA\r\n010010d4  7c80fccf kernel32!GlobalFree\r\n010010d8  7c811602 kernel32!GetLocaleInfoW\r\n010010dc  7c8099cf kernel32!LocalFree\r\n010010e0  7c809a2d kernel32!LocalAlloc\r\n010010e4  7c809aa9 kernel32!lstrlenW\r\n010010e8  7c832eb1 kernel32!LocalUnlock\r\n010010ec  7c80a3fe kernel32!CompareStringW\r\n..............</pre>\r\n</div>So, we get a nice clean list of the Function Names, the module name from which they are imported and the absolute virtual addresses.<br />\r\n<br />\r\nIt is good to know how to fetch an IAT of a PE image since we can use this output to detect any sort of IAT Hooks. We will look into IAT hooks later which is a technique used by rootkits to take control of the functions in a DLL by overwriting the function pointers in the IAT.<br />\r\n<br />\r\nThe question now is, how did the IAT get filled up with these values at run time?<br />\r\n<br />\r\nWhen the OS Loader starts the PE, it will fill the IAT with function pointers to the imported functions from various loaded modules. We will try to find out how it got to know these function pointers.<br />\r\n<br />\r\nLet\'s take an example to understand this better. My PE image makes use of a function called GetCurrentProcess from kernel32.dll. The kernel32.dll file exports these functions to our PE image.<br />\r\n<br />\r\nPE image imports the functions from kernel32.dll<br />\r\nkernel32.dll exports the functions to our PE image.<br />\r\n<br />\r\nSo, there\'s a handshake taking place <img src="images/smilies/smile.png" border="0" alt="" title="Smile" class="inlineimg" /><br />\r\n<br />\r\nThis is a complicated concept to grasp but it should become clear with an example.<br />\r\n<br />\r\nEach loaded module will have it\'s own Export Directory. This export directory is a structure called, <b>IMAGE_EXPORT_DIRECTORY</b>, having the following form:<br />\r\n<br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:180px;">Private Type IMAGE_EXPORT_DIRECTORY\r\n   Characteristics As Long\r\n   TimeDateStamp As Long\r\n   MajorVersion As Integer\r\n   MinorVersion As Integer\r\n   lpName As Long\r\n   Base As Long\r\n   NumberOfFunctions As Long\r\n   NumberOfNames As Long\r\n   lpAddressOfFunctions As Long    \r\n   lpAddressOfNames As Long     \r\n   lpAddressOfNameOrdinals As Long\r\nEnd Type</pre>\r\n</div>This structure will help us understand the export directory. I would recommend the article by Iczelion on Export Directory to understand it better.\r\n						</blockquote>\r\n					</div>\r\n\r\n					\r\n				</div>\r\n			</div>\r\n			\r\n			<div class="cleardiv"></div>\r\n		</div>\r\n	</div>\r\n		<div class="postfoot">\r\n			<!-' + '- <div class="postfoot_container"> -' + '->\r\n			<div class="textcontrols floatcontainer">\r\n				<span class="postcontrols">\r\n					<img style="display:none" id="progress_6756" src="images/misc/progress.gif" alt="" />\r\n					\r\n					\r\n					\r\n						<a id="qrwq_6756" class="newreply" href="newreply.php?do=newreply&amp;p=6756" rel="nofollow" title="Reply With Quote"><img id="quoteimg_6756" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> \r\n					\r\n					\r\n					\r\n				</span>\r\n				<span class="postlinking">\r\n					\r\n						\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n\r\n					\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n					\r\n				</span>\r\n			<!-' + '- </div> -' + '->\r\n			</div>\r\n		</div>\r\n	<hr />\r\n</li>\r\n';
pd[6757] = '\r\n<li class="postbitlegacy postbitim postcontainer old" id="post_6757">\r\n<!-' + '- see bottom of postbit.css for .userinfo .popupmenu styles -' + '->\r\n\r\n	<div class="posthead">\r\n			<span class="postdate old">\r\n				\r\n					<span class="date">12-29-2011,&nbsp;<span class="time">12:15 PM</span></span>\r\n				\r\n			</span>\r\n			<span class="nodecontrols">\r\n				\r\n					<a name="post6757" href="showthread.php?t=1862&amp;p=6757&amp;viewfull=1#post6757" class="postcounter">#4</a><a id="postcount6757" name="4"></a>\r\n				\r\n				\r\n				\r\n			</span>\r\n	</div>\r\n	<div class="postdetails">\r\n		<div class="userinfo">\r\n			<div class="username_container">\r\n			\r\n				<div class="popupmenu memberaction">\r\n	<a class="username offline popupctrl" href="member.php?u=311" title="c0d3inj3cT is offline"><strong>c0d3inj3cT</strong></a>\r\n	<ul class="popupbody popuphover memberaction_body">\r\n		<li class="left">\r\n			<a href="member.php?u=311" class="siteicon_profile">\r\n				View Profile\r\n			</a>\r\n		</li>\r\n		\r\n		<li class="right">\r\n			<a href="search.php?do=finduser&amp;userid=311&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">\r\n				View Forum Posts\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="private.php?do=newpm&amp;u=311" class="siteicon_message" rel="nofollow">\r\n				Private Message\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="blog.php?u=311" class="siteicon_blog" rel="nofollow">\r\n				View Blog Entries\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="http://garage4hackers.com/list.php?r=author/311-c0d3inj3cT" class="siteicon_article" rel="nofollow">\r\n				View Articles\r\n			</a>\r\n		</li>\r\n		\r\n\r\n		\r\n\r\n		\r\n		\r\n	</ul>\r\n</div>\r\n				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.png" alt="c0d3inj3cT is offline" border="0" />\r\n\r\n			\r\n			</div>\r\n			<span class="usertitle">\r\n				Garage Member\r\n			</span>\r\n			\r\n			\r\n			\r\n				<span class="postbit_reputation" id="repdisplay_6757_311" title="c0d3inj3cT will become famous soon enough">\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n				</span>\r\n			\r\n			 \r\n			\r\n				<hr />\r\n				<dl class="userinfo_extra">\r\n					<dt>Join Date</dt> <dd>Dec 2010</dd>\r\n					\r\n					\r\n					<dt>Posts</dt> <dd>67</dd>	\r\n					<dt>Blog Entries</dt><dd><a href="blog.php?u=311">2</a></dd>\r\n				</dl>\r\n				\r\n				\r\n				<div class="imlinks">\r\n					    \r\n				</div>\r\n			\r\n		</div>\r\n		<div class="postbody">\r\n			<div class="postrow">\r\n				\r\n				\r\n\r\n\r\n						\r\n						\r\n				<div class="content">\r\n					<div id="post_message_6757">\r\n						<blockquote class="postcontent restore ">\r\n							A summary of the Structure: This structure contains pointers to 3 Arrays. The pointers are in the form of RVAs relative to the base address of the Image.<br />\r\n<br />\r\nWhat are these arrays?<br />\r\n<br />\r\n<b>AddressOfFunctions:</b> It is an array of RVAs of the functions in the module.<br />\r\n<br />\r\n<b>AddressOfNames:</b> It is an array of RVAs each corresponding to the function name strings of exported functions.<br />\r\n<br />\r\n<b>AddressOfNameOrdinals:</b> This array is in sync with the AddressOfNames array and there is a one to one correspondence between the two. It gives an index or an offset into the AddressOfFunctions array to get the Address of the Function Name.<br />\r\n<br />\r\nSo, the flow is like this:<br />\r\n<br />\r\nThe function name is fetched using Export Names Table and the corresponding entry in the Export Ordinals Table is looked up to get the index or offset. This index is used to parse the Export Address Table and fetch the Function Address.<br />\r\n<br />\r\n<b>Export Names Table &gt; Export Ordinals Table -&gt; Export Address Table = Function Address (VA).</b><br />\r\n<br />\r\nThis should make it clear how the OS Loader gets to know the addresses of Functions which are imported by the main module from these loaded modules.<br />\r\n<br />\r\nViewing the Exported Function Names:<br />\r\n<br />\r\nLet\'s say, I want to view all the functions exported by the GDI32.dll module.<br />\r\n<br />\r\nI need to first view the data directory of gdi32.dll:<br />\r\n<br />\r\n<b>!dh gdi32 -f</b><br />\r\n<br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:372px;">File Type: DLL\r\nFILE HEADER VALUES\r\n     14C machine (i386)\r\n       4 number of sections\r\n4900717E time date stamp Thu Oct 23 18:13:42 2008\r\n\r\n       0 file pointer to symbol table\r\n       0 number of symbols\r\n      E0 size of optional header\r\n    210E characteristics\r\n            Executable\r\n            Line numbers stripped\r\n            Symbols stripped\r\n            32 bit word machine\r\n            DLL\r\n\r\nOPTIONAL HEADER VALUES\r\n     10B magic #\r\n    7.10 linker version\r\n   42C00 size of code\r\n    3000 size of initialized data\r\n       0 size of uninitialized data\r\n    6587 address of entry point\r\n    1000 base of code\r\n         -' + '-' + '-' + '-' + '- new -' + '-' + '-' + '-' + '-\r\n77f10000 image base\r\n    1000 section alignment\r\n     200 file alignment\r\n       3 subsystem (Windows CUI)\r\n    5.01 operating system version\r\n    5.01 image version\r\n    4.10 subsystem version\r\n   49000 size of image\r\n     400 size of headers\r\n   52F15 checksum\r\n00040000 size of stack reserve\r\n00001000 size of stack commit\r\n00100000 size of heap reserve\r\n00001000 size of heap commit\r\n       0  DLL characteristics\r\n    1CA0 [    3CD6] address [size] of Export Directory\r\n   42F24 [      50] address [size] of Import Directory\r\n   46000 [     3D0] address [size] of Resource Directory\r\n       0 [       0] address [size] of Exception Directory\r\n       0 [       0] address [size] of Security Directory\r\n   47000 [    1870] address [size] of Base Relocation Directory\r\n   43A10 [      38] address [size] of Debug Directory\r\n       0 [       0] address [size] of Description Directory\r\n       0 [       0] address [size] of Special Directory\r\n       0 [       0] address [size] of Thread Storage Directory\r\n   2B098 [      40] address [size] of Load Configuration Directory\r\n       0 [       0] address [size] of Bound Import Directory\r\n    1000 [     1E8] address [size] of Import Address Table Directory\r\n       0 [       0] address [size] of Delay Import Directory\r\n       0 [       0] address [size] of COR20 Header Directory\r\n       0 [       0] address [size] of Reserved Directory</pre>\r\n</div>We are interested in the Export Directory:<br />\r\n<br />\r\n <div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:36px;">1CA0 [    3CD6] address [size] of Export Directory</pre>\r\n</div>So, the offset of the Export Directory is 1CA0 relative to the Image Base Address.<br />\r\n<br />\r\nLet\'s view the IMAGE_EXPORT_DIRECTORY structure in the memory:<br />\r\n<br />\r\nThe base address of gdi32.dll is: 77f10000<br />\r\n<br />\r\n<b>dd 77f10000+1CA0</b><br />\r\n<br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:120px;">77f11ca0  00000000 48ff5bdd 00000000 0000349c\r\n77f11cb0  00000001 00000262 00000262 00001cc8\r\n77f11cc0  00002650 00002fd8 00034cd2 00036009\r\n77f11cd0  0002f7d5 00019415 0001942f 0002ffc5\r\n77f11ce0  0002fe78 0002ffab 00035069 0002d182\r\n77f11cf0  00041fda 0003511b 00035207 000204cc\r\n77f11d00  00042b64 00042b78 0001cd62 0001d4b0\r\n77f11d10  00006f79 0001f0a6 0001f0ba 00042b16</pre>\r\n</div>Focus on first 3 rows. The first column has the memory address. We need to focus on the values in the next 4 columns for the first 3 rows.<br />\r\n<br />\r\nParsing these values and comparing them with the IMAGE_EXPORT_DIRECTORY structure definition we get:<br />\r\n<br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:156px;">Characteristics = 00000000\r\nTimeDateStamp = 48ff5bdd\r\nMajorVersion = 0000\r\nMinorVersion = 0000\r\nlpName = 0000349c\r\nBase = 00000001\r\nNumberOfFunctions = 00000262\r\nNumberOfNames = 00000262\r\nlpAddressOfFunctions = 00001cc8\r\nlpAddressOfNames = 00002650\r\nlpAddressOfNameOrdinals = 00002fd8</pre>\r\n</div>From this, we get the pointers to the 3 arrays.\r\n						</blockquote>\r\n					</div>\r\n\r\n					\r\n				</div>\r\n			</div>\r\n			\r\n			<div class="cleardiv"></div>\r\n		</div>\r\n	</div>\r\n		<div class="postfoot">\r\n			<!-' + '- <div class="postfoot_container"> -' + '->\r\n			<div class="textcontrols floatcontainer">\r\n				<span class="postcontrols">\r\n					<img style="display:none" id="progress_6757" src="images/misc/progress.gif" alt="" />\r\n					\r\n					\r\n					\r\n						<a id="qrwq_6757" class="newreply" href="newreply.php?do=newreply&amp;p=6757" rel="nofollow" title="Reply With Quote"><img id="quoteimg_6757" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> \r\n					\r\n					\r\n					\r\n				</span>\r\n				<span class="postlinking">\r\n					\r\n						\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n\r\n					\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n					\r\n				</span>\r\n			<!-' + '- </div> -' + '->\r\n			</div>\r\n		</div>\r\n	<hr />\r\n</li>\r\n';
pd[6758] = '\r\n<li class="postbitlegacy postbitim postcontainer old" id="post_6758">\r\n<!-' + '- see bottom of postbit.css for .userinfo .popupmenu styles -' + '->\r\n\r\n	<div class="posthead">\r\n			<span class="postdate old">\r\n				\r\n					<span class="date">12-29-2011,&nbsp;<span class="time">12:18 PM</span></span>\r\n				\r\n			</span>\r\n			<span class="nodecontrols">\r\n				\r\n					<a name="post6758" href="showthread.php?t=1862&amp;p=6758&amp;viewfull=1#post6758" class="postcounter">#5</a><a id="postcount6758" name="5"></a>\r\n				\r\n				\r\n				\r\n			</span>\r\n	</div>\r\n	<div class="postdetails">\r\n		<div class="userinfo">\r\n			<div class="username_container">\r\n			\r\n				<div class="popupmenu memberaction">\r\n	<a class="username offline popupctrl" href="member.php?u=311" title="c0d3inj3cT is offline"><strong>c0d3inj3cT</strong></a>\r\n	<ul class="popupbody popuphover memberaction_body">\r\n		<li class="left">\r\n			<a href="member.php?u=311" class="siteicon_profile">\r\n				View Profile\r\n			</a>\r\n		</li>\r\n		\r\n		<li class="right">\r\n			<a href="search.php?do=finduser&amp;userid=311&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">\r\n				View Forum Posts\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="private.php?do=newpm&amp;u=311" class="siteicon_message" rel="nofollow">\r\n				Private Message\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="blog.php?u=311" class="siteicon_blog" rel="nofollow">\r\n				View Blog Entries\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="http://garage4hackers.com/list.php?r=author/311-c0d3inj3cT" class="siteicon_article" rel="nofollow">\r\n				View Articles\r\n			</a>\r\n		</li>\r\n		\r\n\r\n		\r\n\r\n		\r\n		\r\n	</ul>\r\n</div>\r\n				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.png" alt="c0d3inj3cT is offline" border="0" />\r\n\r\n			\r\n			</div>\r\n			<span class="usertitle">\r\n				Garage Member\r\n			</span>\r\n			\r\n			\r\n			\r\n				<span class="postbit_reputation" id="repdisplay_6758_311" title="c0d3inj3cT will become famous soon enough">\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n				</span>\r\n			\r\n			 \r\n			\r\n				<hr />\r\n				<dl class="userinfo_extra">\r\n					<dt>Join Date</dt> <dd>Dec 2010</dd>\r\n					\r\n					\r\n					<dt>Posts</dt> <dd>67</dd>	\r\n					<dt>Blog Entries</dt><dd><a href="blog.php?u=311">2</a></dd>\r\n				</dl>\r\n				\r\n				\r\n				<div class="imlinks">\r\n					    \r\n				</div>\r\n			\r\n		</div>\r\n		<div class="postbody">\r\n			<div class="postrow">\r\n				\r\n				\r\n\r\n\r\n						\r\n						\r\n				<div class="content">\r\n					<div id="post_message_6758">\r\n						<blockquote class="postcontent restore ">\r\n							Let\'s get the list of function names now:<br />\n<br />\nThe RVA of the pointer to AddressOfNames array is: 00002650<br />\n<br />\nto dump the contents of this array, let\'s add it to the base address and display:<br />\n<br />\n<b>dd 77f10000+00002650</b><br />\n<br />\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:120px;">77f12650  000034a6 000034af 000034b9 000034ce\n77f12660  000034df 000034f2 00003505 0000351d\n77f12670  0000352e 00003537 00003546 00003555\n77f12680  00003559 0000355f 0000357b 00003592\n77f12690  000035a7 000035c0 000035ca 000035d1\n77f126a0  000035df 000035f2 00003605 0000360e\n77f126b0  00003621 00003633 00003639 0000364f\n77f126c0  00003664 00003675 00003681 0000368f</pre>\r\n</div>So, we got the list of RVAs now. Each of these RVAs when added to the base address of gdi32.dll will point to the Function Name string. Let\'s check by taking the first RVA from this list: 000034a6<br />\n<br />\n<b>da gdi32+000034a6</b><br />\n<br />\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:36px;">77f134a6  &quot;AbortDoc&quot;</pre>\r\n</div>to get the next function name:<br />\n<br />\n<b>da gdi32+000034af</b><br />\n<br />\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:36px;">77f134af  &quot;AbortPath&quot;</pre>\r\n</div>This way, we can get the list of function names.<br />\n<br />\nThe <b>NumberOfNames</b> field in the <b>IMAGE_EXPORT_DIRECTORY</b> structure had a value of 262. It means, that there are 262 function names exported by gdi32.dll. We cannot list all of them manually, that would be a very tedious task.<br />\n<br />\nSo, I will make use of a windbg script to iterate through these RVAs and grab the corresponding Function Name String.<br />\n<br />\nBefore we write the script, let\'s make sure that our expression evaluator is set to MASM:<br />\n<br />\nCurrent Expression Evaulator:<br />\n<br />\n<b>.expr /q</b><br />\n<br />\n<b>Current expression evaluator: MASM - Microsoft Assembler expressions</b><br />\n<br />\nNow, the windbg script:<br />\n<br />\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:60px;">r? @$t0 = ((int *) (0x77f12650))\n\n.for (r @$t1 = 0; @$t1 &lt; 100; r @$t1 = @$t1 + 1) {da gdi32+(@@c++(@$t0[@$t1]));}</pre>\r\n</div>0x77f12650 is a pointer to the first element of the AddressOfNames array. <br />\n<br />\nIt is obtained by adding the base address of gdi32.dll (0x77f10000) to the RVA of AddressOfNames array (00002650) as given in the IMAGE_EXPORT_DIRECTORY structure.<br />\n<br />\nI save this script as parser.wds in the path: C:\\Scripts\\parser.wds and execute as follows:<br />\n<br />\n<b>$$&gt;&lt;C:\\Scripts\\parser.wds</b><br />\n<br />\nIt gives me the list of function names as follows:<br />\n<br />\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:372px;">77f134a6  &quot;AbortDoc&quot;\n77f134af  &quot;AbortPath&quot;\n77f134b9  &quot;AddFontMemResourceEx&quot;\n77f134ce  &quot;AddFontResourceA&quot;\n77f134df  &quot;AddFontResourceExA&quot;\n77f134f2  &quot;AddFontResourceExW&quot;\n77f13505  &quot;AddFontResourceTracking&quot;\n77f1351d  &quot;AddFontResourceW&quot;\n77f1352e  &quot;AngleArc&quot;\n77f13537  &quot;AnimatePalette&quot;\n77f13546  &quot;AnyLinkedFonts&quot;\n77f13555  &quot;Arc&quot;\n77f13559  &quot;ArcTo&quot;\n77f1355f  &quot;BRUSHOBJ_hGetColorTransform&quot;\n77f1357b  &quot;BRUSHOBJ_pvAllocRbrush&quot;\n77f13592  &quot;BRUSHOBJ_pvGetRbrush&quot;\n77f135a7  &quot;BRUSHOBJ_ulGetBrushColor&quot;\n77f135c0  &quot;BeginPath&quot;\n77f135ca  &quot;BitBlt&quot;\n77f135d1  &quot;CLIPOBJ_bEnum&quot;\n77f135df  &quot;CLIPOBJ_cEnumStart&quot;\n77f135f2  &quot;CLIPOBJ_ppoGetPath&quot;\n77f13605  &quot;CancelDC&quot;\n77f1360e  &quot;CheckColorsInGamut&quot;\n77f13621  &quot;ChoosePixelFormat&quot;\n77f13633  &quot;Chord&quot;\n77f13639  &quot;ClearBitmapAttributes&quot;\n77f1364f  &quot;ClearBrushAttributes&quot;\n77f13664  &quot;CloseEnhMetaFile&quot;\n77f13675  &quot;CloseFigure&quot;\n77f13681  &quot;CloseMetaFile&quot;\n77f1368f  &quot;ColorCorrectPalette&quot;\n77f136a3  &quot;ColorMatchToTarget&quot;\n77f136b6  &quot;CombineRgn&quot;\n77f136c1  &quot;CombineTransform&quot;\n77f136d2  &quot;CopyEnhMetaFileA&quot;\n77f136e3  &quot;CopyEnhMetaFileW&quot;\n77f136f4  &quot;CopyMetaFileA&quot;\n77f13702  &quot;CopyMetaFileW&quot;\n77f13710  &quot;CreateBitmap&quot;\n77f1371d  &quot;CreateBitmapIndirect&quot;\n77f13732  &quot;CreateBrushIndirect&quot;\n77f13746  &quot;CreateColorSpaceA&quot;\n.......</pre>\r\n</div>In this way, we can walk through the list of function names using the Export Directory structure of a loaded module.<br />\n<br />\nImportant thing to note is, if we use the x command to list the export symbols, that\'s going to be more verbose and different from the above output:<br />\n<br />\n<b>x gdi32!* = All the exported symbols.</b>\r\n						</blockquote>\r\n					</div>\r\n\r\n					\r\n				</div>\r\n			</div>\r\n			\r\n			<div class="cleardiv"></div>\r\n		</div>\r\n	</div>\r\n		<div class="postfoot">\r\n			<!-' + '- <div class="postfoot_container"> -' + '->\r\n			<div class="textcontrols floatcontainer">\r\n				<span class="postcontrols">\r\n					<img style="display:none" id="progress_6758" src="images/misc/progress.gif" alt="" />\r\n					\r\n					\r\n					\r\n						<a id="qrwq_6758" class="newreply" href="newreply.php?do=newreply&amp;p=6758" rel="nofollow" title="Reply With Quote"><img id="quoteimg_6758" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> \r\n					\r\n					\r\n					\r\n				</span>\r\n				<span class="postlinking">\r\n					\r\n						\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n\r\n					\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n					\r\n				</span>\r\n			<!-' + '- </div> -' + '->\r\n			</div>\r\n		</div>\r\n	<hr />\r\n</li>\r\n';

// next/previous post info
pn[6754] = "6758,6755";
pn[0] = ",6754";
pn[6755] = "6754,6756";
pn[6756] = "6755,6757";
pn[6757] = "6756,6758";
pn[6758] = "6757,6754";

// cached usernames
pu[0] = guestphrase;
pu[311] = "c0d3inj3cT";

// -->
</script>


<div id="threaded_view">
	<h4>Threaded View</h4>

	<div id="posttree">
		<script type="text/javascript">
		<!--
			writeLink(6754, 0, 0, 311, "", "PE's Import Address Table and...", "12-29-2011", "12:01 PM", 0, "showthread284f.html?t=1862&amp;p=6754#post6754");
  writeLink(6755, 0, 0, 311, "T", "<i>PE Header: Let's see how the...</i>", "12-29-2011", "12:04 PM", 0, "showthread66f3.html?t=1862&amp;p=6755#post6755");
  writeLink(6756, 0, 0, 311, "T", "<i>The data directories I am...</i>", "12-29-2011", "12:10 PM", 0, "showthread3744.html?t=1862&amp;p=6756#post6756");
  writeLink(6757, 0, 0, 311, "T", "<i>A summary of the Structure:...</i>", "12-29-2011", "12:15 PM", 0, "showthread778c.html?t=1862&amp;p=6757#post6757");
  writeLink(6758, 0, 0, 311, "L", "<i>Let's get the list of...</i>", "12-29-2011", "12:18 PM", 0, "showthread95e4.html?t=1862&amp;p=6758#post6758");

		//-->
		</script>
	</div>
</div>
	

	
		<ol class="posts" id="posts" start="1">
			
<li class="postbitlegacy postbitim postcontainer old" id="post_6758">
<!-- see bottom of postbit.css for .userinfo .popupmenu styles -->

	<div class="posthead">
			<span class="postdate old">
				
					<span class="date">12-29-2011, <span class="time">12:18 PM</span></span>
				
			</span>
			<span class="nodecontrols">
				
					<a class="postcounter" href="showthread76a7-2.html?t=1862&amp;p=6758&amp;viewfull=1#post6758" name="post6758">#5</a><a id="postcount6758" name="5"></a>
				
				
				
			</span>
	</div>
	<div class="postdetails">
		<div class="userinfo">
			<div class="username_container">
			
				<div class="popupmenu memberaction">
	<a class="username offline popupctrl" href="memberdb73.html?u=311" title="c0d3inj3cT is offline"><strong>c0d3inj3cT</strong></a>
	<ul class="popupbody popuphover memberaction_body">
		<li class="left">
			<a class="siteicon_profile" href="memberdb73.html?u=311">
				View Profile
			</a>
		</li>
		
		<li class="right">
			<a class="siteicon_forum" href="search9737.html?do=finduser&amp;userid=311&amp;contenttype=vBForum_Post&amp;showposts=1" rel="nofollow">
				View Forum Posts
			</a>
		</li>
		
		
		<li class="left">
			<a class="siteicon_message" href="private1fcf.html?do=newpm&amp;u=311" rel="nofollow">
				Private Message
			</a>
		</li>
		
		
		
		<li class="right">
			<a class="siteicon_blog" href="blogdb73.html?u=311" rel="nofollow">
				View Blog Entries
			</a>
		</li>
		
		
		
		
		
		<li class="right">
			<a class="siteicon_article" href="list1ee8.html?r=author/311-c0d3inj3cT" rel="nofollow">
				View Articles
			</a>
		</li>
		

		

		
		
	</ul>
</div>
				<img alt="c0d3inj3cT is offline" border="0" class="inlineimg onlinestatus" src="images/statusicon/user-offline.png"/>

			
			</div>
			<span class="usertitle">
				Garage Member
			</span>
			
			
			
				<span class="postbit_reputation" id="repdisplay_6758_311" title="c0d3inj3cT will become famous soon enough">
					
						<img alt="" class="repimg" src="images/reputation/reputation_pos.png"/>
					
						<img alt="" class="repimg" src="images/reputation/reputation_pos.png"/>
					
				</span>
			
			 
			
				<hr/>
				<dl class="userinfo_extra">
					<dt>Join Date</dt> <dd>Dec 2010</dd>
					
					
					<dt>Posts</dt> <dd>67</dd>	
					<dt>Blog Entries</dt><dd><a href="blogdb73.html?u=311">2</a></dd>
				</dl>
				
				
				<div class="imlinks">
					    
				</div>
			
		</div>
		<div class="postbody">
			<div class="postrow">
				
				


						
						
				<div class="content">
					<div id="post_message_6758">
						<blockquote class="postcontent restore">
							Let's get the list of function names now:<br/>
<br/>
The RVA of the pointer to AddressOfNames array is: 00002650<br/>
<br/>
to dump the contents of this array, let's add it to the base address and display:<br/>
<br/>
<b>dd 77f10000+00002650</b><br/>
<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code" style="height:120px;">77f12650  000034a6 000034af 000034b9 000034ce
77f12660  000034df 000034f2 00003505 0000351d
77f12670  0000352e 00003537 00003546 00003555
77f12680  00003559 0000355f 0000357b 00003592
77f12690  000035a7 000035c0 000035ca 000035d1
77f126a0  000035df 000035f2 00003605 0000360e
77f126b0  00003621 00003633 00003639 0000364f
77f126c0  00003664 00003675 00003681 0000368f</pre>
</div>So, we got the list of RVAs now. Each of these RVAs when added to the base address of gdi32.dll will point to the Function Name string. Let's check by taking the first RVA from this list: 000034a6<br/>
<br/>
<b>da gdi32+000034a6</b><br/>
<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code" style="height:36px;">77f134a6  "AbortDoc"</pre>
</div>to get the next function name:<br/>
<br/>
<b>da gdi32+000034af</b><br/>
<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code" style="height:36px;">77f134af  "AbortPath"</pre>
</div>This way, we can get the list of function names.<br/>
<br/>
The <b>NumberOfNames</b> field in the <b>IMAGE_EXPORT_DIRECTORY</b> structure had a value of 262. It means, that there are 262 function names exported by gdi32.dll. We cannot list all of them manually, that would be a very tedious task.<br/>
<br/>
So, I will make use of a windbg script to iterate through these RVAs and grab the corresponding Function Name String.<br/>
<br/>
Before we write the script, let's make sure that our expression evaluator is set to MASM:<br/>
<br/>
Current Expression Evaulator:<br/>
<br/>
<b>.expr /q</b><br/>
<br/>
<b>Current expression evaluator: MASM - Microsoft Assembler expressions</b><br/>
<br/>
Now, the windbg script:<br/>
<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code" style="height:60px;">r? @$t0 = ((int *) (0x77f12650))

.for (r @$t1 = 0; @$t1 &lt; 100; r @$t1 = @$t1 + 1) {da gdi32+(@@c++(@$t0[@$t1]));}</pre>
</div>0x77f12650 is a pointer to the first element of the AddressOfNames array. <br/>
<br/>
It is obtained by adding the base address of gdi32.dll (0x77f10000) to the RVA of AddressOfNames array (00002650) as given in the IMAGE_EXPORT_DIRECTORY structure.<br/>
<br/>
I save this script as parser.wds in the path: C:\Scripts\parser.wds and execute as follows:<br/>
<br/>
<b>$$&gt;&lt;C:\Scripts\parser.wds</b><br/>
<br/>
It gives me the list of function names as follows:<br/>
<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code" style="height:372px;">77f134a6  "AbortDoc"
77f134af  "AbortPath"
77f134b9  "AddFontMemResourceEx"
77f134ce  "AddFontResourceA"
77f134df  "AddFontResourceExA"
77f134f2  "AddFontResourceExW"
77f13505  "AddFontResourceTracking"
77f1351d  "AddFontResourceW"
77f1352e  "AngleArc"
77f13537  "AnimatePalette"
77f13546  "AnyLinkedFonts"
77f13555  "Arc"
77f13559  "ArcTo"
77f1355f  "BRUSHOBJ_hGetColorTransform"
77f1357b  "BRUSHOBJ_pvAllocRbrush"
77f13592  "BRUSHOBJ_pvGetRbrush"
77f135a7  "BRUSHOBJ_ulGetBrushColor"
77f135c0  "BeginPath"
77f135ca  "BitBlt"
77f135d1  "CLIPOBJ_bEnum"
77f135df  "CLIPOBJ_cEnumStart"
77f135f2  "CLIPOBJ_ppoGetPath"
77f13605  "CancelDC"
77f1360e  "CheckColorsInGamut"
77f13621  "ChoosePixelFormat"
77f13633  "Chord"
77f13639  "ClearBitmapAttributes"
77f1364f  "ClearBrushAttributes"
77f13664  "CloseEnhMetaFile"
77f13675  "CloseFigure"
77f13681  "CloseMetaFile"
77f1368f  "ColorCorrectPalette"
77f136a3  "ColorMatchToTarget"
77f136b6  "CombineRgn"
77f136c1  "CombineTransform"
77f136d2  "CopyEnhMetaFileA"
77f136e3  "CopyEnhMetaFileW"
77f136f4  "CopyMetaFileA"
77f13702  "CopyMetaFileW"
77f13710  "CreateBitmap"
77f1371d  "CreateBitmapIndirect"
77f13732  "CreateBrushIndirect"
77f13746  "CreateColorSpaceA"
.......</pre>
</div>In this way, we can walk through the list of function names using the Export Directory structure of a loaded module.<br/>
<br/>
Important thing to note is, if we use the x command to list the export symbols, that's going to be more verbose and different from the above output:<br/>
<br/>
<b>x gdi32!* = All the exported symbols.</b>
						</blockquote>
					</div>

					
				</div>
			</div>
			
			<div class="cleardiv"></div>
		</div>
	</div>
		<div class="postfoot">
			<!-- <div class="postfoot_container"> -->
			<div class="textcontrols floatcontainer">
				<span class="postcontrols">
					<img alt="" id="progress_6758" src="images/misc/progress.gif" style="display:none"/>
					
					
					
						<a class="newreply" href="newreply6ab3.html?do=newreply&amp;p=6758" id="qrwq_6758" rel="nofollow" title="Reply With Quote"><img alt="Reply With Quote" id="quoteimg_6758" src="clear.gif"/>  Reply With Quote</a> 
					
					
					
				</span>
				<span class="postlinking">
					
						
					

					
					
					
					

					
					

					
					
					
					
					
				</span>
			<!-- </div> -->
			</div>
		</div>
	<hr/>
</li>

		</ol>
                <div class="separator"></div>
		<div class="postlistfoot">
			
		</div>

	

</div>

<div class="noinlinemod below_postlist" id="below_postlist">
	
	<div class="pagination_bottom" id="pagination_bottom">
	
		<div class="clear"></div>
<div class="navpopupmenu popupmenu nohovermenu" id="showthread_navpopup">
	
		<span class="shade">Quick Navigation</span>
		<a class="popupctrl" href="showthread3577-2.html?t=1862"><span class="ctrlcontainer">Reverse Engineering and Application Cracking</span></a>
		<a class="textcontrol" href="showthread95e4.html?t=1862&amp;p=6758#top" onclick="document.location.hash='top';return false;">Top</a>
	
	<ul class="navpopupbody popupbody popuphover">
		
		<li class="optionlabel">Site Areas</li>
		<li><a href="usercp.html">Settings</a></li>
		<li><a href="private.html">Private Messages</a></li>
		<li><a href="subscription.html">Subscriptions</a></li>
		<li><a href="online.html">Who's Online</a></li>
		<li><a href="search.html">Search Forums</a></li>
		<li><a href="forum.html">Forums Home</a></li>
		
			<li class="optionlabel">Forums</li>
			
		
			
				<li><a href="forumdisplay58da.html?f=1">Garage Network</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplay12a3.html?f=2">Garage Announcements</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplaye57d.html?f=58">Bravo - Null 2012</a></li>
			
		
			
				<li><a href="forumdisplay0756.html?f=59">Garage Local Chapter Meets</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplay31e6.html?f=4">Garage Rules</a></li>
			
		
			
				<li><a href="forumdisplaye774.html?f=5">Feedback &amp; Suggestions</a></li>
			
		
			
				<li><a href="forumdisplayd42b.html?f=7">Introduce Your Self</a></li>
			
		
			
				<li><a href="forumdisplay2b89.html?f=38">Shout-box</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplaycf19.html?f=6">Garage Lounge</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplay5579.html?f=30">Hacking for Beginners</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplay6ac3.html?f=57">Did You Know?</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplay957d.html?f=8">Security &amp; Hacking News Thread</a></li>
			
		
			
				<li><a href="forumdisplay3215.html?f=36">Career in InfoSec</a></li>
			
		
			
				<li><a href="forumdisplay814c.html?f=29">Request Zone</a></li>
			
		
			
				<li><a href="forumdisplay13b6.html?f=27">Noobs Corner</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplayfdc5.html?f=9">Hacking and Security Discussions</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplayfac0.html?f=55">Tip | Trick of the Day</a></li>
			
		
			
				<li><a href="forumdisplayc4a6.html?f=66">ICS / SCADA Security</a></li>
			
		
			
				<li><a href="forumdisplay6111.html?f=67">Internet of Things - IoT</a></li>
			
		
			
				<li><a href="forumdisplay15ca.html?f=10">Network Vulnerabiltity Assessment &amp; Penetration Testing</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplaya05c.html?f=56">Post Exploitation</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplay8a83.html?f=11">Web Application Penetration Testing</a></li>
			
		
			
				<li><a href="forumdisplay01c9.html?f=12">Wireless and Bluetooth Hacking</a></li>
			
		
			
				<li><a href="forumdisplay48ab.html?f=17">Computer Forensics and Incident Handling</a></li>
			
		
			
				<li><a href="forumdisplay218b.html?f=19">Physical Security and Social Engineering</a></li>
			
		
			
				<li><a href="forumdisplayb09f.html?f=15">General Security &amp; Best Practices</a></li>
			
		
			
				<li><a href="forumdisplay907f.html?f=42">Security and Hacking Videos</a></li>
			
		
			
				<li><a href="forumdisplay9e0d.html?f=54">Mobile Security</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplay9780.html?f=14">General Security Discussions</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplay9df8.html?f=31">Programming</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplay65b9.html?f=35">Assembly</a></li>
			
		
			
				<li><a href="forumdisplayc4f1.html?f=32">C/C++</a></li>
			
		
			
				<li><a href="forumdisplayb0a0.html?f=34">Perl</a></li>
			
		
			
				<li><a href="forumdisplayb8c1.html?f=60">PHP</a></li>
			
		
			
				<li><a href="forumdisplay6c4e.html?f=33">Python</a></li>
			
		
			
				<li><a href="forumdisplay208f.html?f=51">Linux Shell / Bash Programming</a></li>
			
		
			
				<li><a href="forumdisplay3238.html?f=47">Windows Batch Programming</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplayce40.html?f=28">BackTrack and Other Linux Distributions</a></li>
			
		
			
				<li><a href="forumdisplayf2fa.html?f=16">Networks &amp; Networking</a></li>
			
		
			
				<li><a href="forumdisplaya213.html?f=18">Cloud Computing</a></li>
			
		
			
				<li><a href="forumdisplaydfa4.html?f=39">Security Podcast and Videos</a></li>
			
		
			
				<li><a href="forumdisplaya3f5.html?f=40">Miscellanous Thread</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplay30ac.html?f=49">Brush Up Your Skills</a></li>
			
		
			
					</ol>
				</li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplayffeb.html?f=20">Experts Forum</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplaycdba.html?f=48">My Meanest Hacks</a></li>
			
		
			
				<li><a href="forumdisplayf6ac.html?f=37">Hacking &amp; Security Books and Tutorials</a></li>
			
		
			
				<li><a href="forumdisplay8011.html?f=23">Tools &amp; Scripts</a></li>
			
		
			
				<li><a href="forumdisplay8941.html?f=22">Exploitation Techniques</a></li>
			
		
			
				<li><a href="forumdisplay345c.html?f=24">Reverse Engineering and Application Cracking</a></li>
			
		
			
				<li><a href="forumdisplaye8b3.html?f=25">Botnets, Malwares &amp; Rootkits Analysis</a></li>
			
		
			
				<li><a href="forumdisplay107e.html?f=43">Garage4hackers Exploits</a></li>
			
		
			
				<li><a href="forumdisplaye5f3.html?f=64">Browser Fuzzing</a></li>
			
		
			
					</ol>
				</li>
			
		
		
	</ul>
</div>
<div class="clear"></div>
	</div>
</div>










<!-- next / previous links -->
<div class="navlinks">
	
	<strong>«</strong>
	<a href="showthread6fed.html?t=1862&amp;goto=nextoldest" rel="nofollow">Previous Thread</a>
	|
	<a href="showthreadb6c3.html?t=1862&amp;goto=nextnewest" rel="nofollow">Next Thread</a>
	<strong>»</strong>
	
</div>
<!-- / next / previous links -->

<div class="thread_info" id="thread_info">
	
	
	
	
	<h4 class="threadinfohead"><span class="optiontitle">Tags for this Thread</span></h4>
	<div class="thread_info_block" id="thread_tags_list">
		<div class="inner_block">
			
			<div id="tag_list_cell">
				
		
			<a href="tags64ed.html?tag=windbg">windbg</a>
		

<img alt="" class="inlineimg hidden" id="tag_form_progress" src="images/misc/11x11progress.gif"/>
			</div>
			<p>
				<a href="tags.html">View Tag Cloud</a>
			</p>
		</div>
	</div>
	
	<div class="options_block_container">
		
		<div class="options_block">
			<h4 class="collapse">
				<a class="collapse" href="showthread95e4.html?t=1862&amp;p=6758#top" id="collapse_posting_rules"><img alt="" src="images/buttons/collapse_40b.png"/></a>
				<span class="optiontitle">Posting Permissions</span>
			</h4>
			<div class="thread_info_block" id="posting_rules">
				
<div class="info_subblock" id="forumrules">

	<ul class="youcandoblock">
		<li>You <strong>may not</strong> post new threads</li>
		<li>You <strong>may not</strong> post replies</li>
		<li>You <strong>may not</strong> post attachments</li>
		<li>You <strong>may not</strong> edit your posts</li>
		<li> </li>
	</ul>
	<div class="bbcodeblock">
		<ul>
			<li><a href="miscaff0.html?do=bbcode" target="_blank">BB code</a> is <strong>On</strong></li>
			<li><a href="misc9712.html?do=showsmilies" target="_blank">Smilies</a> are <strong>On</strong></li>
			<li><a href="miscaff0.html?do=bbcode#imgcode" target="_blank">[IMG]</a> code is <strong>On</strong></li>
			<li><a href="miscaff0.html?do=bbcode#videocode" target="_blank">[VIDEO]</a> code is <strong>On</strong></li>
			<li>HTML code is <strong>Off</strong></li>
		</ul>
	</div>
	<p class="rules_link"><a href="misc17ec.html?do=showrules" target="_blank">Forum Rules</a></p>

</div>

			</div>
		</div>

	</div>

</div>








<div style="clear: left">
  
<div class="google_adsense_footer" style="width:468px; margin:0 auto; padding-top:1em">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6847984837250662";
google_ad_host = "ca-host-pub-2606800903002383";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "text_image";
google_ad_channel = "";
google_color_border = "";
google_color_bg = "";
google_color_link = "";
google_color_text = "";
google_color_url = "";
google_ui_features = "rc:6";
//-->
</script>
<script src="../pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>
</div>

  <div id="ad_global_above_footer"><div align="center">
<script type="text/javascript"><!--
google_ad_client = "pub-6847984837250662";
/* 728x90, created 7/9/10 */
google_ad_slot = "7101394260";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script src="../pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script></div>
</div>

<div class="floatcontainer footer" id="footer">

	<form action="../external.html?link=http://garage4hackers.com/forum.php" class="footer_select" id="footer_select" method="get">

		
			<select name="styleid" onchange="switch_id(this, 'style')">
				<optgroup label="Quick Style Chooser"><option class="hidden"></option></optgroup>
				
					
					<optgroup label=" Standard Styles">
									
					
	<option class="" selected="selected" value="1">-- Default Style</option>

					
					</optgroup>
										
				
				
					
					<optgroup label=" Mobile Styles">
					
					
	<option class="" value="2">-- Default Mobile Style</option>

					
					</optgroup>
										
				
			</select>	
		
		
		
	</form>

	<ul class="footer_links" id="footer_links">
		<li><a accesskey="9" href="sendmessage.html" rel="nofollow">Contact Us</a></li>
		<li><a href="index.html">Garage4hackers</a></li>
		
		
		<li><a href="archive/index.html">Archive</a></li>
		<li><a href="#" target="_blank">Web Hosting</a></li>
		
		
		<li><a href="showthread95e4.html?t=1862&amp;p=6758#top" onclick="document.location.hash='top'; return false;">Top</a></li>
	</ul>
	
	
	
	
	<script type="text/javascript">
	<!--
		// Main vBulletin Javascript Initialization
		vBulletin_init();
		function md5hash(B,A,E,C){if(navigator.userAgent.indexOf("Mozilla/index.html")==1&&parseInt(navigator.appVersion)>=4){var D=hex_md5(str_to_ent(trim(B.value)));A.value=D;if(E){D=hex_md5(trim(B.value));E.value=D}if(!C){B.value=""}}return true};
	//-->
	</script>
        
</div>
</div> <!-- closing div for body_wrapper -->

<div class="below_body">
<div class="shade footer_time" id="footer_time">All times are GMT +5.5. The time now is <span class="time">05:49 PM</span>.</div>

<div class="shade footer_copyright" id="footer_copyright">
	<!-- Do not remove this copyright notice -->
	Powered by <a href="https://www.vbulletin.com/" id="vbulletinlink">vBulletin®</a> Version 4.2.1 <br/>Copyright © 2020 vBulletin Solutions, Inc. All rights reserved. 
	<!-- Do not remove this copyright notice -->	
</div>
<div class="shade footer_morecopyright" id="footer_morecopyright">
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	Copyright 2010 - 2017, Garage4Hackers
	
</div>
 

	<div id="fb-root"></div>
<script src="clientscript/vbulletin_facebook6719.js?v=421" type="text/javascript"></script>

<script type="text/javascript">
<!--
	loadFacebookAPI('en_US');
	function fbAsyncInit()
	{
		vBfb = new vB_Facebook({
			appid : "170793809601191",
			connected : 0,
			active : 0,
			autoreg : 0,
			feed_newthread : 1,
			feed_postreply : 1,
			feed_blogentry : 1,
			feed_blogcomment : 1,
			feed_newarticle : 1,
			feed_articlecomment : 1
		});
	}
// -->
</script>

</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker('UA-17311051-3');
pageTracker._trackPageview();
} catch(err) {}</script>

</div></body></html>