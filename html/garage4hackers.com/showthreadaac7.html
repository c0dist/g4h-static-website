<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html dir="ltr" id="vbulletin_html" lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://www.facebook.com/2008/fbml"><!-- Mirrored from garage4hackers.com/showthread.php?t=1467&p=5626 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 12:58:44 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

	<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="index.html" id="e_vb_meta_bburl" name="vb_meta_bburl"/>
<base/><!--[if IE]></base><![endif]-->
<meta content="vBulletin 4.2.1" name="generator"/>
<meta content="IE=9" http-equiv="X-UA-Compatible"/>

	<link href="favicon.ico" rel="Shortcut Icon" type="image/x-icon"/>






	<meta content="170793809601191" property="fb:app_id"/>
<meta content="Garage4hackers Forum" property="og:site_name"/>
<meta content="Garage4Hackers(G4H) is an open security community for Information Security enthusiasts, gurus and aspirants.Members of the team dedicate time and resources towards helping other information security aspirants, sharing knowledge,spreading security awareness and promoting research." property="og:description"/>
<meta content="showthread69f0.html?t=1467" property="og:url"/>
<meta content="article" property="og:type"/>




	
		<script src="../yui.yahooapis.com/comboaa66?2.9.0/build/yuiloader-dom-event/yuiloader-dom-event.js&amp;2.9.0/build/connection/connection-min.js" type="text/javascript"></script>
	

<script type="text/javascript">
<!--
	if (typeof YAHOO === 'undefined') // Load ALL YUI Local
	{
		document.write('<script type="text/javascript" src="clientscript/yui/yuiloader-dom-event/yuiloader-dom-event6719.html?v=421"><\/script>');
		document.write('<script type="text/javascript" src="clientscript/yui/connection/connection-min6719.html?v=421"><\/script>');
		var yuipath = 'clientscript/yui';
		var yuicombopath = '';
		var remoteyui = false;
	}
	else	// Load Rest of YUI remotely (where possible)
	{
		var yuipath = '../external.html?link=http://yui.yahooapis.com/2.9.0/build';
		var yuicombopath = '../external.html?link=http://yui.yahooapis.com/combo';
		var remoteyui = true;
		if (!yuicombopath)
		{
			document.write('<script type="text/javascript" src="../yui.yahooapis.com/2.9.0/build/connection/connection-min6719.js?v=421"><\/script>');
		}
	}
	var SESSIONURL = "";
	var SECURITYTOKEN = "guest";
	var IMGDIR_MISC = "images/misc";
	var IMGDIR_BUTTON = "images/buttons";
	var vb_disable_ajax = parseInt("0", 10);
	var SIMPLEVERSION = "421";
	var BBURL = "index.html";
	var LOGGEDIN = 0 > 0 ? true : false;
	var THIS_SCRIPT = "showthread";
	var RELPATH = "showthreadaac7.html?t=1467&amp;p=5626";
	var PATHS = {
		forum : "",
		cms   : "",
		blog  : ""
	};
	var AJAXBASEURL = "index.html";
// -->
</script>
<script src="clientscript/vbulletin-core6719.js?v=421" type="text/javascript"></script>



	<link href="external9476.php?type=RSS2" rel="alternate" title="Garage4hackers Forum RSS Feed" type="application/rss+xml"/>
	
		<link href="external935d.php?type=RSS2&amp;forumids=25" rel="alternate" title="Garage4hackers Forum - Botnets, Malwares &amp; Rootkits Analysis - RSS Feed" type="application/rss+xml"/>
	



	<link href="css30f2.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=bbcode.css,editor.css,popupmenu.css,reset-fonts.css,vbulletin.css,vbulletin-chrome.css,vbulletin-formcontrols.css," rel="stylesheet" type="text/css"/>

	<!--[if lt IE 8]>
	<link rel="stylesheet" type="text/css" href="css.php?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=popupmenu-ie.css,vbulletin-ie.css,vbulletin-chrome-ie.css,vbulletin-formcontrols-ie.css,editor-ie.css" />
	<![endif]-->


	<meta content="adobe, malicious pdf analysis, malware analysis, reverse engineering, javascript, encoded, content, data, vulnerability, function, creator, code, object, imageshack.us, http://imageshack.us, uploaded, decoded, util.printf, executing, eval, replacing, exploit, unescape, this.creator, created, screenshot, case, shellcode, exploiting, shows, stage, buffer, place, &amp;8220eval=print&amp;8221, script, funcionality, beginning, overide, continued, ways, executes, multiple, shown, cve-2008-2992, allocated, passing, number, target, heapy, parameter" name="keywords"/>
	<meta content="Part 1 
 
This post contains the analysis that i carried out on a malicious pdf file, exploiting a stack based overflow vulnerablity in the adobe acrobat reader. Before analyzing the malicious pdf, it is necessary to understand the structure of the pdf file, so before getting into the analysis i would like to explain the structure of pdf document. Also the PDF document can include images, fonts, text, javascript, flash and other content to dispay the document. 
 
 
PDF document structure 
In" name="description"/>

	<title> Malicious PDF analysis</title>
	<link href="showthread69f0.html?t=1467" rel="canonical"/>
	
	<script src="clientscript/vbulletin_textedit6719.html?v=421" type="text/javascript"></script>
	<script src="clientscript/vbulletin_post_loader6719.html?v=421" type="text/javascript"></script>
	
	
	
	
	
	

	
		<link href="css8d9b.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=postlist.css,showthread.css,postbit.css,attachment.css,poll.css,lightbox.css" rel="stylesheet" type="text/css"/>
	

<link href="css657d.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=additional.css" rel="stylesheet" type="text/css"/>

</head>

<body onload="if (document.body.scrollIntoView &amp;&amp; fetch_object('currentPost') &amp;&amp; (window.location.href.indexOf('#') == -1 || window.location.href.indexOf('#post') &gt; -1)) { fetch_object('currentPost').scrollIntoView(true); }">

<div class="above_body"> <!-- closing tag is in template navbar -->
<div class="floatcontainer doc_header" id="header">
	<div><a class="logo-image" href="forum.html" name="top"><img alt="Garage4hackers Forum" src="images/misc/vbulletin4_logo.png"/></a></div>
	<div class="toplinks" id="toplinks">
		
			<ul class="nouser">
			
				<li><a href="register.html" rel="nofollow">Register</a></li>
			
				<li><a href="faq.html" rel="help">Help</a></li>
				<li>
			<script src="clientscript/vbulletin_md56719.html?v=421" type="text/javascript"></script>
			<form action="../external.html?link=http://garage4hackers.com/login.php?do=login" id="navbar_loginform" method="post" onsubmit="md5hash(vb_login_password, vb_login_md5password, vb_login_md5password_utf, 0)">
				<fieldset class="logindetails" id="logindetails">
					<div>
						<div>
					<input accesskey="u" class="textbox default-value" id="navbar_username" name="vb_login_username" size="10" tabindex="101" type="text" value="User Name"/>
					<input class="textbox" id="navbar_password" name="vb_login_password" size="10" tabindex="102" type="password"/>
					<input class="textbox default-value" id="navbar_password_hint" name="vb_login_password_hint" size="10" style="display:none;" tabindex="102" type="text" value="Password"/>
					<input accesskey="s" class="loginbutton" tabindex="104" title="Enter your username and password in the boxes provided to login, or click the 'register' button to create a profile for yourself." type="submit" value="Log in"/>
						</div>
					</div>
				</fieldset>
				<div class="remember" id="remember">
					<label for="cb_cookieuser_navbar"><input accesskey="c" class="cb_cookieuser_navbar" id="cb_cookieuser_navbar" name="cookieuser" tabindex="103" type="checkbox" value="1"/> Remember Me?</label>
				</div>

				<input name="s" type="hidden" value=""/>
				<input name="securitytoken" type="hidden" value="guest"/>
				<input name="do" type="hidden" value="login"/>
				<input name="vb_login_md5password" type="hidden"/>
				<input name="vb_login_md5password_utf" type="hidden"/>
			</form>
			<script type="text/javascript">
			YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "inline");
			YAHOO.util.Dom.setStyle('navbar_password', "display", "none");
			vB_XHTML_Ready.subscribe(function()
			{
			//
				YAHOO.util.Event.on('navbar_username', "focus", navbar_username_focus);
				YAHOO.util.Event.on('navbar_username', "blur", navbar_username_blur);
				YAHOO.util.Event.on('navbar_password_hint', "focus", navbar_password_hint);
				YAHOO.util.Event.on('navbar_password', "blur", navbar_password);
			});
			
			function navbar_username_focus(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				if (textbox.value == 'User Name')
				{
				//
					textbox.value='';
					textbox.style.color='#000000';
				}
			}

			function navbar_username_blur(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				if (textbox.value == '')
				{
				//
					textbox.value='User Name';
					textbox.style.color='#777777';
				}
			}
			
			function navbar_password_hint(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				
				YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "none");
				YAHOO.util.Dom.setStyle('navbar_password', "display", "inline");
				YAHOO.util.Dom.get('navbar_password').focus();
			}

			function navbar_password(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				
				if (textbox.value == '')
				{
					YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "inline");
					YAHOO.util.Dom.setStyle('navbar_password', "display", "none");
				}
			}
			</script>
				</li>
				
					<li class="hidden" id="fb_headerbox">

	<a href="#" id="fb_loginbtn"><img alt="The Facebook Platform" src="images/misc/facebook_login.gif"/></a>

</li>

				
			</ul>
		
	</div>
	<div class="ad_global_header">
		 
		 
	</div>
	<hr/>
</div>
<div class="navbar" id="navbar">
	<ul class="navtabs floatcontainer" id="navtabs">
		
		
	
		<li id="vbtab_whatsnew">
			<a class="navtab" href="activity.html">What's New?</a>
		</li>
		
		

	
		<li id="vbtab_cms">
			<a class="navtab" href="content.html">Articles</a>
		</li>
		
		

	
		<li class="selected" id="vbtab_forum">
			<a class="navtab" href="forum.html">Forum</a>
		</li>
		
		
			<ul class="floatcontainer">
				
					
						
							<li id="vbflink_newposts"><a href="search8427.html?do=getnew&amp;contenttype=vBForum_Post">New Posts</a></li>
						
					
				
					
						
							<li id="vbflink_faq"><a href="faq.html">FAQ</a></li>
						
					
				
					
						
							<li id="vbflink_calendar"><a href="calendar.html">Calendar</a></li>
						
					
				
					
						<li class="popupmenu" id="vbmenu_community">
							<a class="popupctrl" href="javascript://">Community</a>
							<ul class="popupbody popuphover">
								
									<li id="vbclink_members"><a href="memberlist.html">Member List</a></li>
								
							</ul>
						</li>
					
				
					
						<li class="popupmenu" id="vbmenu_actions">
							<a class="popupctrl" href="javascript://">Forum Actions</a>
							<ul class="popupbody popuphover">
								
									<li id="vbalink_mfr"><a href="forum.html?do=markread&amp;markreadhash=guest">Mark Forums Read</a></li>
								
							</ul>
						</li>
					
				
					
						<li class="popupmenu" id="vbmenu_qlinks">
							<a class="popupctrl" href="javascript://">Quick Links</a>
							<ul class="popupbody popuphover">
								
									<li id="vbqlink_posts"><a href="search2791.html?do=getdaily&amp;contenttype=vBForum_Post">Today's Posts</a></li>
								
									<li id="vbqlink_leaders"><a href="showgroups.html">View Site Leaders</a></li>
								
							</ul>
						</li>
					
				
			</ul>
		

	
		<li id="vbtab_blog">
			<a class="navtab" href="blog.html">Blogs</a>
		</li>
		
		

	
		<li id="tab_nja4_357">
			<a class="navtab" href="pages7b82.html?pageid=2">G4H Team</a>
		</li>
		
		

	
		<li id="tab_nta0_579">
			<a class="navtab" href="pages8782.html?pageid=3">IRC</a>
		</li>
		
		

	
		<li id="tab_nta0_442">
			<a class="navtab" href="pagesdbe0.html?pageid=4">Ranchoddas</a>
		</li>
		
		

		<li>
            <a class="navtab" href="pages.html">Events and Conferences</a></li>
	</ul>
	
		<div class="globalsearch" id="globalsearch">
			<form action="../external.html?link=http://garage4hackers.com/search.php?do=process" class="navbar_search" id="navbar_search" method="post">
				
				<input name="securitytoken" type="hidden" value="guest"/>
				<input name="do" type="hidden" value="process"/>
				<span class="textboxcontainer"><span><input class="textbox" name="query" tabindex="99" type="text" value=""/></span></span>
				<span class="buttoncontainer"><span><input class="searchbutton" name="submit" onclick="document.getElementById('navbar_search').submit;" src="images/buttons/search.html" tabindex="100" type="image"/></span></span>
			</form>
			<ul class="navbar_advanced_search">
				<li><a accesskey="4" href="search.html">Advanced Search</a></li>
				
			</ul>
		</div>
	
</div>
</div><!-- closing div for above_body -->

<div class="body_wrapper">
<div class="breadcrumb" id="breadcrumb">
	<ul class="floatcontainer">
		<li class="navbithome"><a accesskey="1" href="content.html"><img alt="Home" src="images/misc/navbit-home.png"/></a></li>
		
	<li class="navbit"><a href="forum.html">Forum</a></li>

	<li class="navbit"><a href="forumdisplayffeb.html?f=20">Experts Forum</a></li>

	<li class="navbit"><a href="forumdisplaye8b3.html?f=25">Botnets, Malwares &amp; Rootkits Analysis</a></li>

		
	<li class="navbit lastnavbit"><span> Malicious PDF analysis</span></li>

	</ul>
	<hr/>
</div>


<div style="width:728px; margin:0 auto; padding-bottom:1em">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6847984837250662";
google_ad_host = "ca-host-pub-2606800903002383";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al_s";
google_ad_channel = "";
google_color_border = "";
google_color_bg = "";
google_color_link = "";
google_color_text = "";
google_color_url = "";
google_ui_features = "rc:6";
//-->
</script>
<script src="../pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>
</div>

<div id="ad_global_below_navbar"><script async="" src="../pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- garage1 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-6847984837250662" data-ad-slot="4036513682" style="display:inline-block;width:728px;height:90px"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>


	<form action="../external.html?link=http://garage4hackers.com/profile.php?do=dismissnotice" class="notices" id="notices" method="post">
		<input name="do" type="hidden" value="dismissnotice"/>
		<input name="s" type="hidden" value=""/>
		<input name="securitytoken" type="hidden" value="guest"/>
		<input id="dismiss_notice_hidden" name="dismiss_noticeid" type="hidden" value=""/>
		<input name="url" type="hidden" value=""/>
		<ol>
			<li class="restore" id="navbar_notice_2">
	
	
<h2>
The forum is <a href="showthread1180.html?t=7049&amp;p=14985#post14985">frozen forever</a> - but it won't die; it'll stay for long in search engine results and we hope it would keep helping newbies in some way or other - cheers! 


</h2>

<!-- Mirrored from garage4hackers.com/showthread.php?t=1467&p=5626 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 12:58:44 GMT -->

</li>
		</ol>
	</form>





	<div class="above_postlist" id="above_postlist">
		

		<div class="pagination_top" id="pagination_top">
		
			<div class="postpagestats" id="postpagestats_above">
				Results 1 to 5 of 5
			</div>
		</div>
	</div>
<div class="pagetitle" id="pagetitle">
	<h1>
		Thread: <span class="threadtitle"><a href="showthread69f0.html?t=1467" title="Reload this Page">Malicious PDF analysis</a></span>

<a class="a2a_dd" href="../external.html?link=http://www.addtoany.com/share_save"><img alt="Share/Save - My123World.Com!" border="0" height="16" src="../static.addtoany.com/buttons/share_save_171_16.png" width="171"/></a><script type="text/javascript">a2a_show_title=1;a2a_num_services=14;</script><script src="../static.addtoany.com/menu/page.js" type="text/javascript"></script>

		
			
<fb:like action="../external.html?link=http://garage4hackers.com/like" colorscheme="light" font="tahoma" href="showthread69f0.html?t=1467" layout="standard" show_faces="false" width="260"></fb:like>
		
	</h1>
</div>
	<div class="thread_controls" id="thread_controls">
		<div>
		<ul class="postlist_popups popupgroup" id="postlist_popups">
			
			<li class="popupmenu" id="threadtools">
				<h6><a class="popupctrl" href="javascript://">Thread Tools</a></h6>
				<ul class="popupbody popuphover">
					<li><a accesskey="3" href="printthreadbf3e.html?t=1467&amp;pp=10&amp;page=1" rel="nofollow">Show Printable Version</a></li>
					<li><a href="sendmessage9d0c.html?do=sendtofriend&amp;t=1467" rel="nofollow">Email this Page…</a></li>
					<li>
						
							<a href="subscriptiona5f2.html?do=addsubscription&amp;t=1467" rel="nofollow">Subscribe to this Thread…</a>
											
					</li>
					
				</ul>
			</li>

			

			
				<li class="popupmenu searchthread" id="searchthread">
					<h6><a class="popupctrl" href="javascript://">Search Thread</a></h6>
					<form action="../external.html?link=http://garage4hackers.com/search.php" method="post">
						<ul class="popupbody popuphover">
							<li>
								<input class="searchbox" name="query" tabindex="13" type="text" value="Search..."/>
								<input class="button" tabindex="14" type="submit" value="Search"/>
							</li>
							<li class="formsubmit">
								<div><a class="advancedsearchlink" href="search648e.html?search_type=1&amp;searchthreadid=1467&amp;contenttype=vBForum_Post">Advanced Search</a></div>
							</li>
						</ul>
						<input name="s" type="hidden" value=""/>
						<input name="securitytoken" type="hidden" value="guest"/>
						<input name="do" type="hidden" value="process"/>
						<input name="searchthreadid" type="hidden" value="1467"/>
						<input name="search_type" type="hidden" value="1"/>
						<input name="contenttype" type="hidden" value="vBForum_Post"/>

					</form>
				</li>
			

			

			
				<li class="popupmenu" id="displaymodes">
					<h6><a class="popupctrl" href="javascript://">Display</a></h6>
					<ul class="popupbody popuphover">
						<li><label>Linear Mode</label></li>
						<li><a href="showthreadecf5.html?t=1467&amp;mode=hybrid"> Switch to Hybrid Mode</a></li>
						<li><a href="showthread89d6.html?t=1467&amp;p=5621&amp;mode=threaded#post5621"> Switch to Threaded Mode</a></li>
					</ul>
				</li>
			

			
		</ul>
		</div>
	</div>

<div class="postlist restrain" id="postlist">
	

	
		<ol class="posts" id="posts" start="1">
			
<li class="postbitlegacy postbitim postcontainer old" id="post_5621">
<!-- see bottom of postbit.css for .userinfo .popupmenu styles -->

	<div class="posthead">
			<span class="postdate old">
				
					<span class="date">09-11-2011, <span class="time">04:49 PM</span></span>
				
			</span>
			<span class="nodecontrols">
				
					<a class="postcounter" href="showthread4c91-2.html?t=1467&amp;p=5621&amp;viewfull=1#post5621" name="post5621">#1</a><a id="postcount5621" name="1"></a>
				
				
				
			</span>
	</div>
	<div class="postdetails">
		<div class="userinfo">
			<div class="username_container">
			
				<div class="popupmenu memberaction">
	<a class="username offline popupctrl" href="member62b2.html?u=1164" title="m0nna is offline"><strong>m0nna</strong></a>
	<ul class="popupbody popuphover memberaction_body">
		<li class="left">
			<a class="siteicon_profile" href="member62b2.html?u=1164">
				View Profile
			</a>
		</li>
		
		<li class="right">
			<a class="siteicon_forum" href="searchc71c.html?do=finduser&amp;userid=1164&amp;contenttype=vBForum_Post&amp;showposts=1" rel="nofollow">
				View Forum Posts
			</a>
		</li>
		
		
		<li class="left">
			<a class="siteicon_message" href="private83fa.html?do=newpm&amp;u=1164" rel="nofollow">
				Private Message
			</a>
		</li>
		
		
		
		<li class="right">
			<a class="siteicon_blog" href="blog62b2.html?u=1164" rel="nofollow">
				View Blog Entries
			</a>
		</li>
		
		
		
		
		
		<li class="right">
			<a class="siteicon_article" href="listbfcd.html?r=author/1164-m0nna" rel="nofollow">
				View Articles
			</a>
		</li>
		

		

		
		
	</ul>
</div>
				<img alt="m0nna is offline" border="0" class="inlineimg onlinestatus" src="images/statusicon/user-offline.png"/>

			
			</div>
			<span class="usertitle">
				Garage Newcomer
			</span>
			
			
			
				<span class="postbit_reputation" id="repdisplay_5621_1164" title="m0nna is on a distinguished road">
					
						<img alt="" class="repimg" src="images/reputation/reputation_pos.png"/>
					
				</span>
			
			 
			
				<hr/>
				<dl class="userinfo_extra">
					<dt>Join Date</dt> <dd>Sep 2011</dd>
					
					
					<dt>Posts</dt> <dd>21</dd>	
					<dt>Blog Entries</dt><dd><a href="blog62b2.html?u=1164">2</a></dd>
				</dl>
				
				
				<div class="imlinks">
					    
				</div>
			
		</div>
		<div class="postbody">
			<div class="postrow has_after_content">
				
				
				<h2 class="title icon">
					Malicious PDF analysis
				</h2>
				


						
							
							
						
						
				<div class="content">
					<div id="post_message_5621">
						<blockquote class="postcontent restore">
							<b>Part 1</b><br/>
<br/>
This post contains the analysis that i carried out on a malicious pdf file, exploiting a stack based overflow vulnerablity in the adobe acrobat reader. Before analyzing the malicious pdf, it is necessary to understand the structure of the pdf file, so before getting into the analysis i would like to explain the structure of pdf document. Also the PDF document can include images, fonts, text, javascript, flash and other content to dispay the document.<br/>
<br/>
<br/>
PDF document structure<br/>
In this document i'l not explain the full pdf structure, but i'l be explaining the parts that is required for the analysis. The pdf document starts with a header which looks like this %PDF-a.b.c.d, this is the version of the pdf language. Without this header the pdf readers will not accept it.<br/>
The pdf document also consists of multiple indirect objects, an example of an indirect object is shown below, the indirect objects have an object id (1 in the below example)  and version number (0 in the below example) follwed by the keyword obj, endobj marks the end of the object.<br/>
<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code" style="height:108px;">%PDF-1.1        &lt;------ PDF header

1 0 obj            &lt;-------- Indirect object, 1 is the object id and 0 is the version number

........
.....
endobj        &lt;------ This marks the end of object 1</pre>
</div><br/>
Inside the object  there are a series of tags describing the contents of the object or reference to another object, In the below example,  object 7 contains javascript (indicated by /Javascript tag) and the /JS tag indicates the content of the javascript, whereas object 31 has reference to javascript object (object id 34) indicated by /JS 34 0 R, the R stands for Reference.  One of the object essential for analyzing malicious pdf files is the stream object. In the example below the object 34 contains stream object. A stream object contains a stream of data between the keyword stream and endstream. This data stream is often compressed and that is the reason it looks like meaningless data. In the example FlateDecode indicates that the data stream is compressed using zlib compression algorithm.<br/>
Also there are different types of tags, for example: /JS and /javascript indicates javascript<br/>
/Richmedia  indicates flash,<br/>
/AA, /OpenAction indicates an automatic action to be performed when the document is viewed.<br/>
<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code" style="height:360px;">7 0 obj                              &lt;---- object 7
&lt;&lt;
/Type /Action
/S /JavaScript                &lt;---- javascript tag
/JS &lt;javascript code&gt;      &lt;---- javascript content
...............
.............
&gt;&gt;
endobj


obj 31 0                                    &lt;----- object 31
Type:
Referencing: 34 0 R
[(2, '&lt;&lt;'), (2, '/S'), (2, '/JavaScript'), (2, '/JS'), (1, ' '), (3, '34'), (1, ' '), (3, '0'), (1, ' '), (3, 'R'), (2, '&gt;&gt;'), (1, '\r')]
&lt;&lt;
/S /JavaScript
/JS 34 0 R                          &lt;------ reference to a javascript object, in this case object 34
&gt;&gt;
endobj


34 0 obj&lt;&lt;/Subtype/Type1C/Length 5416/Filter/FlateDecode
&gt;&gt;stream                                                                     &lt;--- stream object
H‰|T}T#W#Ÿ!d&amp;"FI#Å‰NFW#åC                      &lt;---- compressed stream content, in this case zlib compressed data indicated by /FlatDecode
…
endstream
endobj</pre>
</div>Continued
						</blockquote>
					</div>

					
				</div>
			</div>
			
			<div class="after_content">
				
				<!-- edit note -->
				<blockquote class="postcontent lastedited">
					
						Last edited by m0nna; 09-11-2011 at <span class="time">05:04 PM</span>.
					
					
				</blockquote>
				<!-- / edit note -->
				
				
				
					
				
				
				
			</div>
			
			<div class="cleardiv"></div>
		</div>
	</div>
		<div class="postfoot">
			<!-- <div class="postfoot_container"> -->
			<div class="textcontrols floatcontainer">
				<span class="postcontrols">
					<img alt="" id="progress_5621" src="images/misc/progress.gif" style="display:none"/>
					
					
					
						<a class="newreply" href="newreply9787.html?do=newreply&amp;p=5621" id="qrwq_5621" rel="nofollow" title="Reply With Quote"><img alt="Reply With Quote" id="quoteimg_5621" src="clear.gif"/>  Reply With Quote</a> 
					
					
					
				</span>
				<span class="postlinking">
					
						
					

					
					
					
					

					
					

					
					
					
					
					
				</span>
			<!-- </div> -->
			</div>
		</div>
	<hr/>
</li>

<li class="postbitlegacy postbitim postcontainer old" id="post_5622">
<!-- see bottom of postbit.css for .userinfo .popupmenu styles -->

	<div class="posthead">
			<span class="postdate old">
				
					<span class="date">09-11-2011, <span class="time">05:01 PM</span></span>
				
			</span>
			<span class="nodecontrols">
				
					<a class="postcounter" href="showthread3831.html?t=1467&amp;p=5622&amp;viewfull=1#post5622" name="post5622">#2</a><a id="postcount5622" name="2"></a>
				
				
				
			</span>
	</div>
	<div class="postdetails">
		<div class="userinfo">
			<div class="username_container">
			
				<div class="popupmenu memberaction">
	<a class="username offline popupctrl" href="member62b2.html?u=1164" title="m0nna is offline"><strong>m0nna</strong></a>
	<ul class="popupbody popuphover memberaction_body">
		<li class="left">
			<a class="siteicon_profile" href="member62b2.html?u=1164">
				View Profile
			</a>
		</li>
		
		<li class="right">
			<a class="siteicon_forum" href="searchc71c.html?do=finduser&amp;userid=1164&amp;contenttype=vBForum_Post&amp;showposts=1" rel="nofollow">
				View Forum Posts
			</a>
		</li>
		
		
		<li class="left">
			<a class="siteicon_message" href="private83fa.html?do=newpm&amp;u=1164" rel="nofollow">
				Private Message
			</a>
		</li>
		
		
		
		<li class="right">
			<a class="siteicon_blog" href="blog62b2.html?u=1164" rel="nofollow">
				View Blog Entries
			</a>
		</li>
		
		
		
		
		
		<li class="right">
			<a class="siteicon_article" href="listbfcd.html?r=author/1164-m0nna" rel="nofollow">
				View Articles
			</a>
		</li>
		

		

		
		
	</ul>
</div>
				<img alt="m0nna is offline" border="0" class="inlineimg onlinestatus" src="images/statusicon/user-offline.png"/>

			
			</div>
			<span class="usertitle">
				Garage Newcomer
			</span>
			
			
			
				<span class="postbit_reputation" id="repdisplay_5622_1164" title="m0nna is on a distinguished road">
					
						<img alt="" class="repimg" src="images/reputation/reputation_pos.png"/>
					
				</span>
			
			 
			
				<hr/>
				<dl class="userinfo_extra">
					<dt>Join Date</dt> <dd>Sep 2011</dd>
					
					
					<dt>Posts</dt> <dd>21</dd>	
					<dt>Blog Entries</dt><dd><a href="blog62b2.html?u=1164">2</a></dd>
				</dl>
				
				
				<div class="imlinks">
					    
				</div>
			
		</div>
		<div class="postbody">
			<div class="postrow has_after_content">
				
				


						
						
				<div class="content">
					<div id="post_message_5622">
						<blockquote class="postcontent restore">
							<b>Part 2</b><br/>
<br/>
Analysis<br/>
<br/>
Now we know the structure of the pdf document, lets analyze the malicious pdf sample. When i was look through my spam folder in my personal mail id, i got this sample, after submitting this sample to virustotal i found that this is a malicious sample. The virustotal report for the sample is shown below: The operating sytem used for the analysis is BackTrack 5 which is built on ubuntu linux.<br/>
<br/>
<a href="../external.html?link=http://imageshack.us/photo/my-images/838/vt1g.png/" target="_blank"><img alt="" border="0" src="../external.html?link=http://imageshack.com/e/p5aMES7Yj"/></a><br/>
<br/>
Uploaded with <a href="../external.html?link=http://imageshack.us/" target="_blank">ImageShack.us</a><br/>
<br/>
Now that i knew that malicious pdf file is malicious, i decided to analyze this sample.<br/>
First step was to look for the keywords in the malicious pdf document, to do that i used  pdfid.py, The below screenshot shows the output of pdfid. Looking at the output you can see that pdf document contains only 1 page (marked by /Page tag) , 2 javascript tags (marked by /JavaScript tag) and 1 javascript content (marked by /JS)<br/>
<br/>
<a href="../external.html?link=http://imageshack.us/photo/my-images/12/pdfid2.png/" target="_blank"><img alt="" border="0" src="../external.html?link=http://imageshack.com/e/p5aMES7Yj"/></a><br/>
<br/>
Uploaded with <a href="../external.html?link=http://imageshack.us/" target="_blank">ImageShack.us</a><br/>
<br/>
javascript is mostly used to exploit vulnerabilites in the pdf document, and also the javascript interpreter (modified version of spidermonkey) used by pdf itself was to know to have multiple vulnerabilities. Now that there is presence of javascript tag in the pdf document, i decided to search for the javascript object using the tool “pdf-parser.py”, this tool can parse PDF constructs used in malicious pdf files.  The search for javascript using pdf-parser returned two objects as show in the below screenshot<br/>
<br/>
<a href="../external.html?link=http://imageshack.us/photo/my-images/827/20214007.png/" target="_blank"><img alt="" border="0" src="../external.html?link=http://imageshack.com/e/p5aMES7Yj"/></a><br/>
<br/>
Uploaded with <a href="../external.html?link=http://imageshack.us/" target="_blank">ImageShack.us</a><br/>
<br/>
From the above screenshot you can see that object 3 references object 5 (marked by /JavasScript 5 0 R) which is a javascript object and object 6 references object 111611 which is also javascript object (marked by /JS 111611).<br/>
In this case the relation ship between both the objects are not clear. So i looked at object 5 using pdf-parser, looking at the output below you can see that object 5 refernces object 6 (which in turn referenced object 111611) in the above screenshot.<br/>
<br/>
<a href="../external.html?link=http://imageshack.us/photo/my-images/707/79755128.png/" target="_blank"><img alt="" border="0" src="../external.html?link=http://imageshack.com/e/p5aMES7Yj"/></a><br/>
<br/>
Uploaded with <a href="../external.html?link=http://imageshack.us/" target="_blank">ImageShack.us</a><br/>
<br/>
Looking at object 111611 shows that this object contains data stream (indicated by stream keyword) and the data stream is zlib compressed indicated by (/FlatDecode), this indicates that this is the object which contains javascript code.<br/>
<br/>
<a href="../external.html?link=http://imageshack.us/photo/my-images/823/11981039.png/" target="_blank"><img alt="" border="0" src="../external.html?link=http://imageshack.com/e/p5aMES7Yj"/></a><br/>
<br/>
Uploaded with <a href="../external.html?link=http://imageshack.us/" target="_blank">ImageShack.us</a><br/>
<br/>
Now the relationship between the objects are clear. Obj 3 references obj 5 which in turn references obj 6 which references object 111611, this is a technique used to confuse the security researchers.<br/>
<br/>
                                <br/>
                                        obj 3 --&gt; obj 5 --&gt; obj6 --&gt; obj 111611<br/>
<br/>
Now that i know object 111611 contains the javascript code, next step is to extract the javascript code from object 11161.<br/>
<br/>
Continued
						</blockquote>
					</div>

					
				</div>
			</div>
			
			<div class="after_content">
				
				<!-- edit note -->
				<blockquote class="postcontent lastedited">
					
						Last edited by m0nna; 09-11-2011 at <span class="time">05:37 PM</span>.
					
					
				</blockquote>
				<!-- / edit note -->
				
				
				
				
				
			</div>
			
			<div class="cleardiv"></div>
		</div>
	</div>
		<div class="postfoot">
			<!-- <div class="postfoot_container"> -->
			<div class="textcontrols floatcontainer">
				<span class="postcontrols">
					<img alt="" id="progress_5622" src="images/misc/progress.gif" style="display:none"/>
					
					
					
						<a class="newreply" href="newreply5e39.html?do=newreply&amp;p=5622" id="qrwq_5622" rel="nofollow" title="Reply With Quote"><img alt="Reply With Quote" id="quoteimg_5622" src="clear.gif"/>  Reply With Quote</a> 
					
					
					
				</span>
				<span class="postlinking">
					
						
					

					
					
					
					

					
					

					
					
					
					
					
				</span>
			<!-- </div> -->
			</div>
		</div>
	<hr/>
</li>

<li class="postbitlegacy postbitim postcontainer old" id="post_5624">
<!-- see bottom of postbit.css for .userinfo .popupmenu styles -->

	<div class="posthead">
			<span class="postdate old">
				
					<span class="date">09-11-2011, <span class="time">05:50 PM</span></span>
				
			</span>
			<span class="nodecontrols">
				
					<a class="postcounter" href="showthread48fc.html?t=1467&amp;p=5624&amp;viewfull=1#post5624" name="post5624">#3</a><a id="postcount5624" name="3"></a>
				
				
				
			</span>
	</div>
	<div class="postdetails">
		<div class="userinfo">
			<div class="username_container">
			
				<div class="popupmenu memberaction">
	<a class="username offline popupctrl" href="member62b2.html?u=1164" title="m0nna is offline"><strong>m0nna</strong></a>
	<ul class="popupbody popuphover memberaction_body">
		<li class="left">
			<a class="siteicon_profile" href="member62b2.html?u=1164">
				View Profile
			</a>
		</li>
		
		<li class="right">
			<a class="siteicon_forum" href="searchc71c.html?do=finduser&amp;userid=1164&amp;contenttype=vBForum_Post&amp;showposts=1" rel="nofollow">
				View Forum Posts
			</a>
		</li>
		
		
		<li class="left">
			<a class="siteicon_message" href="private83fa.html?do=newpm&amp;u=1164" rel="nofollow">
				Private Message
			</a>
		</li>
		
		
		
		<li class="right">
			<a class="siteicon_blog" href="blog62b2.html?u=1164" rel="nofollow">
				View Blog Entries
			</a>
		</li>
		
		
		
		
		
		<li class="right">
			<a class="siteicon_article" href="listbfcd.html?r=author/1164-m0nna" rel="nofollow">
				View Articles
			</a>
		</li>
		

		

		
		
	</ul>
</div>
				<img alt="m0nna is offline" border="0" class="inlineimg onlinestatus" src="images/statusicon/user-offline.png"/>

			
			</div>
			<span class="usertitle">
				Garage Newcomer
			</span>
			
			
			
				<span class="postbit_reputation" id="repdisplay_5624_1164" title="m0nna is on a distinguished road">
					
						<img alt="" class="repimg" src="images/reputation/reputation_pos.png"/>
					
				</span>
			
			 
			
				<hr/>
				<dl class="userinfo_extra">
					<dt>Join Date</dt> <dd>Sep 2011</dd>
					
					
					<dt>Posts</dt> <dd>21</dd>	
					<dt>Blog Entries</dt><dd><a href="blog62b2.html?u=1164">2</a></dd>
				</dl>
				
				
				<div class="imlinks">
					    
				</div>
			
		</div>
		<div class="postbody">
			<div class="postrow">
				
				


						
						
				<div class="content">
					<div id="post_message_5624">
						<blockquote class="postcontent restore">
							<b>Part 3</b><br/>
<br/>
<b><u>Extracting Javascript</u></b><br/>
<br/>
To extract javascript for object first we need to decompress the zlib compressed data, only then the javascript would make sense. Pdf-parser.py was used to decompress  and extract the javascript code. The below screenshots show the pdf-parser otuput.<br/>
<br/>
<a href="../external.html?link=http://imageshack.us/photo/my-images/196/80839886.png/" target="_blank"><img alt="" border="0" src="../external.html?link=http://imageshack.com/e/p5aMES7Yj"/></a><br/>
<br/>
Uploaded with <a href="../external.html?link=http://imageshack.us/" target="_blank">ImageShack.us</a><br/>
<br/>
The below screenshot shows just the extracted javascript code. But again this code is obfuscated.<br/>
<br/>
<a href="../external.html?link=http://imageshack.us/photo/my-images/97/92034501.png/" target="_blank"><img alt="" border="0" src="../external.html?link=http://imageshack.com/e/p5aMES7Yj"/></a><br/>
<br/>
Uploaded with <a href="../external.html?link=http://imageshack.us/" target="_blank">ImageShack.us</a><br/>
<br/>
After beautifying the data, the output looks little better , but still obfuscated as show in the below screenshot, the obfuscation technique is used to confuse the analyts and to prevent the security devices from detecting.<br/>
<br/>
<a href="../external.html?link=http://imageshack.us/photo/my-images/684/50453750.png/" target="_blank"><img alt="" border="0" src="../external.html?link=http://imageshack.com/e/p5aMES7Yj"/></a><br/>
<br/>
Uploaded with <a href="../external.html?link=http://imageshack.us/" target="_blank">ImageShack.us</a><br/>
<br/>
When you look at the javascript code above you will find that all the text in blue (marked by /* and */) is a multiline comment in javascript, removing that will not affect the javascript code in anyway, this is just there to confuse the analysts. After deleting all the multiline comment you will find that the javascript now makes sense as shown in the below screenshost<br/>
<br/>
<a href="../external.html?link=http://imageshack.us/photo/my-images/193/31283776.png/" target="_blank"><img alt="" border="0" src="../external.html?link=http://imageshack.com/e/p5aMES7Yj"/></a><br/>
<br/>
Uploaded with <a href="../external.html?link=http://imageshack.us/" target="_blank">ImageShack.us</a><br/>
<br/>
now we have the javascript, executing this code with spidermonkey gives an error, as shown below: The reason for this is javascript is trying to access  “this.creator” which is adobe specific object, In this case the attacker has split the javascript across multiple objects (multi stage), this is again another technique used to confuse the analysts, this.creator references the creator object (marked by /Creator tag in the pdf document). This /Creator tag usually contains the string which identifies the creator of the pdf document.<br/>
<br/>
<a href="../external.html?link=http://imageshack.us/photo/my-images/163/39401306.png/" target="_blank"><img alt="" border="0" src="../external.html?link=http://imageshack.com/e/p5aMES7Yj"/></a><br/>
<br/>
Uploaded with <a href="../external.html?link=http://imageshack.us/" target="_blank">ImageShack.us</a><br/>
<br/>
Continued
						</blockquote>
					</div>

					
				</div>
			</div>
			
			<div class="cleardiv"></div>
		</div>
	</div>
		<div class="postfoot">
			<!-- <div class="postfoot_container"> -->
			<div class="textcontrols floatcontainer">
				<span class="postcontrols">
					<img alt="" id="progress_5624" src="images/misc/progress.gif" style="display:none"/>
					
					
					
						<a class="newreply" href="newreplyf506.html?do=newreply&amp;p=5624" id="qrwq_5624" rel="nofollow" title="Reply With Quote"><img alt="Reply With Quote" id="quoteimg_5624" src="clear.gif"/>  Reply With Quote</a> 
					
					
					
				</span>
				<span class="postlinking">
					
						
					

					
					
					
					

					
					

					
					
					
					
					
				</span>
			<!-- </div> -->
			</div>
		</div>
	<hr/>
</li>

<li class="postbitlegacy postbitim postcontainer old" id="post_5625">
<!-- see bottom of postbit.css for .userinfo .popupmenu styles -->

	<div class="posthead">
			<span class="postdate old">
				
					<span class="date">09-11-2011, <span class="time">05:52 PM</span></span>
				
			</span>
			<span class="nodecontrols">
				
					<a class="postcounter" href="showthread394d.html?t=1467&amp;p=5625&amp;viewfull=1#post5625" name="post5625">#4</a><a id="postcount5625" name="4"></a>
				
				
				
			</span>
	</div>
	<div class="postdetails">
		<div class="userinfo">
			<div class="username_container">
			
				<div class="popupmenu memberaction">
	<a class="username offline popupctrl" href="member62b2.html?u=1164" title="m0nna is offline"><strong>m0nna</strong></a>
	<ul class="popupbody popuphover memberaction_body">
		<li class="left">
			<a class="siteicon_profile" href="member62b2.html?u=1164">
				View Profile
			</a>
		</li>
		
		<li class="right">
			<a class="siteicon_forum" href="searchc71c.html?do=finduser&amp;userid=1164&amp;contenttype=vBForum_Post&amp;showposts=1" rel="nofollow">
				View Forum Posts
			</a>
		</li>
		
		
		<li class="left">
			<a class="siteicon_message" href="private83fa.html?do=newpm&amp;u=1164" rel="nofollow">
				Private Message
			</a>
		</li>
		
		
		
		<li class="right">
			<a class="siteicon_blog" href="blog62b2.html?u=1164" rel="nofollow">
				View Blog Entries
			</a>
		</li>
		
		
		
		
		
		<li class="right">
			<a class="siteicon_article" href="listbfcd.html?r=author/1164-m0nna" rel="nofollow">
				View Articles
			</a>
		</li>
		

		

		
		
	</ul>
</div>
				<img alt="m0nna is offline" border="0" class="inlineimg onlinestatus" src="images/statusicon/user-offline.png"/>

			
			</div>
			<span class="usertitle">
				Garage Newcomer
			</span>
			
			
			
				<span class="postbit_reputation" id="repdisplay_5625_1164" title="m0nna is on a distinguished road">
					
						<img alt="" class="repimg" src="images/reputation/reputation_pos.png"/>
					
				</span>
			
			 
			
				<hr/>
				<dl class="userinfo_extra">
					<dt>Join Date</dt> <dd>Sep 2011</dd>
					
					
					<dt>Posts</dt> <dd>21</dd>	
					<dt>Blog Entries</dt><dd><a href="blog62b2.html?u=1164">2</a></dd>
				</dl>
				
				
				<div class="imlinks">
					    
				</div>
			
		</div>
		<div class="postbody">
			<div class="postrow">
				
				


						
						
				<div class="content">
					<div id="post_message_5625">
						<blockquote class="postcontent restore">
							Part 4<br/>
<br/>
Searching for the creator object in pdf document using pdf-parser showed that object 8 contians the creator info, but in this case instead of the string which identifies the creator,  it contains  encoded javascript code.(which is the second stage code)<br/>
The below screenshot shows the extracted content from the creator object.<br/>
<br/>
<a href="../external.html?link=http://imageshack.us/photo/my-images/683/50490223.png/" target="_blank"><img alt="" border="0" src="../external.html?link=http://imageshack.com/e/p5aMES7Yj"/></a><br/>
<br/>
Uploaded with <a href="../external.html?link=http://imageshack.us/" target="_blank">ImageShack.us</a><br/>
<br/>
After extracting this encoded content, i added this encoded content into the first stage javascript (created a variable called this.creator with encoded  javascript as value), the below screenshot shows the modified javascript. <br/>
<br/>
<a href="../external.html?link=http://imageshack.us/photo/my-images/651/18347871.png/" target="_blank"><img alt="" border="0" src="../external.html?link=http://imageshack.com/e/p5aMES7Yj"/></a><br/>
<br/>
Uploaded with <a href="../external.html?link=http://imageshack.us/" target="_blank">ImageShack.us</a><br/>
<br/>
In this above screeshot, unescape function is used to decode the encoded data, in this case it is replacing “z” from the content of this.creator and replacing with “%” sign and decoding the data, and eval is used to execute the decoded data,  so now we need to make sure that instead of executing the data, it has to print the data so that we can see the decoded content.....there are multiple ways to do this, one way is to add “eval=print;” at the beginning to overide the funcionality of eval, After executing the script with spidermonkey we get the decoded javascript as shown below:<br/>
<br/>
<a href="../external.html?link=http://imageshack.us/photo/my-images/225/68737317.png/" target="_blank"><img alt="" border="0" src="../external.html?link=http://imageshack.com/e/p5aMES7Yj"/></a><br/>
<br/>
Uploaded with <a href="../external.html?link=http://imageshack.us/" target="_blank">ImageShack.us</a><br/>
<br/>
In the above code you can see that exploit target the vulnerability in the util.printf() (CVE-2008-2992) function by passing a big number as the second parameter to the function and you can also see the buffer being allocated and the heapy spray code prior to exploiting the vulnerability and you can also see the shellcode in the unescape funtion.<br/>
<br/>
Now we know the javascript exploit the vulnerability in the util.printf() function and place the shellcode in the created buffer and executes it after exploiting the vulnerability.<br/>
<br/>
Continued
						</blockquote>
					</div>

					
				</div>
			</div>
			
			<div class="cleardiv"></div>
		</div>
	</div>
		<div class="postfoot">
			<!-- <div class="postfoot_container"> -->
			<div class="textcontrols floatcontainer">
				<span class="postcontrols">
					<img alt="" id="progress_5625" src="images/misc/progress.gif" style="display:none"/>
					
					
					
						<a class="newreply" href="newreply2d0d.html?do=newreply&amp;p=5625" id="qrwq_5625" rel="nofollow" title="Reply With Quote"><img alt="Reply With Quote" id="quoteimg_5625" src="clear.gif"/>  Reply With Quote</a> 
					
					
					
				</span>
				<span class="postlinking">
					
						
					

					
					
					
					

					
					

					
					
					
					
					
				</span>
			<!-- </div> -->
			</div>
		</div>
	<hr/>
</li>

<li class="postbitlegacy postbitim postcontainer old" id="post_5626">
<!-- see bottom of postbit.css for .userinfo .popupmenu styles -->

	<div class="posthead">
			<span class="postdate old">
				
					<span class="date">09-11-2011, <span class="time">05:57 PM</span></span>
				
			</span>
			<span class="nodecontrols">
				
					<a class="postcounter" href="showthreadbfce.html?t=1467&amp;p=5626&amp;viewfull=1#post5626" name="post5626">#5</a><a id="postcount5626" name="5"></a>
				
				
				
			</span>
	</div>
	<div class="postdetails">
		<div class="userinfo">
			<div class="username_container">
			
				<div class="popupmenu memberaction">
	<a class="username offline popupctrl" href="member62b2.html?u=1164" title="m0nna is offline"><strong>m0nna</strong></a>
	<ul class="popupbody popuphover memberaction_body">
		<li class="left">
			<a class="siteicon_profile" href="member62b2.html?u=1164">
				View Profile
			</a>
		</li>
		
		<li class="right">
			<a class="siteicon_forum" href="searchc71c.html?do=finduser&amp;userid=1164&amp;contenttype=vBForum_Post&amp;showposts=1" rel="nofollow">
				View Forum Posts
			</a>
		</li>
		
		
		<li class="left">
			<a class="siteicon_message" href="private83fa.html?do=newpm&amp;u=1164" rel="nofollow">
				Private Message
			</a>
		</li>
		
		
		
		<li class="right">
			<a class="siteicon_blog" href="blog62b2.html?u=1164" rel="nofollow">
				View Blog Entries
			</a>
		</li>
		
		
		
		
		
		<li class="right">
			<a class="siteicon_article" href="listbfcd.html?r=author/1164-m0nna" rel="nofollow">
				View Articles
			</a>
		</li>
		

		

		
		
	</ul>
</div>
				<img alt="m0nna is offline" border="0" class="inlineimg onlinestatus" src="images/statusicon/user-offline.png"/>

			
			</div>
			<span class="usertitle">
				Garage Newcomer
			</span>
			
			
			
				<span class="postbit_reputation" id="repdisplay_5626_1164" title="m0nna is on a distinguished road">
					
						<img alt="" class="repimg" src="images/reputation/reputation_pos.png"/>
					
				</span>
			
			 
			
				<hr/>
				<dl class="userinfo_extra">
					<dt>Join Date</dt> <dd>Sep 2011</dd>
					
					
					<dt>Posts</dt> <dd>21</dd>	
					<dt>Blog Entries</dt><dd><a href="blog62b2.html?u=1164">2</a></dd>
				</dl>
				
				
				<div class="imlinks">
					    
				</div>
			
		</div>
		<div class="postbody">
			<div class="postrow">
				
				


						
						
							
						
				<div class="content">
					<div id="post_message_5626">
						<blockquote class="postcontent restore">
							Part 5<br/>
<br/>
<b><u>Shellcode analysis</u></b><br/>
<br/>
Now its time to analyze the shellcode to know its capabilities,  the below screeshot shows the extracted shellcode<br/>
<br/>
<a href="../external.html?link=http://imageshack.us/photo/my-images/822/43259587.png/" target="_blank"><img alt="" border="0" src="../external.html?link=http://imageshack.com/e/p5aMES7Yj"/></a><br/>
<br/>
Uploaded with <a href="../external.html?link=http://imageshack.us/" target="_blank">ImageShack.us</a><br/>
<br/>
the shellcode was converted to exe for further analysis, the below screenshot shows the conversion, the converted exe is called converted_shellcode.exe<br/>
<br/>
<a href="../external.html?link=http://imageshack.us/photo/my-images/215/52474607.png/" target="_blank"><img alt="" border="0" src="../external.html?link=http://imageshack.com/e/p5aMES7Yj"/></a><br/>
<br/>
Uploaded with <a href="../external.html?link=http://imageshack.us/" target="_blank">ImageShack.us</a><br/>
<br/>
looks at the strings and opening the convered exe in a debugger/hexeditor, you can say that the shellcode is used as  a downloader, in the below screenshots you can also see referecnes to a malicious website (grinchalina8.com), the google search on that website shows that this site is malicious and also you can see references to api calls which is used by downloader and also reference to an exe (pdfupd.exe).<br/>
 In this case the “LoadLibraryA” api call is used to load urlmon.dll, then uses the api call “UrlDownloadToFileA” to download the exe file “pdfupd.exe”  and then it uses “WinExec” api call to execute the downloaded executable.<br/>
<br/>
<a href="../external.html?link=http://imageshack.us/photo/my-images/696/37334246.png/" target="_blank"><img alt="" border="0" src="../external.html?link=http://imageshack.com/e/p5aMES7Yj"/></a><br/>
<br/>
Uploaded with <a href="../external.html?link=http://imageshack.us/" target="_blank">ImageShack.us</a><br/>
<br/>
<a href="../external.html?link=http://imageshack.us/photo/my-images/829/35226564.png/" target="_blank"><img alt="" border="0" src="../external.html?link=http://imageshack.com/e/p5aMES7Yj"/></a><br/>
<br/>
Uploaded with <a href="../external.html?link=http://imageshack.us/" target="_blank">ImageShack.us</a><br/>
<br/>
<a href="../external.html?link=http://imageshack.us/photo/my-images/196/98258008.png/" target="_blank"><img alt="" border="0" src="../external.html?link=http://imageshack.com/e/p5aMES7Yj"/></a><br/>
<br/>
Uploaded with <a href="../external.html?link=http://imageshack.us/" target="_blank">ImageShack.us</a><br/>
<br/>
With this i complete my analysis, i hope this will help beginners like me understand the analysis of malicious pdf document. :-)
						</blockquote>
					</div>

					
				</div>
			</div>
			
			<div class="cleardiv"></div>
		</div>
	</div>
		<div class="postfoot">
			<!-- <div class="postfoot_container"> -->
			<div class="textcontrols floatcontainer">
				<span class="postcontrols">
					<img alt="" id="progress_5626" src="images/misc/progress.gif" style="display:none"/>
					
					
					
						<a class="newreply" href="newreply3089.html?do=newreply&amp;p=5626" id="qrwq_5626" rel="nofollow" title="Reply With Quote"><img alt="Reply With Quote" id="quoteimg_5626" src="clear.gif"/>  Reply With Quote</a> 
					
					
					
				</span>
				<span class="postlinking">
					
						
					

					
					
					
					

					
					

					
					
					
					
					
				</span>
			<!-- </div> -->
			</div>
		</div>
	<hr/>
</li>

		</ol>
                <div class="separator"></div>
		<div class="postlistfoot">
			
		</div>

	

</div>

<div class="noinlinemod below_postlist" id="below_postlist">
	
	<div class="pagination_bottom" id="pagination_bottom">
	
		<div class="clear"></div>
<div class="navpopupmenu popupmenu nohovermenu" id="showthread_navpopup">
	
		<span class="shade">Quick Navigation</span>
		<a class="popupctrl" href="showthread69f0.html?t=1467"><span class="ctrlcontainer">Botnets, Malwares &amp; Rootkits Analysis</span></a>
		<a class="textcontrol" href="showthreadaac7.html?t=1467&amp;p=5626#top" onclick="document.location.hash='top';return false;">Top</a>
	
	<ul class="navpopupbody popupbody popuphover">
		
		<li class="optionlabel">Site Areas</li>
		<li><a href="usercp.html">Settings</a></li>
		<li><a href="private.html">Private Messages</a></li>
		<li><a href="subscription.html">Subscriptions</a></li>
		<li><a href="online.html">Who's Online</a></li>
		<li><a href="search.html">Search Forums</a></li>
		<li><a href="forum.html">Forums Home</a></li>
		
			<li class="optionlabel">Forums</li>
			
		
			
				<li><a href="forumdisplay58da.html?f=1">Garage Network</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplay12a3.html?f=2">Garage Announcements</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplaye57d.html?f=58">Bravo - Null 2012</a></li>
			
		
			
				<li><a href="forumdisplay0756.html?f=59">Garage Local Chapter Meets</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplay31e6.html?f=4">Garage Rules</a></li>
			
		
			
				<li><a href="forumdisplaye774.html?f=5">Feedback &amp; Suggestions</a></li>
			
		
			
				<li><a href="forumdisplayd42b.html?f=7">Introduce Your Self</a></li>
			
		
			
				<li><a href="forumdisplay2b89.html?f=38">Shout-box</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplaycf19.html?f=6">Garage Lounge</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplay5579.html?f=30">Hacking for Beginners</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplay6ac3.html?f=57">Did You Know?</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplay957d.html?f=8">Security &amp; Hacking News Thread</a></li>
			
		
			
				<li><a href="forumdisplay3215.html?f=36">Career in InfoSec</a></li>
			
		
			
				<li><a href="forumdisplay814c.html?f=29">Request Zone</a></li>
			
		
			
				<li><a href="forumdisplay13b6.html?f=27">Noobs Corner</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplayfdc5.html?f=9">Hacking and Security Discussions</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplayfac0.html?f=55">Tip | Trick of the Day</a></li>
			
		
			
				<li><a href="forumdisplayc4a6.html?f=66">ICS / SCADA Security</a></li>
			
		
			
				<li><a href="forumdisplay6111.html?f=67">Internet of Things - IoT</a></li>
			
		
			
				<li><a href="forumdisplay15ca.html?f=10">Network Vulnerabiltity Assessment &amp; Penetration Testing</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplaya05c.html?f=56">Post Exploitation</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplay8a83.html?f=11">Web Application Penetration Testing</a></li>
			
		
			
				<li><a href="forumdisplay01c9.html?f=12">Wireless and Bluetooth Hacking</a></li>
			
		
			
				<li><a href="forumdisplay48ab.html?f=17">Computer Forensics and Incident Handling</a></li>
			
		
			
				<li><a href="forumdisplay218b.html?f=19">Physical Security and Social Engineering</a></li>
			
		
			
				<li><a href="forumdisplayb09f.html?f=15">General Security &amp; Best Practices</a></li>
			
		
			
				<li><a href="forumdisplay907f.html?f=42">Security and Hacking Videos</a></li>
			
		
			
				<li><a href="forumdisplay9e0d.html?f=54">Mobile Security</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplay9780.html?f=14">General Security Discussions</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplay9df8.html?f=31">Programming</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplay65b9.html?f=35">Assembly</a></li>
			
		
			
				<li><a href="forumdisplayc4f1.html?f=32">C/C++</a></li>
			
		
			
				<li><a href="forumdisplayb0a0.html?f=34">Perl</a></li>
			
		
			
				<li><a href="forumdisplayb8c1.html?f=60">PHP</a></li>
			
		
			
				<li><a href="forumdisplay6c4e.html?f=33">Python</a></li>
			
		
			
				<li><a href="forumdisplay208f.html?f=51">Linux Shell / Bash Programming</a></li>
			
		
			
				<li><a href="forumdisplay3238.html?f=47">Windows Batch Programming</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplayce40.html?f=28">BackTrack and Other Linux Distributions</a></li>
			
		
			
				<li><a href="forumdisplayf2fa.html?f=16">Networks &amp; Networking</a></li>
			
		
			
				<li><a href="forumdisplaya213.html?f=18">Cloud Computing</a></li>
			
		
			
				<li><a href="forumdisplaydfa4.html?f=39">Security Podcast and Videos</a></li>
			
		
			
				<li><a href="forumdisplaya3f5.html?f=40">Miscellanous Thread</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplay30ac.html?f=49">Brush Up Your Skills</a></li>
			
		
			
					</ol>
				</li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplayffeb.html?f=20">Experts Forum</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplaycdba.html?f=48">My Meanest Hacks</a></li>
			
		
			
				<li><a href="forumdisplayf6ac.html?f=37">Hacking &amp; Security Books and Tutorials</a></li>
			
		
			
				<li><a href="forumdisplay8011.html?f=23">Tools &amp; Scripts</a></li>
			
		
			
				<li><a href="forumdisplay8941.html?f=22">Exploitation Techniques</a></li>
			
		
			
				<li><a href="forumdisplay345c.html?f=24">Reverse Engineering and Application Cracking</a></li>
			
		
			
				<li><a href="forumdisplaye8b3.html?f=25">Botnets, Malwares &amp; Rootkits Analysis</a></li>
			
		
			
				<li><a href="forumdisplay107e.html?f=43">Garage4hackers Exploits</a></li>
			
		
			
				<li><a href="forumdisplaye5f3.html?f=64">Browser Fuzzing</a></li>
			
		
			
					</ol>
				</li>
			
		
		
	</ul>
</div>
<div class="clear"></div>
	</div>
</div>










<!-- next / previous links -->
<div class="navlinks">
	
	<strong>«</strong>
	<a href="showthread0802.html?t=1467&amp;goto=nextoldest" rel="nofollow">Previous Thread</a>
	|
	<a href="showthread2a1d.html?t=1467&amp;goto=nextnewest" rel="nofollow">Next Thread</a>
	<strong>»</strong>
	
</div>
<!-- / next / previous links -->

<div class="thread_info" id="thread_info">
	
	
	
	
	<h4 class="threadinfohead"><span class="optiontitle">Tags for this Thread</span></h4>
	<div class="thread_info_block" id="thread_tags_list">
		<div class="inner_block">
			
			<div id="tag_list_cell">
				
		
			<a href="tags5972-2.html?tag=adobe">adobe</a>, 
		
			<a href="tags33cc.html?tag=malicious+pdf+analysis">malicious pdf analysis</a>, 
		
			<a href="tagsb0b0.html?tag=malware+analysis">malware analysis</a>, 
		
			<a href="tagsb72d.html?tag=reverse+engineering">reverse engineering</a>
		

<img alt="" class="inlineimg hidden" id="tag_form_progress" src="images/misc/11x11progress.gif"/>
			</div>
			<p>
				<a href="tags.html">View Tag Cloud</a>
			</p>
		</div>
	</div>
	
	<div class="options_block_container">
		
		<div class="options_block">
			<h4 class="collapse">
				<a class="collapse" href="showthreadaac7.html?t=1467&amp;p=5626#top" id="collapse_posting_rules"><img alt="" src="images/buttons/collapse_40b.png"/></a>
				<span class="optiontitle">Posting Permissions</span>
			</h4>
			<div class="thread_info_block" id="posting_rules">
				
<div class="info_subblock" id="forumrules">

	<ul class="youcandoblock">
		<li>You <strong>may not</strong> post new threads</li>
		<li>You <strong>may not</strong> post replies</li>
		<li>You <strong>may not</strong> post attachments</li>
		<li>You <strong>may not</strong> edit your posts</li>
		<li> </li>
	</ul>
	<div class="bbcodeblock">
		<ul>
			<li><a href="miscaff0.html?do=bbcode" target="_blank">BB code</a> is <strong>On</strong></li>
			<li><a href="misc9712.html?do=showsmilies" target="_blank">Smilies</a> are <strong>On</strong></li>
			<li><a href="miscaff0.html?do=bbcode#imgcode" target="_blank">[IMG]</a> code is <strong>On</strong></li>
			<li><a href="miscaff0.html?do=bbcode#videocode" target="_blank">[VIDEO]</a> code is <strong>On</strong></li>
			<li>HTML code is <strong>Off</strong></li>
		</ul>
	</div>
	<p class="rules_link"><a href="misc17ec.html?do=showrules" target="_blank">Forum Rules</a></p>

</div>

			</div>
		</div>

	</div>

</div>








<div style="clear: left">
  
<div class="google_adsense_footer" style="width:468px; margin:0 auto; padding-top:1em">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6847984837250662";
google_ad_host = "ca-host-pub-2606800903002383";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "text_image";
google_ad_channel = "";
google_color_border = "";
google_color_bg = "";
google_color_link = "";
google_color_text = "";
google_color_url = "";
google_ui_features = "rc:6";
//-->
</script>
<script src="../pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>
</div>

  <div id="ad_global_above_footer"><div align="center">
<script type="text/javascript"><!--
google_ad_client = "pub-6847984837250662";
/* 728x90, created 7/9/10 */
google_ad_slot = "7101394260";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script src="../pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script></div>
</div>

<div class="floatcontainer footer" id="footer">

	<form action="../external.html?link=http://garage4hackers.com/forum.php" class="footer_select" id="footer_select" method="get">

		
			<select name="styleid" onchange="switch_id(this, 'style')">
				<optgroup label="Quick Style Chooser"><option class="hidden"></option></optgroup>
				
					
					<optgroup label=" Standard Styles">
									
					
	<option class="" selected="selected" value="1">-- Default Style</option>

					
					</optgroup>
										
				
				
					
					<optgroup label=" Mobile Styles">
					
					
	<option class="" value="2">-- Default Mobile Style</option>

					
					</optgroup>
										
				
			</select>	
		
		
		
	</form>

	<ul class="footer_links" id="footer_links">
		<li><a accesskey="9" href="sendmessage.html" rel="nofollow">Contact Us</a></li>
		<li><a href="index.html">Garage4hackers</a></li>
		
		
		<li><a href="archive/index.html">Archive</a></li>
		<li><a href="../external.html?link=http://glowhost.com/" target="_blank">Web Hosting</a></li>
		
		
		<li><a href="showthreadaac7.html?t=1467&amp;p=5626#top" onclick="document.location.hash='top'; return false;">Top</a></li>
	</ul>
	
	
	
	
	<script type="text/javascript">
	<!--
		// Main vBulletin Javascript Initialization
		vBulletin_init();
		function md5hash(B,A,E,C){if(navigator.userAgent.indexOf("Mozilla/index.html")==1&&parseInt(navigator.appVersion)>=4){var D=hex_md5(str_to_ent(trim(B.value)));A.value=D;if(E){D=hex_md5(trim(B.value));E.value=D}if(!C){B.value=""}}return true};
	//-->
	</script>
        
</div>
</div> <!-- closing div for body_wrapper -->

<div class="below_body">
<div class="shade footer_time" id="footer_time">All times are GMT +5.5. The time now is <span class="time">04:12 PM</span>.</div>

<div class="shade footer_copyright" id="footer_copyright">
	<!-- Do not remove this copyright notice -->
	Powered by <a href="../external.html?link=https://www.vbulletin.com/" id="vbulletinlink">vBulletin®</a> Version 4.2.1 <br/>Copyright © 2020 vBulletin Solutions, Inc. All rights reserved. 
	<!-- Do not remove this copyright notice -->	
</div>
<div class="shade footer_morecopyright" id="footer_morecopyright">
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	Copyright 2010 - 2017, Garage4Hackers
	
</div>
 

	<div id="fb-root"></div>
<script src="clientscript/vbulletin_facebook6719.js?v=421" type="text/javascript"></script>

<script type="text/javascript">
<!--
	loadFacebookAPI('en_US');
	function fbAsyncInit()
	{
		vBfb = new vB_Facebook({
			appid : "170793809601191",
			connected : 0,
			active : 0,
			autoreg : 0,
			feed_newthread : 1,
			feed_postreply : 1,
			feed_blogentry : 1,
			feed_blogcomment : 1,
			feed_newarticle : 1,
			feed_articlecomment : 1
		});
	}
// -->
</script>

</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker('UA-17311051-3');
pageTracker._trackPageview();
} catch(err) {}</script>

</div></body></html>