<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html dir="ltr" id="vbulletin_html" lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://www.facebook.com/2008/fbml"><!-- Mirrored from garage4hackers.com/showthread.php?t=216 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 18:22:23 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

	<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="index.html" id="e_vb_meta_bburl" name="vb_meta_bburl"/>
<base/><!--[if IE]></base><![endif]-->
<meta content="vBulletin 4.2.1" name="generator"/>
<meta content="IE=9" http-equiv="X-UA-Compatible"/>

	<link href="favicon.ico" rel="Shortcut Icon" type="image/x-icon"/>






	<meta content="170793809601191" property="fb:app_id"/>
<meta content="Garage4hackers Forum" property="og:site_name"/>
<meta content="Garage4Hackers(G4H) is an open security community for Information Security enthusiasts, gurus and aspirants.Members of the team dedicate time and resources towards helping other information security aspirants, sharing knowledge,spreading security awareness and promoting research." property="og:description"/>
<meta content="showthread3265.html?t=216" property="og:url"/>
<meta content="article" property="og:type"/>




	
		<script src="../yui.yahooapis.com/comboaa66?2.9.0/build/yuiloader-dom-event/yuiloader-dom-event.js&amp;2.9.0/build/connection/connection-min.js" type="text/javascript"></script>
	

<script type="text/javascript">
<!--
	if (typeof YAHOO === 'undefined') // Load ALL YUI Local
	{
		document.write('<script type="text/javascript" src="clientscript/yui/yuiloader-dom-event/yuiloader-dom-event6719.html?v=421"><\/script>');
		document.write('<script type="text/javascript" src="clientscript/yui/connection/connection-min6719.html?v=421"><\/script>');
		var yuipath = 'clientscript/yui';
		var yuicombopath = '';
		var remoteyui = false;
	}
	else	// Load Rest of YUI remotely (where possible)
	{
		var yuipath = '../external.html?link=http://yui.yahooapis.com/2.9.0/build';
		var yuicombopath = '../external.html?link=http://yui.yahooapis.com/combo';
		var remoteyui = true;
		if (!yuicombopath)
		{
			document.write('<script type="text/javascript" src="../yui.yahooapis.com/2.9.0/build/connection/connection-min6719.js?v=421"><\/script>');
		}
	}
	var SESSIONURL = "";
	var SECURITYTOKEN = "guest";
	var IMGDIR_MISC = "images/misc";
	var IMGDIR_BUTTON = "images/buttons";
	var vb_disable_ajax = parseInt("0", 10);
	var SIMPLEVERSION = "421";
	var BBURL = "index.html";
	var LOGGEDIN = 0 > 0 ? true : false;
	var THIS_SCRIPT = "showthread";
	var RELPATH = "showthread3265.html?t=216";
	var PATHS = {
		forum : "",
		cms   : "",
		blog  : ""
	};
	var AJAXBASEURL = "index.html";
// -->
</script>
<script src="clientscript/vbulletin-core6719.js?v=421" type="text/javascript"></script>



	<link href="external9476.php?type=RSS2" rel="alternate" title="Garage4hackers Forum RSS Feed" type="application/rss+xml"/>
	
		<link href="externalb77f.php?type=RSS2&amp;forumids=22" rel="alternate" title="Garage4hackers Forum - Exploitation Techniques - RSS Feed" type="application/rss+xml"/>
	



	<link href="css30f2.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=bbcode.css,editor.css,popupmenu.css,reset-fonts.css,vbulletin.css,vbulletin-chrome.css,vbulletin-formcontrols.css," rel="stylesheet" type="text/css"/>

	<!--[if lt IE 8]>
	<link rel="stylesheet" type="text/css" href="css.php?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=popupmenu-ie.css,vbulletin-ie.css,vbulletin-chrome-ie.css,vbulletin-formcontrols-ie.css,editor-ie.css" />
	<![endif]-->


	<meta content="file, exploit, race, condition, .lnk, case, false, xcheck, access, code, shortcut, link, include, project, pragma, shared, tackle, windows, write, team, dllmain, bool, ul_reason_for_call, true, sections, handle, resources, void, routine, memory, exploitation, victim, resolved, vinnu, execute, dll_thread_detach, dll_process_detach, switch, inbreak, break, dll_process_attach, dll_thread_attach, path, added, workspace, needed, x.def, /----------end, file-----------------, return" name="keywords"/>
	<meta content='Team : Legion Of Xtremers / Garage4Hackers 
author : "vinnu" 
Greetz : Prashant Uniyal, b0nd, D4rk457, and Secfence team. 
Exploit path : http://www.exploit-db.com/exploits/14403/ 
Exploit by : Ivanlef0u 
 
 
Windows Link exploit (shortcut file) race condition tackling 
 
The .lnk exploit retrieves a DLL from remote machine and execute it while the icon' name="description"/>

	<title> Windows Link exploit (shortcut file) race condition tackling--"vinnu"</title>
	<link href="showthread3265.html?t=216" rel="canonical"/>
	
	<script src="clientscript/vbulletin_textedit6719.html?v=421" type="text/javascript"></script>
	<script src="clientscript/vbulletin_post_loader6719.html?v=421" type="text/javascript"></script>
	
	
	
	
	
	

	
		<link href="css8d9b.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=postlist.css,showthread.css,postbit.css,attachment.css,poll.css,lightbox.css" rel="stylesheet" type="text/css"/>
	

<link href="css657d.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=additional.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<div class="above_body"> <!-- closing tag is in template navbar -->
<div class="floatcontainer doc_header" id="header">
	<div><a class="logo-image" href="forum.html" name="top"><img alt="Garage4hackers Forum" src="images/misc/vbulletin4_logo.png"/></a></div>
	<div class="toplinks" id="toplinks">
		
			<ul class="nouser">
			
				<li><a href="register.html" rel="nofollow">Register</a></li>
			
				<li><a href="faq.html" rel="help">Help</a></li>
				<li>
			<script src="clientscript/vbulletin_md56719.html?v=421" type="text/javascript"></script>
			<form action="../external.html?link=http://garage4hackers.com/login.php?do=login" id="navbar_loginform" method="post" onsubmit="md5hash(vb_login_password, vb_login_md5password, vb_login_md5password_utf, 0)">
				<fieldset class="logindetails" id="logindetails">
					<div>
						<div>
					<input accesskey="u" class="textbox default-value" id="navbar_username" name="vb_login_username" size="10" tabindex="101" type="text" value="User Name"/>
					<input class="textbox" id="navbar_password" name="vb_login_password" size="10" tabindex="102" type="password"/>
					<input class="textbox default-value" id="navbar_password_hint" name="vb_login_password_hint" size="10" style="display:none;" tabindex="102" type="text" value="Password"/>
					<input accesskey="s" class="loginbutton" tabindex="104" title="Enter your username and password in the boxes provided to login, or click the 'register' button to create a profile for yourself." type="submit" value="Log in"/>
						</div>
					</div>
				</fieldset>
				<div class="remember" id="remember">
					<label for="cb_cookieuser_navbar"><input accesskey="c" class="cb_cookieuser_navbar" id="cb_cookieuser_navbar" name="cookieuser" tabindex="103" type="checkbox" value="1"/> Remember Me?</label>
				</div>

				<input name="s" type="hidden" value=""/>
				<input name="securitytoken" type="hidden" value="guest"/>
				<input name="do" type="hidden" value="login"/>
				<input name="vb_login_md5password" type="hidden"/>
				<input name="vb_login_md5password_utf" type="hidden"/>
			</form>
			<script type="text/javascript">
			YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "inline");
			YAHOO.util.Dom.setStyle('navbar_password', "display", "none");
			vB_XHTML_Ready.subscribe(function()
			{
			//
				YAHOO.util.Event.on('navbar_username', "focus", navbar_username_focus);
				YAHOO.util.Event.on('navbar_username', "blur", navbar_username_blur);
				YAHOO.util.Event.on('navbar_password_hint', "focus", navbar_password_hint);
				YAHOO.util.Event.on('navbar_password', "blur", navbar_password);
			});
			
			function navbar_username_focus(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				if (textbox.value == 'User Name')
				{
				//
					textbox.value='';
					textbox.style.color='#000000';
				}
			}

			function navbar_username_blur(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				if (textbox.value == '')
				{
				//
					textbox.value='User Name';
					textbox.style.color='#777777';
				}
			}
			
			function navbar_password_hint(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				
				YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "none");
				YAHOO.util.Dom.setStyle('navbar_password', "display", "inline");
				YAHOO.util.Dom.get('navbar_password').focus();
			}

			function navbar_password(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				
				if (textbox.value == '')
				{
					YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "inline");
					YAHOO.util.Dom.setStyle('navbar_password', "display", "none");
				}
			}
			</script>
				</li>
				
					<li class="hidden" id="fb_headerbox">

	<a href="#" id="fb_loginbtn"><img alt="The Facebook Platform" src="images/misc/facebook_login.gif"/></a>

</li>

				
			</ul>
		
	</div>
	<div class="ad_global_header">
		 
		 
	</div>
	<hr/>
</div>
<div class="navbar" id="navbar">
	<ul class="navtabs floatcontainer" id="navtabs">
		
		
	
		<li id="vbtab_whatsnew">
			<a class="navtab" href="activity.html">What's New?</a>
		</li>
		
		

	
		<li id="vbtab_cms">
			<a class="navtab" href="content.html">Articles</a>
		</li>
		
		

	
		<li class="selected" id="vbtab_forum">
			<a class="navtab" href="forum.html">Forum</a>
		</li>
		
		
			<ul class="floatcontainer">
				
					
						
							<li id="vbflink_newposts"><a href="search8427.html?do=getnew&amp;contenttype=vBForum_Post">New Posts</a></li>
						
					
				
					
						
							<li id="vbflink_faq"><a href="faq.html">FAQ</a></li>
						
					
				
					
						
							<li id="vbflink_calendar"><a href="calendar.html">Calendar</a></li>
						
					
				
					
						<li class="popupmenu" id="vbmenu_community">
							<a class="popupctrl" href="javascript://">Community</a>
							<ul class="popupbody popuphover">
								
									<li id="vbclink_members"><a href="memberlist.html">Member List</a></li>
								
							</ul>
						</li>
					
				
					
						<li class="popupmenu" id="vbmenu_actions">
							<a class="popupctrl" href="javascript://">Forum Actions</a>
							<ul class="popupbody popuphover">
								
									<li id="vbalink_mfr"><a href="forum.html?do=markread&amp;markreadhash=guest">Mark Forums Read</a></li>
								
							</ul>
						</li>
					
				
					
						<li class="popupmenu" id="vbmenu_qlinks">
							<a class="popupctrl" href="javascript://">Quick Links</a>
							<ul class="popupbody popuphover">
								
									<li id="vbqlink_posts"><a href="search2791.html?do=getdaily&amp;contenttype=vBForum_Post">Today's Posts</a></li>
								
									<li id="vbqlink_leaders"><a href="showgroups.html">View Site Leaders</a></li>
								
							</ul>
						</li>
					
				
			</ul>
		

	
		<li id="vbtab_blog">
			<a class="navtab" href="blog.html">Blogs</a>
		</li>
		
		

	
		<li id="tab_nja4_357">
			<a class="navtab" href="pages7b82.html?pageid=2">G4H Team</a>
		</li>
		
		

	
		<li id="tab_nta0_579">
			<a class="navtab" href="pages8782.html?pageid=3">IRC</a>
		</li>
		
		

	
		<li id="tab_nta0_442">
			<a class="navtab" href="pagesdbe0.html?pageid=4">Ranchoddas</a>
		</li>
		
		

		<li>
            <a class="navtab" href="pages.html">Events and Conferences</a></li>
	</ul>
	
		<div class="globalsearch" id="globalsearch">
			<form action="../external.html?link=http://garage4hackers.com/search.php?do=process" class="navbar_search" id="navbar_search" method="post">
				
				<input name="securitytoken" type="hidden" value="guest"/>
				<input name="do" type="hidden" value="process"/>
				<span class="textboxcontainer"><span><input class="textbox" name="query" tabindex="99" type="text" value=""/></span></span>
				<span class="buttoncontainer"><span><input class="searchbutton" name="submit" onclick="document.getElementById('navbar_search').submit;" src="images/buttons/search.html" tabindex="100" type="image"/></span></span>
			</form>
			<ul class="navbar_advanced_search">
				<li><a accesskey="4" href="search.html">Advanced Search</a></li>
				
			</ul>
		</div>
	
</div>
</div><!-- closing div for above_body -->

<div class="body_wrapper">
<div class="breadcrumb" id="breadcrumb">
	<ul class="floatcontainer">
		<li class="navbithome"><a accesskey="1" href="content.html"><img alt="Home" src="images/misc/navbit-home.png"/></a></li>
		
	<li class="navbit"><a href="forum.html">Forum</a></li>

	<li class="navbit"><a href="forumdisplayffeb.html?f=20">Experts Forum</a></li>

	<li class="navbit"><a href="forumdisplay8941.html?f=22">Exploitation Techniques</a></li>

		
	<li class="navbit lastnavbit"><span> Windows Link exploit (shortcut file) race condition tackling--"vinnu"</span></li>

	</ul>
	<hr/>
</div>


<div style="width:728px; margin:0 auto; padding-bottom:1em">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6847984837250662";
google_ad_host = "ca-host-pub-2606800903002383";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al_s";
google_ad_channel = "";
google_color_border = "";
google_color_bg = "";
google_color_link = "";
google_color_text = "";
google_color_url = "";
google_ui_features = "rc:6";
//-->
</script>
<script src="../pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>
</div>

<div id="ad_global_below_navbar"><script async="" src="../pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- garage1 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-6847984837250662" data-ad-slot="4036513682" style="display:inline-block;width:728px;height:90px"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>


	<form action="../external.html?link=http://garage4hackers.com/profile.php?do=dismissnotice" class="notices" id="notices" method="post">
		<input name="do" type="hidden" value="dismissnotice"/>
		<input name="s" type="hidden" value=""/>
		<input name="securitytoken" type="hidden" value="guest"/>
		<input id="dismiss_notice_hidden" name="dismiss_noticeid" type="hidden" value=""/>
		<input name="url" type="hidden" value=""/>
		<ol>
			<li class="restore" id="navbar_notice_2">
	
	
<h2>
The forum is <a href="showthread1180.html?t=7049&amp;p=14985#post14985">frozen forever</a> - but it won't die; it'll stay for long in search engine results and we hope it would keep helping newbies in some way or other - cheers! 


</h2>

<!-- Mirrored from garage4hackers.com/showthread.php?t=216 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 18:22:23 GMT -->

</li>
		</ol>
	</form>





	<div class="above_postlist" id="above_postlist">
		

		<div class="pagination_top" id="pagination_top">
		
			<div class="postpagestats" id="postpagestats_above">
				Results 1 to 6 of 6
			</div>
		</div>
	</div>
<div class="pagetitle" id="pagetitle">
	<h1>
		Thread: <span class="threadtitle"><a href="showthread3265.html?t=216" title="Reload this Page">Windows Link exploit (shortcut file) race condition tackling--"vinnu"</a></span>

<a class="a2a_dd" href="http://www.addtoany.com/share_save"><img alt="Share/Save - My123World.Com!" border="0" height="16" src="../static.addtoany.com/buttons/share_save_171_16.png" width="171"/></a><script type="text/javascript">a2a_show_title=1;a2a_num_services=14;</script><script src="../static.addtoany.com/menu/page.js" type="text/javascript"></script>

		
			
<fb:like action="../external.html?link=http://garage4hackers.com/like" colorscheme="light" font="tahoma" href="showthread3265.html?t=216" layout="standard" show_faces="false" width="260"></fb:like>
		
	</h1>
</div>
	<div class="thread_controls" id="thread_controls">
		<div>
		<ul class="postlist_popups popupgroup" id="postlist_popups">
			
			<li class="popupmenu" id="threadtools">
				<h6><a class="popupctrl" href="javascript://">Thread Tools</a></h6>
				<ul class="popupbody popuphover">
					<li><a accesskey="3" href="printthreadb0f5.html?t=216&amp;pp=10&amp;page=1" rel="nofollow">Show Printable Version</a></li>
					<li><a href="sendmessage4db8.html?do=sendtofriend&amp;t=216" rel="nofollow">Email this Page…</a></li>
					<li>
						
							<a href="subscription4386.html?do=addsubscription&amp;t=216" rel="nofollow">Subscribe to this Thread…</a>
											
					</li>
					
				</ul>
			</li>

			

			
				<li class="popupmenu searchthread" id="searchthread">
					<h6><a class="popupctrl" href="javascript://">Search Thread</a></h6>
					<form action="../external.html?link=http://garage4hackers.com/search.php" method="post">
						<ul class="popupbody popuphover">
							<li>
								<input class="searchbox" name="query" tabindex="13" type="text" value="Search..."/>
								<input class="button" tabindex="14" type="submit" value="Search"/>
							</li>
							<li class="formsubmit">
								<div><a class="advancedsearchlink" href="search70ed.html?search_type=1&amp;searchthreadid=216&amp;contenttype=vBForum_Post">Advanced Search</a></div>
							</li>
						</ul>
						<input name="s" type="hidden" value=""/>
						<input name="securitytoken" type="hidden" value="guest"/>
						<input name="do" type="hidden" value="process"/>
						<input name="searchthreadid" type="hidden" value="216"/>
						<input name="search_type" type="hidden" value="1"/>
						<input name="contenttype" type="hidden" value="vBForum_Post"/>

					</form>
				</li>
			

			

			
				<li class="popupmenu" id="displaymodes">
					<h6><a class="popupctrl" href="javascript://">Display</a></h6>
					<ul class="popupbody popuphover">
						<li><a href="showthread3e24.html?t=216&amp;p=480&amp;mode=linear#post480"> Switch to Linear Mode</a></li>
						<li><a href="showthreadee09.html?t=216&amp;mode=hybrid"> Switch to Hybrid Mode</a></li>
						<li><label>Threaded Mode</label></li>
					</ul>
				</li>
			

			
		</ul>
		</div>
	</div>

<div class="postlist restrain" id="postlist">
	
		<script type="text/javascript">
<!--
var imgdir_statusicon = "images/statusicon";
var imgdir_misc = "images/misc";
var cleargifurl = "clear.gif";
var guestphrase = "Guest";
var morephrase = "More replies below current depth...";
var highlightwords = "";
//-->
</script>

<script src="clientscript/vbulletin_thrdpostlist6719.html?v=421" type="text/javascript"></script>

<script type="text/javascript">
<!--
// initialize some variables
var curpostid = 480;
var quickreply = false;

// cached posts (no page reload required to view)
pd[480] = '\r\n<li class="postbitlegacy postbitim postcontainer old" id="post_480">\r\n<!-' + '- see bottom of postbit.css for .userinfo .popupmenu styles -' + '->\r\n\r\n	<div class="posthead">\r\n			<span class="postdate old">\r\n				\r\n					<span class="date">08-03-2010,&nbsp;<span class="time">03:01 PM</span></span>\r\n				\r\n			</span>\r\n			<span class="nodecontrols">\r\n				\r\n					<a name="post480" href="showthread.php?t=216&amp;p=480&amp;viewfull=1#post480" class="postcounter">#1</a><a id="postcount480" name="1"></a>\r\n				\r\n				\r\n				\r\n			</span>\r\n	</div>\r\n	<div class="postdetails">\r\n		<div class="userinfo">\r\n			<div class="username_container">\r\n			\r\n				<div class="popupmenu memberaction">\r\n	<a class="username offline popupctrl" href="member.php?u=18" title="prashant_uniyal is offline"><strong>prashant_uniyal</strong></a>\r\n	<ul class="popupbody popuphover memberaction_body">\r\n		<li class="left">\r\n			<a href="member.php?u=18" class="siteicon_profile">\r\n				View Profile\r\n			</a>\r\n		</li>\r\n		\r\n		<li class="right">\r\n			<a href="search.php?do=finduser&amp;userid=18&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">\r\n				View Forum Posts\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="private.php?do=newpm&amp;u=18" class="siteicon_message" rel="nofollow">\r\n				Private Message\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="blog.php?u=18" class="siteicon_blog" rel="nofollow">\r\n				View Blog Entries\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="http://hackingethics.wordpress.com" class="siteicon_homepage">\r\n				Visit Homepage\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="http://garage4hackers.com/list.php?r=author/18-prashant_uniyal" class="siteicon_article" rel="nofollow">\r\n				View Articles\r\n			</a>\r\n		</li>\r\n		\r\n\r\n		\r\n\r\n		\r\n		\r\n	</ul>\r\n</div>\r\n				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.png" alt="prashant_uniyal is offline" border="0" />\r\n\r\n			\r\n			</div>\r\n			<span class="usertitle">\r\n				Security Analyst\r\n			</span>\r\n			\r\n			\r\n			\r\n				<span class="postbit_reputation" id="repdisplay_480_18" title="prashant_uniyal has a spectacular aura about">\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n				</span>\r\n			\r\n			\r\n			<a class="postuseravatar" href="member.php?u=18" title="prashant_uniyal is offline">\r\n				<img src="image.php?u=18&amp;dateline=1393305256" alt="prashant_uniyal\'s Avatar" title="prashant_uniyal\'s Avatar" />\r\n			</a>\r\n			 \r\n			\r\n				<hr />\r\n				<dl class="userinfo_extra">\r\n					<dt>Join Date</dt> <dd>Jul 2010</dd>\r\n					<dt>Location</dt> <dd>localhost</dd>\r\n					\r\n					<dt>Posts</dt> <dd>505</dd>	\r\n					<dt>Blog Entries</dt><dd><a href="blog.php?u=18">8</a></dd>\r\n				</dl>\r\n				\r\n				\r\n				<div class="imlinks">\r\n					    \r\n				</div>\r\n			\r\n		</div>\r\n		<div class="postbody">\r\n			<div class="postrow has_after_content">\r\n				\r\n				\r\n				<h2 class="title icon">\r\n					Windows Link exploit (shortcut file) race condition tackling-' + '-&quot;vinnu&quot;\r\n				</h2>\r\n				\r\n\r\n\r\n						\r\n						\r\n				<div class="content">\r\n					<div id="post_message_480">\r\n						<blockquote class="postcontent restore ">\r\n							Team : Legion Of Xtremers / Garage4Hackers<br />\r\nauthor : &quot;vinnu&quot;<br />\r\nGreetz : Prashant Uniyal, b0nd, D4rk457, and Secfence team.<br />\r\nExploit path : <a href="http://www.exploit-db.com/exploits/14403/" target="_blank">http://www.exploit-db.com/exploits/14403/</a><br />\r\nExploit by : Ivanlef0u<br />\r\n<br />\r\n<br />\r\nWindows Link exploit (shortcut file) race condition tackling<br />\r\n<br />\r\nThe .lnk exploit retrieves a DLL from remote machine and execute it while the icon<br />\r\nfor the shortcut (.lnk file) is resolved.<br />\r\n<br />\r\nThe race condition:<br />\r\nThe .lnk exploitation suffers from a race condition as it executes the downloaded dll 3 times<br />\r\nsimultaneously. This hinders the proper exploitation of the victim in case the payload dll<br />\r\ntries to write any file on the disk or tries to access and change any other resource on the victim<br />\r\nsystem.<br />\r\nFirst thing to be noted that the .lnk exploit is actually an undocumented DLL-Injection<br />\r\ntechnique.<br />\r\nThe .lnk file will retrieve a file of type either .dll, .cpl or .ocx or extension which are<br />\r\nlegitimate dynamic libraries with DllMain() defined.<br />\r\n<br />\r\nThe race condition need to be resolved in this retrieved DLL.<br />\r\nIn this example, we are going to download and execute the x.dll.<br />\r\nThe example sample DLL code is (suppose \'x\' is the project name):<br />\r\n<br />\r\n/* -' + '-' + '-' + '-' + '-' + '-' + '-' + '-' + '-' + '-' + '-' + '-x.cpp-' + '-' + '-' + '-' + '-' + '-' + '-' + '-' + '-' + '-' + '-' + '-' + '-' + '-' + '-' + '-' + '-' + '-' + '-' + '-*/<br />\r\n#include &lt;iostream&gt;<br />\r\n#include &lt;shellapi.h&gt;<br />\r\n<br />\r\n#pragma data_seg(&quot;.xdat&quot;)	// Shared memory section to tackle race condition<br />\r\nbool xcheck = false;<br />\r\n#pragma data_seg()<br />\r\n<br />\r\nvoid x()	{<br />\r\n	// The exploit worked, not install malware<br />\r\n	// Place all mallware installation code here.<br />\r\n	// The code to access the resources<br />\r\n	// like file creation etc...<br />\r\n}<br />\r\nvoid in()	{	// This routine will handle the race condition<br />\r\n	if (xcheck == false)	{	// If false then set it true and access the resources<br />\r\n		xcheck = true;x();		// otherwise just exit the routine.<br />\r\n	}<br />\r\n}<br />\r\nBOOL APIENTRY DllMain( HANDLE hModule, <br />\r\n                       DWORD  ul_reason_for_call, <br />\r\n                       LPVOID lpReserved<br />\r\n					 )<br />\r\n{<br />\r\n    switch (ul_reason_for_call)<br />\r\n	{<br />\r\n		case DLL_PROCESS_ATTACH:<br />\r\n			in();break;<br />\r\n		case DLL_THREAD_ATTACH:<br />\r\n		case DLL_THREAD_DETACH:<br />\r\n		case DLL_PROCESS_DETACH:<br />\r\n			break;<br />\r\n    }<br />\r\n    return TRUE;<br />\r\n}<br />\r\n/*-' + '-' + '-' + '-' + '-' + '-' + '-' + '-' + '-' + '-end of file-' + '-' + '-' + '-' + '-' + '-' + '-' + '-' + '-' + '-' + '-' + '-' + '-' + '-' + '-' + '-' + '-*/<br />\r\n<br />\r\nAlso a x.DEF file is needed and must be added to the project workspace.<br />\r\nThis file will define the custom memory sections attributes:<br />\r\n<br />\r\nSECTIONS<br />\r\n.xdat READ WRITE SHARED<br />\r\n<br />\r\nThere exists more ways to tackle race condition like the use of mutexes, semaphores etc.<br />\r\nThe same exploit can aslo be made cross browser and can also be launched via internet.<br />\r\n<br />\r\nBut try a little it urself. I\'ll tell u later....&quot;vinnu&quot;<br />\r\n<br />\r\n<b>[Study the exploit to know more the above discussion. The link has been provided above.]</b>\r\n						</blockquote>\r\n					</div>\r\n\r\n					\r\n				</div>\r\n			</div>\r\n			\r\n			<div class="after_content">\r\n				\r\n				\r\n				\r\n				\r\n					<blockquote class="signature restore"><div class="signaturecontainer"><i><b>The three great essentials to achieve anything worth while are: Hard work, Stick-to-itiveness, and Common sense.</b></i> - <b>Thomas A. Edison</b><br />\r\n__________________________________________________  _____________________</div></blockquote>\r\n				\r\n				\r\n			</div>\r\n			\r\n			<div class="cleardiv"></div>\r\n		</div>\r\n	</div>\r\n		<div class="postfoot">\r\n			<!-' + '- <div class="postfoot_container"> -' + '->\r\n			<div class="textcontrols floatcontainer">\r\n				<span class="postcontrols">\r\n					<img style="display:none" id="progress_480" src="images/misc/progress.gif" alt="" />\r\n					\r\n					\r\n					\r\n						<a id="qrwq_480" class="newreply" href="newreply.php?do=newreply&amp;p=480" rel="nofollow" title="Reply With Quote"><img id="quoteimg_480" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> \r\n					\r\n					\r\n					\r\n				</span>\r\n				<span class="postlinking">\r\n					\r\n						\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n\r\n					\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n					\r\n				</span>\r\n			<!-' + '- </div> -' + '->\r\n			</div>\r\n		</div>\r\n	<hr />\r\n</li>\r\n';
pd[2472] = '\r\n<li class="postbitlegacy postbitim postcontainer old" id="post_2472">\r\n<!-' + '- see bottom of postbit.css for .userinfo .popupmenu styles -' + '->\r\n\r\n	<div class="posthead">\r\n			<span class="postdate old">\r\n				\r\n					<span class="date">01-01-2011,&nbsp;<span class="time">09:52 PM</span></span>\r\n				\r\n			</span>\r\n			<span class="nodecontrols">\r\n				\r\n					<a name="post2472" href="showthread.php?t=216&amp;p=2472&amp;viewfull=1#post2472" class="postcounter">#2</a><a id="postcount2472" name="2"></a>\r\n				\r\n				\r\n				\r\n			</span>\r\n	</div>\r\n	<div class="postdetails">\r\n		<div class="userinfo">\r\n			<div class="username_container">\r\n			\r\n				<div class="popupmenu memberaction">\r\n	<a class="username offline popupctrl" href="member.php?u=191" title="abhaythehero is offline"><strong>abhaythehero</strong></a>\r\n	<ul class="popupbody popuphover memberaction_body">\r\n		<li class="left">\r\n			<a href="member.php?u=191" class="siteicon_profile">\r\n				View Profile\r\n			</a>\r\n		</li>\r\n		\r\n		<li class="right">\r\n			<a href="search.php?do=finduser&amp;userid=191&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">\r\n				View Forum Posts\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="private.php?do=newpm&amp;u=191" class="siteicon_message" rel="nofollow">\r\n				Private Message\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="blog.php?u=191" class="siteicon_blog" rel="nofollow">\r\n				View Blog Entries\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="https://twitter.com/#!/abhaythehero" class="siteicon_homepage">\r\n				Visit Homepage\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="http://garage4hackers.com/list.php?r=author/191-abhaythehero" class="siteicon_article" rel="nofollow">\r\n				View Articles\r\n			</a>\r\n		</li>\r\n		\r\n\r\n		\r\n\r\n		\r\n		\r\n	</ul>\r\n</div>\r\n				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.png" alt="abhaythehero is offline" border="0" />\r\n\r\n			\r\n			</div>\r\n			<span class="usertitle">\r\n				Super Commando Dhruv\r\n			</span>\r\n			\r\n			\r\n			\r\n				<span class="postbit_reputation" id="repdisplay_2472_191" title="abhaythehero has a spectacular aura about">\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n				</span>\r\n			\r\n			\r\n			<a class="postuseravatar" href="member.php?u=191" title="abhaythehero is offline">\r\n				<img src="image.php?u=191&amp;dateline=1330713871" alt="abhaythehero\'s Avatar" title="abhaythehero\'s Avatar" />\r\n			</a>\r\n			 \r\n			\r\n				<hr />\r\n				<dl class="userinfo_extra">\r\n					<dt>Join Date</dt> <dd>Sep 2010</dd>\r\n					<dt>Location</dt> <dd>Lucknow/Pune,India</dd>\r\n					\r\n					<dt>Posts</dt> <dd>466</dd>	\r\n					<dt>Blog Entries</dt><dd><a href="blog.php?u=191">2</a></dd>\r\n				</dl>\r\n				\r\n				\r\n				<div class="imlinks">\r\n					    \r\n				</div>\r\n			\r\n		</div>\r\n		<div class="postbody">\r\n			<div class="postrow has_after_content">\r\n				\r\n				\r\n				<h2 class="title icon">\r\n					Excellent post by &quot;vinnu&quot; sir ..!!\r\n				</h2>\r\n				\r\n\r\n\r\n						\r\n						\r\n				<div class="content">\r\n					<div id="post_message_2472">\r\n						<blockquote class="postcontent restore ">\r\n							I read this post earlier and it was like bouncer to me as I did\'nt knew what is race condition .. <img src="images/smilies/rolleyes.png" border="0" alt="" title="Roll Eyes (Sarcastic)" class="inlineimg" /><br />\r\n<br />\r\nwell the other day I was preparing for my OS exam and I read that race conditions in operating systems can be exploited by hackers ...<br />\r\n<br />\r\ngoogled a little and did some reading. Found out these are a tough exploits. <br />\r\n<br />\r\nAnyways , just thought that it would be helpful for any beginners to know basic methodology behind exploiting race conditions. <br />\r\n<br />\r\nHere it goes ( Source : operating systems by Silberschatz, Galvin, Gagne) ...<br />\r\n<br />\r\n<u><b><font color="Purple">What is race condition ?</font></b></u><br />\r\n<br />\r\nSuppose two simultaneous processes are trying to change a single variable count.<br />\r\n1st process does <b>count ++</b><br />\r\n2nd process does <b>count -' + '-</b><br />\r\n<br />\r\nNow suppose the initial value of count is 5.<br />\r\nIf both process execute one after another the value of count will remain 5.<br />\r\nWhich is the right value to be recorded.<br />\r\n<br />\r\nBut if both the process run concurrently , the value of variable count <br />\r\ncan be 4,5 or 6 !!<br />\r\n<br />\r\nThis fact can be shown by implementing both<b> count++</b> and <b>count -' + '-</b> at register level.<br />\r\n<br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:84px;">count++ could be implemented as\r\n\r\n     register1 = count\r\n     register1 = register1 + 1\r\n     count = register1</pre>\r\n</div><div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:84px;">count-' + '- could be implemented as\r\n\r\n     register2 = count\r\n     register2 = register2 - 1\r\n     count = register2</pre>\r\n</div><div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:132px;">Consider this execution interleaving with “count = 5” initially:\r\n\r\n\r\nS0: process 1 execute register1 = count                       {register1 = 5}\r\nS1: process 1 execute register1 = register1 + 1             {register1 = 6} \r\nS2: process 2 execute register2 = count                      {register2 = 5} \r\nS3: process 2 execute register2 = register2 - 1             {register2 = 4} \r\nS4: process 1 execute count = register1                        {count = 6 } \r\nS5: process 2 execute count = register2                       {count = 4}</pre>\r\n</div>Notice we arrived at wrong value = 4 !!<br />\r\n<br />\r\n<i>This is called race condition.</i>\r\n						</blockquote>\r\n					</div>\r\n\r\n					\r\n				</div>\r\n			</div>\r\n			\r\n			<div class="after_content">\r\n				\r\n				\r\n				\r\n				\r\n					<blockquote class="signature restore"><div class="signaturecontainer"><b><i>In the world of 0s and 1s, are you a zero or The One !</i></b></div></blockquote>\r\n				\r\n				\r\n			</div>\r\n			\r\n			<div class="cleardiv"></div>\r\n		</div>\r\n	</div>\r\n		<div class="postfoot">\r\n			<!-' + '- <div class="postfoot_container"> -' + '->\r\n			<div class="textcontrols floatcontainer">\r\n				<span class="postcontrols">\r\n					<img style="display:none" id="progress_2472" src="images/misc/progress.gif" alt="" />\r\n					\r\n					\r\n					\r\n						<a id="qrwq_2472" class="newreply" href="newreply.php?do=newreply&amp;p=2472" rel="nofollow" title="Reply With Quote"><img id="quoteimg_2472" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> \r\n					\r\n					\r\n					\r\n				</span>\r\n				<span class="postlinking">\r\n					\r\n						\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n\r\n					\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n					\r\n				</span>\r\n			<!-' + '- </div> -' + '->\r\n			</div>\r\n		</div>\r\n	<hr />\r\n</li>\r\n';
pd[2473] = '\r\n<li class="postbitlegacy postbitim postcontainer old" id="post_2473">\r\n<!-' + '- see bottom of postbit.css for .userinfo .popupmenu styles -' + '->\r\n\r\n	<div class="posthead">\r\n			<span class="postdate old">\r\n				\r\n					<span class="date">01-01-2011,&nbsp;<span class="time">10:00 PM</span></span>\r\n				\r\n			</span>\r\n			<span class="nodecontrols">\r\n				\r\n					<a name="post2473" href="showthread.php?t=216&amp;p=2473&amp;viewfull=1#post2473" class="postcounter">#3</a><a id="postcount2473" name="3"></a>\r\n				\r\n				\r\n				\r\n			</span>\r\n	</div>\r\n	<div class="postdetails">\r\n		<div class="userinfo">\r\n			<div class="username_container">\r\n			\r\n				<div class="popupmenu memberaction">\r\n	<a class="username offline popupctrl" href="member.php?u=191" title="abhaythehero is offline"><strong>abhaythehero</strong></a>\r\n	<ul class="popupbody popuphover memberaction_body">\r\n		<li class="left">\r\n			<a href="member.php?u=191" class="siteicon_profile">\r\n				View Profile\r\n			</a>\r\n		</li>\r\n		\r\n		<li class="right">\r\n			<a href="search.php?do=finduser&amp;userid=191&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">\r\n				View Forum Posts\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="private.php?do=newpm&amp;u=191" class="siteicon_message" rel="nofollow">\r\n				Private Message\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="blog.php?u=191" class="siteicon_blog" rel="nofollow">\r\n				View Blog Entries\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="https://twitter.com/#!/abhaythehero" class="siteicon_homepage">\r\n				Visit Homepage\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="http://garage4hackers.com/list.php?r=author/191-abhaythehero" class="siteicon_article" rel="nofollow">\r\n				View Articles\r\n			</a>\r\n		</li>\r\n		\r\n\r\n		\r\n\r\n		\r\n		\r\n	</ul>\r\n</div>\r\n				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.png" alt="abhaythehero is offline" border="0" />\r\n\r\n			\r\n			</div>\r\n			<span class="usertitle">\r\n				Super Commando Dhruv\r\n			</span>\r\n			\r\n			\r\n			\r\n				<span class="postbit_reputation" id="repdisplay_2473_191" title="abhaythehero has a spectacular aura about">\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n				</span>\r\n			\r\n			\r\n			<a class="postuseravatar" href="member.php?u=191" title="abhaythehero is offline">\r\n				<img src="image.php?u=191&amp;dateline=1330713871" alt="abhaythehero\'s Avatar" title="abhaythehero\'s Avatar" />\r\n			</a>\r\n			 \r\n			\r\n				<hr />\r\n				<dl class="userinfo_extra">\r\n					<dt>Join Date</dt> <dd>Sep 2010</dd>\r\n					<dt>Location</dt> <dd>Lucknow/Pune,India</dd>\r\n					\r\n					<dt>Posts</dt> <dd>466</dd>	\r\n					<dt>Blog Entries</dt><dd><a href="blog.php?u=191">2</a></dd>\r\n				</dl>\r\n				\r\n				\r\n				<div class="imlinks">\r\n					    \r\n				</div>\r\n			\r\n		</div>\r\n		<div class="postbody">\r\n			<div class="postrow has_after_content">\r\n				\r\n				\r\n				<h2 class="title icon">\r\n					Exploiting Race conditions (Copy pasted from several locations)\r\n				</h2>\r\n				\r\n\r\n\r\n						\r\n						\r\n				<div class="content">\r\n					<div id="post_message_2473">\r\n						<blockquote class="postcontent restore ">\r\n							Most systems today are &quot;multitasking/multithreaded&quot;. This means that can execute more than one program at a time. There is a danger if two programs need to access the same data at the same time. <br />\r\n<br />\r\nImagine two programs, ABC and XYZ, each program attempts to modify the same file. In order to modify a file, each program must first read the file into memory, change the contents in memory, then copy the memory back out into the file. <br />\r\n<br />\r\nThe race condition occurs when program ABC reads the file into memory and then makes the change. However, before ABC gets to write the file, program XYZ steps in and does the full read/modify/write on the file. Now program ABC writes their copies<br />\r\nback out to the file. Since program ABC started with a copy before XYZ made its changes, all of XYZ\'s changes will be lost. <br />\r\n<br />\r\nSince you need to get the sequence of events in just the right order, race conditions are very rare.Attackers usually attempt such actions thousands of times before they get it right, and gain access to the system.<br />\r\n<br />\r\n<b><i><u>There are two basic types of race condition that can be exploited:</u></i></b> <br />\r\n<br />\r\n<br />\r\n<font color="DarkOrchid"><u><b>Time of Check–Time of Use</b></u></font><br />\r\n<br />\r\nCommonly, an application checks some condition before undertaking an action. For example, it might check to see if a file exists before writing to it, or whether the user has access rights to read a file before opening it for reading. Because there is a time gap between the check and the use (even though it might be a fraction of a second), an attacker can sometimes use that gap to mount an attack.<br />\r\n<br />\r\nA classic example is the case where an application checks for the existence of a temporary file before writing data to it. If such a file exists, the application deletes it or chooses a new name for the temporary file to avoid conflict. If the file does not exist, the application opens the file for writing, because the system routine that opens a file for writing automatically creates a new file if none exists. An attacker, by continuously running a program that creates a new temporary file with the appropriate name, can (with a little persistence and some luck) create the file in the gap between when the application checked to make sure the temporary file didn\'t exist and when it opens it for writing. The application then opens the attacker\'s file and writes to it (remember, the system routine opens an existing file if there is one, and creates a new file only if there is no existing file). The attacker\'s file might have different access permissions than the application\'s temporary file, so the attacker can then read the contents. Or, the attacker can write a file that is a symbolic link to some other file, either one owned by the attacker or an existing system file. In one version of this attack, the file chosen is the system password file, so that after the attack, the system passwords have been corrupted to the point that no one, even the system administrator, can log on.<br />\r\n<br />\r\n<br />\r\n<font color="DarkOrchid"><b><u>Interprocess Communication</u></b></font><br />\r\n<br />\r\nSeparate processes—either within a single program or in two different programs—sometimes have to share information. Common methods include using shared memory or using some messaging protocol, such as Sockets, provided by the operating system.<br />\r\n<br />\r\nSome messaging protocols used for interprocess communication are also vulnerable to attack. A common programming error, for example, is to make non-atomic function calls from within a signal handler. A signal, in this context, is a message sent from one process to another in a UNIX-based operating system (such as Mac OS X). Any program that needs to receive signals contains code called a signal handler. A non-atomic function is one that does not necessarily complete operation before being interrupted by the operating system (which might switch to another process before returning to complete execution of the function call). There are very few operations that are safe for a signal handler to do, and most function calls are not among them. The reason is that an attacker can create a race condition by running a routine that operates on the same files or memory locations as the non-atomic function calls in the signal handler. Because the operating system switches rapidly among all the processes running simultaneously on the system, it is possible for the attacker\'s code to run after the signal handler has opened the file or memory location for writing or reading, but before the signal handler has completed running. Then the actual value read or stored in that location has been set by the attacker, not by the signal handler.<br />\r\n<br />\r\nAt a minimum, such a signal handler race condition can be used to disrupt the operation of a program. However, in certain circumstances, an attacker can make the operation of the system unpredictable, or cause the attacker\'s own code to be executed to wreak even more havoc.\r\n						</blockquote>\r\n					</div>\r\n\r\n					\r\n				</div>\r\n			</div>\r\n			\r\n			<div class="after_content">\r\n				\r\n				\r\n				\r\n				\r\n					<blockquote class="signature restore"><div class="signaturecontainer"><b><i>In the world of 0s and 1s, are you a zero or The One !</i></b></div></blockquote>\r\n				\r\n				\r\n			</div>\r\n			\r\n			<div class="cleardiv"></div>\r\n		</div>\r\n	</div>\r\n		<div class="postfoot">\r\n			<!-' + '- <div class="postfoot_container"> -' + '->\r\n			<div class="textcontrols floatcontainer">\r\n				<span class="postcontrols">\r\n					<img style="display:none" id="progress_2473" src="images/misc/progress.gif" alt="" />\r\n					\r\n					\r\n					\r\n						<a id="qrwq_2473" class="newreply" href="newreply.php?do=newreply&amp;p=2473" rel="nofollow" title="Reply With Quote"><img id="quoteimg_2473" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> \r\n					\r\n					\r\n					\r\n				</span>\r\n				<span class="postlinking">\r\n					\r\n						\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n\r\n					\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n					\r\n				</span>\r\n			<!-' + '- </div> -' + '->\r\n			</div>\r\n		</div>\r\n	<hr />\r\n</li>\r\n';
pd[2474] = '\r\n<li class="postbitlegacy postbitim postcontainer old" id="post_2474">\r\n<!-' + '- see bottom of postbit.css for .userinfo .popupmenu styles -' + '->\r\n\r\n	<div class="posthead">\r\n			<span class="postdate old">\r\n				\r\n					<span class="date">01-01-2011,&nbsp;<span class="time">10:11 PM</span></span>\r\n				\r\n			</span>\r\n			<span class="nodecontrols">\r\n				\r\n					<a name="post2474" href="showthread.php?t=216&amp;p=2474&amp;viewfull=1#post2474" class="postcounter">#4</a><a id="postcount2474" name="4"></a>\r\n				\r\n				\r\n				\r\n			</span>\r\n	</div>\r\n	<div class="postdetails">\r\n		<div class="userinfo">\r\n			<div class="username_container">\r\n			\r\n				<div class="popupmenu memberaction">\r\n	<a class="username offline popupctrl" href="member.php?u=191" title="abhaythehero is offline"><strong>abhaythehero</strong></a>\r\n	<ul class="popupbody popuphover memberaction_body">\r\n		<li class="left">\r\n			<a href="member.php?u=191" class="siteicon_profile">\r\n				View Profile\r\n			</a>\r\n		</li>\r\n		\r\n		<li class="right">\r\n			<a href="search.php?do=finduser&amp;userid=191&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">\r\n				View Forum Posts\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="private.php?do=newpm&amp;u=191" class="siteicon_message" rel="nofollow">\r\n				Private Message\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="blog.php?u=191" class="siteicon_blog" rel="nofollow">\r\n				View Blog Entries\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="https://twitter.com/#!/abhaythehero" class="siteicon_homepage">\r\n				Visit Homepage\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="http://garage4hackers.com/list.php?r=author/191-abhaythehero" class="siteicon_article" rel="nofollow">\r\n				View Articles\r\n			</a>\r\n		</li>\r\n		\r\n\r\n		\r\n\r\n		\r\n		\r\n	</ul>\r\n</div>\r\n				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.png" alt="abhaythehero is offline" border="0" />\r\n\r\n			\r\n			</div>\r\n			<span class="usertitle">\r\n				Super Commando Dhruv\r\n			</span>\r\n			\r\n			\r\n			\r\n				<span class="postbit_reputation" id="repdisplay_2474_191" title="abhaythehero has a spectacular aura about">\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n				</span>\r\n			\r\n			\r\n			<a class="postuseravatar" href="member.php?u=191" title="abhaythehero is offline">\r\n				<img src="image.php?u=191&amp;dateline=1330713871" alt="abhaythehero\'s Avatar" title="abhaythehero\'s Avatar" />\r\n			</a>\r\n			 \r\n			\r\n				<hr />\r\n				<dl class="userinfo_extra">\r\n					<dt>Join Date</dt> <dd>Sep 2010</dd>\r\n					<dt>Location</dt> <dd>Lucknow/Pune,India</dd>\r\n					\r\n					<dt>Posts</dt> <dd>466</dd>	\r\n					<dt>Blog Entries</dt><dd><a href="blog.php?u=191">2</a></dd>\r\n				</dl>\r\n				\r\n				\r\n				<div class="imlinks">\r\n					    \r\n				</div>\r\n			\r\n		</div>\r\n		<div class="postbody">\r\n			<div class="postrow has_after_content">\r\n				\r\n				\r\n				<h2 class="title icon">\r\n					Finally to end with an example ....\r\n				</h2>\r\n				\r\n\r\n\r\n						\r\n						\r\n				<div class="content">\r\n					<div id="post_message_2474">\r\n						<blockquote class="postcontent restore ">\r\n							suppose a programmer wrote:<br />\r\n<br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:48px;">touch (&quot;myfile&quot;);\r\nchmod (&quot;myfile&quot;,700);</pre>\r\n</div>instead of:<br />\r\n<br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:48px;">umask (077);\r\ntouch (&quot;myfile&quot;);</pre>\r\n</div>race condition can be exploited by opening the file for reading right after the touch command was executed and before the chmod command took place.\r\n						</blockquote>\r\n					</div>\r\n\r\n					\r\n				</div>\r\n			</div>\r\n			\r\n			<div class="after_content">\r\n				\r\n				\r\n				\r\n				\r\n					<blockquote class="signature restore"><div class="signaturecontainer"><b><i>In the world of 0s and 1s, are you a zero or The One !</i></b></div></blockquote>\r\n				\r\n				\r\n			</div>\r\n			\r\n			<div class="cleardiv"></div>\r\n		</div>\r\n	</div>\r\n		<div class="postfoot">\r\n			<!-' + '- <div class="postfoot_container"> -' + '->\r\n			<div class="textcontrols floatcontainer">\r\n				<span class="postcontrols">\r\n					<img style="display:none" id="progress_2474" src="images/misc/progress.gif" alt="" />\r\n					\r\n					\r\n					\r\n						<a id="qrwq_2474" class="newreply" href="newreply.php?do=newreply&amp;p=2474" rel="nofollow" title="Reply With Quote"><img id="quoteimg_2474" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> \r\n					\r\n					\r\n					\r\n				</span>\r\n				<span class="postlinking">\r\n					\r\n						\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n\r\n					\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n					\r\n				</span>\r\n			<!-' + '- </div> -' + '->\r\n			</div>\r\n		</div>\r\n	<hr />\r\n</li>\r\n';
pd[3536] = '\r\n<li class="postbitlegacy postbitim postcontainer old" id="post_3536">\r\n<!-' + '- see bottom of postbit.css for .userinfo .popupmenu styles -' + '->\r\n\r\n	<div class="posthead">\r\n			<span class="postdate old">\r\n				\r\n					<span class="date">04-25-2011,&nbsp;<span class="time">03:24 PM</span></span>\r\n				\r\n			</span>\r\n			<span class="nodecontrols">\r\n				\r\n					<a name="post3536" href="showthread.php?t=216&amp;p=3536&amp;viewfull=1#post3536" class="postcounter">#5</a><a id="postcount3536" name="5"></a>\r\n				\r\n				\r\n				\r\n			</span>\r\n	</div>\r\n	<div class="postdetails">\r\n		<div class="userinfo">\r\n			<div class="username_container">\r\n			\r\n				<div class="popupmenu memberaction">\r\n	<a class="username offline popupctrl" href="member.php?u=30" title="pseud0cod3r is offline"><strong>pseud0cod3r</strong></a>\r\n	<ul class="popupbody popuphover memberaction_body">\r\n		<li class="left">\r\n			<a href="member.php?u=30" class="siteicon_profile">\r\n				View Profile\r\n			</a>\r\n		</li>\r\n		\r\n		<li class="right">\r\n			<a href="search.php?do=finduser&amp;userid=30&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">\r\n				View Forum Posts\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="private.php?do=newpm&amp;u=30" class="siteicon_message" rel="nofollow">\r\n				Private Message\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="blog.php?u=30" class="siteicon_blog" rel="nofollow">\r\n				View Blog Entries\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="http://m47r1x.co.cc" class="siteicon_homepage">\r\n				Visit Homepage\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="http://garage4hackers.com/list.php?r=author/30-pseud0cod3r" class="siteicon_article" rel="nofollow">\r\n				View Articles\r\n			</a>\r\n		</li>\r\n		\r\n\r\n		\r\n\r\n		\r\n		\r\n	</ul>\r\n</div>\r\n				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.png" alt="pseud0cod3r is offline" border="0" />\r\n\r\n			\r\n			</div>\r\n			<span class="usertitle">\r\n				Garage Newcomer\r\n			</span>\r\n			\r\n			\r\n			\r\n				<span class="postbit_reputation" id="repdisplay_3536_30" title="pseud0cod3r is on a distinguished road">\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n				</span>\r\n			\r\n			 \r\n			\r\n				<hr />\r\n				<dl class="userinfo_extra">\r\n					<dt>Join Date</dt> <dd>Jul 2010</dd>\r\n					<dt>Location</dt> <dd>/dev/random</dd>\r\n					\r\n					<dt>Posts</dt> <dd>19</dd>	\r\n					\r\n				</dl>\r\n				\r\n				\r\n				<div class="imlinks">\r\n					    \r\n				</div>\r\n			\r\n		</div>\r\n		<div class="postbody">\r\n			<div class="postrow">\r\n				\r\n				\r\n\r\n\r\n						\r\n						\r\n				<div class="content">\r\n					<div id="post_message_3536">\r\n						<blockquote class="postcontent restore ">\r\n							If you are serious about race condition and their difficulty of exploitatibility take a look at here(not at all difficult )<br />\n<a href="http://www.cs.sunysb.edu/~rob/papers/races2.pdf" target="_blank">www.cs.sunysb.edu/~rob/papers/races2.pdf</a>\r\n						</blockquote>\r\n					</div>\r\n\r\n					\r\n				</div>\r\n			</div>\r\n			\r\n			<div class="cleardiv"></div>\r\n		</div>\r\n	</div>\r\n		<div class="postfoot">\r\n			<!-' + '- <div class="postfoot_container"> -' + '->\r\n			<div class="textcontrols floatcontainer">\r\n				<span class="postcontrols">\r\n					<img style="display:none" id="progress_3536" src="images/misc/progress.gif" alt="" />\r\n					\r\n					\r\n					\r\n						<a id="qrwq_3536" class="newreply" href="newreply.php?do=newreply&amp;p=3536" rel="nofollow" title="Reply With Quote"><img id="quoteimg_3536" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> \r\n					\r\n					\r\n					\r\n				</span>\r\n				<span class="postlinking">\r\n					\r\n						\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n\r\n					\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n					\r\n				</span>\r\n			<!-' + '- </div> -' + '->\r\n			</div>\r\n		</div>\r\n	<hr />\r\n</li>\r\n';
pd[4844] = '\r\n<li class="postbitlegacy postbitim postcontainer old" id="post_4844">\r\n<!-' + '- see bottom of postbit.css for .userinfo .popupmenu styles -' + '->\r\n\r\n	<div class="posthead">\r\n			<span class="postdate old">\r\n				\r\n					<span class="date">07-19-2011,&nbsp;<span class="time">08:51 AM</span></span>\r\n				\r\n			</span>\r\n			<span class="nodecontrols">\r\n				\r\n					<a name="post4844" href="showthread.php?t=216&amp;p=4844&amp;viewfull=1#post4844" class="postcounter">#6</a><a id="postcount4844" name="6"></a>\r\n				\r\n				\r\n				\r\n			</span>\r\n	</div>\r\n	<div class="postdetails">\r\n		<div class="userinfo">\r\n			<div class="username_container">\r\n			\r\n				<div class="popupmenu memberaction">\r\n	<a class="username offline popupctrl" href="member.php?u=61" title="&quot;vinnu&quot; is offline"><strong>&quot;vinnu&quot;</strong></a>\r\n	<ul class="popupbody popuphover memberaction_body">\r\n		<li class="left">\r\n			<a href="member.php?u=61" class="siteicon_profile">\r\n				View Profile\r\n			</a>\r\n		</li>\r\n		\r\n		<li class="right">\r\n			<a href="search.php?do=finduser&amp;userid=61&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">\r\n				View Forum Posts\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="private.php?do=newpm&amp;u=61" class="siteicon_message" rel="nofollow">\r\n				Private Message\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="blog.php?u=61" class="siteicon_blog" rel="nofollow">\r\n				View Blog Entries\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="http://garage4hackers.com/list.php?r=author/61-quot-vinnu-quot" class="siteicon_article" rel="nofollow">\r\n				View Articles\r\n			</a>\r\n		</li>\r\n		\r\n\r\n		\r\n\r\n		\r\n		\r\n	</ul>\r\n</div>\r\n				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.png" alt="&quot;vinnu&quot; is offline" border="0" />\r\n\r\n			\r\n			</div>\r\n			<span class="usertitle">\r\n				Security Researcher\r\n			</span>\r\n			\r\n			\r\n			\r\n				<span class="postbit_reputation" id="repdisplay_4844_61" title="&quot;vinnu&quot; is a jewel in the rough">\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n				</span>\r\n			\r\n			\r\n			<a class="postuseravatar" href="member.php?u=61" title="&quot;vinnu&quot; is offline">\r\n				<img src="image.php?u=61&amp;dateline=1311230253" alt="&quot;vinnu&quot;\'s Avatar" title="&quot;vinnu&quot;\'s Avatar" />\r\n			</a>\r\n			 \r\n			\r\n				<hr />\r\n				<dl class="userinfo_extra">\r\n					<dt>Join Date</dt> <dd>Jul 2010</dd>\r\n					\r\n					\r\n					<dt>Posts</dt> <dd>271</dd>	\r\n					<dt>Blog Entries</dt><dd><a href="blog.php?u=61">4</a></dd>\r\n				</dl>\r\n				\r\n				\r\n				<div class="imlinks">\r\n					    \r\n				</div>\r\n			\r\n		</div>\r\n		<div class="postbody">\r\n			<div class="postrow">\r\n				\r\n				\r\n\r\n\r\n						\r\n						\r\n				<div class="content">\r\n					<div id="post_message_4844">\r\n						<blockquote class="postcontent restore ">\r\n							My mistake , sorry for correcting it very late:<br />\n<br />\nFollowing lines :<br />\n<br />\nvoid x()	{<br />\n// The exploit worked, not install malware<br />\n<br />\nShould be:<br />\n<br />\nvoid x()	{<br />\n// The exploit worked, now install malware..<br />\n<br />\nThe word &quot;not&quot; should be considered &quot;now&quot;.<br />\n<br />\n...&quot;vinnu&quot;\r\n						</blockquote>\r\n					</div>\r\n\r\n					\r\n				</div>\r\n			</div>\r\n			\r\n			<div class="cleardiv"></div>\r\n		</div>\r\n	</div>\r\n		<div class="postfoot">\r\n			<!-' + '- <div class="postfoot_container"> -' + '->\r\n			<div class="textcontrols floatcontainer">\r\n				<span class="postcontrols">\r\n					<img style="display:none" id="progress_4844" src="images/misc/progress.gif" alt="" />\r\n					\r\n					\r\n					\r\n						<a id="qrwq_4844" class="newreply" href="newreply.php?do=newreply&amp;p=4844" rel="nofollow" title="Reply With Quote"><img id="quoteimg_4844" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> \r\n					\r\n					\r\n					\r\n				</span>\r\n				<span class="postlinking">\r\n					\r\n						\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n\r\n					\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n					\r\n				</span>\r\n			<!-' + '- </div> -' + '->\r\n			</div>\r\n		</div>\r\n	<hr />\r\n</li>\r\n';

// next/previous post info
pn[480] = "4844,2472";
pn[0] = ",480";
pn[2472] = "480,2473";
pn[2473] = "2472,2474";
pn[2474] = "2473,3536";
pn[3536] = "2474,4844";
pn[4844] = "3536,480";

// cached usernames
pu[0] = guestphrase;
pu[18] = "prashant_uniyal";
pu[191] = "abhaythehero";
pu[30] = "pseud0cod3r";
pu[61] = "&quot;vinnu&quot;";

// -->
</script>


<div id="threaded_view">
	<h4>Threaded View</h4>

	<div id="posttree">
		<script type="text/javascript">
		<!--
			writeLink(480, 0, 0, 18, "", "Windows Link exploit...", "08-03-2010", "03:01 PM", 0, "showthread0945.html?t=216&amp;p=480#post480");
  writeLink(2472, 0, 0, 191, "T", "Excellent post by &quot;vinnu&quot; sir...", "01-01-2011", "09:52 PM", 0, "showthread42c1.html?t=216&amp;p=2472#post2472");
  writeLink(2473, 0, 0, 191, "T", "Exploiting Race conditions...", "01-01-2011", "10:00 PM", 0, "showthread010b-2.html?t=216&amp;p=2473#post2473");
  writeLink(2474, 0, 0, 191, "T", "Finally to end with an...", "01-01-2011", "10:11 PM", 0, "showthreadc289.html?t=216&amp;p=2474#post2474");
  writeLink(3536, 0, 0, 30, "T", "<i>If you are serious about race...</i>", "04-25-2011", "03:24 PM", 0, "showthread752b-2.html?t=216&amp;p=3536#post3536");
  writeLink(4844, 0, 0, 61, "L", "<i>My mistake , sorry for...</i>", "07-19-2011", "08:51 AM", 0, "showthread4361.html?t=216&amp;p=4844#post4844");

		//-->
		</script>
	</div>
</div>
	

	
		<ol class="posts" id="posts" start="1">
			
<li class="postbitlegacy postbitim postcontainer old" id="post_480">
<!-- see bottom of postbit.css for .userinfo .popupmenu styles -->

	<div class="posthead">
			<span class="postdate old">
				
					<span class="date">08-03-2010, <span class="time">03:01 PM</span></span>
				
			</span>
			<span class="nodecontrols">
				
					<a class="postcounter" href="showthread0272.html?t=216&amp;p=480&amp;viewfull=1#post480" name="post480">#1</a><a id="postcount480" name="1"></a>
				
				
				
			</span>
	</div>
	<div class="postdetails">
		<div class="userinfo">
			<div class="username_container">
			
				<div class="popupmenu memberaction">
	<a class="username offline popupctrl" href="memberc1f0.html?u=18" title="prashant_uniyal is offline"><strong>prashant_uniyal</strong></a>
	<ul class="popupbody popuphover memberaction_body">
		<li class="left">
			<a class="siteicon_profile" href="memberc1f0.html?u=18">
				View Profile
			</a>
		</li>
		
		<li class="right">
			<a class="siteicon_forum" href="searchae80.html?do=finduser&amp;userid=18&amp;contenttype=vBForum_Post&amp;showposts=1" rel="nofollow">
				View Forum Posts
			</a>
		</li>
		
		
		<li class="left">
			<a class="siteicon_message" href="privateb48e.html?do=newpm&amp;u=18" rel="nofollow">
				Private Message
			</a>
		</li>
		
		
		
		<li class="right">
			<a class="siteicon_blog" href="blogc1f0.html?u=18" rel="nofollow">
				View Blog Entries
			</a>
		</li>
		
		
		
		<li class="left">
			<a class="siteicon_homepage" href="http://hackingethics.wordpress.com/">
				Visit Homepage
			</a>
		</li>
		
		
		
		<li class="right">
			<a class="siteicon_article" href="list5954.html?r=author/18-prashant_uniyal" rel="nofollow">
				View Articles
			</a>
		</li>
		

		

		
		
	</ul>
</div>
				<img alt="prashant_uniyal is offline" border="0" class="inlineimg onlinestatus" src="images/statusicon/user-offline.png"/>

			
			</div>
			<span class="usertitle">
				Security Analyst
			</span>
			
			
			
				<span class="postbit_reputation" id="repdisplay_480_18" title="prashant_uniyal has a spectacular aura about">
					
						<img alt="" class="repimg" src="images/reputation/reputation_pos.png"/>
					
						<img alt="" class="repimg" src="images/reputation/reputation_pos.png"/>
					
						<img alt="" class="repimg" src="images/reputation/reputation_pos.png"/>
					
				</span>
			
			
			<a class="postuseravatar" href="memberc1f0.html?u=18" title="prashant_uniyal is offline">
				<img alt="prashant_uniyal's Avatar" src="parasf2b13.jpg?u=18&amp;dateline=1393305256" title="prashant_uniyal's Avatar"/>
			</a>
			 
			
				<hr/>
				<dl class="userinfo_extra">
					<dt>Join Date</dt> <dd>Jul 2010</dd>
					<dt>Location</dt> <dd>localhost</dd>
					
					<dt>Posts</dt> <dd>505</dd>	
					<dt>Blog Entries</dt><dd><a href="blogc1f0.html?u=18">8</a></dd>
				</dl>
				
				
				<div class="imlinks">
					    
				</div>
			
		</div>
		<div class="postbody">
			<div class="postrow has_after_content">
				
				
				<h2 class="title icon">
					Windows Link exploit (shortcut file) race condition tackling--"vinnu"
				</h2>
				


						
						
				<div class="content">
					<div id="post_message_480">
						<blockquote class="postcontent restore">
							Team : Legion Of Xtremers / Garage4Hackers<br/>
author : "vinnu"<br/>
Greetz : Prashant Uniyal, b0nd, D4rk457, and Secfence team.<br/>
Exploit path : <a href="http://www.exploit-db.com/exploits/14403/" target="_blank">http://www.exploit-db.com/exploits/14403/</a><br/>
Exploit by : Ivanlef0u<br/>
<br/>
<br/>
Windows Link exploit (shortcut file) race condition tackling<br/>
<br/>
The .lnk exploit retrieves a DLL from remote machine and execute it while the icon<br/>
for the shortcut (.lnk file) is resolved.<br/>
<br/>
The race condition:<br/>
The .lnk exploitation suffers from a race condition as it executes the downloaded dll 3 times<br/>
simultaneously. This hinders the proper exploitation of the victim in case the payload dll<br/>
tries to write any file on the disk or tries to access and change any other resource on the victim<br/>
system.<br/>
First thing to be noted that the .lnk exploit is actually an undocumented DLL-Injection<br/>
technique.<br/>
The .lnk file will retrieve a file of type either .dll, .cpl or .ocx or extension which are<br/>
legitimate dynamic libraries with DllMain() defined.<br/>
<br/>
The race condition need to be resolved in this retrieved DLL.<br/>
In this example, we are going to download and execute the x.dll.<br/>
The example sample DLL code is (suppose 'x' is the project name):<br/>
<br/>
/* ------------x.cpp--------------------*/<br/>
#include &lt;iostream&gt;<br/>
#include &lt;shellapi.h&gt;<br/>
<br/>
#pragma data_seg(".xdat")	// Shared memory section to tackle race condition<br/>
bool xcheck = false;<br/>
#pragma data_seg()<br/>
<br/>
void x()	{<br/>
	// The exploit worked, not install malware<br/>
	// Place all mallware installation code here.<br/>
	// The code to access the resources<br/>
	// like file creation etc...<br/>
}<br/>
void in()	{	// This routine will handle the race condition<br/>
	if (xcheck == false)	{	// If false then set it true and access the resources<br/>
		xcheck = true;x();		// otherwise just exit the routine.<br/>
	}<br/>
}<br/>
BOOL APIENTRY DllMain( HANDLE hModule, <br/>
                       DWORD  ul_reason_for_call, <br/>
                       LPVOID lpReserved<br/>
					 )<br/>
{<br/>
    switch (ul_reason_for_call)<br/>
	{<br/>
		case DLL_PROCESS_ATTACH:<br/>
			in();break;<br/>
		case DLL_THREAD_ATTACH:<br/>
		case DLL_THREAD_DETACH:<br/>
		case DLL_PROCESS_DETACH:<br/>
			break;<br/>
    }<br/>
    return TRUE;<br/>
}<br/>
/*----------end of file-----------------*/<br/>
<br/>
Also a x.DEF file is needed and must be added to the project workspace.<br/>
This file will define the custom memory sections attributes:<br/>
<br/>
SECTIONS<br/>
.xdat READ WRITE SHARED<br/>
<br/>
There exists more ways to tackle race condition like the use of mutexes, semaphores etc.<br/>
The same exploit can aslo be made cross browser and can also be launched via internet.<br/>
<br/>
But try a little it urself. I'll tell u later...."vinnu"<br/>
<br/>
<b>[Study the exploit to know more the above discussion. The link has been provided above.]</b>
						</blockquote>
					</div>

					
				</div>
			</div>
			
			<div class="after_content">
				
				
				
				
					<blockquote class="signature restore"><div class="signaturecontainer"><i><b>The three great essentials to achieve anything worth while are: Hard work, Stick-to-itiveness, and Common sense.</b></i> - <b>Thomas A. Edison</b><br/>
__________________________________________________  _____________________</div></blockquote>
				
				
			</div>
			
			<div class="cleardiv"></div>
		</div>
	</div>
		<div class="postfoot">
			<!-- <div class="postfoot_container"> -->
			<div class="textcontrols floatcontainer">
				<span class="postcontrols">
					<img alt="" id="progress_480" src="images/misc/progress.gif" style="display:none"/>
					
					
					
						<a class="newreply" href="newreply14e5.html?do=newreply&amp;p=480" id="qrwq_480" rel="nofollow" title="Reply With Quote"><img alt="Reply With Quote" id="quoteimg_480" src="clear.gif"/>  Reply With Quote</a> 
					
					
					
				</span>
				<span class="postlinking">
					
						
					

					
					
					
					

					
					

					
					
					
					
					
				</span>
			<!-- </div> -->
			</div>
		</div>
	<hr/>
</li>

		</ol>
                <div class="separator"></div>
		<div class="postlistfoot">
			
		</div>

	

</div>

<div class="noinlinemod below_postlist" id="below_postlist">
	
	<div class="pagination_bottom" id="pagination_bottom">
	
		<div class="clear"></div>
<div class="navpopupmenu popupmenu nohovermenu" id="showthread_navpopup">
	
		<span class="shade">Quick Navigation</span>
		<a class="popupctrl" href="showthread3265.html?t=216"><span class="ctrlcontainer">Exploitation Techniques</span></a>
		<a class="textcontrol" href="showthread3265.html?t=216#top" onclick="document.location.hash='top';return false;">Top</a>
	
	<ul class="navpopupbody popupbody popuphover">
		
		<li class="optionlabel">Site Areas</li>
		<li><a href="usercp.html">Settings</a></li>
		<li><a href="private.html">Private Messages</a></li>
		<li><a href="subscription.html">Subscriptions</a></li>
		<li><a href="online.html">Who's Online</a></li>
		<li><a href="search.html">Search Forums</a></li>
		<li><a href="forum.html">Forums Home</a></li>
		
			<li class="optionlabel">Forums</li>
			
		
			
				<li><a href="forumdisplay58da.html?f=1">Garage Network</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplay12a3.html?f=2">Garage Announcements</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplaye57d.html?f=58">Bravo - Null 2012</a></li>
			
		
			
				<li><a href="forumdisplay0756.html?f=59">Garage Local Chapter Meets</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplay31e6.html?f=4">Garage Rules</a></li>
			
		
			
				<li><a href="forumdisplaye774.html?f=5">Feedback &amp; Suggestions</a></li>
			
		
			
				<li><a href="forumdisplayd42b.html?f=7">Introduce Your Self</a></li>
			
		
			
				<li><a href="forumdisplay2b89.html?f=38">Shout-box</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplaycf19.html?f=6">Garage Lounge</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplay5579.html?f=30">Hacking for Beginners</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplay6ac3.html?f=57">Did You Know?</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplay957d.html?f=8">Security &amp; Hacking News Thread</a></li>
			
		
			
				<li><a href="forumdisplay3215.html?f=36">Career in InfoSec</a></li>
			
		
			
				<li><a href="forumdisplay814c.html?f=29">Request Zone</a></li>
			
		
			
				<li><a href="forumdisplay13b6.html?f=27">Noobs Corner</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplayfdc5.html?f=9">Hacking and Security Discussions</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplayfac0.html?f=55">Tip | Trick of the Day</a></li>
			
		
			
				<li><a href="forumdisplayc4a6.html?f=66">ICS / SCADA Security</a></li>
			
		
			
				<li><a href="forumdisplay6111.html?f=67">Internet of Things - IoT</a></li>
			
		
			
				<li><a href="forumdisplay15ca.html?f=10">Network Vulnerabiltity Assessment &amp; Penetration Testing</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplaya05c.html?f=56">Post Exploitation</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplay8a83.html?f=11">Web Application Penetration Testing</a></li>
			
		
			
				<li><a href="forumdisplay01c9.html?f=12">Wireless and Bluetooth Hacking</a></li>
			
		
			
				<li><a href="forumdisplay48ab.html?f=17">Computer Forensics and Incident Handling</a></li>
			
		
			
				<li><a href="forumdisplay218b.html?f=19">Physical Security and Social Engineering</a></li>
			
		
			
				<li><a href="forumdisplayb09f.html?f=15">General Security &amp; Best Practices</a></li>
			
		
			
				<li><a href="forumdisplay907f.html?f=42">Security and Hacking Videos</a></li>
			
		
			
				<li><a href="forumdisplay9e0d.html?f=54">Mobile Security</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplay9780.html?f=14">General Security Discussions</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplay9df8.html?f=31">Programming</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplay65b9.html?f=35">Assembly</a></li>
			
		
			
				<li><a href="forumdisplayc4f1.html?f=32">C/C++</a></li>
			
		
			
				<li><a href="forumdisplayb0a0.html?f=34">Perl</a></li>
			
		
			
				<li><a href="forumdisplayb8c1.html?f=60">PHP</a></li>
			
		
			
				<li><a href="forumdisplay6c4e.html?f=33">Python</a></li>
			
		
			
				<li><a href="forumdisplay208f.html?f=51">Linux Shell / Bash Programming</a></li>
			
		
			
				<li><a href="forumdisplay3238.html?f=47">Windows Batch Programming</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplayce40.html?f=28">BackTrack and Other Linux Distributions</a></li>
			
		
			
				<li><a href="forumdisplayf2fa.html?f=16">Networks &amp; Networking</a></li>
			
		
			
				<li><a href="forumdisplaya213.html?f=18">Cloud Computing</a></li>
			
		
			
				<li><a href="forumdisplaydfa4.html?f=39">Security Podcast and Videos</a></li>
			
		
			
				<li><a href="forumdisplaya3f5.html?f=40">Miscellanous Thread</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplay30ac.html?f=49">Brush Up Your Skills</a></li>
			
		
			
					</ol>
				</li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplayffeb.html?f=20">Experts Forum</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplaycdba.html?f=48">My Meanest Hacks</a></li>
			
		
			
				<li><a href="forumdisplayf6ac.html?f=37">Hacking &amp; Security Books and Tutorials</a></li>
			
		
			
				<li><a href="forumdisplay8011.html?f=23">Tools &amp; Scripts</a></li>
			
		
			
				<li><a href="forumdisplay8941.html?f=22">Exploitation Techniques</a></li>
			
		
			
				<li><a href="forumdisplay345c.html?f=24">Reverse Engineering and Application Cracking</a></li>
			
		
			
				<li><a href="forumdisplaye8b3.html?f=25">Botnets, Malwares &amp; Rootkits Analysis</a></li>
			
		
			
				<li><a href="forumdisplay107e.html?f=43">Garage4hackers Exploits</a></li>
			
		
			
				<li><a href="forumdisplaye5f3.html?f=64">Browser Fuzzing</a></li>
			
		
			
					</ol>
				</li>
			
		
		
	</ul>
</div>
<div class="clear"></div>
	</div>
</div>










<!-- next / previous links -->
<div class="navlinks">
	
	<strong>«</strong>
	<a href="showthreadd9e7.html?t=216&amp;goto=nextoldest" rel="nofollow">Previous Thread</a>
	|
	<a href="showthreadecad.html?t=216&amp;goto=nextnewest" rel="nofollow">Next Thread</a>
	<strong>»</strong>
	
</div>
<!-- / next / previous links -->

<div class="thread_info" id="thread_info">
	
	
	
	
	<div class="options_block_container">
		
		<div class="options_block">
			<h4 class="collapse">
				<a class="collapse" href="showthread3265.html?t=216#top" id="collapse_posting_rules"><img alt="" src="images/buttons/collapse_40b.png"/></a>
				<span class="optiontitle">Posting Permissions</span>
			</h4>
			<div class="thread_info_block" id="posting_rules">
				
<div class="info_subblock" id="forumrules">

	<ul class="youcandoblock">
		<li>You <strong>may not</strong> post new threads</li>
		<li>You <strong>may not</strong> post replies</li>
		<li>You <strong>may not</strong> post attachments</li>
		<li>You <strong>may not</strong> edit your posts</li>
		<li> </li>
	</ul>
	<div class="bbcodeblock">
		<ul>
			<li><a href="miscaff0.html?do=bbcode" target="_blank">BB code</a> is <strong>On</strong></li>
			<li><a href="misc9712.html?do=showsmilies" target="_blank">Smilies</a> are <strong>On</strong></li>
			<li><a href="miscaff0.html?do=bbcode#imgcode" target="_blank">[IMG]</a> code is <strong>On</strong></li>
			<li><a href="miscaff0.html?do=bbcode#videocode" target="_blank">[VIDEO]</a> code is <strong>On</strong></li>
			<li>HTML code is <strong>Off</strong></li>
		</ul>
	</div>
	<p class="rules_link"><a href="misc17ec.html?do=showrules" target="_blank">Forum Rules</a></p>

</div>

			</div>
		</div>

	</div>

</div>








<div style="clear: left">
  
<div class="google_adsense_footer" style="width:468px; margin:0 auto; padding-top:1em">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6847984837250662";
google_ad_host = "ca-host-pub-2606800903002383";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "text_image";
google_ad_channel = "";
google_color_border = "";
google_color_bg = "";
google_color_link = "";
google_color_text = "";
google_color_url = "";
google_ui_features = "rc:6";
//-->
</script>
<script src="../pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>
</div>

  <div id="ad_global_above_footer"><div align="center">
<script type="text/javascript"><!--
google_ad_client = "pub-6847984837250662";
/* 728x90, created 7/9/10 */
google_ad_slot = "7101394260";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script src="../pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script></div>
</div>

<div class="floatcontainer footer" id="footer">

	<form action="../external.html?link=http://garage4hackers.com/forum.php" class="footer_select" id="footer_select" method="get">

		
			<select name="styleid" onchange="switch_id(this, 'style')">
				<optgroup label="Quick Style Chooser"><option class="hidden"></option></optgroup>
				
					
					<optgroup label=" Standard Styles">
									
					
	<option class="" selected="selected" value="1">-- Default Style</option>

					
					</optgroup>
										
				
				
					
					<optgroup label=" Mobile Styles">
					
					
	<option class="" value="2">-- Default Mobile Style</option>

					
					</optgroup>
										
				
			</select>	
		
		
		
	</form>

	<ul class="footer_links" id="footer_links">
		<li><a accesskey="9" href="sendmessage.html" rel="nofollow">Contact Us</a></li>
		<li><a href="index.html">Garage4hackers</a></li>
		
		
		<li><a href="archive/index.html">Archive</a></li>
		<li><a href="#" target="_blank">Web Hosting</a></li>
		
		
		<li><a href="showthread3265.html?t=216#top" onclick="document.location.hash='top'; return false;">Top</a></li>
	</ul>
	
	
	
	
	<script type="text/javascript">
	<!--
		// Main vBulletin Javascript Initialization
		vBulletin_init();
		function md5hash(B,A,E,C){if(navigator.userAgent.indexOf("Mozilla/index.html")==1&&parseInt(navigator.appVersion)>=4){var D=hex_md5(str_to_ent(trim(B.value)));A.value=D;if(E){D=hex_md5(trim(B.value));E.value=D}if(!C){B.value=""}}return true};
	//-->
	</script>
        
</div>
</div> <!-- closing div for body_wrapper -->

<div class="below_body">
<div class="shade footer_time" id="footer_time">All times are GMT +5.5. The time now is <span class="time">05:49 PM</span>.</div>

<div class="shade footer_copyright" id="footer_copyright">
	<!-- Do not remove this copyright notice -->
	Powered by <a href="https://www.vbulletin.com/" id="vbulletinlink">vBulletin®</a> Version 4.2.1 <br/>Copyright © 2020 vBulletin Solutions, Inc. All rights reserved. 
	<!-- Do not remove this copyright notice -->	
</div>
<div class="shade footer_morecopyright" id="footer_morecopyright">
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	Copyright 2010 - 2017, Garage4Hackers
	
</div>
 

	<div id="fb-root"></div>
<script src="clientscript/vbulletin_facebook6719.js?v=421" type="text/javascript"></script>

<script type="text/javascript">
<!--
	loadFacebookAPI('en_US');
	function fbAsyncInit()
	{
		vBfb = new vB_Facebook({
			appid : "170793809601191",
			connected : 0,
			active : 0,
			autoreg : 0,
			feed_newthread : 1,
			feed_postreply : 1,
			feed_blogentry : 1,
			feed_blogcomment : 1,
			feed_newarticle : 1,
			feed_articlecomment : 1
		});
	}
// -->
</script>

</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker('UA-17311051-3');
pageTracker._trackPageview();
} catch(err) {}</script>

</div></body></html>