<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html dir="ltr" lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://www.facebook.com/2008/fbml"><!-- Mirrored from garage4hackers.com/content.php?r=174-Reverse-Engineering-Domain-generation-for-PushDo-Malware-algorithm-released by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 10:24:57 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="index.html" id="e_vb_meta_bburl" name="vb_meta_bburl"/>
<base/><!--[if IE]></base><![endif]-->
<meta content="vBulletin 4.2.1" name="generator"/>
<meta content="IE=9" http-equiv="X-UA-Compatible"/>

	<link href="favicon.ico" rel="Shortcut Icon" type="image/x-icon"/>


		<meta content="push,call,short,dword,eax,dword" name="keywords"/>
		<meta content="DGA : The domain generation for PushDo unleashed
757

About pushdo:

Four times since 2008, authorities and technology companies have taken the prolific PushDo malware and Cutwail spam botnet offline. Yet much like the Energizer Bunny, it keeps coming back for more.

In early March, researchers at Damballa discovered a new version of the malware that had adopted a domain generation algorithm (DGA) in order to not only help it avoid detection by security researchers, but to add resiliency.
http://threatpost.com/pushdo-malware-resurfaces-with-dga-capabilities
 (http://threatpost.com/pushdo-malware-resurfaces-with-dga-capabilities)

In this blog post I would explain the  DGA algorithm used behind Pushdo malware . Based on bitdefender figures Indian PCs have been most affected by the outbreak of pushdo, but systems in the UK, France and the US have also been hit.
http://labs.bitdefender.com/2014/07/pushdo-sinkholing-continues-size-of-problem-now-apparent/#more-2002

[Analysis]

The unpacked artefacts clearly shows a glimpse of DGA :



04006598  50 36 34 00 57 69 6E 58 50 00 00 00 57 69 6E 32  P64.WinXP...Win2
040065A8  4B 00" name="description"/>



	<meta content="170793809601191" property="fb:app_id"/>
<meta content="Garage4hackers Forum" property="og:site_name"/>
<meta content="DGA : The domain generation for PushDo unleashed
757

About pushdo:

Four times since 2008, authorities and technology companies have taken the prolific PushDo malware and Cutwail spam botnet offline. Yet much like the Energizer Bunny, it keeps coming back for more.

In early March, researchers at Damballa discovered a new version of the malware that had adopted a domain generation algorithm (DGA) in order to not only help it avoid detection by security researchers, but to add resiliency.
http://threatpost.com/pushdo-malware-resurfaces-with-dga-capabilities
 (http://threatpost.com/pushdo-malware-resurfaces-with-dga-capabilities)

In this blog post I would explain the  DGA algorithm used behind Pushdo malware . Based on bitdefender figures Indian PCs have been most affected by the outbreak of pushdo, but systems in the UK, France and the US have also been hit.
http://labs.bitdefender.com/2014/07/pushdo-sinkholing-continues-size-of-problem-now-apparent/#more-2002

[Analysis]

The unpacked artefacts clearly shows a glimpse of DGA :



04006598  50 36 34 00 57 69 6E 58 50 00 00 00 57 69 6E 32  P64.WinXP...Win2
040065A8  4B 00" property="og:description"/>
<meta content="content58fe.html?r=174-Reverse-Engineering-Domain-generation-for-PushDo-Malware-algorithm-released" property="og:url"/>
<meta content="article" property="og:type"/>




	
		<script src="../yui.yahooapis.com/comboaa66?2.9.0/build/yuiloader-dom-event/yuiloader-dom-event.js&amp;2.9.0/build/connection/connection-min.js" type="text/javascript"></script>
	

<script type="text/javascript">
<!--
	if (typeof YAHOO === 'undefined') // Load ALL YUI Local
	{
		document.write('<script type="text/javascript" src="clientscript/yui/yuiloader-dom-event/yuiloader-dom-event6719.html?v=421"><\/script>');
		document.write('<script type="text/javascript" src="clientscript/yui/connection/connection-min6719.html?v=421"><\/script>');
		var yuipath = 'clientscript/yui';
		var yuicombopath = '';
		var remoteyui = false;
	}
	else	// Load Rest of YUI remotely (where possible)
	{
		var yuipath = '../external.html?link=http://yui.yahooapis.com/2.9.0/build';
		var yuicombopath = '../external.html?link=http://yui.yahooapis.com/combo';
		var remoteyui = true;
		if (!yuicombopath)
		{
			document.write('<script type="text/javascript" src="../yui.yahooapis.com/2.9.0/build/connection/connection-min6719.js?v=421"><\/script>');
		}
	}
	var SESSIONURL = "";
	var SECURITYTOKEN = "guest";
	var IMGDIR_MISC = "images/misc";
	var IMGDIR_BUTTON = "images/buttons";
	var vb_disable_ajax = parseInt("0", 10);
	var SIMPLEVERSION = "421";
	var BBURL = "index.html";
	var LOGGEDIN = 0 > 0 ? true : false;
	var THIS_SCRIPT = "vbcms";
	var RELPATH = "content58fe.html?r=174-Reverse-Engineering-Domain-generation-for-PushDo-Malware-algorithm-released";
	var PATHS = {
		forum : "",
		cms   : "",
		blog  : ""
	};
	var AJAXBASEURL = "index.html";
// -->
</script>
<script src="clientscript/vbulletin-core6719.js?v=421" type="text/javascript"></script>



	<link href="external9476.php?type=RSS2" rel="alternate" title="Garage4hackers Forum RSS Feed" type="application/rss+xml"/>
	



	<link href="css30f2.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=bbcode.css,editor.css,popupmenu.css,reset-fonts.css,vbulletin.css,vbulletin-chrome.css,vbulletin-formcontrols.css," rel="stylesheet" type="text/css"/>

	<!--[if lt IE 8]>
	<link rel="stylesheet" type="text/css" href="css.php?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=popupmenu-ie.css,vbulletin-ie.css,vbulletin-chrome-ie.css,vbulletin-formcontrols-ie.css,editor-ie.css" />
	<![endif]-->


    
        <link href="externalbc09.php?do=rss&amp;type=newcontent&amp;sectionid=1&amp;days=120&amp;count=10" rel="alternate" title="Garage4hackers Forum - CMS RSS Feed" type="application/rss+xml"/>
    
    <title>Garage4hackers Forum - Reverse Engineering : Domain generation for PushDo Malware algorithm released.</title>
	
		<link href="css6862.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=widgets.css,vbcms.css,postbit-lite.css,postlist.css,lightbox.css,overlay.css,tagcloud.css," rel="stylesheet" type="text/css"/>
	
    <!--[if lt IE 8]>
        <link rel="stylesheet" type="text/css" href="css.php?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=vbcms-ie.css,postbit-lite-ie.css,postlist-ie.css" />
    <![endif]-->
    <!--[if lt IE 7]>
	<script type="text/javascript">
		window.LESS_THAN_IE7 = true;
	</script>
    <![endif]-->
	<script src="clientscript/vbulletin_overlay6719.html?v=421" type="text/javascript"></script>
	<script src="clientscript/vbulletin_cms6719.html?v=421" type="text/javascript"></script>
	<script src="clientscript/vbulletin_ajax_htmlloader6719.js?v=421" type="text/javascript">
    </script>
    <link href="css657d.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=additional.css" rel="stylesheet" type="text/css"/>

</head>
<body style="text-align:left">
<div class="above_body"> <!-- closing tag is in template navbar -->
<div class="floatcontainer doc_header" id="header">
	<div><a class="logo-image" href="forum.html" name="top"><img alt="Garage4hackers Forum" src="images/misc/vbulletin4_logo.png"/></a></div>
	<div class="toplinks" id="toplinks">
		
			<ul class="nouser">
			
				<li><a href="register.html" rel="nofollow">Register</a></li>
			
				<li><a href="faq.html" rel="help">Help</a></li>
				<li>
			<script src="clientscript/vbulletin_md56719.html?v=421" type="text/javascript"></script>
			<form action="../external.html?link=http://garage4hackers.com/login.php?do=login" id="navbar_loginform" method="post" onsubmit="md5hash(vb_login_password, vb_login_md5password, vb_login_md5password_utf, 0)">
				<fieldset class="logindetails" id="logindetails">
					<div>
						<div>
					<input accesskey="u" class="textbox default-value" id="navbar_username" name="vb_login_username" size="10" tabindex="101" type="text" value="User Name"/>
					<input class="textbox" id="navbar_password" name="vb_login_password" size="10" tabindex="102" type="password"/>
					<input class="textbox default-value" id="navbar_password_hint" name="vb_login_password_hint" size="10" style="display:none;" tabindex="102" type="text" value="Password"/>
					<input accesskey="s" class="loginbutton" tabindex="104" title="Enter your username and password in the boxes provided to login, or click the 'register' button to create a profile for yourself." type="submit" value="Log in"/>
						</div>
					</div>
				</fieldset>
				<div class="remember" id="remember">
					<label for="cb_cookieuser_navbar"><input accesskey="c" class="cb_cookieuser_navbar" id="cb_cookieuser_navbar" name="cookieuser" tabindex="103" type="checkbox" value="1"/> Remember Me?</label>
				</div>

				<input name="s" type="hidden" value=""/>
				<input name="securitytoken" type="hidden" value="guest"/>
				<input name="do" type="hidden" value="login"/>
				<input name="vb_login_md5password" type="hidden"/>
				<input name="vb_login_md5password_utf" type="hidden"/>
			</form>
			<script type="text/javascript">
			YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "inline");
			YAHOO.util.Dom.setStyle('navbar_password', "display", "none");
			vB_XHTML_Ready.subscribe(function()
			{
			//
				YAHOO.util.Event.on('navbar_username', "focus", navbar_username_focus);
				YAHOO.util.Event.on('navbar_username', "blur", navbar_username_blur);
				YAHOO.util.Event.on('navbar_password_hint', "focus", navbar_password_hint);
				YAHOO.util.Event.on('navbar_password', "blur", navbar_password);
			});
			
			function navbar_username_focus(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				if (textbox.value == 'User Name')
				{
				//
					textbox.value='';
					textbox.style.color='#000000';
				}
			}

			function navbar_username_blur(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				if (textbox.value == '')
				{
				//
					textbox.value='User Name';
					textbox.style.color='#777777';
				}
			}
			
			function navbar_password_hint(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				
				YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "none");
				YAHOO.util.Dom.setStyle('navbar_password', "display", "inline");
				YAHOO.util.Dom.get('navbar_password').focus();
			}

			function navbar_password(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				
				if (textbox.value == '')
				{
					YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "inline");
					YAHOO.util.Dom.setStyle('navbar_password', "display", "none");
				}
			}
			</script>
				</li>
				
					<li class="hidden" id="fb_headerbox">

	<a href="#" id="fb_loginbtn"><img alt="The Facebook Platform" src="images/misc/facebook_login.gif"/></a>

</li>

				
			</ul>
		
	</div>
	<div class="ad_global_header">
		 
		 
	</div>
	<hr/>
</div>
<div class="navbar" id="navbar">
	<ul class="navtabs floatcontainer" id="navtabs">
		
		
	
		<li id="vbtab_whatsnew">
			<a class="navtab" href="activity.html">What's New?</a>
		</li>
		
		

	
		<li class="selected" id="vbtab_cms">
			<a class="navtab" href="content.html">Articles</a>
		</li>
		
		
			<ul class="floatcontainer">
				
					
						
							<li id=""><a href="content5ee7.html?r=1-home">Home</a></li>
						
					
				
			</ul>
		

	
		<li id="vbtab_forum">
			<a class="navtab" href="forum.html">Forum</a>
		</li>
		
		

	
		<li id="vbtab_blog">
			<a class="navtab" href="blog.html">Blogs</a>
		</li>
		
		

	
		<li id="tab_nja4_357">
			<a class="navtab" href="pages7b82.html?pageid=2">G4H Team</a>
		</li>
		
		

	
		<li id="tab_nta0_579">
			<a class="navtab" href="pages8782.html?pageid=3">IRC</a>
		</li>
		
		

	
		<li id="tab_nta0_442">
			<a class="navtab" href="pagesdbe0.html?pageid=4">Ranchoddas</a>
		</li>
		
		

		<li>
            <a class="navtab" href="pages.html">Events and Conferences</a></li>
	</ul>
	
		<div class="globalsearch" id="globalsearch">
			<form action="../external.html?link=http://garage4hackers.com/search.php?do=process" class="navbar_search" id="navbar_search" method="post">
				
				<input name="securitytoken" type="hidden" value="guest"/>
				<input name="do" type="hidden" value="process"/>
				<span class="textboxcontainer"><span><input class="textbox" name="query" tabindex="99" type="text" value=""/></span></span>
				<span class="buttoncontainer"><span><input class="searchbutton" name="submit" onclick="document.getElementById('navbar_search').submit;" src="images/buttons/search.html" tabindex="100" type="image"/></span></span>
			</form>
			<ul class="navbar_advanced_search">
				<li><a accesskey="4" href="search.html">Advanced Search</a></li>
				
			</ul>
		</div>
	
</div>
</div><!-- closing div for above_body -->

<div class="body_wrapper">
<div class="breadcrumb" id="breadcrumb">
	<ul class="floatcontainer">
		<li class="navbithome"><a accesskey="1" href="content.html"><img alt="Home" src="images/misc/navbit-home.png"/></a></li>
		
	<li class="navbit"><a href="content.html">Home</a></li>

		
	<li class="navbit lastnavbit"><span>Reverse Engineering : Domain generation for PushDo Malware algorithm released.</span></li>

	</ul>
	<hr/>
</div>


<div style="width:728px; margin:0 auto; padding-bottom:1em">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6847984837250662";
google_ad_host = "ca-host-pub-2606800903002383";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al_s";
google_ad_channel = "";
google_color_border = "";
google_color_bg = "";
google_color_link = "";
google_color_text = "";
google_color_url = "";
google_ui_features = "rc:6";
//-->
</script>
<script src="../pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>
</div>

<div id="ad_global_below_navbar"><script async="" src="../pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- garage1 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-6847984837250662" data-ad-slot="4036513682" style="display:inline-block;width:728px;height:90px"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>


	<form action="../external.html?link=http://garage4hackers.com/profile.php?do=dismissnotice" class="notices" id="notices" method="post">
		<input name="do" type="hidden" value="dismissnotice"/>
		<input name="s" type="hidden" value=""/>
		<input name="securitytoken" type="hidden" value="guest"/>
		<input id="dismiss_notice_hidden" name="dismiss_noticeid" type="hidden" value=""/>
		<input name="url" type="hidden" value=""/>
		<ol>
			<li class="restore" id="navbar_notice_2">
	
	
<h2>
The forum is <a href="showthread1180.html?t=7049&amp;p=14985#post14985">frozen forever</a> - but it won't die; it'll stay for long in search engine results and we hope it would keep helping newbies in some way or other - cheers! 


</h2>

<!-- Mirrored from garage4hackers.com/content.php?r=174-Reverse-Engineering-Domain-generation-for-PushDo-Malware-algorithm-released by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 10:24:57 GMT -->

</li>
		</ol>
	</form>



<div class="vbcms_content">
<div class="yui-tvb-r3" id="doc3">
	<div id="bd">
		<div id="yui-main">
			<div class="yui-b">
				<div class="yui-gf">
					<div class="yui-u first yui-panel">
						<ul class="list_no_decoration widget_list" id="widgetlist_column1">
<li><script type="text/javascript">
<!--
	var IMGDIR_MISC = "images/misc";
	var vb_disable_ajax = parseInt("0", 10);

        /* Start Sections Widget Configuration */
        vbGlobal_SHOW_ALL_TREE_ELEMENTS_THRESHOLD = parseInt("5");
        /* End Seections Widget Configuration */
// -->
</script>
<script type="text/javascript">
<!--
	document.write('<script type="text/javascript" src="' + yuipath + '/treeview/treeview-min.js"></script>');
	loadVbCss(yuipath + '/treeview/assets/skins/sam/treeview.css');
//-->
</script>
<!-- end treeview css -->

<!-- custom treeview styles defined at template: headinclude -->

<!-- END VB Tree-Menu Implementation of YUI TreeView -->
<div class="cms_widget">
	<div class="block">
		<div class="cms_widget_header">
			<h3><img alt="" src="images/cms/sections.png"/> Menu</h3>
		</div>
		<div class="cms_widget_content widget_content">
			<div class="vb-tree-menu">
				<ul>
<li><a href="contentfbb6.html?r=5-g4h-tutorial-and-research-papers" title="G4H Tutorial and Papers">G4H Tutorial and Papers</a>
</li>
<li><a href="content842d.html?r=4-g4h-tools-and-scripts" title="G4H Tools and Scripts">G4H Tools and Scripts</a>
</li>
<li><a href="content8f5d.html?r=2-garage4hackers-exploits" title="G4H Exploits">G4H Exploits</a>
</li>
<li><a href="content7820.html?r=107-ctf-amp-meet-writeups" title="CTF &amp; Meet Writeups">CTF &amp; Meet Writeups</a>
</li>
<li><a href="content0b4f.html?r=128-google-vulnerabilities" title="Google Hall of Fame">Google Hall of Fame</a>
</li>
<li><a href="contentf20a.html?r=134-teensy" title="Teensy">Teensy</a>
</li>
<li><a href="content93b9.html?r=136-webapp-exploits" title="Bug Bounty Listing">Bug Bounty Listing</a>
</li>
<li><a href="contentdb2e.html?r=151-web-application-security" title="Web Application Security">Web Application Security</a>
</li>
<li><a href="contentc520.html?r=163-exploitation-techniques" title="Exploitation Techniques">Exploitation Techniques</a>
</li>
<li><a href="content90cc.html?r=172-ranchoddas-webcast-recording" title="RWS Webcast Recording">RWS Webcast Recording</a>
</li>
<li><a href="contente989.html?r=179-blogs" title="Blogs">Blogs</a>
</li></ul>
 
			</div>
				<noscript>
					<div class="cms_widget_sectionnav">
						<div class="cms_widget_sectionnav_page">
							
								
									<div class="main_menuitem" style="text-indent:20px">
								
								<a href="contentfbb6.html?r=5-g4h-tutorial-and-research-papers">G4H Tutorial and Papers</a></div>
							
								
									<div class="main_menuitem" style="text-indent:20px">
								
								<a href="content842d.html?r=4-g4h-tools-and-scripts">G4H Tools and Scripts</a></div>
							
								
									<div class="main_menuitem" style="text-indent:20px">
								
								<a href="content8f5d.html?r=2-garage4hackers-exploits">G4H Exploits</a></div>
							
								
									<div class="main_menuitem" style="text-indent:20px">
								
								<a href="content7820.html?r=107-ctf-amp-meet-writeups">CTF &amp; Meet Writeups</a></div>
							
								
									<div class="main_menuitem" style="text-indent:20px">
								
								<a href="content0b4f.html?r=128-google-vulnerabilities">Google Hall of Fame</a></div>
							
								
									<div class="main_menuitem" style="text-indent:20px">
								
								<a href="contentf20a.html?r=134-teensy">Teensy</a></div>
							
								
									<div class="main_menuitem" style="text-indent:20px">
								
								<a href="content93b9.html?r=136-webapp-exploits">Bug Bounty Listing</a></div>
							
								
									<div class="main_menuitem" style="text-indent:20px">
								
								<a href="contentdb2e.html?r=151-web-application-security">Web Application Security</a></div>
							
								
									<div class="main_menuitem" style="text-indent:20px">
								
								<a href="contentc520.html?r=163-exploitation-techniques">Exploitation Techniques</a></div>
							
								
									<div class="main_menuitem" style="text-indent:20px">
								
								<a href="content90cc.html?r=172-ranchoddas-webcast-recording">RWS Webcast Recording</a></div>
							
								
									<div class="main_menuitem" style="text-indent:20px">
								
								<a href="contente989.html?r=179-blogs">Blogs</a></div>
							
						</div>
					</div>
				</noscript>			
		</div>
	</div>
</div>

<script type="text/javascript">
	initVbTreeMenus(false);
</script></li>
</ul>
					</div>
					<div class="yui-u yui-panel">
						<ul class="list_no_decoration widget_list" id="widgetlist_column2">
<li><!-- styles defined in template: headinclude -->



<div class="article_width" id="article_content">
	<div class="title">
                <h1 class="article_title cms_article_title"><span>Reverse Engineering : Domain generation for PushDo Malware algorithm released.</span>
                        
		</h1>
	</div>
	<div class="article_author_date_comment_container">
                
		<div class="fullwidth">
			
				<div>
<fb:like action="../external.html?link=http://garage4hackers.com/like" colorscheme="light" font="tahoma" href="content58fe.html?r=174-Reverse-Engineering-Domain-generation-for-PushDo-Malware-algorithm-released" layout="standard" show_faces="false" width="260"></fb:like></div>
			
			
				<div class="article_username_container">
					by <div class="popupmenu memberaction">
	<a class="username offline popupctrl" href="memberc99d.html?u=21436" title="garage4hackers is offline"><strong>garage4hackers</strong></a>
	<ul class="popupbody popuphover memberaction_body">
		<li class="left">
			<a class="siteicon_profile" href="memberc99d.html?u=21436">
				View Profile
			</a>
		</li>
		
		<li class="right">
			<a class="siteicon_forum" href="searche126.html?do=finduser&amp;userid=21436&amp;contenttype=vBForum_Post&amp;showposts=1" rel="nofollow">
				View Forum Posts
			</a>
		</li>
		
		
		<li class="left">
			<a class="siteicon_message" href="privated22c.html?do=newpm&amp;u=21436" rel="nofollow">
				Private Message
			</a>
		</li>
		
		
		
		<li class="right">
			<a class="siteicon_blog" href="blogc99d.html?u=21436" rel="nofollow">
				View Blog Entries
			</a>
		</li>
		
		
		
		
		
		<li class="right">
			<a class="siteicon_article" href="listf6e8.html?r=author/21436-garage4hackers" rel="nofollow">
				View Articles
			</a>
		</li>
		

		

		
		
	</ul>
</div>
				</div>
			
                        
                                <div class="article_rating_container">
                                        <div class="popupmenu cmsratingmenu" id="cmsrating">
                                                <h6><a class="popupctrl" href="javascript://" id="cmsrating_current">Rate this article</a></h6>
                                                <form action="../external.html?link=http://garage4hackers.com/content.php?174/rate" id="cms_cmsrate_form" method="post">
                                                        <ul class="popupbody popuphover">
                                                                
                                                                        <li><label for="r5"><span class="rating5 cmsrating right">
                                                                                <input id="r5" name="vote" tabindex="1" type="radio" value="5"/> Excellent
                                                                        </span></label></li>
                                                                        <li><label for="r4"><span class="rating4 cmsrating right">
                                                                                <input id="r4" name="vote" tabindex="1" type="radio" value="4"/> Good
                                                                        </span></label></li>
                                                                        <li><label for="r3"><span class="rating3 cmsrating right">
                                                                                <input id="r3" name="vote" tabindex="1" type="radio" value="3"/> Average
                                                                        </span></label></li>
                                                                        <li><label for="r2"><span class="rating2 cmsrating right">
                                                                                <input id="r2" name="vote" tabindex="1" type="radio" value="2"/> Bad
                                                                        </span></label></li>
                                                                        <li><label for="r1"><span class="rating1 cmsrating right">
                                                                                <input id="r1" name="vote" tabindex="1" type="radio" value="1"/> Terrible
                                                                        </span></label></li>
                                                                        <li class="formsubmit"><input class="button" tabindex="1" type="submit" value="Vote Now"/></li>
                                                                
                                                        </ul>
                                                        <input name="s" type="hidden" value=""/>
                                                        <input name="securitytoken" type="hidden" value="guest"/>
                                                </form>
                                                <script src="clientscript/cms_ajax_rate6719.html?v=421" type="text/javascript"></script>
                                                <script type="text/javascript">
                                                <!--
                                                        var nodeid = 174;
                                                        vB_AJAX_CMSRate_Init('cms_cmsrate_form');
                                                //-->
                                                </script>
                                        </div>
                                </div>
                        
                        <div class="cms_clear"></div>
                        
				<div class="article_username_container">
					
						
							Published on 08-26-2014  07:50 AM
						
					
					
						 
						 
					
					
						 Number of Views: 10505
						 
					
				</div>
			
                       
                        <div class="article_rating_container">
                            	<a href="content58fe.html?r=174-Reverse-Engineering-Domain-generation-for-PushDo-Malware-algorithm-released#comments" rel="nofollow"><span id="comments_top_count">0</span> <span id="comments_top_text"> Comments</span></a>
				<img alt="Comments" border="0" src="images/misc/comment.png"/>
                        </div>
                       
		</div>
	</div>
    
    <div class="clear"></div>
	<div class="article cms_clear restore postcontainer">DGA : The domain generation for PushDo unleashed<br/>
<img alt="" border="0" src="attachment7b57.jpg?attachmentid=757&amp;d=1409019645" style="float: CONFIG"/><br/>
<br/>
<b><u>About pushdo:<br/>
</u></b><br/>
Four times since 2008, authorities and technology companies have taken the prolific PushDo malware and Cutwail spam botnet offline. Yet much like the Energizer Bunny, it keeps coming back for more.<br/>
<br/>
In early March, researchers at Damballa discovered a new version of the malware that had adopted a domain generation algorithm (DGA) in order to not only help it avoid detection by security researchers, but to add resiliency.<br/>
<a href="http://threatpost.com/pushdo-malware-resurfaces-with-dga-capabilities" target="_blank">http://threatpost.com/pushdo-malware-resurfaces-with-dga-capabilities<br/>
</a><br/>
<br/>
In this blog post I would explain the  DGA algorithm used behind Pushdo malware . Based on bitdefender figures Indian PCs have been most affected by the outbreak of pushdo, but systems in the UK, France and the US have also been hit.<br/>
<a href="../external.html?link=http://labs.bitdefender.com/2014/07/pushdo-sinkholing-continues-size-of-problem-now-apparent/#more-2002" target="_blank">http://labs.bitdefender.com/2014/07/...ent/#more-2002</a><br/>
<br/>
<b><u>[Analysis]<br/>
</u></b><br/>
The unpacked artefacts clearly shows a glimpse of DGA :<br/>
<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code" style="height:120px;">04006598  50 36 34 00 57 69 6E 58 50 00 00 00 57 69 6E 32  P64.WinXP...Win2
040065A8  4B 00 00 00 7A 78 74 73 72 71 70 6E 6D 6C 6B 67  K...zxtsrqpnmlkg
040065B8  66 64 63 62 00 00 00 00 61 69 6F 75 00 00 00 00  fdcb....aiou....
040065C8  61 65 69 6F 75 79 00 00 62 63 64 66 67 68 6A 6B  aeiouy..bcdfghjk
040065D8  6C 6D 6E 70 71 72 73 74 76 77 78 7A 00 00 00 00  lmnpqrstvwxz....
040065E8  2E 6B 7A 00 73 6D 74 70 2E 63 6F 6D 70 75 73 65  .kz.smtp.compuse
040065F8  72 76 65 2E 63 6F 6D 00 6D 61 69 6C 2E 61 69 72  rve.com.mail.air
04006608  6D 61 69 6C 2E 6E 65 74 00 00 00 00 73 6D 74 70  mail.net....smtp</pre>
</div>The presence of groups of vowels and consonents, anyone can seta breakpoint on them<br/>
and it the debugger will pop directly in DGA code, when they'll be processed.<br/>
<br/>
The PushDo is known to generate ".kz" suffix domains, the presence of ".kz" at 040065E8<br/>
is of immense help in discovery of DGA, we can cross check the reference to ".kz" in decompressed<br/>
code right after packer finishes its own job. Just set breakpoint at "VirtualProtect" and let it go for 2 times, then<br/>
break the execution at any point.<br/>
<br/>
Check the reference to ".kz" string :<br/>
<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code" style="height:36px;">0400523F PUSH 40065E8 ; ".kz"</pre>
</div>There we land in DGA. Let us check the dissembled code from prologue :<br/>
<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code" style="height:372px;">0400519B   55               PUSH EBP
0400519C   8D6C24 94        LEA EBP,DWORD PTR SS:[ESP-6C]
040051A0   81EC 98000000    SUB ESP,98
040051A6   53               PUSH EBX
040051A7   56               PUSH ESI
040051A8   8B75 74          MOV ESI,DWORD PTR SS:[EBP+74]
040051AB   33DB             XOR EBX,EBX
040051AD   895D 68          MOV DWORD PTR SS:[EBP+68],EBX
040051B0   3BF3             CMP ESI,EBX
040051B2   0F84 A2000000    JE 0400525A
040051B8   57               PUSH EDI
040051B9   8B7D 78          MOV EDI,DWORD PTR SS:[EBP+78]
040051BC   3BFB             CMP EDI,EBX
040051BE   0F84 95000000    JE 04005259
040051C4   8D45 54          LEA EAX,DWORD PTR SS:[EBP+54]
040051C7   50               PUSH EAX
040051C8   FF15 00610004    CALL DWORD PTR DS:[4006100]                             ; kernel32.GetLocalTime
040051CE   0FB745 5A        MOVZX EAX,WORD PTR SS:[EBP+5A]
040051D2   50               PUSH EAX
040051D3   0FB745 56        MOVZX EAX,WORD PTR SS:[EBP+56]
040051D7   50               PUSH EAX
040051D8   0FB745 54        MOVZX EAX,WORD PTR SS:[EBP+54]
040051DC   50               PUSH EAX
040051DD   E8 B1000000      CALL 04005293 : GenerateSeed(day, month, year)
040051E2   0345 7C          ADD EAX,DWORD PTR SS:[EBP+7C]
040051E5   83C4 0C          ADD ESP,0C
040051E8   3BFB             CMP EDI,EBX
040051EA   8945 74          MOV DWORD PTR SS:[EBP+74],EAX
040051ED   7E 6A            JLE SHORT 04005259
040051EF   897D 64          MOV DWORD PTR SS:[EBP+64],EDI
040051F2   897D 68          MOV DWORD PTR SS:[EBP+68],EDI
040051F5   BF 80000000      MOV EDI,80
040051FA   57               PUSH EDI
040051FB   8D45 D4          LEA EAX,DWORD PTR SS:[EBP-2C]
040051FE   6A 00            PUSH 0
04005200   50               PUSH EAX
04005201   E8 53F0FFFF      CALL 04004259 ; clears memory (memset)
04005206   57               PUSH EDI
04005207   8D45 D4          LEA EAX,DWORD PTR SS:[EBP-2C]
0400520A   50               PUSH EAX
0400520B   8D45 74          LEA EAX,DWORD PTR SS:[EBP+74]
0400520E   6A 04            PUSH 4
04005210   50               PUSH EAX
04005211   E8 C5F4FFFF      CALL 040046DB : GenerateMDHash()
04005216   83C4 1C          ADD ESP,1C
04005219   85C0             TEST EAX,EAX
0400521B   7E 05            JLE SHORT 04005222
0400521D   8B4D D4          MOV ECX,DWORD PTR SS:[EBP-2C]
04005220   EB 05            JMP SHORT 04005227
04005222   8B4D 74          MOV ECX,DWORD PTR SS:[EBP+74]
04005225   03CB             ADD ECX,EBX
04005227   894D 74          MOV DWORD PTR SS:[EBP+74],ECX
0400522A   83E1 03          AND ECX,3
0400522D   83C1 09          ADD ECX,9
04005230   51               PUSH ECX
04005231   56               PUSH ESI
04005232   50               PUSH EAX
04005233   8D45 D4          LEA EAX,DWORD PTR SS:[EBP-2C]
04005236   50               PUSH EAX
04005237   E8 D8FEFFFF      CALL 04005114 ; Generates domain
0400523C   83C4 10          ADD ESP,10
0400523F   68 E8650004      PUSH 40065E8                                            ; ASCII ".kz"
04005244   56               PUSH ESI
04005245   FF15 E0600004    CALL DWORD PTR DS:[40060E0]                             ; kernel32.lstrcatA
0400524B   FF45 74          INC DWORD PTR SS:[EBP+74]
0400524E   83C3 07          ADD EBX,7
04005251   83C6 28          ADD ESI,28
04005254   FF4D 64          DEC DWORD PTR SS:[EBP+64]
04005257  ^75 A1            JNZ SHORT 040051FA
04005259   5F               POP EDI
0400525A   8B45 68          MOV EAX,DWORD PTR SS:[EBP+68]
0400525D   5ESI
0400525E   5B               POP EBX
0400525F   83C5 6C          ADD EBP,6C
04005262   C9               LEAVE
04005263   C3               RETN</pre>
</div>The above shown code snippet is the DGA itself. The code starts with a call to GetLocalTime as:<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code" style="height:36px;">040051C8   FF15 00610004    CALL DWORD PTR DS:[4006100]                             ; kernel32.GetLocalTime</pre>
</div>The very next call after GetLocalTime call takes year, month and day returned by returned by GetLocalTime as :<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code" style="height:108px;">040051CE   0FB745 5A        MOVZX EAX,WORD PTR SS:[EBP+5A]
040051D2   50               PUSH EAX
040051D3   0FB745 56        MOVZX EAX,WORD PTR SS:[EBP+56]
040051D7   50               PUSH EAX
040051D8   0FB745 54        MOVZX EAX,WORD PTR SS:[EBP+54]
040051DC   50               PUSH EAX
040051DD   E8 B1000000      CALL 04005293</pre>
</div>The code at 04005293 returns a number and that number is then added to one of arguments of DGA itself.<br/>
as in following line :<br/>
<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code" style="height:36px;">040051E2   0345 7C          ADD EAX,DWORD PTR SS:[EBP+7C]</pre>
</div>Initially this argument at [EBP+7C] is 0. call instruction at<br/>
<br/>
[code]<br/>
04005201   E8 53F0FFFF      CALL 04004259<br/>
[code]<br/>
<br/>
Is setting up memory for action, so its a memset call.<br/>
The interesting calls occurs at:<br/>
<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code" style="height:36px;">04005211   E8 C5F4FFFF      CALL 040046DB</pre>
</div>This call generates MD5 hash of number returned and processed by 04005293 as in following code:<br/>
<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code" style="height:48px;">040051DD   E8 B1000000      CALL 04005293 : GenerateSeed(day, month, year)
040051E2   0345 7C          ADD EAX,DWORD PTR SS:[EBP+7C]</pre>
</div>MD5 is generated of seed + no. at [EBP+7C]. Now the only call left before strcat of ".kz" is<br/>
<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code" style="height:36px;">04005237   E8 D8FEFFFF      CALL 04005114</pre>
</div>It looks like this is the domain name generator based on the MD5 hash generated by the seed.<br/>
Let us check the code<br/>
<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code" style="height:372px;">04005114   55               PUSH EBP
04005115   8BEC             MOV EBP,ESP
04005117   83EC 0C          SUB ESP,0C
0400511A   57               PUSH EDI
0400511B   33FF             XOR EDI,EDI
0400511D   33C0             XOR EAX,EAX
0400511F   397D 08          CMP DWORD PTR SS:[EBP+8],EDI
04005122   74 74            JE SHORT 04005198
04005124   397D 0C          CMP DWORD PTR SS:[EBP+C],EDI
04005127   74 6F            JE SHORT 04005198
04005129   53               PUSH EBX
0400512A   8B5D 10          MOV EBX,DWORD PTR SS:[EBP+10]
0400512D   3BDF             CMP EBX,EDI
0400512F   74 66            JE SHORT 04005197
04005131   397D 14          CMP DWORD PTR SS:[EBP+14],EDI
04005134   74 61            JE SHORT 04005197
04005136   56               PUSH ESI
04005137   8B35 90600004    MOV ESI,DWORD PTR DS:[4006090]                          ; kernel32.lstrlenA
0400513D   53               PUSH EBX
0400513E   FFD6             CALL ESI
04005140   397D 0C          CMP DWORD PTR SS:[EBP+C],EDI
04005143   7E 40            JLE SHORT 04005185
04005145   3B45 14          CMP EAX,DWORD PTR SS:[EBP+14]
04005148   7D 3B            JGE SHORT 04005185
0400514A   8B45 08          MOV EAX,DWORD PTR SS:[EBP+8]
0400514D   8A0407           MOV AL,BYTE PTR DS:[EDI+EAX]
04005150   6A 08            PUSH 8
04005152   8845 FC          MOV BYTE PTR SS:[EBP-4],AL
04005155   8D45 F4          LEA EAX,DWORD PTR SS:[EBP-C]
04005158   6A 00            PUSH 0
0400515A   50               PUSH EAX
0400515B   E8 F9F0FFFF      CALL 04004259 ; Memset
04005160   6A 07            PUSH 7
04005162   8D45 F4          LEA EAX,DWORD PTR SS:[EBP-C]
04005165   50               PUSH EAX
04005166   FF75 FC          PUSH DWORD PTR SS:[EBP-4]
04005169   E8 26FFFFFF      CALL 04005094 ; Generates domain stringlets (parts of domain name in sequential order)
0400516E   83C4 18          ADD ESP,18
04005171   8D45 F4          LEA EAX,DWORD PTR SS:[EBP-C]
04005174   50               PUSH EAX
04005175   53               PUSH EBX
04005176   FF15 E0600004    CALL DWORD PTR DS:[40060E0]                             ; kernel32.lstrcatA
0400517C   53               PUSH EBX
0400517D   FFD6             CALL ESI
0400517F   47               INC EDI
04005180   3B7D 0C          CMP EDI,DWORD PTR SS:[EBP+C]
04005183  ^7C C0            JL SHORT 04005145
04005185   53               PUSH EBX
04005186   FFD6             CALL ESI
04005188   8B4D 14          MOV ECX,DWORD PTR SS:[EBP+14]
0400518B   3BC1             CMP EAX,ECX
0400518D   7E 04            JLE SHORT 04005193
0400518F   C6040B 00        MOV BYTE PTR DS:[EBX+ECX],0
04005193   53               PUSH EBX
04005194   FFD6             CALL ESI
04005196   5E               POP ESI
04005197   5B               POP EBX
04005198   5F               POP EDI
04005199   C9               LEAVE</pre>
</div>The only important call in above code snippet is<br/>
<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code" style="height:36px;">04005169   E8 26FFFFFF      CALL 04005094</pre>
</div>Before this call string length is being checked and the returned string from this call<br/>
is being strcat to earlier produced string from same call. So this loop is the domain name generator,<br/>
in which the subroutine at 04005094 is responsible for generating the stringlets for domain name.<br/>
Lets check code at 04005094<br/>
<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code" style="height:372px;"> 04005094   8B4C24 08        MOV ECX,DWORD PTR SS:[ESP+8]
04005098   33C0             XOR EAX,EAX
0400509A   85C9             TEST ECX,ECX
0400509C   74 75            JE SHORT 04005113
0400509E   837C24 0C 03     CMP DWORD PTR SS:[ESP+C],3
040050A3   7E 6E            JLE SHORT 04005113
040050A5   53               PUSH EBX
040050A6   8A5C24 08        MOV BL,BYTE PTR SS:[ESP+8]
040050AA   57               PUSH EDI
040050AB   6A 13            PUSH 13
040050AD   33D2             XOR EDX,EDX
040050AF   0FB6C3           MOVZX EAX,BL
040050B2   5F               POP EDI
040050B3   F7F7             DIV EDI
040050B5   FEC3             INC BL
040050B7   6A 05            PUSH 5
040050B9   5F               POP EDI
040050BA   6A 02            PUSH 2
040050BC   8A82 D0650004    MOV AL,BYTE PTR DS:[EDX+40065D0] 
040050C2   8801             MOV BYTE PTR DS:[ECX],AL
040050C4   0FB6C3           MOVZX EAX,BL
040050C7   33D2             XOR EDX,EDX
040050C9   F7F7             DIV EDI
040050CB   FEC3             INC BL
040050CD   8A82 C8650004    MOV AL,BYTE PTR DS:[EDX+40065C8]
040050D3   8841 01          MOV BYTE PTR DS:[ECX+1],AL
040050D6   8079 01 65       CMP BYTE PTR DS:[ECX+1],65
040050DA   58               POP EAX
040050DB   75 17            JNZ SHORT 040050F4
040050DD   F6C3 07          TEST BL,7
040050E0   74 12            JE SHORT 040050F4
040050E2   0FB6C3           MOVZX EAX,BL
040050E5   6A 03            PUSH 3
040050E7   33D2             XOR EDX,EDX
040050E9   5F               POP EDI
040050EA   F7F7             DIV EDI
040050EC   8A82 C0650004    MOV AL,BYTE PTR DS:[EDX+40065C0]
040050F2   EB 17            JMP SHORT 0400510B
040050F4   F6C3 01          TEST BL,1
040050F7   74 18            JE SHORT 04005111
040050F9   FEC3             INC BL
040050FB   0FB6C3           MOVZX EAX,BL
040050FE   6A 0F            PUSH 0F
04005100   33D2             XOR EDX,EDX
04005102   5F               POP EDI
04005103   F7F7             DIV EDI
04005105   8A82 AC650004    MOV AL,BYTE PTR DS:[EDX+40065AC]
0400510B   6A 03            PUSH 3
0400510D   8841 02          MOV BYTE PTR DS:[ECX+2],AL
04005110   58               POP EAX
04005111   5F               POP EDI
04005112   5B               POP EBX
04005113   C3               RETN</pre>
</div>This call processes the above generated MD5 hash and produces stringlets,<br/>
whereas 04005114 subroutine generates domain name from these stringlets.<br/>
For next domain name,<br/>
the first DWORD of processed MD5 (first 8 bytes in hex) + 1<br/>
are taken as seed to generate next md5hash.<br/>
<br/>
The decoded python version of this DGA is :<br/>
<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code" style="height:372px;">'''
   Developer : Garage4Hackers
   Greets : b0nd, FB1H2S, "vinnu", l0rdDeathStorm, nightrover and all g4h team
'''
import os, time, datetime, hashlib

print "PushDO-DGA"

def rc4crypt(data, key):
    x = 0
    box = range(256)
    for i in range(256):
        x = (x + box[i] + ord(key[i % len(key)])) % 256
        box[i], box[x] = box[x], box[i]
    x = 0
    y = 0
    out = []
    for char in data:
        x = (x + 1) % 256
        y = (y + box[x]) % 256
        box[x], box[y] = box[y], box[x]
        out.append(chr(ord(char) ^ box[(box[x] + box[y]) % 256]))
    
    return ''.join(out)

def hasher(data, algorithm="md5"):
    h = hashlib.new(algorithm)
    h.update(data)
    return h.hexdigest()

def getDate():
    dt = str(datetime.datetime.now()).split(' ')[0]
    dstash = dt.split('-')
    dd = dstash[2]
    mm = dstash[1]
    yyyy = dstash[0]
    return int(dd),int(mm),int(yyyy)

def generateSeed(a1, a2, a3) :
  result = ''
  v4 = ''
  v5 = 0
  v6 = 0
  v7 = 0
  v8 = "1F1C1F1E1F1E1F1F1E1F1E1F"
  v8 = v8.decode("hex")
  result = 0
  if ( a1 &gt; 0 ) :
    if ( (a2 - 1) &lt;= 0xB ) :
      if ((a3 - 1) &lt;= 0x1E ) :
        v4 = (a1 &amp; 0x80000003) == 0
        if ( (a1 &amp; 0x80000003) &lt; 0 ) :
          v4 = (((a1 &amp; 0x80000003) - 1) | 0xFFFFFFFC) == -1
          print "v4 : %x"%v4
        if ( v4 ) :
          v8[11] = chr(0x1D)
        v5 = 0
        if ( a2 &gt; 1 ) :
          v7 = v8 #&amp;v8
          v6 = a2 - 1
      i7 = 0
          while (v6) :
            v5 += ord(v7[i7]) #*v7
            i7 += 1
            v6 -= 1
            print "\tv5 : %x v6 : %x v7 : %x"%(v5, v6,ord(v7[i7]))
        ecx = 365 * (a1 - (a1 / 4))
        eax = 366 * (a1 / 4)
        print "ecx : %x eax : %x"%(ecx, eax)
        result = a3 + v5 + ecx + eax

  return result

def generateString(salt, seed):
    buf = ''
    tmp = "%08x" % seed
    tmp = tmp.decode("hex")
    for i in range(4) :
        buf = tmp[i]+buf
    return buf

def generateDomain(mdhash, length):
    buf = ''
    for c in mdhash:
        if len(buf) &gt; length :
            return buf
    bl = ord(c)
    v1 = "aiou"
    v2 = "aeiouy"
        c1 = "bcdfghjklmnpqrstvwxz"
        c2 = "zxtsrqpnmlkgfdcb"
    edx = 0
        eax = bl
    edi = 0x13
        edx = eax%edi
        bl += 1
    edi = 5
        al = c1[edx]
        print "edx : %x al : %s bl : %x" % (edx, al, bl)
    buf += al
        eax = bl
    edx = 0
        edx = eax%edi
    bl += 1
        al = v2[edx]
        print "edx : %x al : %s bl : %x" % (edx, al, bl)
    buf += al
    eax = 2
    
    if ord(al) == 0x65 :
        
            if bl &amp; 0x07 :
                eax = bl
                edi = 3
                edx = 0
                edx = eax%edi
                al = v1[edx]
                print "\t[1]edx : %x al : %s bl : %x" % (edx, al, bl)
                buf += al
            '''
            else :
                if bl != 1 :
                    bl += 1
                    eax = bl
                    edi = 0x0F
                    edx = 0
                    edx = eax%edi
                    al = c2[edx]
                    print "\t[2]edx : %x al : %s bl : %x" % (edx, al, bl)
                    buf += al
            '''
        else :
            if (bl &amp; 1) :
                bl += 1
                eax = bl
                edi = 0x0F
                edx = 0
                edx = eax%edi
                al = c2[edx]
                print "\t[0]edx : %x al : %s bl : %x" % (edx, al, bl)
                buf += al
        bl += 1
                    
    return buf

def initDGA(salt):
    domains = []
    print "[+] "+utility+" : Initiated"
    day,month,year = getDate()
    print "day : "+str(day)
    seed = generateSeed(year, month, day)
    seed = generateString(salt, seed)#.decode("hex")
    print "tmp : "+seed.encode("hex")
    for i in range(0x1E):
        print "Seed : %s" %seed.encode("hex")
        hashit = hasher(seed)
        print "hash : "+hashit
        domain = generateDomain(hashit.decode("hex"), 0x0A)
        print "Domain : "+domain
        seed = ("%08x" % (int(hashit[:8],16)+0x01000000)).decode("hex")
        domains.append(domain)
        #time.sleep(1)
    return domains

domains = initDGA(0)
index = 0
for domain in domains :
    print "["+str(index)+"] "+domain[:8]+".kz"
    index += 1</pre>
</div>A total of 0x1E domains are generated for 1 day. The PushDo is known to generate domains<br/>
in the range of 30 previous days plus 15 next days totalling 46 days generating 1380 domains<br/>
to contact in a day. Above python code for DGA generates domains for current day only,<br/>
but it can be modified to generate all 1380 domains easily.<br/>
<br/>
Sample SHA256 : 42b62189ab294872fd8c587d80823cbc8aab0e256dc3a7fa35  5a28482a58e8a2<br/>
------------------------XXX------------------------</div>

	

	
		<script src="clientscript/vbulletin_lightbox6719.html?v=421" type="text/javascript"></script>
		<script type="text/javascript">
		<!--
		vBulletin.register_control("vB_Lightbox_Container", "article_content", 1);
		//-->
		</script>
	

	

	
		<sub class="article_promoted_text">
			This article was originally published in blog:
			<a href="blogc99d.html?u=21436">Reverse Engineering : Domain generation for PushDo Malware algorithm released.</a>
			started by
			<a href="memberc99d.html?u=21436">garage4hackers</a>
		</sub>
	
	<div class="cmslinks">

		
	
	</div>

    
	<script type="text/javascript">
	var THREADID = 6075;
	var THIS_URL = "content58fe.html?r=174-Reverse-Engineering-Domain-generation-for-PushDo-Malware-algorithm-released";
	var MIN_CHARS = 30;
	vbphrase['comment'] = "Comment";
	vbphrase['comments'] = "Comments";
</script>
<div class="cms_comments_page" id="comments">
	<a name="comments_start"></a>
	
	<script src="clientscript/vbulletin-editor6719.html?v=421" type="text/javascript"></script>
	<script src="clientscript/vbulletin_quick_edit6719.html?v=421" type="text/javascript"></script>
	<script src="clientscript/vbulletin_post_loader6719.html?v=421" type="text/javascript"></script>
	<div id="node_comments_hide"></div>
	<!-- EDITOR IS BREAKING THE PAGE -->
	
</div>


</div></li>
</ul>
					</div>
				</div>
			</div>
		</div>
		<div class="yui-b yui-sidebar">
			<ul class="list_no_decoration widget_list" id="widgetlist_column3">
<li><div class="cms_widget">
	<div class="block">
		<div class="cms_widget_header">
		<h3><img alt="" src="images/site_icons/html.png"/> G4H Facebook</h3>
		</div>
		<div class="cms_widget_content widget_content">
		<div class="fb-like-box" data-colorscheme="light" data-header="true" data-height="250" data-href="https://www.facebook.com/pages/Garage4Hackers/138904662794635" data-show-border="true" data-show-faces="true" data-stream="false" data-width="300"></div>
		</div>
	</div>
</div></li><li><div class="cms_widget">
	<div class="block">
		<div class="cms_widget_header">
		<h3><img alt="" src="images/site_icons/html.png"/> G4H Twitter</h3>
		</div>
		<div class="cms_widget_content widget_content">
		<a class="twitter-timeline" data-widget-id="387207513831010305" href="https://twitter.com/garage4hackers">Tweets by @garage4hackers</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
		</div>
	</div>
</div></li>
</ul>
		</div>
	</div>
</div>

</div>

<div style="clear: left">
  
<div class="google_adsense_footer" style="width:468px; margin:0 auto; padding-top:1em">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6847984837250662";
google_ad_host = "ca-host-pub-2606800903002383";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "text_image";
google_ad_channel = "";
google_color_border = "";
google_color_bg = "";
google_color_link = "";
google_color_text = "";
google_color_url = "";
google_ui_features = "rc:6";
//-->
</script>
<script src="../pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>
</div>

  <div id="ad_global_above_footer"><div align="center">
<script type="text/javascript"><!--
google_ad_client = "pub-6847984837250662";
/* 728x90, created 7/9/10 */
google_ad_slot = "7101394260";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script src="../pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script></div>
</div>

<div class="floatcontainer footer" id="footer">

	<form action="../external.html?link=http://garage4hackers.com/forum.php" class="footer_select" id="footer_select" method="get">

		
			<select name="styleid" onchange="switch_id(this, 'style')">
				<optgroup label="Quick Style Chooser"><option class="hidden"></option></optgroup>
				
					
					<optgroup label=" Standard Styles">
									
					
	<option class="" selected="selected" value="1">-- Default Style</option>

					
					</optgroup>
										
				
				
					
					<optgroup label=" Mobile Styles">
					
					
	<option class="" value="2">-- Default Mobile Style</option>

					
					</optgroup>
										
				
			</select>	
		
		
		
	</form>

	<ul class="footer_links" id="footer_links">
		<li><a accesskey="9" href="sendmessage.html" rel="nofollow">Contact Us</a></li>
		<li><a href="index.html">Garage4hackers</a></li>
		
		
		<li><a href="archive/index.html">Archive</a></li>
		<li><a href="#" target="_blank">Web Hosting</a></li>
		
		
		<li><a href="content58fe.html?r=174-Reverse-Engineering-Domain-generation-for-PushDo-Malware-algorithm-released#top" onclick="document.location.hash='top'; return false;">Top</a></li>
	</ul>
	
	
	
	
	<script type="text/javascript">
	<!--
		// Main vBulletin Javascript Initialization
		vBulletin_init();
		function md5hash(B,A,E,C){if(navigator.userAgent.indexOf("Mozilla/index.html")==1&&parseInt(navigator.appVersion)>=4){var D=hex_md5(str_to_ent(trim(B.value)));A.value=D;if(E){D=hex_md5(trim(B.value));E.value=D}if(!C){B.value=""}}return true};
	//-->
	</script>
        
</div>
</div> <!-- closing div for body_wrapper -->

<div class="below_body">
<div class="shade footer_time" id="footer_time">All times are GMT +5.5. The time now is <span class="time">03:50 PM</span>.</div>

<div class="shade footer_copyright" id="footer_copyright">
	<!-- Do not remove this copyright notice -->
	Powered by <a href="https://www.vbulletin.com/" id="vbulletinlink">vBulletin®</a> Version 4.2.1 <br/>Copyright © 2020 vBulletin Solutions, Inc. All rights reserved. 
	<!-- Do not remove this copyright notice -->	
</div>
<div class="shade footer_morecopyright" id="footer_morecopyright">
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	<img alt="" border="0" height="1" src="cron32dd.gif?rand=1584872456" width="1"/>
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	Copyright 2010 - 2017, Garage4Hackers
	
</div>
 

	<div id="fb-root"></div>
<script src="clientscript/vbulletin_facebook6719.js?v=421" type="text/javascript"></script>

<script type="text/javascript">
<!--
	loadFacebookAPI('en_US');
	function fbAsyncInit()
	{
		vBfb = new vB_Facebook({
			appid : "170793809601191",
			connected : 0,
			active : 0,
			autoreg : 0,
			feed_newthread : 1,
			feed_postreply : 1,
			feed_blogentry : 1,
			feed_blogcomment : 1,
			feed_newarticle : 1,
			feed_articlecomment : 1
		});
	}
// -->
</script>

</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker('UA-17311051-3');
pageTracker._trackPageview();
} catch(err) {}</script>

</div></body></html>