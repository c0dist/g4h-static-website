<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://www.facebook.com/2008/fbml" dir="ltr" lang="en" id="vbulletin_html">

<!-- Mirrored from garage4hackers.com/printthread.php?t=2699&pp=10&page=1 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 16:50:05 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=ISO-8859-1" /><!-- /Added by HTTrack -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
	<base  /><!--[if IE]></base><![endif]-->
	<meta name="generator" content="vBulletin 4.2.1" />

	
	<link rel="stylesheet" type="text/css" href="cssddc9.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=bbcode.css,popupmenu.css,printthread.css,vbulletin.css,vbulletin-chrome.css" />
	



	<title> BuYS: Web attack for information disclosure of source code</title>
	<link rel="stylesheet" type="text/css" href="css657d.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=additional.css" />

</head>
<body>

<div class="above_body">
<div id="header" class="floatcontainer">
<div><a name="top" href="forum.html" class="logo-image"><img src="images/misc/vbulletin4_logo.html" alt="Garage4hackers Forum" /></a></div>
</div>
</div>
<div class="body_wrapper">
<div id="pagetitle">
	<h1><a href="showthreadbf6c.html?t=2699">BuYS: Web attack for information disclosure of source code</a></h1>
	<p class="description">Printable View</p>
</div>



<ul id="postlist">
	<li class="postbit blockbody" id="post_1">
	<div class="header">
		<div class="datetime">09-12-2012, 05:11 PM</div>
		<span class="username">abhaythehero</span>
	</div>
	
	
		<div class="title">BuYS: Web attack for information disclosure of source code</div>
	
	<div class="content">
		<blockquote class="restore">We all are pretty much familiar with the notorious %00.<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr /><code class="bbcode_code">http://www.example.com?page=index.php</code><hr />
</div>By adding %00 at end<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr /><code class="bbcode_code">http://www.example.com?page=index.php%00</code><hr />
</div>This throws out the source code of index.php<br />
<br />
Q.1 What is this attack called ?<br />
Q.2 Why does this work or what are the internal flaws in web languages which leads it to leak it.<br />
Q.3 How can this be mitigated.(You can assume PHP to be the language. Or you can answer for other languages as well)<br />
<br />
<br />
PM me the answers within 3 days. All answers with solution will be posted after 3 days completion.</blockquote>
	</div>
</li><li class="postbit blockbody" id="post_2">
	<div class="header">
		<div class="datetime">09-13-2012, 09:22 AM</div>
		<span class="username">b0nd</span>
	</div>
	
	
	<div class="content">
		<blockquote class="restore">Answer pmed Super Commando Dhruv. Not a complete one, but whatever I knew about this attack vector.<br />
<br />
Cheers!</blockquote>
	</div>
</li><li class="postbit blockbody" id="post_3">
	<div class="header">
		<div class="datetime">09-13-2012, 11:43 AM</div>
		<span class="username">abhaythehero</span>
	</div>
	
	
	<div class="content">
		<blockquote class="restore"><div class="bbcode_container">
	<div class="bbcode_description">Quote:</div>
	<div class="bbcode_quote printable">
		<hr />
		
			<div>
				Originally Posted by <strong>b0nd</strong>
				<a href="showthread696f.html?p=8796#post8796" rel="nofollow"><img class="inlineimg" src="images/buttons/viewpost.html" alt="View Post" /></a>
			</div>
			<div class="message">Answer pmed Super Commando Dhruv. Not a complete one, but whatever I knew about this attack vector.<br />
<br />
Cheers!</div>
			
		<hr />
	</div>
</div>Checked you answer. Wow, that was another use of %00 in a different attack. But the basic internals remains the same. You just have to figure out why inserting %00 worked in your case, i.e, Question 2 and Question 3.</blockquote>
	</div>
</li><li class="postbit blockbody" id="post_4">
	<div class="header">
		<div class="datetime">09-18-2012, 04:31 PM</div>
		<span class="username">abhaythehero</span>
	</div>
	
	
	<div class="content">
		<blockquote class="restore">Oops made a mistake in the scenario....<br />
<br />
Here is the correction :<br />
<br />
 <div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr /><code class="bbcode_code">http://www.example.com?page=1</code><hr />
</div><b><font color="#FF0000">(Here we are getting an html output. We assume that 1.html file is there on server and is being acessed.)<br />
</font></b><br />
 <br />
By adding %00 at end<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr /><code class="bbcode_code">http://www.example.com?page=page.php%00</code><hr />
</div>This throws out the source code of page.php<br />
<br />
________________________________________________<br />
<br />
Another 3 days :)</blockquote>
	</div>
</li><li class="postbit blockbody" id="post_5">
	<div class="header">
		<div class="datetime">10-05-2012, 04:39 PM</div>
		<span class="username">abhaythehero</span>
	</div>
	
	
	<div class="content">
		<blockquote class="restore"><b>b0nd's</b> answer : <div class="bbcode_container">
	<div class="bbcode_description">Quote:</div>
	<div class="bbcode_quote printable">
		<hr />
		
			Not sure about %00 disclosing source code of the page but, to the best of my memory, it does help in commenting out the extension part of file (back door shells) and hence in their execution. Have seen practical usage when uploading of shells like xyz.php but filters doesn't allow extensions other than txt, jpg etc.<br />
Solution used to be to rename xyz.php to xyz.php.txt and upload and then run on browser as /path/xyz.php%00.txt
			
		<hr />
	</div>
</div>----------------------------------------------------------------------------<br />
<br />
<font color="#FF0000"><u>Ans 1.</u></font> Poison NULL byte attack. Full paper <a href="../insecure.org/news/P55-07.txt" target="_blank">http://insecure.org/news/P55-07.txt</a><br />
<br />
<font color="#FF0000"><u>Ans 2.</u></font> PHP,Perl,etc allows NULL characters in its variables as data. Unlike C, NULL is not a string delimiter.  So, &quot;root&quot; != &quot;root\0&quot;.  But, the underlying system/kernel calls are programmed in C, which DOES recognize NULL as a delimiter.  So the end result?  PHP passes &quot;index.php%00&quot;, but the underlying libs stop processing when they hit the first (our) NULL. Hence index.php%00 is meant by php code, but C library understands it as index.php. So the code of index.php is coughed(as would happen in case of 1.html file) on page and not considered by server side code to be executed.<br />
<br />
<font color="#FF0000"><u>Ans 3.</u></font>  Apply regex to filter out null. (Read the paper, it is explained in detail there)</blockquote>
	</div>
</li>
</ul>


</div>
<div class="below_body">
<div id="footer_time" class="footer_time">All times are GMT +5.5. The time now is <span class="time">05:27 PM</span>.</div>

<div id="footer_copyright" class="footer_copyright">
	<!-- Do not remove this copyright notice -->
	Powered by <a href="../external.html?link=https://www.vbulletin.com/" id="vbulletinlink">vBulletin&reg;</a> Version 4.2.1 <br />Copyright &copy; 2020 vBulletin Solutions, Inc. All rights reserved. 
	<!-- Do not remove this copyright notice -->	
</div>
<div id="footer_morecopyright" class="footer_morecopyright">
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	Copyright 2010 - 2017, Garage4Hackers
</div>
 
</div>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker('UA-17311051-3');
pageTracker._trackPageview();
} catch(err) {}</script>
</body>

<!-- Mirrored from garage4hackers.com/printthread.php?t=2699&pp=10&page=1 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 16:50:05 GMT -->
</html>