<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://www.facebook.com/2008/fbml" dir="ltr" lang="en" id="vbulletin_html">

<!-- Mirrored from garage4hackers.com/showthread.php?t=1924&p=7032 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 18:30:37 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=ISO-8859-1" /><!-- /Added by HTTrack -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta id="e_vb_meta_bburl" name="vb_meta_bburl" content="index.html" />
<base  /><!--[if IE]></base><![endif]-->
<meta name="generator" content="vBulletin 4.2.1" />
<meta http-equiv="X-UA-Compatible" content="IE=9" />

	<link rel="Shortcut Icon" href="favicon.ico" type="image/x-icon" />






	<meta property="fb:app_id" content="170793809601191" />
<meta property="og:site_name" content="Garage4hackers Forum" />
<meta property="og:description" content="Garage4Hackers(G4H) is an open security community for Information Security enthusiasts, gurus and aspirants.Members of the team dedicate time and resources towards helping other information security aspirants, sharing knowledge,spreading security awareness and promoting research." />
<meta property="og:url" content="showthread8fac.html?t=1924" />
<meta property="og:type" content="article" />




	
		<script type="text/javascript" src="../yui.yahooapis.com/comboaa66?2.9.0/build/yuiloader-dom-event/yuiloader-dom-event.js&amp;2.9.0/build/connection/connection-min.js"></script>
	

<script type="text/javascript">
<!--
	if (typeof YAHOO === 'undefined') // Load ALL YUI Local
	{
		document.write('<script type="text/javascript" src="clientscript/yui/yuiloader-dom-event/yuiloader-dom-event6719.html?v=421"><\/script>');
		document.write('<script type="text/javascript" src="clientscript/yui/connection/connection-min6719.html?v=421"><\/script>');
		var yuipath = 'clientscript/yui';
		var yuicombopath = '';
		var remoteyui = false;
	}
	else	// Load Rest of YUI remotely (where possible)
	{
		var yuipath = '../external.html?link=http://yui.yahooapis.com/2.9.0/build';
		var yuicombopath = '../external.html?link=http://yui.yahooapis.com/combo';
		var remoteyui = true;
		if (!yuicombopath)
		{
			document.write('<script type="text/javascript" src="../yui.yahooapis.com/2.9.0/build/connection/connection-min6719.js?v=421"><\/script>');
		}
	}
	var SESSIONURL = "";
	var SECURITYTOKEN = "guest";
	var IMGDIR_MISC = "images/misc";
	var IMGDIR_BUTTON = "images/buttons";
	var vb_disable_ajax = parseInt("0", 10);
	var SIMPLEVERSION = "421";
	var BBURL = "index.html";
	var LOGGEDIN = 0 > 0 ? true : false;
	var THIS_SCRIPT = "showthread";
	var RELPATH = "showthread535c.html?t=1924&amp;p=7032";
	var PATHS = {
		forum : "",
		cms   : "",
		blog  : ""
	};
	var AJAXBASEURL = "index.html";
// -->
</script>
<script type="text/javascript" src="clientscript/vbulletin-core6719.js?v=421"></script>



	<link rel="alternate" type="application/rss+xml" title="Garage4hackers Forum RSS Feed" href="external9476.php?type=RSS2" />
	
		<link rel="alternate" type="application/rss+xml" title="Garage4hackers Forum - Reverse Engineering and Application Cracking - RSS Feed" href="external2471.php?type=RSS2&amp;forumids=24" />
	



	<link rel="stylesheet" type="text/css" href="css30f2.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=bbcode.css,editor.css,popupmenu.css,reset-fonts.css,vbulletin.css,vbulletin-chrome.css,vbulletin-formcontrols.css," />

	<!--[if lt IE 8]>
	<link rel="stylesheet" type="text/css" href="css.php?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=popupmenu-ie.css,vbulletin-ie.css,vbulletin-chrome-ie.css,vbulletin-formcontrols-ie.css,editor-ie.css" />
	<![endif]-->


	<meta name="keywords" content="function, address, rootkit, pointer, kernel32.dll, array, export, directory, memory, offset, instructions, 004022a4, getsystemdirectorya, environment, block, previous, table, image, process, addressofnames, executable, header, image_nt_header, stack, stores, activateactctx, knowledge, rustock.b, pointers, articles, exported, [ebx+ecx+78], registers, contents, gained, pushad, points, e_lfanew, [ebx+3c], field, image_dos_header, locate, portable, 004020dc, index, inside, insight, [ecx+20], ecx,ebx, internals" />
	<meta name="description" content="This time, we will apply the knowledge gained from my previous articles about IAT, EAT of a PE and also about Process Environment Block. 
 
I have taken the Rustock.B rootkit as an example and this rootkit makes use of a myriad of function APIs exported by kernel32.dll for its working. It has to get the function pointers to memory addresses of these exported Function APIs. And we are going to see how exactly, the rootkit does this. 
 
Knowledge of the previous articles is highly recommended" />

	<title> An insight into OS Internals with Rustock.B Rootkit</title>
	<link rel="canonical" href="showthread8fac.html?t=1924" />
	
	<script type="text/javascript" src="clientscript/vbulletin_textedit6719.html?v=421"></script>
	<script type="text/javascript" src="clientscript/vbulletin_post_loader6719.html?v=421"></script>
	
	
	
	
	
	
		<script type="text/javascript" src="clientscript/vbulletin_lightbox6719.html?v=421"></script>
	

	
		<link rel="stylesheet" type="text/css" href="css8d9b.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=postlist.css,showthread.css,postbit.css,attachment.css,poll.css,lightbox.css" />
	

<link rel="stylesheet" type="text/css" href="css657d.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=additional.css" />

</head>

<body>

<div class="above_body"> <!-- closing tag is in template navbar -->
<div id="header" class="floatcontainer doc_header">
	<div><a name="top" href="forum.html" class="logo-image"><img src="images/misc/vbulletin4_logo.html" alt="Garage4hackers Forum" /></a></div>
	<div id="toplinks" class="toplinks">
		
			<ul class="nouser">
			
				<li><a href="register.html" rel="nofollow">Register</a></li>
			
				<li><a rel="help" href="faq.html">Help</a></li>
				<li>
			<script type="text/javascript" src="clientscript/vbulletin_md56719.html?v=421"></script>
			<form id="navbar_loginform" action="../external.html?link=http://garage4hackers.com/login.php?do=login" method="post" onsubmit="md5hash(vb_login_password, vb_login_md5password, vb_login_md5password_utf, 0)">
				<fieldset id="logindetails" class="logindetails">
					<div>
						<div>
					<input type="text" class="textbox default-value" name="vb_login_username" id="navbar_username" size="10" accesskey="u" tabindex="101" value="User Name" />
					<input type="password" class="textbox" tabindex="102" name="vb_login_password" id="navbar_password" size="10" />
					<input type="text" class="textbox default-value" tabindex="102" name="vb_login_password_hint" id="navbar_password_hint" size="10" value="Password" style="display:none;" />
					<input type="submit" class="loginbutton" tabindex="104" value="Log in" title="Enter your username and password in the boxes provided to login, or click the 'register' button to create a profile for yourself." accesskey="s" />
						</div>
					</div>
				</fieldset>
				<div id="remember" class="remember">
					<label for="cb_cookieuser_navbar"><input type="checkbox" name="cookieuser" value="1" id="cb_cookieuser_navbar" class="cb_cookieuser_navbar" accesskey="c" tabindex="103" /> Remember Me?</label>
				</div>

				<input type="hidden" name="s" value="" />
				<input type="hidden" name="securitytoken" value="guest" />
				<input type="hidden" name="do" value="login" />
				<input type="hidden" name="vb_login_md5password" />
				<input type="hidden" name="vb_login_md5password_utf" />
			</form>
			<script type="text/javascript">
			YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "inline");
			YAHOO.util.Dom.setStyle('navbar_password', "display", "none");
			vB_XHTML_Ready.subscribe(function()
			{
			//
				YAHOO.util.Event.on('navbar_username', "focus", navbar_username_focus);
				YAHOO.util.Event.on('navbar_username', "blur", navbar_username_blur);
				YAHOO.util.Event.on('navbar_password_hint', "focus", navbar_password_hint);
				YAHOO.util.Event.on('navbar_password', "blur", navbar_password);
			});
			
			function navbar_username_focus(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				if (textbox.value == 'User Name')
				{
				//
					textbox.value='';
					textbox.style.color='#000000';
				}
			}

			function navbar_username_blur(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				if (textbox.value == '')
				{
				//
					textbox.value='User Name';
					textbox.style.color='#777777';
				}
			}
			
			function navbar_password_hint(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				
				YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "none");
				YAHOO.util.Dom.setStyle('navbar_password', "display", "inline");
				YAHOO.util.Dom.get('navbar_password').focus();
			}

			function navbar_password(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				
				if (textbox.value == '')
				{
					YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "inline");
					YAHOO.util.Dom.setStyle('navbar_password', "display", "none");
				}
			}
			</script>
				</li>
				
					<li id="fb_headerbox" class="hidden">

	<a id="fb_loginbtn" href="#"><img src="images/misc/facebook_login.html" alt="The Facebook Platform" /></a>

</li>

				
			</ul>
		
	</div>
	<div class="ad_global_header">
		 
		 
	</div>
	<hr />
</div>
<div id="navbar" class="navbar">
	<ul id="navtabs" class="navtabs floatcontainer">
		
		
	
		<li  id="vbtab_whatsnew">
			<a class="navtab" href="activity.html">What's New?</a>
		</li>
		
		

	
		<li  id="vbtab_cms">
			<a class="navtab" href="content.html">Articles</a>
		</li>
		
		

	
		<li class="selected" id="vbtab_forum">
			<a class="navtab" href="forum.html">Forum</a>
		</li>
		
		
			<ul class="floatcontainer">
				
					
						
							<li id="vbflink_newposts"><a href="search8427.html?do=getnew&amp;contenttype=vBForum_Post">New Posts</a></li>
						
					
				
					
						
							<li id="vbflink_faq"><a href="faq.html">FAQ</a></li>
						
					
				
					
						
							<li id="vbflink_calendar"><a href="calendar.html">Calendar</a></li>
						
					
				
					
						<li class="popupmenu" id="vbmenu_community">
							<a href="javascript://" class="popupctrl">Community</a>
							<ul class="popupbody popuphover">
								
									<li id="vbclink_members"><a href="memberlist.html">Member List</a></li>
								
							</ul>
						</li>
					
				
					
						<li class="popupmenu" id="vbmenu_actions">
							<a href="javascript://" class="popupctrl">Forum Actions</a>
							<ul class="popupbody popuphover">
								
									<li id="vbalink_mfr"><a href="forum.html?do=markread&amp;markreadhash=guest">Mark Forums Read</a></li>
								
							</ul>
						</li>
					
				
					
						<li class="popupmenu" id="vbmenu_qlinks">
							<a href="javascript://" class="popupctrl">Quick Links</a>
							<ul class="popupbody popuphover">
								
									<li id="vbqlink_posts"><a href="search2791.html?do=getdaily&amp;contenttype=vBForum_Post">Today's Posts</a></li>
								
									<li id="vbqlink_leaders"><a href="showgroups.html">View Site Leaders</a></li>
								
							</ul>
						</li>
					
				
			</ul>
		

	
		<li  id="vbtab_blog">
			<a class="navtab" href="blog.html">Blogs</a>
		</li>
		
		

	
		<li  id="tab_nja4_357">
			<a class="navtab" href="pages7b82.html?pageid=2">G4H Team</a>
		</li>
		
		

	
		<li  id="tab_nta0_579">
			<a class="navtab" href="pages8782.html?pageid=3">IRC</a>
		</li>
		
		

	
		<li  id="tab_nta0_442">
			<a class="navtab" href="pagesdbe0.html?pageid=4">Ranchoddas</a>
		</li>
		
		

		<li>
            <a class="navtab" href="pages.html">Events and Conferences</a></li>
	</ul>
	
		<div id="globalsearch" class="globalsearch">
			<form action="../external.html?link=http://garage4hackers.com/search.php?do=process" method="post" id="navbar_search" class="navbar_search">
				
				<input type="hidden" name="securitytoken" value="guest" />
				<input type="hidden" name="do" value="process" />
				<span class="textboxcontainer"><span><input type="text" value="" name="query" class="textbox" tabindex="99"/></span></span>
				<span class="buttoncontainer"><span><input type="image" class="searchbutton" src="images/buttons/search.html" name="submit" onclick="document.getElementById('navbar_search').submit;" tabindex="100"/></span></span>
			</form>
			<ul class="navbar_advanced_search">
				<li><a href="search.html" accesskey="4">Advanced Search</a></li>
				
			</ul>
		</div>
	
</div>
</div><!-- closing div for above_body -->

<div class="body_wrapper">
<div id="breadcrumb" class="breadcrumb">
	<ul class="floatcontainer">
		<li class="navbithome"><a href="content.html" accesskey="1"><img src="images/misc/navbit-home.html" alt="Home" /></a></li>
		
	<li class="navbit"><a href="forum.html">Forum</a></li>

	<li class="navbit"><a href="forumdisplayffeb.html?f=20">Experts Forum</a></li>

	<li class="navbit"><a href="forumdisplay345c.html?f=24">Reverse Engineering and Application Cracking</a></li>

		
	<li class="navbit lastnavbit"><span> An insight into OS Internals with Rustock.B Rootkit</span></li>

	</ul>
	<hr />
</div>


<div style="width:728px; margin:0 auto; padding-bottom:1em">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6847984837250662";
google_ad_host = "ca-host-pub-2606800903002383";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al_s";
google_ad_channel = "";
google_color_border = "";
google_color_bg = "";
google_color_link = "";
google_color_text = "";
google_color_url = "";
google_ui_features = "rc:6";
//-->
</script>
<script type="text/javascript"
  src="../pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>

<div id="ad_global_below_navbar"><script async src="../pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- garage1 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:728px;height:90px"
     data-ad-client="ca-pub-6847984837250662"
     data-ad-slot="4036513682"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>


	<form action="../external.html?link=http://garage4hackers.com/profile.php?do=dismissnotice" method="post" id="notices" class="notices">
		<input type="hidden" name="do" value="dismissnotice" />
		<input type="hidden" name="s" value="" />
		<input type="hidden" name="securitytoken" value="guest" />
		<input type="hidden" id="dismiss_notice_hidden" name="dismiss_noticeid" value="" />
		<input type="hidden" name="url" value="" />
		<ol>
			<li class="restore" id="navbar_notice_2">
	
	<html>
<h2>
The forum is <a href="showthread1180.html?t=7049&amp;p=14985#post14985">frozen forever</a> - but it won't die; it'll stay for long in search engine results and we hope it would keep helping newbies in some way or other - cheers! 


</h2>

<!-- Mirrored from garage4hackers.com/showthread.php?t=1924&p=7032 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 18:30:37 GMT -->
</html>
</li>
		</ol>
	</form>





	<div id="above_postlist" class="above_postlist">
		

		<div id="pagination_top" class="pagination_top">
		
			<div id="postpagestats_above" class="postpagestats">
				Results 1 to 5 of 5
			</div>
		</div>
	</div>
<div id="pagetitle" class="pagetitle">
	<h1>
		Thread: <span class="threadtitle"><a href="showthread8fac.html?t=1924" title="Reload this Page">An insight into OS Internals with Rustock.B Rootkit</a></span>

<a class="a2a_dd" href="../external.html?link=http://www.addtoany.com/share_save"><img src="../static.addtoany.com/buttons/share_save_171_16.png" width="171" height="16" border="0" alt="Share/Save - My123World.Com!"/></a><script type="text/javascript">a2a_show_title=1;a2a_num_services=14;</script><script type="text/javascript" src="../static.addtoany.com/menu/page.js"></script>

		
			
<fb:like href="showthread8fac.html?t=1924" font="tahoma" layout="standard" show_faces="false" width="260" action="../external.html?link=http://garage4hackers.com/like" colorscheme="light"></fb:like>
		
	</h1>
</div>
	<div id="thread_controls" class="thread_controls">
		<div>
		<ul id="postlist_popups" class="postlist_popups popupgroup">
			
			<li class="popupmenu" id="threadtools">
				<h6><a class="popupctrl" href="javascript://">Thread Tools</a></h6>
				<ul class="popupbody popuphover">
					<li><a href="printthreaddac0.html?t=1924&amp;pp=10&amp;page=1" accesskey="3" 
						rel="nofollow">Show Printable Version</a></li>
					<li><a href="sendmessage7c8d.html?do=sendtofriend&amp;t=1924"
						rel="nofollow">Email this Page&hellip;</a></li>
					<li>
						
							<a href="subscription8335.html?do=addsubscription&amp;t=1924" 
								rel="nofollow">Subscribe to this Thread&hellip;</a>
											
					</li>
					
				</ul>
			</li>

			

			
				<li class="popupmenu searchthread" id="searchthread">
					<h6><a class="popupctrl" href="javascript://">Search Thread</a></h6>
					<form action="../external.html?link=http://garage4hackers.com/search.php" method="post">
						<ul class="popupbody popuphover">
							<li>
								<input type="text" name="query" class="searchbox" value="Search..." tabindex="13" />
								<input type="submit" class="button" value="Search" tabindex="14" />
							</li>
							<li class="formsubmit">
								<div><a class="advancedsearchlink" href="searchbf4e.html?search_type=1&amp;searchthreadid=1924&amp;contenttype=vBForum_Post">Advanced Search</a></div>
							</li>
						</ul>
						<input type="hidden" name="s" value="" />
						<input type="hidden" name="securitytoken" value="guest" />
						<input type="hidden" name="do" value="process" />
						<input type="hidden" name="searchthreadid" value="1924" />
						<input type="hidden" name="search_type" value="1" />
						<input type="hidden" name="contenttype" value="vBForum_Post" />

					</form>
				</li>
			

			

			
				<li class="popupmenu" id="displaymodes">
					<h6><a class="popupctrl" href="javascript://">Display</a></h6>
					<ul class="popupbody popuphover">
						<li><a href="showthread49e8.html?t=1924&amp;p=7032&amp;mode=linear#post7032"> Switch to Linear Mode</a></li>
						<li><a href="showthreadcfcb.html?t=1924&amp;mode=hybrid"> Switch to Hybrid Mode</a></li>
						<li><label>Threaded Mode</label></li>
					</ul>
				</li>
			

			
		</ul>
		</div>
	</div>

<div id="postlist" class="postlist restrain">
	
		<script type="text/javascript">
<!--
var imgdir_statusicon = "images/statusicon";
var imgdir_misc = "images/misc";
var cleargifurl = "clear.gif";
var guestphrase = "Guest";
var morephrase = "More replies below current depth...";
var highlightwords = "";
//-->
</script>

<script type="text/javascript" src="clientscript/vbulletin_thrdpostlist6719.html?v=421"></script>

<script type="text/javascript">
<!--
// initialize some variables
var curpostid = 7032;
var quickreply = false;

// cached posts (no page reload required to view)
pd[6931] = '\r\n<li class="postbitlegacy postbitim postcontainer old" id="post_6931">\r\n<!-' + '- see bottom of postbit.css for .userinfo .popupmenu styles -' + '->\r\n\r\n	<div class="posthead">\r\n			<span class="postdate old">\r\n				\r\n					<span class="date">01-16-2012,&nbsp;<span class="time">08:53 PM</span></span>\r\n				\r\n			</span>\r\n			<span class="nodecontrols">\r\n				\r\n					<a name="post6931" href="showthread.php?t=1924&amp;p=6931&amp;viewfull=1#post6931" class="postcounter">#1</a><a id="postcount6931" name="1"></a>\r\n				\r\n				\r\n				\r\n			</span>\r\n	</div>\r\n	<div class="postdetails">\r\n		<div class="userinfo">\r\n			<div class="username_container">\r\n			\r\n				<div class="popupmenu memberaction">\r\n	<a class="username offline popupctrl" href="member.php?u=311" title="c0d3inj3cT is offline"><strong>c0d3inj3cT</strong></a>\r\n	<ul class="popupbody popuphover memberaction_body">\r\n		<li class="left">\r\n			<a href="member.php?u=311" class="siteicon_profile">\r\n				View Profile\r\n			</a>\r\n		</li>\r\n		\r\n		<li class="right">\r\n			<a href="search.php?do=finduser&amp;userid=311&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">\r\n				View Forum Posts\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="private.php?do=newpm&amp;u=311" class="siteicon_message" rel="nofollow">\r\n				Private Message\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="blog.php?u=311" class="siteicon_blog" rel="nofollow">\r\n				View Blog Entries\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="http://garage4hackers.com/list.php?r=author/311-c0d3inj3cT" class="siteicon_article" rel="nofollow">\r\n				View Articles\r\n			</a>\r\n		</li>\r\n		\r\n\r\n		\r\n\r\n		\r\n		\r\n	</ul>\r\n</div>\r\n				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.png" alt="c0d3inj3cT is offline" border="0" />\r\n\r\n			\r\n			</div>\r\n			<span class="usertitle">\r\n				Garage Member\r\n			</span>\r\n			\r\n			\r\n			\r\n				<span class="postbit_reputation" id="repdisplay_6931_311" title="c0d3inj3cT will become famous soon enough">\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n				</span>\r\n			\r\n			 \r\n			\r\n				<hr />\r\n				<dl class="userinfo_extra">\r\n					<dt>Join Date</dt> <dd>Dec 2010</dd>\r\n					\r\n					\r\n					<dt>Posts</dt> <dd>67</dd>	\r\n					<dt>Blog Entries</dt><dd><a href="blog.php?u=311">2</a></dd>\r\n				</dl>\r\n				\r\n				\r\n				<div class="imlinks">\r\n					    \r\n				</div>\r\n			\r\n		</div>\r\n		<div class="postbody">\r\n			<div class="postrow has_after_content">\r\n				\r\n				\r\n				<h2 class="title icon">\r\n					An insight into OS Internals with Rustock.B Rootkit\r\n				</h2>\r\n				\r\n\r\n\r\n						\r\n						\r\n				<div class="content">\r\n					<div id="post_message_6931">\r\n						<blockquote class="postcontent restore ">\r\n							This time, we will apply the knowledge gained from my previous articles about IAT, EAT of a PE and also about Process Environment Block.<br />\n<br />\nI have taken the <b>Rustock.B</b> rootkit as an example and this rootkit makes use of a myriad of function APIs exported by kernel32.dll for its working. It has to get the function pointers to memory addresses of these exported Function APIs. And we are going to see how exactly, the rootkit does this.<br />\n<br />\nKnowledge of the previous articles is highly recommended before you read further.<br />\n<br />\nI have added my comments to the assembly language instructions to make it easier for you to understand.<br />\n<br />\nAfter unpacking the rootkit, this is what we see:<br />\n<br />\n<b>Function I:</b><br />\n<br />\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:132px;">pop ebp\nsub ebp, 9\nmov eax, fs:[30]    ; Pointer to Process Environment Block    \nmov eax, [eax+c]    ; Pointer to _PEB_LDR_DATA structure\nmov eax, [eax+1c]    ; Pointer to InInitializationOrderModuleList.Flink\nmov eax, [eax]        ; The second entry\nmov eax, [eax+8]    ; The base address of kernel32.dll\nlea esi, [ebp+722]    ; At memory address, 004022A4, we have the function name GetSystemDirectoryA\nlea edi, [ebp+893]    ; 00402415</pre>\r\n</div>The above set of instructions will grab a pointer to <b>Process Environment Block</b> and then use it to find the base address of kernel32.dll. I have covered this in detail in my previous article.<br />\n<br />\nAlso, in the above instructions, we have grabbed the name of Function API, <b>GetSystemDirectoryA</b> from memory location, 004022A4. The Rootkit stores the array of names of all the Function APIs which it uses, at memory address, 004022A4 as shown in the screenshot below.<br />\n<br />\n<div class="img_align_center "><a href="http://garage4hackers.com/attachment.php?attachmentid=181&amp;d=1326727076" id="attachment181" rel="Lightbox_6931" ><img src="http://garage4hackers.com/attachment.php?attachmentid=181&amp;d=1326727076" border="0" alt="Click image for larger version.&nbsp;\r\n\r\nName:	Malware Function API Names.jpg&nbsp;\r\nViews:	588&nbsp;\r\nSize:	99.4 KB&nbsp;\r\nID:	181" class="align_center size_large" /></a></div><br />\n<br />\nThen it parses this list and grabs the function pointers to each of the above APIs and stores them in another array.<br />\n<br />\n<b>Function II:</b><br />\n<br />\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:168px;">1. pushad                    ; save the contents of all the registers on the stack\n2. mov ebx, eax            ; kernel32.dll base address is placed in ebx\n3. mov ecx, [ebx+3c]        ; e_lfanew field in the IMAGE_DOS_HEADER of the executable is at offset 0x3c and it points to the PE header\n4. mov ecx, [ebx+ecx+78]    ; at offset 78h from IMAGE_NT_HEADER, we have the RVA of Export Directory Table of kernel32.dll\n5. add ecx,ebx            ; add image base address\n6. mov edx, [ecx+20]        ; At offset 20h in the Export Directory table, we have the RVA of AddressOfNames array\n7. add edx, ebx            ; add the image base address\n8. mov edi, [edx]        ; move the RVA of first function name in kernel32.dll in edi\n9. add edi, ebx            ; add the image base address\na. push edi            ; push the First Function Name, ActivateActCtx to the stack\nb. push -1            \nc. call 004020dc</pre>\r\n</div>In the above set of instructions, we have used the <b>IMAGE_NT_HEADER</b> to locate the Export Data Directory of the Rootkit. In a Portable Executable you can find the Export Table at Offset 0x78 from the PE File Header.<br />\n<br />\nWe have got a pointer to the first function name in the <b>AddressOfNames</b> array inside the Export Directory. This function name is, ActivateActCtx.<br />\n<br />\nWe have to find the function pointer to GetSystemDirectoryA. To do this, we have to first find out the index of API function in the AddressOfNames Array in EAT.\r\n						</blockquote>\r\n					</div>\r\n\r\n					\r\n				</div>\r\n			</div>\r\n			\r\n			<div class="after_content">\r\n				\r\n				<!-' + '- edit note -' + '->\r\n				<blockquote class="postcontent lastedited">\r\n					\r\n						Last edited by c0d3inj3cT; 01-16-2012 at <span class="time">09:54 PM</span>.\r\n					\r\n					\r\n				</blockquote>\r\n				<!-' + '- / edit note -' + '->\r\n				\r\n				\r\n				\r\n				\r\n				\r\n			</div>\r\n			\r\n			<div class="cleardiv"></div>\r\n		</div>\r\n	</div>\r\n		<div class="postfoot">\r\n			<!-' + '- <div class="postfoot_container"> -' + '->\r\n			<div class="textcontrols floatcontainer">\r\n				<span class="postcontrols">\r\n					<img style="display:none" id="progress_6931" src="images/misc/progress.gif" alt="" />\r\n					\r\n					\r\n					\r\n						<a id="qrwq_6931" class="newreply" href="newreply.php?do=newreply&amp;p=6931" rel="nofollow" title="Reply With Quote"><img id="quoteimg_6931" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> \r\n					\r\n					\r\n					\r\n				</span>\r\n				<span class="postlinking">\r\n					\r\n						\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n\r\n					\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n					\r\n				</span>\r\n			<!-' + '- </div> -' + '->\r\n			</div>\r\n		</div>\r\n	<hr />\r\n</li>\r\n';
pd[6932] = '\r\n<li class="postbitlegacy postbitim postcontainer old" id="post_6932">\r\n<!-' + '- see bottom of postbit.css for .userinfo .popupmenu styles -' + '->\r\n\r\n	<div class="posthead">\r\n			<span class="postdate old">\r\n				\r\n					<span class="date">01-16-2012,&nbsp;<span class="time">08:59 PM</span></span>\r\n				\r\n			</span>\r\n			<span class="nodecontrols">\r\n				\r\n					<a name="post6932" href="showthread.php?t=1924&amp;p=6932&amp;viewfull=1#post6932" class="postcounter">#2</a><a id="postcount6932" name="2"></a>\r\n				\r\n				\r\n				\r\n			</span>\r\n	</div>\r\n	<div class="postdetails">\r\n		<div class="userinfo">\r\n			<div class="username_container">\r\n			\r\n				<div class="popupmenu memberaction">\r\n	<a class="username offline popupctrl" href="member.php?u=311" title="c0d3inj3cT is offline"><strong>c0d3inj3cT</strong></a>\r\n	<ul class="popupbody popuphover memberaction_body">\r\n		<li class="left">\r\n			<a href="member.php?u=311" class="siteicon_profile">\r\n				View Profile\r\n			</a>\r\n		</li>\r\n		\r\n		<li class="right">\r\n			<a href="search.php?do=finduser&amp;userid=311&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">\r\n				View Forum Posts\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="private.php?do=newpm&amp;u=311" class="siteicon_message" rel="nofollow">\r\n				Private Message\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="blog.php?u=311" class="siteicon_blog" rel="nofollow">\r\n				View Blog Entries\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="http://garage4hackers.com/list.php?r=author/311-c0d3inj3cT" class="siteicon_article" rel="nofollow">\r\n				View Articles\r\n			</a>\r\n		</li>\r\n		\r\n\r\n		\r\n\r\n		\r\n		\r\n	</ul>\r\n</div>\r\n				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.png" alt="c0d3inj3cT is offline" border="0" />\r\n\r\n			\r\n			</div>\r\n			<span class="usertitle">\r\n				Garage Member\r\n			</span>\r\n			\r\n			\r\n			\r\n				<span class="postbit_reputation" id="repdisplay_6932_311" title="c0d3inj3cT will become famous soon enough">\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n				</span>\r\n			\r\n			 \r\n			\r\n				<hr />\r\n				<dl class="userinfo_extra">\r\n					<dt>Join Date</dt> <dd>Dec 2010</dd>\r\n					\r\n					\r\n					<dt>Posts</dt> <dd>67</dd>	\r\n					<dt>Blog Entries</dt><dd><a href="blog.php?u=311">2</a></dd>\r\n				</dl>\r\n				\r\n				\r\n				<div class="imlinks">\r\n					    \r\n				</div>\r\n			\r\n		</div>\r\n		<div class="postbody">\r\n			<div class="postrow">\r\n				\r\n				\r\n\r\n\r\n						\r\n						\r\n				<div class="content">\r\n					<div id="post_message_6932">\r\n						<blockquote class="postcontent restore ">\r\n							<b>Function III:</b><br />\n<br />\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:192px;">1. pushad            ; save the contents of registers to the stack\n2. xor edx, edx            ; clear the contents of edx. edx will store the index number of the API in the AddressOfNames array\n3. push esi            ; push the name of the function to the stack\n4. cmp byte ptr [esi], 0    ; check whether the current byte is null or not\n5. je short 004020f2        ; if the byte is 0 then exit the function\n6. cmps byte ptr [esi], byte ptr es:[edi]    ; compare the strings pointed to by esi and edi, byte by byte\n7. je short 004020e0        ; if the byte matches then compare the next byte\n8. inc edx            ; increment the counter\n9. xor eax, eax            ; clear the eax register which is used to check for string termination\na. dec edi            ; set the edi register to point to the API name\nb. scas byte ptr es:[edi]    ; compare the byte pointed to by edi with al register. in other words, compare the current char with null byte\nc. jnz short 004020ec        ; keep checking till null byte is reached. at the end of this loop, we will have the next API name pointer in the edi register\nd. pop esi            ; store the function name in the esi register\ne. jmp short 004020df        ; check with the next function name in the AddressOfNames array</pre>\r\n</div>The above set of instructions will walk through the AddressOfNames array of kernel32.dll\'s Export Directory till it locates the function API whose address we want to find. In our case, GetSystemDirectoryA function.<br />\n<br />\nAt the end of the above function, edx register will have the index of the Function API whose address we are trying to find.<br />\n<br />\n<b>Function IV:</b><br />\n<br />\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:96px;">1. inc esi            ; point esi to the next function name whose address we have to fetch\n2. mov [esp+8], esi        ; store this function name on the stack\n3. mov [esp+20], edx        ; store the index number of function API on the stack\n4. pop eax            ; eax is set to function API name\n5. popad            ; restore all the registers using the stack contents\n6. ret</pre>\r\n</div>At the end of the above set of instructions, we have the following stack layout.<br />\n<br />\neax: index number of function API in the AddressOfNames array<br />\necx: virtual address of kernel32.dll\'s export address table<br />\nedx: <br />\nebx: base address of kernel32.dll<br />\nesp: stack pointer<br />\nebp: base pointer<br />\nesi: pointer to next function name whose address we have to find<br />\nedi: pointer to the first function name in kernel32.dll\'s EAT\'s AddressOfNames array<br />\n<br />\n<b>Function V:</b><br />\n<br />\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:252px;">1. pop edi                ; store FFFFFFFF in the edi register\n2. inc edi                ; set edi to 0 and therefore initialize the counter\n3. push edi                ; save it to stack\n4. mov edx, [ecx+24]            ; store the RVA of AddressOfOrdinals array of Export Directory. It is at offset, 0x24 from the base address of Export Directory\n5. add edx, ebx                ; add the base address of kernel32.dll to this RVA to get the Virtual Address of AddressOfOrdinals Array\n6. movzx edx, word ptr [edx+eax*2]    ; using index of function name from AddressOfNames array, we get the corresponding ordinal from AddressOfOrdinals array. store     \n\n                        in edx\n7. mov eax, [ecx+1c]            ; store the RVA of AddressOfFunctions array of Export Directory which is at offset 0x1c from base of EAT in eax.    \n8. add eax, ebx                ; add the base address of kernel32.dll to eax to get the VA of AddressOfFunctions array\n9. mov eax, [eax+edx*4]            ; using the ordinal of function api from AddressOfOrdinals array, we get the RVA from AddressOfFunctions array and store in eax\na. add eax, ebx                ; add base address of kernel32.dll to the above RVA to get the Virtual Address of Function API\nb. push esi                ; push the next function name whose address we have to find to the stack\nc. mov esi, [esp+c]            ; get the pointer to the internal table where the malware stores the function pointers to different APIs\nd. mov [esi+edi*4], eax            ; store the function API virtual address in the malware\'s function pointer table\ne. pop esi                ; store the next function API\'s name back in esi\nf. mov edi, [esp+4]            ; point edi to the first function name in the AddressOfNames array\n10. cmp byte ptr [esi],0        ; check whether esi is pointing to null byte or not\n11. jnz short 004020aa            ; if esi is pointing to a function name then repeat the entire process to find its virtual address</pre>\r\n</div>As you can see, the rootkit maintains a table of function Pointers at the memory address, 00402415, which initially looks like this:<br />\n<br />\n<div class="img_align_center "><a href="http://garage4hackers.com/attachment.php?attachmentid=182&amp;d=1326727662" id="attachment182" rel="Lightbox_6932" ><img src="http://garage4hackers.com/attachment.php?attachmentid=182&amp;d=1326727662" border="0" alt="Click image for larger version.&nbsp;\r\n\r\nName:	Malware Pointer Table I.jpg&nbsp;\r\nViews:	563&nbsp;\r\nSize:	98.1 KB&nbsp;\r\nID:	182" class="align_center size_large" /></a></div><br />\n<br />\nAfter running through the above loop multiple times, this table is filled with the function pointers to all the APIs which the rootkit will be using:<br />\n<br />\n<div class="img_align_center "><a href="http://garage4hackers.com/attachment.php?attachmentid=183&amp;d=1326727690" id="attachment183" rel="Lightbox_6932" ><img src="http://garage4hackers.com/attachment.php?attachmentid=183&amp;d=1326727690" border="0" alt="Click image for larger version.&nbsp;\r\n\r\nName:	Malware Pointer Table II.jpg&nbsp;\r\nViews:	509&nbsp;\r\nSize:	96.5 KB&nbsp;\r\nID:	183" class="align_center size_large" /></a></div>\r\n						</blockquote>\r\n					</div>\r\n\r\n					\r\n				</div>\r\n			</div>\r\n			\r\n			<div class="cleardiv"></div>\r\n		</div>\r\n	</div>\r\n		<div class="postfoot">\r\n			<!-' + '- <div class="postfoot_container"> -' + '->\r\n			<div class="textcontrols floatcontainer">\r\n				<span class="postcontrols">\r\n					<img style="display:none" id="progress_6932" src="images/misc/progress.gif" alt="" />\r\n					\r\n					\r\n					\r\n						<a id="qrwq_6932" class="newreply" href="newreply.php?do=newreply&amp;p=6932" rel="nofollow" title="Reply With Quote"><img id="quoteimg_6932" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> \r\n					\r\n					\r\n					\r\n				</span>\r\n				<span class="postlinking">\r\n					\r\n						\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n\r\n					\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n					\r\n				</span>\r\n			<!-' + '- </div> -' + '->\r\n			</div>\r\n		</div>\r\n	<hr />\r\n</li>\r\n';
pd[6933] = '\r\n<li class="postbitlegacy postbitim postcontainer old" id="post_6933">\r\n<!-' + '- see bottom of postbit.css for .userinfo .popupmenu styles -' + '->\r\n\r\n	<div class="posthead">\r\n			<span class="postdate old">\r\n				\r\n					<span class="date">01-16-2012,&nbsp;<span class="time">09:02 PM</span></span>\r\n				\r\n			</span>\r\n			<span class="nodecontrols">\r\n				\r\n					<a name="post6933" href="showthread.php?t=1924&amp;p=6933&amp;viewfull=1#post6933" class="postcounter">#3</a><a id="postcount6933" name="3"></a>\r\n				\r\n				\r\n				\r\n			</span>\r\n	</div>\r\n	<div class="postdetails">\r\n		<div class="userinfo">\r\n			<div class="username_container">\r\n			\r\n				<div class="popupmenu memberaction">\r\n	<a class="username offline popupctrl" href="member.php?u=311" title="c0d3inj3cT is offline"><strong>c0d3inj3cT</strong></a>\r\n	<ul class="popupbody popuphover memberaction_body">\r\n		<li class="left">\r\n			<a href="member.php?u=311" class="siteicon_profile">\r\n				View Profile\r\n			</a>\r\n		</li>\r\n		\r\n		<li class="right">\r\n			<a href="search.php?do=finduser&amp;userid=311&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">\r\n				View Forum Posts\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="private.php?do=newpm&amp;u=311" class="siteicon_message" rel="nofollow">\r\n				Private Message\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="blog.php?u=311" class="siteicon_blog" rel="nofollow">\r\n				View Blog Entries\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="http://garage4hackers.com/list.php?r=author/311-c0d3inj3cT" class="siteicon_article" rel="nofollow">\r\n				View Articles\r\n			</a>\r\n		</li>\r\n		\r\n\r\n		\r\n\r\n		\r\n		\r\n	</ul>\r\n</div>\r\n				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.png" alt="c0d3inj3cT is offline" border="0" />\r\n\r\n			\r\n			</div>\r\n			<span class="usertitle">\r\n				Garage Member\r\n			</span>\r\n			\r\n			\r\n			\r\n				<span class="postbit_reputation" id="repdisplay_6933_311" title="c0d3inj3cT will become famous soon enough">\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n				</span>\r\n			\r\n			 \r\n			\r\n				<hr />\r\n				<dl class="userinfo_extra">\r\n					<dt>Join Date</dt> <dd>Dec 2010</dd>\r\n					\r\n					\r\n					<dt>Posts</dt> <dd>67</dd>	\r\n					<dt>Blog Entries</dt><dd><a href="blog.php?u=311">2</a></dd>\r\n				</dl>\r\n				\r\n				\r\n				<div class="imlinks">\r\n					    \r\n				</div>\r\n			\r\n		</div>\r\n		<div class="postbody">\r\n			<div class="postrow">\r\n				\r\n				\r\n\r\n\r\n						\r\n						\r\n				<div class="content">\r\n					<div id="post_message_6933">\r\n						<blockquote class="postcontent restore ">\r\n							Now, we will understand the above set of instructions much better using Windbg.<br />\r\n<br />\r\nI will take <b>AddConsoleAliasA</b> as an example. By Walking through the above functions, I will highlight, how the assembly language code is working.<br />\r\n<br />\r\nI will not go into the details of Function I, since it is already covered in previous article.<br />\r\n<br />\r\nIn Function II,<br />\r\n<br />\r\nebx = kernel32.dll base address<br />\r\n<br />\r\nI will check the value at offset 3c from the base.<br />\r\n<br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:48px;">0:001&gt; dd 7c800000+3c\r\n7c80003c  000000f0 0eba1f0e cd09b400 4c01b821</pre>\r\n</div>So, the value is f0.<br />\r\n<br />\r\nThis is the offset of the PE File Header from the base address of kernel32.dll<br />\r\n<br />\r\nNext, I will read the PE File Header by adding this offset to the base address,<br />\r\n<br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:48px;">0:001&gt; dc 7c800000+f0\r\n7c8000f0  00004550 0004014c 49c4f2bb 00000000  PE..L......I....</pre>\r\n</div>As can be seen, we have the PE File Header  at the offset f0 from the base address of kernel32.dll. This marks the beginning of PE File Header.<br />\r\n<br />\r\nLet\'s view this header now,<br />\r\n<br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:372px;">0:001&gt; !dh kernel32 -f\r\n\r\nFile Type: DLL\r\nFILE HEADER VALUES\r\n     14C machine (i386)\r\n       4 number of sections\r\n49C4F2BB time date stamp Sat Mar 21 19:29:23 2009\r\n\r\n       0 file pointer to symbol table\r\n       0 number of symbols\r\n      E0 size of optional header\r\n    210E characteristics\r\n            Executable\r\n            Line numbers stripped\r\n            Symbols stripped\r\n            32 bit word machine\r\n            DLL\r\n\r\nOPTIONAL HEADER VALUES\r\n     10B magic #\r\n    7.10 linker version\r\n   83A00 size of code\r\n   70400 size of initialized data\r\n       0 size of uninitialized data\r\n    B64E address of entry point\r\n    1000 base of code\r\n         -' + '-' + '-' + '-' + '- new -' + '-' + '-' + '-' + '-\r\n7c800000 image base\r\n    1000 section alignment\r\n     200 file alignment\r\n       3 subsystem (Windows CUI)\r\n    5.01 operating system version\r\n    5.01 image version\r\n    4.00 subsystem version\r\n   F6000 size of image\r\n     400 size of headers\r\n   F8F85 checksum\r\n00040000 size of stack reserve\r\n00001000 size of stack commit\r\n00100000 size of heap reserve\r\n00001000 size of heap commit\r\n       0  DLL characteristics\r\n    262C [    6D19] address [size] of Export Directory\r\n   81EB4 [      28] address [size] of Import Directory\r\n   8A000 [   65EE8] address [size] of Resource Directory\r\n       0 [       0] address [size] of Exception Directory\r\n       0 [       0] address [size] of Security Directory\r\n   F0000 [    5CA0] address [size] of Base Relocation Directory\r\n   847A4 [      38] address [size] of Debug Directory\r\n       0 [       0] address [size] of Description Directory\r\n       0 [       0] address [size] of Special Directory\r\n       0 [       0] address [size] of Thread Storage Directory\r\n   4E600 [      40] address [size] of Load Configuration Directory\r\n       0 [       0] address [size] of Bound Import Directory\r\n    1000 [     624] address [size] of Import Address Table Directory\r\n       0 [       0] address [size] of Delay Import Directory\r\n       0 [       0] address [size] of COR20 Header Directory\r\n       0 [       0] address [size] of Reserved Directory</pre>\r\n</div>From this we can see that the Export Directory is at RVA, 262C from the base address.<br />\r\n<br />\r\nIn the Function II above, we are reaching the Export Directory by reading address at offset, 0x78 from the PE File Header.<br />\r\n<br />\r\nSo, let\'s check that,<br />\r\n<br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:60px;">0:001&gt; dd 7c8000f0+78\r\n7c800168  0000262c 00006d19 00081eb4 00000028\r\n7c800178  0008a000 00065ee8 00000000 00000000</pre>\r\n</div>As can be seen, the value at offset 0x78 is, 262C which is the RVA of Export Directory.<br />\r\n<br />\r\nLet\'s dump the export directory.<br />\r\n<br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:72px;">0:001&gt; dd 7c800000+0000262c\r\n7c80262c  00000000 49c4ce3f 00000000 00004b98\r\n7c80263c  00000001 000003ba 000003ba 00002654\r\n7c80264c  0000353c 00004424 0000a6e4 000354ed</pre>\r\n</div>I showed in my previous article that how we can traverse this data and compare it with the IMAGE_EXPORT_DIRECTORY structure to get the RVAs of the 3 arrays.<br />\r\n<br />\r\nIn the function II above, we have read the RVA at offset 0x20 from the Export Directory Base.<br />\r\n<br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:72px;">0:001&gt; dd 7c800000+0000262c+20\r\n7c80264c  0000353c 00004424 0000a6e4 000354ed\r\n7c80265c  000326c1 0007241f 000723e1 000593fa\r\n7c80266c  000592de 0002bf11 00009011 00072a71</pre>\r\n</div>The value is 353c and this is the RVA of AddressOfNames array.<br />\r\n<br />\r\nLet\'s view the contents of this array,<br />\r\n<br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:72px;">0:001&gt; dd 7c800000+0000353c\r\n7c80353c  00004ba5 00004bb4 00004bbd 00004bc6\r\n7c80354c  00004bd7 00004be8 00004c07 00004c26\r\n7c80355c  00004c33 00004c4f 00004c5c 00004c76</pre>\r\n</div>In instruction 8,9 and 10, we are moving the RVA of first function name, adding base address of kernel32.dll to it and then pushing the string found at that address to the stack.<br />\r\n<br />\r\nLet\'s view this string,<br />\r\n<br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:48px;">0:001&gt; da 7c800000+00004ba5\r\n7c804ba5  &quot;ActivateActCtx&quot;</pre>\r\n</div>This is the first function name in the array.\r\n						</blockquote>\r\n					</div>\r\n\r\n					\r\n				</div>\r\n			</div>\r\n			\r\n			<div class="cleardiv"></div>\r\n		</div>\r\n	</div>\r\n		<div class="postfoot">\r\n			<!-' + '- <div class="postfoot_container"> -' + '->\r\n			<div class="textcontrols floatcontainer">\r\n				<span class="postcontrols">\r\n					<img style="display:none" id="progress_6933" src="images/misc/progress.gif" alt="" />\r\n					\r\n					\r\n					\r\n						<a id="qrwq_6933" class="newreply" href="newreply.php?do=newreply&amp;p=6933" rel="nofollow" title="Reply With Quote"><img id="quoteimg_6933" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> \r\n					\r\n					\r\n					\r\n				</span>\r\n				<span class="postlinking">\r\n					\r\n						\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n\r\n					\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n					\r\n				</span>\r\n			<!-' + '- </div> -' + '->\r\n			</div>\r\n		</div>\r\n	<hr />\r\n</li>\r\n';
pd[6934] = '\r\n<li class="postbitlegacy postbitim postcontainer old" id="post_6934">\r\n<!-' + '- see bottom of postbit.css for .userinfo .popupmenu styles -' + '->\r\n\r\n	<div class="posthead">\r\n			<span class="postdate old">\r\n				\r\n					<span class="date">01-16-2012,&nbsp;<span class="time">09:04 PM</span></span>\r\n				\r\n			</span>\r\n			<span class="nodecontrols">\r\n				\r\n					<a name="post6934" href="showthread.php?t=1924&amp;p=6934&amp;viewfull=1#post6934" class="postcounter">#4</a><a id="postcount6934" name="4"></a>\r\n				\r\n				\r\n				\r\n			</span>\r\n	</div>\r\n	<div class="postdetails">\r\n		<div class="userinfo">\r\n			<div class="username_container">\r\n			\r\n				<div class="popupmenu memberaction">\r\n	<a class="username offline popupctrl" href="member.php?u=311" title="c0d3inj3cT is offline"><strong>c0d3inj3cT</strong></a>\r\n	<ul class="popupbody popuphover memberaction_body">\r\n		<li class="left">\r\n			<a href="member.php?u=311" class="siteicon_profile">\r\n				View Profile\r\n			</a>\r\n		</li>\r\n		\r\n		<li class="right">\r\n			<a href="search.php?do=finduser&amp;userid=311&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">\r\n				View Forum Posts\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="private.php?do=newpm&amp;u=311" class="siteicon_message" rel="nofollow">\r\n				Private Message\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="blog.php?u=311" class="siteicon_blog" rel="nofollow">\r\n				View Blog Entries\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="http://garage4hackers.com/list.php?r=author/311-c0d3inj3cT" class="siteicon_article" rel="nofollow">\r\n				View Articles\r\n			</a>\r\n		</li>\r\n		\r\n\r\n		\r\n\r\n		\r\n		\r\n	</ul>\r\n</div>\r\n				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.png" alt="c0d3inj3cT is offline" border="0" />\r\n\r\n			\r\n			</div>\r\n			<span class="usertitle">\r\n				Garage Member\r\n			</span>\r\n			\r\n			\r\n			\r\n				<span class="postbit_reputation" id="repdisplay_6934_311" title="c0d3inj3cT will become famous soon enough">\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n				</span>\r\n			\r\n			 \r\n			\r\n				<hr />\r\n				<dl class="userinfo_extra">\r\n					<dt>Join Date</dt> <dd>Dec 2010</dd>\r\n					\r\n					\r\n					<dt>Posts</dt> <dd>67</dd>	\r\n					<dt>Blog Entries</dt><dd><a href="blog.php?u=311">2</a></dd>\r\n				</dl>\r\n				\r\n				\r\n				<div class="imlinks">\r\n					    \r\n				</div>\r\n			\r\n		</div>\r\n		<div class="postbody">\r\n			<div class="postrow">\r\n				\r\n				\r\n\r\n\r\n						\r\n						\r\n				<div class="content">\r\n					<div id="post_message_6934">\r\n						<blockquote class="postcontent restore ">\r\n							We have to find the function pointer to <b>AddConsoleAliasA </b>function.<br />\r\n<br />\r\nNow, let\'s analyze Function III,<br />\r\n<br />\r\nIn function III, we traverse the <b>AddressOfNames</b> array, take each RVA and add it to the base address of kernel32.dll. The Function Name at that address is compared with AddConsoleAliasA. This loop is repeated till the matching RVA is found. A counter is incremented everytime the loop is executed and this is stored in edx.<br />\r\n<br />\r\nSo, after running this loop and searching for AddConsoleAliasA function, we get the value in edx as 3. <br />\r\n<br />\r\nLet\'s analyze function V,<br />\r\n<br />\r\nhere ecx register will have the Export Directory Table base address, 7c80262c<br />\r\n<br />\r\nAt offset 0x24 from this address we have the RVA of AddressOfOrdinals array.<br />\r\n<br />\r\nlet\'s check it,<br />\r\n<br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:72px;">0:001&gt; dd 7c80262c+24\r\n7c802650  00004424 0000a6e4 000354ed 000326c1\r\n7c802660  0007241f 000723e1 000593fa 000592de\r\n7c802670  0002bf11 00009011 00072a71 0005fcb4</pre>\r\n</div>So, base address of the array is, 7c804424<br />\r\n<br />\r\nIn instruction 6, we use the index from AddressOfNames array and read the corresponding word from the AddressOfOrdinals array. This gives us, 0x03.<br />\r\n<br />\r\nIn instruction 7, I read the RVA of AddressOfFunctions array which is at offset 0x1c from the Export Directory\'s base address as shown below,<br />\r\n<br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:72px;">0:001&gt; dd 7c80262c+1c\r\n7c802648  00002654 0000353c 00004424 0000a6e4\r\n7c802658  000354ed 000326c1 0007241f 000723e1\r\n7c802668  000593fa 000592de 0002bf11 00009011</pre>\r\n</div>So, the base address of AddressOfFunctions Array is: 7c802654<br />\r\n<br />\r\nLet\'s view this array,<br />\r\n<br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:72px;">0:001&gt; dd 7c802654\r\n7c802654  0000a6e4 000354ed 000326c1 0007241f\r\n7c802664  000723e1 000593fa 000592de 0002bf11\r\n7c802674  00009011 00072a71 0005fcb4 0003594f</pre>\r\n</div>We use the AddressOfOrdinals index and parse this array in steps of 4 bytes till index 0x3. This gives us the RVA of AddConsoleAliasA function as 0007241f<br />\r\n<br />\r\nSo, the base address of AddConsoleAliasA is: 7c800000+0007241f = 7c87241f<br />\r\n<br />\r\nLet us verify the function name at this memory address,<br />\r\n<br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:48px;">0:001&gt; ln 7c87241f\r\n(7c87241f)   kernel32!AddConsoleAliasA</pre>\r\n</div>In this way, we saw a realistic application of the method to find base address of a function API by analyzing the rootkit.\r\n						</blockquote>\r\n					</div>\r\n\r\n					\r\n				</div>\r\n			</div>\r\n			\r\n			<div class="cleardiv"></div>\r\n		</div>\r\n	</div>\r\n		<div class="postfoot">\r\n			<!-' + '- <div class="postfoot_container"> -' + '->\r\n			<div class="textcontrols floatcontainer">\r\n				<span class="postcontrols">\r\n					<img style="display:none" id="progress_6934" src="images/misc/progress.gif" alt="" />\r\n					\r\n					\r\n					\r\n						<a id="qrwq_6934" class="newreply" href="newreply.php?do=newreply&amp;p=6934" rel="nofollow" title="Reply With Quote"><img id="quoteimg_6934" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> \r\n					\r\n					\r\n					\r\n				</span>\r\n				<span class="postlinking">\r\n					\r\n						\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n\r\n					\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n					\r\n				</span>\r\n			<!-' + '- </div> -' + '->\r\n			</div>\r\n		</div>\r\n	<hr />\r\n</li>\r\n';
pd[7032] = '\r\n<li class="postbitlegacy postbitim postcontainer old" id="post_7032">\r\n<!-' + '- see bottom of postbit.css for .userinfo .popupmenu styles -' + '->\r\n\r\n	<div class="posthead">\r\n			<span class="postdate old">\r\n				\r\n					<span class="date">02-02-2012,&nbsp;<span class="time">12:20 AM</span></span>\r\n				\r\n			</span>\r\n			<span class="nodecontrols">\r\n				\r\n					<a name="post7032" href="showthread.php?t=1924&amp;p=7032&amp;viewfull=1#post7032" class="postcounter">#5</a><a id="postcount7032" name="5"></a>\r\n				\r\n				\r\n				\r\n			</span>\r\n	</div>\r\n	<div class="postdetails">\r\n		<div class="userinfo">\r\n			<div class="username_container">\r\n			\r\n				<div class="popupmenu memberaction">\r\n	<a class="username offline popupctrl" href="member.php?u=17" title="DouBle_Zer0 is offline"><strong>DouBle_Zer0</strong></a>\r\n	<ul class="popupbody popuphover memberaction_body">\r\n		<li class="left">\r\n			<a href="member.php?u=17" class="siteicon_profile">\r\n				View Profile\r\n			</a>\r\n		</li>\r\n		\r\n		<li class="right">\r\n			<a href="search.php?do=finduser&amp;userid=17&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">\r\n				View Forum Posts\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="private.php?do=newpm&amp;u=17" class="siteicon_message" rel="nofollow">\r\n				Private Message\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="blog.php?u=17" class="siteicon_blog" rel="nofollow">\r\n				View Blog Entries\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="http://garage4hackers.com/list.php?r=author/17-DouBle_Zer0" class="siteicon_article" rel="nofollow">\r\n				View Articles\r\n			</a>\r\n		</li>\r\n		\r\n\r\n		\r\n\r\n		\r\n		\r\n	</ul>\r\n</div>\r\n				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.png" alt="DouBle_Zer0 is offline" border="0" />\r\n\r\n			\r\n			</div>\r\n			<span class="usertitle">\r\n				Security Researcher\r\n			</span>\r\n			\r\n			\r\n			\r\n				<span class="postbit_reputation" id="repdisplay_7032_17" title="DouBle_Zer0 is on a distinguished road">\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n				</span>\r\n			\r\n			 \r\n			\r\n				<hr />\r\n				<dl class="userinfo_extra">\r\n					<dt>Join Date</dt> <dd>Jul 2010</dd>\r\n					\r\n					\r\n					<dt>Posts</dt> <dd>37</dd>	\r\n					\r\n				</dl>\r\n				\r\n				\r\n				<div class="imlinks">\r\n					    \r\n				</div>\r\n			\r\n		</div>\r\n		<div class="postbody">\r\n			<div class="postrow has_after_content">\r\n				\r\n				\r\n\r\n\r\n						\r\n						\r\n				<div class="content">\r\n					<div id="post_message_7032">\r\n						<blockquote class="postcontent restore ">\r\n							My kind of guy... <img src="images/smilies/smile.png" border="0" alt="" title="Smile" class="inlineimg" /><br />\n<br />\njust drop me an (&quot;hello world&quot;) email : <a href="mailto:m.amit30@gmail.com">m.amit30@gmail.com</a>\r\n						</blockquote>\r\n					</div>\r\n\r\n					\r\n				</div>\r\n			</div>\r\n			\r\n			<div class="after_content">\r\n				\r\n				\r\n				\r\n				\r\n					<blockquote class="signature restore"><div class="signaturecontainer">-' + '-<br />\r\nWhen you know what you want,and you want it badly enough,you\'ll find a way to get it.</div></blockquote>\r\n				\r\n				\r\n			</div>\r\n			\r\n			<div class="cleardiv"></div>\r\n		</div>\r\n	</div>\r\n		<div class="postfoot">\r\n			<!-' + '- <div class="postfoot_container"> -' + '->\r\n			<div class="textcontrols floatcontainer">\r\n				<span class="postcontrols">\r\n					<img style="display:none" id="progress_7032" src="images/misc/progress.gif" alt="" />\r\n					\r\n					\r\n					\r\n						<a id="qrwq_7032" class="newreply" href="newreply.php?do=newreply&amp;p=7032" rel="nofollow" title="Reply With Quote"><img id="quoteimg_7032" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> \r\n					\r\n					\r\n					\r\n				</span>\r\n				<span class="postlinking">\r\n					\r\n						\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n\r\n					\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n					\r\n				</span>\r\n			<!-' + '- </div> -' + '->\r\n			</div>\r\n		</div>\r\n	<hr />\r\n</li>\r\n';

// next/previous post info
pn[6931] = "7032,6932";
pn[0] = ",6931";
pn[6932] = "6931,6933";
pn[6933] = "6932,6934";
pn[6934] = "6933,7032";
pn[7032] = "6934,6931";

// cached usernames
pu[0] = guestphrase;
pu[311] = "c0d3inj3cT";
pu[17] = "DouBle_Zer0";

// -->
</script>


<div id="threaded_view">
	<h4>Threaded View</h4>

	<div id="posttree">
		<script type="text/javascript">
		<!--
			writeLink(6931, 0, 0, 311, "", "An insight into OS Internals...", "01-16-2012", "08:53 PM", 0, "showthread9a26.html?t=1924&amp;p=6931#post6931");
  writeLink(6932, 0, 0, 311, "T", "<i>Function III: \n \n \n1. pushad ...</i>", "01-16-2012", "08:59 PM", 0, "showthread8f89-2.html?t=1924&amp;p=6932#post6932");
  writeLink(6933, 0, 0, 311, "T", "<i>Now, we will understand the...</i>", "01-16-2012", "09:02 PM", 0, "showthread2e56.html?t=1924&amp;p=6933#post6933");
  writeLink(6934, 0, 0, 311, "T", "<i>We have to find the function...</i>", "01-16-2012", "09:04 PM", 0, "showthread816f.html?t=1924&amp;p=6934#post6934");
  writeLink(7032, 0, 0, 17, "L", "<i>My kind of guy... :) \n \njust...</i>", "02-02-2012", "12:20 AM", 0, "showthread535c.html?t=1924&amp;p=7032#post7032");

		//-->
		</script>
	</div>
</div>
	

	
		<ol id="posts" class="posts" start="1">
			
<li class="postbitlegacy postbitim postcontainer old" id="post_7032">
<!-- see bottom of postbit.css for .userinfo .popupmenu styles -->

	<div class="posthead">
			<span class="postdate old">
				
					<span class="date">02-02-2012,&nbsp;<span class="time">12:20 AM</span></span>
				
			</span>
			<span class="nodecontrols">
				
					<a name="post7032" href="showthreaddf22.html?t=1924&amp;p=7032&amp;viewfull=1#post7032" class="postcounter">#5</a><a id="postcount7032" name="5"></a>
				
				
				
			</span>
	</div>
	<div class="postdetails">
		<div class="userinfo">
			<div class="username_container">
			
				<div class="popupmenu memberaction">
	<a class="username offline popupctrl" href="memberb0a6.html?u=17" title="DouBle_Zer0 is offline"><strong>DouBle_Zer0</strong></a>
	<ul class="popupbody popuphover memberaction_body">
		<li class="left">
			<a href="memberb0a6.html?u=17" class="siteicon_profile">
				View Profile
			</a>
		</li>
		
		<li class="right">
			<a href="searchdc14.html?do=finduser&amp;userid=17&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">
				View Forum Posts
			</a>
		</li>
		
		
		<li class="left">
			<a href="privateb0d0.html?do=newpm&amp;u=17" class="siteicon_message" rel="nofollow">
				Private Message
			</a>
		</li>
		
		
		
		<li class="right">
			<a href="blogb0a6.html?u=17" class="siteicon_blog" rel="nofollow">
				View Blog Entries
			</a>
		</li>
		
		
		
		
		
		<li class="right">
			<a href="liste004.html?r=author/17-DouBle_Zer0" class="siteicon_article" rel="nofollow">
				View Articles
			</a>
		</li>
		

		

		
		
	</ul>
</div>
				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.html" alt="DouBle_Zer0 is offline" border="0" />

			
			</div>
			<span class="usertitle">
				Security Researcher
			</span>
			
			
			
				<span class="postbit_reputation" id="repdisplay_7032_17" title="DouBle_Zer0 is on a distinguished road">
					
						<img class="repimg" src="images/reputation/reputation_pos.html" alt="" />
					
				</span>
			
			 
			
				<hr />
				<dl class="userinfo_extra">
					<dt>Join Date</dt> <dd>Jul 2010</dd>
					
					
					<dt>Posts</dt> <dd>37</dd>	
					
				</dl>
				
				
				<div class="imlinks">
					    
				</div>
			
		</div>
		<div class="postbody">
			<div class="postrow has_after_content">
				
				


						
						
				<div class="content">
					<div id="post_message_7032">
						<blockquote class="postcontent restore ">
							My kind of guy... <img src="images/smilies/smile.html" border="0" alt="" title="Smile" class="inlineimg" /><br />
<br />
just drop me an (&quot;hello world&quot;) email : <a href="mailto:m.amit30@gmail.com">m.amit30@gmail.com</a>
						</blockquote>
					</div>

					
				</div>
			</div>
			
			<div class="after_content">
				
				
				
				
					<blockquote class="signature restore"><div class="signaturecontainer">--<br />
When you know what you want,and you want it badly enough,you'll find a way to get it.</div></blockquote>
				
				
			</div>
			
			<div class="cleardiv"></div>
		</div>
	</div>
		<div class="postfoot">
			<!-- <div class="postfoot_container"> -->
			<div class="textcontrols floatcontainer">
				<span class="postcontrols">
					<img style="display:none" id="progress_7032" src="images/misc/progress.html" alt="" />
					
					
					
						<a id="qrwq_7032" class="newreply" href="newreply3386.html?do=newreply&amp;p=7032" rel="nofollow" title="Reply With Quote"><img id="quoteimg_7032" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> 
					
					
					
				</span>
				<span class="postlinking">
					
						
					

					
					
					
					

					
					

					
					
					
					
					
				</span>
			<!-- </div> -->
			</div>
		</div>
	<hr />
</li>

		</ol>
                <div class="separator"></div>
		<div class="postlistfoot">
			
		</div>

	

</div>

<div id="below_postlist" class="noinlinemod below_postlist">
	
	<div id="pagination_bottom" class="pagination_bottom">
	
		<div class="clear"></div>
<div class="navpopupmenu popupmenu nohovermenu" id="showthread_navpopup">
	
		<span class="shade">Quick Navigation</span>
		<a href="showthread8fac.html?t=1924" class="popupctrl"><span class="ctrlcontainer">Reverse Engineering and Application Cracking</span></a>
		<a href="showthread535c.html?t=1924&amp;p=7032#top" class="textcontrol" onclick="document.location.hash='top';return false;">Top</a>
	
	<ul class="navpopupbody popupbody popuphover">
		
		<li class="optionlabel">Site Areas</li>
		<li><a href="usercp.html">Settings</a></li>
		<li><a href="private.html">Private Messages</a></li>
		<li><a href="subscription.html">Subscriptions</a></li>
		<li><a href="online.html">Who's Online</a></li>
		<li><a href="search.html">Search Forums</a></li>
		<li><a href="forum.html">Forums Home</a></li>
		
			<li class="optionlabel">Forums</li>
			
		
			
				<li><a href="forumdisplay58da.html?f=1">Garage Network</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplay12a3.html?f=2">Garage Announcements</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplaye57d.html?f=58">Bravo - Null 2012</a></li>
			
		
			
				<li><a href="forumdisplay0756.html?f=59">Garage Local Chapter Meets</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplay31e6.html?f=4">Garage Rules</a></li>
			
		
			
				<li><a href="forumdisplaye774.html?f=5">Feedback &amp; Suggestions</a></li>
			
		
			
				<li><a href="forumdisplayd42b.html?f=7">Introduce Your Self</a></li>
			
		
			
				<li><a href="forumdisplay2b89.html?f=38">Shout-box</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplaycf19.html?f=6">Garage Lounge</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplay5579.html?f=30">Hacking for Beginners</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplay6ac3.html?f=57">Did You Know?</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplay957d.html?f=8">Security &amp; Hacking News Thread</a></li>
			
		
			
				<li><a href="forumdisplay3215.html?f=36">Career in InfoSec</a></li>
			
		
			
				<li><a href="forumdisplay814c.html?f=29">Request Zone</a></li>
			
		
			
				<li><a href="forumdisplay13b6.html?f=27">Noobs Corner</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplayfdc5.html?f=9">Hacking and Security Discussions</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplayfac0.html?f=55">Tip | Trick of the Day</a></li>
			
		
			
				<li><a href="forumdisplayc4a6.html?f=66">ICS / SCADA Security</a></li>
			
		
			
				<li><a href="forumdisplay6111.html?f=67">Internet of Things - IoT</a></li>
			
		
			
				<li><a href="forumdisplay15ca.html?f=10">Network Vulnerabiltity Assessment &amp; Penetration Testing</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplaya05c.html?f=56">Post Exploitation</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplay8a83.html?f=11">Web Application Penetration Testing</a></li>
			
		
			
				<li><a href="forumdisplay01c9.html?f=12">Wireless and Bluetooth Hacking</a></li>
			
		
			
				<li><a href="forumdisplay48ab.html?f=17">Computer Forensics and Incident Handling</a></li>
			
		
			
				<li><a href="forumdisplay218b.html?f=19">Physical Security and Social Engineering</a></li>
			
		
			
				<li><a href="forumdisplayb09f.html?f=15">General Security &amp; Best Practices</a></li>
			
		
			
				<li><a href="forumdisplay907f.html?f=42">Security and Hacking Videos</a></li>
			
		
			
				<li><a href="forumdisplay9e0d.html?f=54">Mobile Security</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplay9780.html?f=14">General Security Discussions</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplay9df8.html?f=31">Programming</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplay65b9.html?f=35">Assembly</a></li>
			
		
			
				<li><a href="forumdisplayc4f1.html?f=32">C/C++</a></li>
			
		
			
				<li><a href="forumdisplayb0a0.html?f=34">Perl</a></li>
			
		
			
				<li><a href="forumdisplayb8c1.html?f=60">PHP</a></li>
			
		
			
				<li><a href="forumdisplay6c4e.html?f=33">Python</a></li>
			
		
			
				<li><a href="forumdisplay208f.html?f=51">Linux Shell / Bash Programming</a></li>
			
		
			
				<li><a href="forumdisplay3238.html?f=47">Windows Batch Programming</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplayce40.html?f=28">BackTrack and Other Linux Distributions</a></li>
			
		
			
				<li><a href="forumdisplayf2fa.html?f=16">Networks &amp; Networking</a></li>
			
		
			
				<li><a href="forumdisplaya213.html?f=18">Cloud Computing</a></li>
			
		
			
				<li><a href="forumdisplaydfa4.html?f=39">Security Podcast and Videos</a></li>
			
		
			
				<li><a href="forumdisplaya3f5.html?f=40">Miscellanous Thread</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplay30ac.html?f=49">Brush Up Your Skills</a></li>
			
		
			
					</ol>
				</li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplayffeb.html?f=20">Experts Forum</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplaycdba.html?f=48">My Meanest Hacks</a></li>
			
		
			
				<li><a href="forumdisplayf6ac.html?f=37">Hacking &amp; Security Books and Tutorials</a></li>
			
		
			
				<li><a href="forumdisplay8011.html?f=23">Tools &amp; Scripts</a></li>
			
		
			
				<li><a href="forumdisplay8941.html?f=22">Exploitation Techniques</a></li>
			
		
			
				<li><a href="forumdisplay345c.html?f=24">Reverse Engineering and Application Cracking</a></li>
			
		
			
				<li><a href="forumdisplaye8b3.html?f=25">Botnets, Malwares &amp; Rootkits Analysis</a></li>
			
		
			
				<li><a href="forumdisplay107e.html?f=43">Garage4hackers Exploits</a></li>
			
		
			
				<li><a href="forumdisplaye5f3.html?f=64">Browser Fuzzing</a></li>
			
		
			
					</ol>
				</li>
			
		
		
	</ul>
</div>
<div class="clear"></div>
	</div>
</div>










<!-- next / previous links -->
<div class="navlinks">
	
	<strong>&laquo;</strong>
	<a href="showthread676b-3.html?t=1924&amp;goto=nextoldest" rel="nofollow">Previous Thread</a>
	|
	<a href="showthreadad32.html?t=1924&amp;goto=nextnewest" rel="nofollow">Next Thread</a>
	<strong>&raquo;</strong>
	
</div>
<!-- / next / previous links -->

<div id="thread_info" class="thread_info">
	
	
	
	
	<div class="options_block_container">
		
		<div class="options_block">
			<h4 class="collapse">
				<a class="collapse" id="collapse_posting_rules" href="showthread535c.html?t=1924&amp;p=7032#top"><img src="images/buttons/collapse_40b.png" alt="" /></a>
				<span class="optiontitle">Posting Permissions</span>
			</h4>
			<div id="posting_rules" class="thread_info_block">
				
<div id="forumrules" class="info_subblock">

	<ul class="youcandoblock">
		<li>You <strong>may not</strong> post new threads</li>
		<li>You <strong>may not</strong> post replies</li>
		<li>You <strong>may not</strong> post attachments</li>
		<li>You <strong>may not</strong> edit your posts</li>
		<li>&nbsp;</li>
	</ul>
	<div class="bbcodeblock">
		<ul>
			<li><a href="miscaff0.html?do=bbcode" target="_blank">BB code</a> is <strong>On</strong></li>
			<li><a href="misc9712.html?do=showsmilies" target="_blank">Smilies</a> are <strong>On</strong></li>
			<li><a href="miscaff0.html?do=bbcode#imgcode" target="_blank">[IMG]</a> code is <strong>On</strong></li>
			<li><a href="miscaff0.html?do=bbcode#videocode" target="_blank">[VIDEO]</a> code is <strong>On</strong></li>
			<li>HTML code is <strong>Off</strong></li>
		</ul>
	</div>
	<p class="rules_link"><a href="misc17ec.html?do=showrules" target="_blank">Forum Rules</a></p>

</div>

			</div>
		</div>

	</div>

</div>





<!-- lightbox scripts -->
	<script type="text/javascript">
	<!--
	vBulletin.register_control("vB_Lightbox_Container", "posts", 1);
	//-->
	</script>
<!-- / lightbox scripts -->




<div style="clear: left">
  
<div class="google_adsense_footer" style="width:468px; margin:0 auto; padding-top:1em">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6847984837250662";
google_ad_host = "ca-host-pub-2606800903002383";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "text_image";
google_ad_channel = "";
google_color_border = "";
google_color_bg = "";
google_color_link = "";
google_color_text = "";
google_color_url = "";
google_ui_features = "rc:6";
//-->
</script>
<script type="text/javascript"
  src="../pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>

  <div id="ad_global_above_footer"><div align="center">
<script type="text/javascript"><!--
google_ad_client = "pub-6847984837250662";
/* 728x90, created 7/9/10 */
google_ad_slot = "7101394260";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="../pagead2.googlesyndication.com/pagead/show_ads.js">
</script></div>
</div>

<div id="footer" class="floatcontainer footer">

	<form action="../external.html?link=http://garage4hackers.com/forum.php" method="get" id="footer_select" class="footer_select">

		
			<select name="styleid" onchange="switch_id(this, 'style')">
				<optgroup label="Quick Style Chooser"><option class="hidden"></option></optgroup>
				
					
					<optgroup label="&nbsp;Standard Styles">
									
					
	<option value="1" class="" selected="selected">-- Default Style</option>

					
					</optgroup>
										
				
				
					
					<optgroup label="&nbsp;Mobile Styles">
					
					
	<option value="2" class="" >-- Default Mobile Style</option>

					
					</optgroup>
										
				
			</select>	
		
		
		
	</form>

	<ul id="footer_links" class="footer_links">
		<li><a href="sendmessage.html" rel="nofollow" accesskey="9">Contact Us</a></li>
		<li><a href="index.html">Garage4hackers</a></li>
		
		
		<li><a href="archive/index.html">Archive</a></li>
		<li><a href="../external.html?link=http://glowhost.com/" target="_blank">Web Hosting</a></li>
		
		
		<li><a href="showthread535c.html?t=1924&amp;p=7032#top" onclick="document.location.hash='top'; return false;">Top</a></li>
	</ul>
	
	
	
	
	<script type="text/javascript">
	<!--
		// Main vBulletin Javascript Initialization
		vBulletin_init();
		function md5hash(B,A,E,C){if(navigator.userAgent.indexOf("Mozilla/index.html")==1&&parseInt(navigator.appVersion)>=4){var D=hex_md5(str_to_ent(trim(B.value)));A.value=D;if(E){D=hex_md5(trim(B.value));E.value=D}if(!C){B.value=""}}return true};
	//-->
	</script>
        
</div>
</div> <!-- closing div for body_wrapper -->

<div class="below_body">
<div id="footer_time" class="shade footer_time">All times are GMT +5.5. The time now is <span class="time">05:51 PM</span>.</div>

<div id="footer_copyright" class="shade footer_copyright">
	<!-- Do not remove this copyright notice -->
	Powered by <a href="../external.html?link=https://www.vbulletin.com/" id="vbulletinlink">vBulletin&reg;</a> Version 4.2.1 <br />Copyright &copy; 2020 vBulletin Solutions, Inc. All rights reserved. 
	<!-- Do not remove this copyright notice -->	
</div>
<div id="footer_morecopyright" class="shade footer_morecopyright">
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	<img src="cron3aa0.gif?rand=1584879688" alt="" width="1" height="1" border="0" />
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	Copyright 2010 - 2017, Garage4Hackers
	
</div>
 

	<div id="fb-root"></div>
<script type="text/javascript" src="clientscript/vbulletin_facebook6719.js?v=421"></script>

<script type="text/javascript">
<!--
	loadFacebookAPI('en_US');
	function fbAsyncInit()
	{
		vBfb = new vB_Facebook({
			appid : "170793809601191",
			connected : 0,
			active : 0,
			autoreg : 0,
			feed_newthread : 1,
			feed_postreply : 1,
			feed_blogentry : 1,
			feed_blogcomment : 1,
			feed_newarticle : 1,
			feed_articlecomment : 1
		});
	}
// -->
</script>

</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker('UA-17311051-3');
pageTracker._trackPageview();
} catch(err) {}</script>
</body>
</html>