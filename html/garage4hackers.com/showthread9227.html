<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://www.facebook.com/2008/fbml" dir="ltr" lang="en" id="vbulletin_html">

<!-- Mirrored from garage4hackers.com/showthread.php?t=1587&p=5993 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 18:37:18 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=ISO-8859-1" /><!-- /Added by HTTrack -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta id="e_vb_meta_bburl" name="vb_meta_bburl" content="index.html" />
<base  /><!--[if IE]></base><![endif]-->
<meta name="generator" content="vBulletin 4.2.1" />
<meta http-equiv="X-UA-Compatible" content="IE=9" />

	<link rel="Shortcut Icon" href="favicon.ico" type="image/x-icon" />






	<meta property="fb:app_id" content="170793809601191" />
<meta property="og:site_name" content="Garage4hackers Forum" />
<meta property="og:description" content="Garage4Hackers(G4H) is an open security community for Information Security enthusiasts, gurus and aspirants.Members of the team dedicate time and resources towards helping other information security aspirants, sharing knowledge,spreading security awareness and promoting research." />
<meta property="og:url" content="showthreadabdd.html?t=1587" />
<meta property="og:type" content="article" />




	
		<script type="text/javascript" src="../yui.yahooapis.com/comboaa66?2.9.0/build/yuiloader-dom-event/yuiloader-dom-event.js&amp;2.9.0/build/connection/connection-min.js"></script>
	

<script type="text/javascript">
<!--
	if (typeof YAHOO === 'undefined') // Load ALL YUI Local
	{
		document.write('<script type="text/javascript" src="clientscript/yui/yuiloader-dom-event/yuiloader-dom-event6719.html?v=421"><\/script>');
		document.write('<script type="text/javascript" src="clientscript/yui/connection/connection-min6719.html?v=421"><\/script>');
		var yuipath = 'clientscript/yui';
		var yuicombopath = '';
		var remoteyui = false;
	}
	else	// Load Rest of YUI remotely (where possible)
	{
		var yuipath = '../external.html?link=http://yui.yahooapis.com/2.9.0/build';
		var yuicombopath = '../external.html?link=http://yui.yahooapis.com/combo';
		var remoteyui = true;
		if (!yuicombopath)
		{
			document.write('<script type="text/javascript" src="../yui.yahooapis.com/2.9.0/build/connection/connection-min6719.js?v=421"><\/script>');
		}
	}
	var SESSIONURL = "";
	var SECURITYTOKEN = "guest";
	var IMGDIR_MISC = "images/misc";
	var IMGDIR_BUTTON = "images/buttons";
	var vb_disable_ajax = parseInt("0", 10);
	var SIMPLEVERSION = "421";
	var BBURL = "index.html";
	var LOGGEDIN = 0 > 0 ? true : false;
	var THIS_SCRIPT = "showthread";
	var RELPATH = "showthread9227.html?t=1587&amp;p=5993";
	var PATHS = {
		forum : "",
		cms   : "",
		blog  : ""
	};
	var AJAXBASEURL = "index.html";
// -->
</script>
<script type="text/javascript" src="clientscript/vbulletin-core6719.js?v=421"></script>



	<link rel="alternate" type="application/rss+xml" title="Garage4hackers Forum RSS Feed" href="external9476.php?type=RSS2" />
	
		<link rel="alternate" type="application/rss+xml" title="Garage4hackers Forum - Botnets, Malwares &amp; Rootkits Analysis - RSS Feed" href="external935d.php?type=RSS2&amp;forumids=25" />
	



	<link rel="stylesheet" type="text/css" href="css30f2.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=bbcode.css,editor.css,popupmenu.css,reset-fonts.css,vbulletin.css,vbulletin-chrome.css,vbulletin-formcontrols.css," />

	<!--[if lt IE 8]>
	<link rel="stylesheet" type="text/css" href="css.php?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=popupmenu-ie.css,vbulletin-ie.css,vbulletin-chrome-ie.css,vbulletin-formcontrols-ie.css,editor-ie.css" />
	<![endif]-->


	<meta name="keywords" content="rootkit, windows, kernel, driver, signature, file, makes, bytes, mode, load, winload.exe, kdcom.dll, system, boot, loads, drive, process, loaded, checks, policy, tdl-4, back, memory, flag, understand, code, signing, hard, files, booting, scan, variant, bypass, data, latest, authors, loading, highlights, store, algorithm, modified, important, exploited, hive, configuration, date, stored, open, command, till" />
	<meta name="description" content="TDL-4 Rootkit, the latest variant of TDSS rootkit is considered to be the most sophisticated rootkits known till date. The rootkit authors continue to push the envelope and develop new ways to bypass the security mechanisms. 
 
Few highlights of this rootkit and what makes it special. I have decided to open this thread as a single place to discuss all about this amazing rootkit. I start by giving a high level overview of the rootkit and it's functions. 
 
I will also cover the basic definitions" />

	<title> TDL-4, The Latest Variant of TDSS Rootkit</title>
	<link rel="canonical" href="showthreadabdd.html?t=1587" />
	
	<script type="text/javascript" src="clientscript/vbulletin_textedit6719.html?v=421"></script>
	<script type="text/javascript" src="clientscript/vbulletin_post_loader6719.html?v=421"></script>
	
	
	
	
	
	

	
		<link rel="stylesheet" type="text/css" href="css8d9b.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=postlist.css,showthread.css,postbit.css,attachment.css,poll.css,lightbox.css" />
	

<link rel="stylesheet" type="text/css" href="css657d.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=additional.css" />

</head>

<body onload="if (document.body.scrollIntoView &amp;&amp; fetch_object('currentPost') &amp;&amp; (window.location.href.indexOf('#') == -1 || window.location.href.indexOf('#post') &gt; -1)) { fetch_object('currentPost').scrollIntoView(true); }">

<div class="above_body"> <!-- closing tag is in template navbar -->
<div id="header" class="floatcontainer doc_header">
	<div><a name="top" href="forum.html" class="logo-image"><img src="images/misc/vbulletin4_logo.html" alt="Garage4hackers Forum" /></a></div>
	<div id="toplinks" class="toplinks">
		
			<ul class="nouser">
			
				<li><a href="register.html" rel="nofollow">Register</a></li>
			
				<li><a rel="help" href="faq.html">Help</a></li>
				<li>
			<script type="text/javascript" src="clientscript/vbulletin_md56719.html?v=421"></script>
			<form id="navbar_loginform" action="../external.html?link=http://garage4hackers.com/login.php?do=login" method="post" onsubmit="md5hash(vb_login_password, vb_login_md5password, vb_login_md5password_utf, 0)">
				<fieldset id="logindetails" class="logindetails">
					<div>
						<div>
					<input type="text" class="textbox default-value" name="vb_login_username" id="navbar_username" size="10" accesskey="u" tabindex="101" value="User Name" />
					<input type="password" class="textbox" tabindex="102" name="vb_login_password" id="navbar_password" size="10" />
					<input type="text" class="textbox default-value" tabindex="102" name="vb_login_password_hint" id="navbar_password_hint" size="10" value="Password" style="display:none;" />
					<input type="submit" class="loginbutton" tabindex="104" value="Log in" title="Enter your username and password in the boxes provided to login, or click the 'register' button to create a profile for yourself." accesskey="s" />
						</div>
					</div>
				</fieldset>
				<div id="remember" class="remember">
					<label for="cb_cookieuser_navbar"><input type="checkbox" name="cookieuser" value="1" id="cb_cookieuser_navbar" class="cb_cookieuser_navbar" accesskey="c" tabindex="103" /> Remember Me?</label>
				</div>

				<input type="hidden" name="s" value="" />
				<input type="hidden" name="securitytoken" value="guest" />
				<input type="hidden" name="do" value="login" />
				<input type="hidden" name="vb_login_md5password" />
				<input type="hidden" name="vb_login_md5password_utf" />
			</form>
			<script type="text/javascript">
			YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "inline");
			YAHOO.util.Dom.setStyle('navbar_password', "display", "none");
			vB_XHTML_Ready.subscribe(function()
			{
			//
				YAHOO.util.Event.on('navbar_username', "focus", navbar_username_focus);
				YAHOO.util.Event.on('navbar_username', "blur", navbar_username_blur);
				YAHOO.util.Event.on('navbar_password_hint', "focus", navbar_password_hint);
				YAHOO.util.Event.on('navbar_password', "blur", navbar_password);
			});
			
			function navbar_username_focus(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				if (textbox.value == 'User Name')
				{
				//
					textbox.value='';
					textbox.style.color='#000000';
				}
			}

			function navbar_username_blur(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				if (textbox.value == '')
				{
				//
					textbox.value='User Name';
					textbox.style.color='#777777';
				}
			}
			
			function navbar_password_hint(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				
				YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "none");
				YAHOO.util.Dom.setStyle('navbar_password', "display", "inline");
				YAHOO.util.Dom.get('navbar_password').focus();
			}

			function navbar_password(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				
				if (textbox.value == '')
				{
					YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "inline");
					YAHOO.util.Dom.setStyle('navbar_password', "display", "none");
				}
			}
			</script>
				</li>
				
					<li id="fb_headerbox" class="hidden">

	<a id="fb_loginbtn" href="#"><img src="images/misc/facebook_login.html" alt="The Facebook Platform" /></a>

</li>

				
			</ul>
		
	</div>
	<div class="ad_global_header">
		 
		 
	</div>
	<hr />
</div>
<div id="navbar" class="navbar">
	<ul id="navtabs" class="navtabs floatcontainer">
		
		
	
		<li  id="vbtab_whatsnew">
			<a class="navtab" href="activity.html">What's New?</a>
		</li>
		
		

	
		<li  id="vbtab_cms">
			<a class="navtab" href="content.html">Articles</a>
		</li>
		
		

	
		<li class="selected" id="vbtab_forum">
			<a class="navtab" href="forum.html">Forum</a>
		</li>
		
		
			<ul class="floatcontainer">
				
					
						
							<li id="vbflink_newposts"><a href="search8427.html?do=getnew&amp;contenttype=vBForum_Post">New Posts</a></li>
						
					
				
					
						
							<li id="vbflink_faq"><a href="faq.html">FAQ</a></li>
						
					
				
					
						
							<li id="vbflink_calendar"><a href="calendar.html">Calendar</a></li>
						
					
				
					
						<li class="popupmenu" id="vbmenu_community">
							<a href="javascript://" class="popupctrl">Community</a>
							<ul class="popupbody popuphover">
								
									<li id="vbclink_members"><a href="memberlist.html">Member List</a></li>
								
							</ul>
						</li>
					
				
					
						<li class="popupmenu" id="vbmenu_actions">
							<a href="javascript://" class="popupctrl">Forum Actions</a>
							<ul class="popupbody popuphover">
								
									<li id="vbalink_mfr"><a href="forum.html?do=markread&amp;markreadhash=guest">Mark Forums Read</a></li>
								
							</ul>
						</li>
					
				
					
						<li class="popupmenu" id="vbmenu_qlinks">
							<a href="javascript://" class="popupctrl">Quick Links</a>
							<ul class="popupbody popuphover">
								
									<li id="vbqlink_posts"><a href="search2791.html?do=getdaily&amp;contenttype=vBForum_Post">Today's Posts</a></li>
								
									<li id="vbqlink_leaders"><a href="showgroups.html">View Site Leaders</a></li>
								
							</ul>
						</li>
					
				
			</ul>
		

	
		<li  id="vbtab_blog">
			<a class="navtab" href="blog.html">Blogs</a>
		</li>
		
		

	
		<li  id="tab_nja4_357">
			<a class="navtab" href="pages7b82.html?pageid=2">G4H Team</a>
		</li>
		
		

	
		<li  id="tab_nta0_579">
			<a class="navtab" href="pages8782.html?pageid=3">IRC</a>
		</li>
		
		

	
		<li  id="tab_nta0_442">
			<a class="navtab" href="pagesdbe0.html?pageid=4">Ranchoddas</a>
		</li>
		
		

		<li>
            <a class="navtab" href="pages.html">Events and Conferences</a></li>
	</ul>
	
		<div id="globalsearch" class="globalsearch">
			<form action="../external.html?link=http://garage4hackers.com/search.php?do=process" method="post" id="navbar_search" class="navbar_search">
				
				<input type="hidden" name="securitytoken" value="guest" />
				<input type="hidden" name="do" value="process" />
				<span class="textboxcontainer"><span><input type="text" value="" name="query" class="textbox" tabindex="99"/></span></span>
				<span class="buttoncontainer"><span><input type="image" class="searchbutton" src="images/buttons/search.html" name="submit" onclick="document.getElementById('navbar_search').submit;" tabindex="100"/></span></span>
			</form>
			<ul class="navbar_advanced_search">
				<li><a href="search.html" accesskey="4">Advanced Search</a></li>
				
			</ul>
		</div>
	
</div>
</div><!-- closing div for above_body -->

<div class="body_wrapper">
<div id="breadcrumb" class="breadcrumb">
	<ul class="floatcontainer">
		<li class="navbithome"><a href="content.html" accesskey="1"><img src="images/misc/navbit-home.html" alt="Home" /></a></li>
		
	<li class="navbit"><a href="forum.html">Forum</a></li>

	<li class="navbit"><a href="forumdisplayffeb.html?f=20">Experts Forum</a></li>

	<li class="navbit"><a href="forumdisplaye8b3.html?f=25">Botnets, Malwares &amp; Rootkits Analysis</a></li>

		
	<li class="navbit lastnavbit"><span> TDL-4, The Latest Variant of TDSS Rootkit</span></li>

	</ul>
	<hr />
</div>


<div style="width:728px; margin:0 auto; padding-bottom:1em">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6847984837250662";
google_ad_host = "ca-host-pub-2606800903002383";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al_s";
google_ad_channel = "";
google_color_border = "";
google_color_bg = "";
google_color_link = "";
google_color_text = "";
google_color_url = "";
google_ui_features = "rc:6";
//-->
</script>
<script type="text/javascript"
  src="../pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>

<div id="ad_global_below_navbar"><script async src="../pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- garage1 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:728px;height:90px"
     data-ad-client="ca-pub-6847984837250662"
     data-ad-slot="4036513682"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>


	<form action="../external.html?link=http://garage4hackers.com/profile.php?do=dismissnotice" method="post" id="notices" class="notices">
		<input type="hidden" name="do" value="dismissnotice" />
		<input type="hidden" name="s" value="" />
		<input type="hidden" name="securitytoken" value="guest" />
		<input type="hidden" id="dismiss_notice_hidden" name="dismiss_noticeid" value="" />
		<input type="hidden" name="url" value="" />
		<ol>
			<li class="restore" id="navbar_notice_2">
	
	<html>
<h2>
The forum is <a href="showthread1180.html?t=7049&amp;p=14985#post14985">frozen forever</a> - but it won't die; it'll stay for long in search engine results and we hope it would keep helping newbies in some way or other - cheers! 


</h2>

<!-- Mirrored from garage4hackers.com/showthread.php?t=1587&p=5993 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 18:37:18 GMT -->
</html>
</li>
		</ol>
	</form>





	<div id="above_postlist" class="above_postlist">
		

		<div id="pagination_top" class="pagination_top">
		
			<div id="postpagestats_above" class="postpagestats">
				Results 1 to 5 of 5
			</div>
		</div>
	</div>
<div id="pagetitle" class="pagetitle">
	<h1>
		Thread: <span class="threadtitle"><a href="showthreadabdd.html?t=1587" title="Reload this Page">TDL-4, The Latest Variant of TDSS Rootkit</a></span>

<a class="a2a_dd" href="../external.html?link=http://www.addtoany.com/share_save"><img src="../static.addtoany.com/buttons/share_save_171_16.png" width="171" height="16" border="0" alt="Share/Save - My123World.Com!"/></a><script type="text/javascript">a2a_show_title=1;a2a_num_services=14;</script><script type="text/javascript" src="../static.addtoany.com/menu/page.js"></script>

		
			
<fb:like href="showthreadabdd.html?t=1587" font="tahoma" layout="standard" show_faces="false" width="260" action="../external.html?link=http://garage4hackers.com/like" colorscheme="light"></fb:like>
		
	</h1>
</div>
	<div id="thread_controls" class="thread_controls">
		<div>
		<ul id="postlist_popups" class="postlist_popups popupgroup">
			
			<li class="popupmenu" id="threadtools">
				<h6><a class="popupctrl" href="javascript://">Thread Tools</a></h6>
				<ul class="popupbody popuphover">
					<li><a href="printthreadcb1b.html?t=1587&amp;pp=10&amp;page=1" accesskey="3" 
						rel="nofollow">Show Printable Version</a></li>
					<li><a href="sendmessagec65c.html?do=sendtofriend&amp;t=1587"
						rel="nofollow">Email this Page&hellip;</a></li>
					<li>
						
							<a href="subscriptionf02d.html?do=addsubscription&amp;t=1587" 
								rel="nofollow">Subscribe to this Thread&hellip;</a>
											
					</li>
					
				</ul>
			</li>

			

			
				<li class="popupmenu searchthread" id="searchthread">
					<h6><a class="popupctrl" href="javascript://">Search Thread</a></h6>
					<form action="../external.html?link=http://garage4hackers.com/search.php" method="post">
						<ul class="popupbody popuphover">
							<li>
								<input type="text" name="query" class="searchbox" value="Search..." tabindex="13" />
								<input type="submit" class="button" value="Search" tabindex="14" />
							</li>
							<li class="formsubmit">
								<div><a class="advancedsearchlink" href="search7630.html?search_type=1&amp;searchthreadid=1587&amp;contenttype=vBForum_Post">Advanced Search</a></div>
							</li>
						</ul>
						<input type="hidden" name="s" value="" />
						<input type="hidden" name="securitytoken" value="guest" />
						<input type="hidden" name="do" value="process" />
						<input type="hidden" name="searchthreadid" value="1587" />
						<input type="hidden" name="search_type" value="1" />
						<input type="hidden" name="contenttype" value="vBForum_Post" />

					</form>
				</li>
			

			

			
				<li class="popupmenu" id="displaymodes">
					<h6><a class="popupctrl" href="javascript://">Display</a></h6>
					<ul class="popupbody popuphover">
						<li><label>Linear Mode</label></li>
						<li><a href="showthread87ba-2.html?t=1587&amp;mode=hybrid"> Switch to Hybrid Mode</a></li>
						<li><a href="showthreade10e.html?t=1587&amp;p=5970&amp;mode=threaded#post5970"> Switch to Threaded Mode</a></li>
					</ul>
				</li>
			

			
		</ul>
		</div>
	</div>

<div id="postlist" class="postlist restrain">
	

	
		<ol id="posts" class="posts" start="1">
			
<li class="postbitlegacy postbitim postcontainer old" id="post_5970">
<!-- see bottom of postbit.css for .userinfo .popupmenu styles -->

	<div class="posthead">
			<span class="postdate old">
				
					<span class="date">10-11-2011,&nbsp;<span class="time">07:26 PM</span></span>
				
			</span>
			<span class="nodecontrols">
				
					<a name="post5970" href="showthread7685.html?t=1587&amp;p=5970&amp;viewfull=1#post5970" class="postcounter">#1</a><a id="postcount5970" name="1"></a>
				
				
				
			</span>
	</div>
	<div class="postdetails">
		<div class="userinfo">
			<div class="username_container">
			
				<div class="popupmenu memberaction">
	<a class="username offline popupctrl" href="memberdb73.html?u=311" title="c0d3inj3cT is offline"><strong>c0d3inj3cT</strong></a>
	<ul class="popupbody popuphover memberaction_body">
		<li class="left">
			<a href="memberdb73.html?u=311" class="siteicon_profile">
				View Profile
			</a>
		</li>
		
		<li class="right">
			<a href="search9737.html?do=finduser&amp;userid=311&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">
				View Forum Posts
			</a>
		</li>
		
		
		<li class="left">
			<a href="private1fcf.html?do=newpm&amp;u=311" class="siteicon_message" rel="nofollow">
				Private Message
			</a>
		</li>
		
		
		
		<li class="right">
			<a href="blogdb73.html?u=311" class="siteicon_blog" rel="nofollow">
				View Blog Entries
			</a>
		</li>
		
		
		
		
		
		<li class="right">
			<a href="list1ee8.html?r=author/311-c0d3inj3cT" class="siteicon_article" rel="nofollow">
				View Articles
			</a>
		</li>
		

		

		
		
	</ul>
</div>
				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.html" alt="c0d3inj3cT is offline" border="0" />

			
			</div>
			<span class="usertitle">
				Garage Member
			</span>
			
			
			
				<span class="postbit_reputation" id="repdisplay_5970_311" title="c0d3inj3cT will become famous soon enough">
					
						<img class="repimg" src="images/reputation/reputation_pos.html" alt="" />
					
						<img class="repimg" src="images/reputation/reputation_pos.html" alt="" />
					
				</span>
			
			 
			
				<hr />
				<dl class="userinfo_extra">
					<dt>Join Date</dt> <dd>Dec 2010</dd>
					
					
					<dt>Posts</dt> <dd>67</dd>	
					<dt>Blog Entries</dt><dd><a href="blogdb73.html?u=311">2</a></dd>
				</dl>
				
				
				<div class="imlinks">
					    
				</div>
			
		</div>
		<div class="postbody">
			<div class="postrow">
				
				
				<h2 class="title icon">
					TDL-4, The Latest Variant of TDSS Rootkit
				</h2>
				


						
							
							
						
						
				<div class="content">
					<div id="post_message_5970">
						<blockquote class="postcontent restore ">
							TDL-4 Rootkit, the latest variant of TDSS rootkit is considered to be the most sophisticated rootkits known till date. The rootkit authors continue to push the envelope and develop new ways to bypass the security mechanisms.<br />
<br />
Few highlights of this rootkit and what makes it special. I have decided to open this thread as a single place to discuss all about this amazing rootkit. I start by giving a high level overview of the rootkit and it's functions.<br />
<br />
I will also cover the basic definitions and summary of terms which may not be common to many.<br />
<br />
<b>Highlights:</b><br />
<br />
<b>Bootkit technique:</b> Yes, the old school technique of infecting the MBR is back. This rootkit infects the MBR so that it can load itself even before the Operating System loads. This makes the rootkit very persistent.<br />
<br />
MBR is the first sector of your hard drive. It consists of the bootcode and the partition table. In order to view the contents of your MBR, you can either use a tool like HD Hacker 1.4 if you prefer the GUI. Else, if you have a copy of linux then you can use the dd command to view the hex dump as follows.<br />
<br />
Run, fdisk -l and note down the device name of your hard drive.<br />
<br />
Let's say, it's /dev/sda<br />
<br />
dd if=/dev/sda count=1 | hexdump -C | more<br />
<br />
The above command will display the first 512 bytes of the hard drive sector. It's important to understand the format of a MBR to further analyze the rootkit functions.<br />
<br />
MBR - 512 bytes = 446 bytes of boot code + 64 bytes of partition table + 2 bytes (MBR Signature)<br />
<br />
We'll see in more detail as to how the bootkit loads itself during the booting process.<br />
<br />
MBR is loaded by the BIOS into memory during the booting process. The code stored in the first 446 bytes of MBR is executed first.<br />
<br />
<b>Windows Driver Signing Policy Bypass</b> - Till date, we didn't have a kernel mode rootkit for x64 systems of Windows. The primary reason for this was, Windows x64 Systems have a Driver Signature Enforcement Policy enabled which doesn't allow unsigned drivers to be loaded.<br />
<br />
A rootkit driver and it's dll files are not signed. So, it was not possible to load them during the booting process. But the authors of TDL have found a clever workaround for this.<br />
<br />
In Windows OS prior to Vista, ntldr used to handle the role of loading the kernel. This has been replaced by the Boot Manager starting from Windows Vista.<br />
<br />
Boot.ini files of older versions of Windows is now replaced by BCD (Boot Configuration Data). It maintains all the information in the BCD Store (you can use bcdedit /enum &lt;type&gt; to list them)<br />
<br />
Boot Manager reads the Boot Configuration Data and then loads either winload.exe or winresume.exe (to resume from hibernating state).<br />
<br />
We'll focus on winload.exe and how it's exploited.<br />
<br />
Winload.exe is the executable that is responsible to load the windows kernel and it's dependencies like hal.dll, kdcom.dll and bootvid.dll. While loading these modules, it checks the BCD Store for the status of certain flags or elements.<br />
<br />
The ones which control the driver signature policy are:<br />
<br />
BcdLibraryBoolean_DisableIntegrityCheck<br />
BcdOSLoaderBoolean_WinPEMode<br />
<br />
If one of these is set, then driver signature verification process is disabled.<br />
<br />
This fact is exploited by rootkit. It will swap the values of flags, BCDLibraryBoolean_ESMEnabled with BcdOSLoaderBoolean_WinPEMode. This makes winload.exe load the Windows Kernel in Pre Installation Mode thereby disabling kernel mode code integrity checks.<br />
<br />
It's important to understand what exactly happens when winload.exe loads Windows OS in preinstallation mode. It passes the flag /MININT to Windows Kernel. This flag causes the Windows Kernel to open the Registry System Hive in volatile mode and changes to it in memory are not saved back to hive image.<br />
<br />
However, the whole purpose of loading the Windows OS in WinPE mode is to bypass the driver signing checks to load the infected version of kdcom.dll file. Once this is done, rootkit will enable the driver signing policy back again!<br />
<br />
To do this, the flag passed to windows kernel is modified to IN/MINT. As windows kernel doesn't understand this string, it continues to load normally.<br />
<br />
When exactly is the kdcom.dll file loaded into memory? To find this out, TDL-4 makes use of a signature scan which checks for the kdcom.dll's PE export directory size. If it's equal to 0xFA, then rootkit knows that kdcom.dll file is being loaded and it starts the infection.<br />
<br />
Microsoft had patched kdcom.dll by modifying the export data directory size of it, to evade the TDL-4 Signature Scan. Not a clever thing to do to restrict the rootkit authors! So, the rootkit was modified quickly to update the signature scan to the new value.<br />
<br />
<b>Encrypted File System</b> - Another new feature of this rootkit is the use of an encrypted virtual hidden file system. It makes use of an RC4 encryption algorithm.<br />
<br />
This file system is stored in the last sectors of the physical drive. All the malicious files which are required by rootkit, like ldr16, ldr32, ldr64 are copied to this location.<br />
<br />
The latest variant of TDL rootkit makes use of it's own encryption algorithm using XOR swaps.
						</blockquote>
					</div>

					
				</div>
			</div>
			
			<div class="cleardiv"></div>
		</div>
	</div>
		<div class="postfoot">
			<!-- <div class="postfoot_container"> -->
			<div class="textcontrols floatcontainer">
				<span class="postcontrols">
					<img style="display:none" id="progress_5970" src="images/misc/progress.html" alt="" />
					
					
					
						<a id="qrwq_5970" class="newreply" href="newreply44d8.html?do=newreply&amp;p=5970" rel="nofollow" title="Reply With Quote"><img id="quoteimg_5970" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> 
					
					
					
				</span>
				<span class="postlinking">
					
						
					

					
					
					
					

					
					

					
					
					
					
					
				</span>
			<!-- </div> -->
			</div>
		</div>
	<hr />
</li>

<li class="postbitlegacy postbitim postcontainer old" id="post_5971">
<!-- see bottom of postbit.css for .userinfo .popupmenu styles -->

	<div class="posthead">
			<span class="postdate old">
				
					<span class="date">10-11-2011,&nbsp;<span class="time">08:11 PM</span></span>
				
			</span>
			<span class="nodecontrols">
				
					<a name="post5971" href="showthreada706.html?t=1587&amp;p=5971&amp;viewfull=1#post5971" class="postcounter">#2</a><a id="postcount5971" name="2"></a>
				
				
				
			</span>
	</div>
	<div class="postdetails">
		<div class="userinfo">
			<div class="username_container">
			
				<div class="popupmenu memberaction">
	<a class="username offline popupctrl" href="memberdb73.html?u=311" title="c0d3inj3cT is offline"><strong>c0d3inj3cT</strong></a>
	<ul class="popupbody popuphover memberaction_body">
		<li class="left">
			<a href="memberdb73.html?u=311" class="siteicon_profile">
				View Profile
			</a>
		</li>
		
		<li class="right">
			<a href="search9737.html?do=finduser&amp;userid=311&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">
				View Forum Posts
			</a>
		</li>
		
		
		<li class="left">
			<a href="private1fcf.html?do=newpm&amp;u=311" class="siteicon_message" rel="nofollow">
				Private Message
			</a>
		</li>
		
		
		
		<li class="right">
			<a href="blogdb73.html?u=311" class="siteicon_blog" rel="nofollow">
				View Blog Entries
			</a>
		</li>
		
		
		
		
		
		<li class="right">
			<a href="list1ee8.html?r=author/311-c0d3inj3cT" class="siteicon_article" rel="nofollow">
				View Articles
			</a>
		</li>
		

		

		
		
	</ul>
</div>
				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.html" alt="c0d3inj3cT is offline" border="0" />

			
			</div>
			<span class="usertitle">
				Garage Member
			</span>
			
			
			
				<span class="postbit_reputation" id="repdisplay_5971_311" title="c0d3inj3cT will become famous soon enough">
					
						<img class="repimg" src="images/reputation/reputation_pos.html" alt="" />
					
						<img class="repimg" src="images/reputation/reputation_pos.html" alt="" />
					
				</span>
			
			 
			
				<hr />
				<dl class="userinfo_extra">
					<dt>Join Date</dt> <dd>Dec 2010</dd>
					
					
					<dt>Posts</dt> <dd>67</dd>	
					<dt>Blog Entries</dt><dd><a href="blogdb73.html?u=311">2</a></dd>
				</dl>
				
				
				<div class="imlinks">
					    
				</div>
			
		</div>
		<div class="postbody">
			<div class="postrow">
				
				


						
						
				<div class="content">
					<div id="post_message_5971">
						<blockquote class="postcontent restore ">
							We have discussed about how Rootkit bypasses Windows Driver Signing Policy to load an infected unsigned version of kdcom.dll file which is ldr32 or ldr64 depending on the operating system.<br />
<br />
But, how exactly the rootkit controls which file is read from the hard drive during the boot process?<br />
<br />
BIOS Interrupt are low level routines which are used by the OS to load certain drivers during the boot process. If we can control the flow of these routines, we can determine which file is loaded by BIOS Services.<br />
<br />
This is exactly what ldr16 does. It hooks the BIOS Interrupt, int 13h which provides low level disk services.<br />
<br />
You can find more details about different types of BIOS Interrupts here:<br />
<br />
<a href="../external.html?link=http://en.wikipedia.org/wiki/BIOS_interrupt_call" target="_blank">http://en.wikipedia.org/wiki/BIOS_interrupt_call</a><br />
<br />
How do we pass parameters to the BIOS Interrupt?<br />
<br />
It's important to understand that the same interrupt could be used for multiple purposes. The function depends on the function number loaded in a prespecified format in a register, ah. Also, other values like driver number, number of sectors to be read have to be passed to the BIOS Interrupt.<br />
<br />
So, once the BIOS Interrupt, int 13h is hooked by ldr16, it now controls the read/write opertations of hard drive during boot process. It exploits this by loading an infected version of kdcom.dll which is, ldr32 or ldr64.<br />
<br />
ldr32 or ldr64 have the same exported symbols as kdcom.dll. <br />
<br />
Purpose of replacing kdcom.dll with malicious file:<br />
<br />
To load the bootkit's driver<br />
To disable Kernel mode Debugging functions.<br />
<br />
Among the exported functions of infected kdcom.dll, the one of primary importance is the KdDebuggerInitialize1 function. This is the infected function which allows the loading of bootkit driver, drv32 of drv64.<br />
<br />
To summarize the sequence in which files are loaded in the boot process:<br />
<br />
<ul><li style="">BIOS Loads Infected MBR</li><li style="">Infected MBR executes boot code</li><li style="">Locates Hidden VFS of Bootkit</li><li style="">Loads and Executes Ldr16</li><li style="">Ldr16 hooks BIOS Interrupt, int 13h</li><li style="">It takes control of all low level disk service</li><li style="">Reads ldr32 or ldr64 instead of kdcom.dll (bypasses Windows Driver Signing Policy here)</li><li style="">Infected KdDebuggerInitialize1 function loads Bootkit Driver (drv32 or drv64)</li></ul>
						</blockquote>
					</div>

					
				</div>
			</div>
			
			<div class="cleardiv"></div>
		</div>
	</div>
		<div class="postfoot">
			<!-- <div class="postfoot_container"> -->
			<div class="textcontrols floatcontainer">
				<span class="postcontrols">
					<img style="display:none" id="progress_5971" src="images/misc/progress.html" alt="" />
					
					
					
						<a id="qrwq_5971" class="newreply" href="newreplyeefb.html?do=newreply&amp;p=5971" rel="nofollow" title="Reply With Quote"><img id="quoteimg_5971" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> 
					
					
					
				</span>
				<span class="postlinking">
					
						
					

					
					
					
					

					
					

					
					
					
					
					
				</span>
			<!-- </div> -->
			</div>
		</div>
	<hr />
</li>

<li class="postbitlegacy postbitim postcontainer old" id="post_5975">
<!-- see bottom of postbit.css for .userinfo .popupmenu styles -->

	<div class="posthead">
			<span class="postdate old">
				
					<span class="date">10-12-2011,&nbsp;<span class="time">01:13 PM</span></span>
				
			</span>
			<span class="nodecontrols">
				
					<a name="post5975" href="showthreadcb54.html?t=1587&amp;p=5975&amp;viewfull=1#post5975" class="postcounter">#3</a><a id="postcount5975" name="3"></a>
				
				
				
			</span>
	</div>
	<div class="postdetails">
		<div class="userinfo">
			<div class="username_container">
			
				<div class="popupmenu memberaction">
	<a class="username offline popupctrl" href="member0612.html?u=16" title="41.w4r10r is offline"><strong>41.w4r10r</strong></a>
	<ul class="popupbody popuphover memberaction_body">
		<li class="left">
			<a href="member0612.html?u=16" class="siteicon_profile">
				View Profile
			</a>
		</li>
		
		<li class="right">
			<a href="searchbd13.html?do=finduser&amp;userid=16&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">
				View Forum Posts
			</a>
		</li>
		
		
		<li class="left">
			<a href="private4f8b.html?do=newpm&amp;u=16" class="siteicon_message" rel="nofollow">
				Private Message
			</a>
		</li>
		
		
		
		<li class="right">
			<a href="blog0612.html?u=16" class="siteicon_blog" rel="nofollow">
				View Blog Entries
			</a>
		</li>
		
		
		
		
		
		<li class="right">
			<a href="list2370.html?r=author/16-41-w4r10r" class="siteicon_article" rel="nofollow">
				View Articles
			</a>
		</li>
		

		

		
		
	</ul>
</div>
				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.html" alt="41.w4r10r is offline" border="0" />

			
			</div>
			<span class="usertitle">
				Garage Addict
			</span>
			
			
			
				<span class="postbit_reputation" id="repdisplay_5975_16" title="41.w4r10r has a spectacular aura about">
					
						<img class="repimg" src="images/reputation/reputation_pos.html" alt="" />
					
						<img class="repimg" src="images/reputation/reputation_pos.html" alt="" />
					
						<img class="repimg" src="images/reputation/reputation_pos.html" alt="" />
					
				</span>
			
			
			<a class="postuseravatar" href="member0612.html?u=16" title="41.w4r10r is offline">
				<img src="Koala7637.jpg?u=16&amp;dateline=1317119947" alt="41.w4r10r's Avatar" title="41.w4r10r's Avatar" />
			</a>
			 
			
				<hr />
				<dl class="userinfo_extra">
					<dt>Join Date</dt> <dd>Jul 2010</dd>
					<dt>Location</dt> <dd>Pune</dd>
					
					<dt>Posts</dt> <dd>338</dd>	
					<dt>Blog Entries</dt><dd><a href="blog0612.html?u=16">3</a></dd>
				</dl>
				
				
				<div class="imlinks">
					    
				</div>
			
		</div>
		<div class="postbody">
			<div class="postrow">
				
				


						
						
				<div class="content">
					<div id="post_message_5975">
						<blockquote class="postcontent restore ">
							awesome information bro....<br />
very nicely written so even beginner can easily understand the working of bootkits....<br />
hope see some more analysis on different bootkits and vectors used in it,...
						</blockquote>
					</div>

					
				</div>
			</div>
			
			<div class="cleardiv"></div>
		</div>
	</div>
		<div class="postfoot">
			<!-- <div class="postfoot_container"> -->
			<div class="textcontrols floatcontainer">
				<span class="postcontrols">
					<img style="display:none" id="progress_5975" src="images/misc/progress.html" alt="" />
					
					
					
						<a id="qrwq_5975" class="newreply" href="newreply46ab.html?do=newreply&amp;p=5975" rel="nofollow" title="Reply With Quote"><img id="quoteimg_5975" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> 
					
					
					
				</span>
				<span class="postlinking">
					
						
					

					
					
					
					

					
					

					
					
					
					
					
				</span>
			<!-- </div> -->
			</div>
		</div>
	<hr />
</li>

<li class="postbitlegacy postbitim postcontainer old" id="post_5985">
<!-- see bottom of postbit.css for .userinfo .popupmenu styles -->

	<div class="posthead">
			<span class="postdate old">
				
					<span class="date">10-13-2011,&nbsp;<span class="time">05:32 PM</span></span>
				
			</span>
			<span class="nodecontrols">
				
					<a name="post5985" href="showthreadf3d0.html?t=1587&amp;p=5985&amp;viewfull=1#post5985" class="postcounter">#4</a><a id="postcount5985" name="4"></a>
				
				
				
			</span>
	</div>
	<div class="postdetails">
		<div class="userinfo">
			<div class="username_container">
			
				<div class="popupmenu memberaction">
	<a class="username offline popupctrl" href="memberdb73.html?u=311" title="c0d3inj3cT is offline"><strong>c0d3inj3cT</strong></a>
	<ul class="popupbody popuphover memberaction_body">
		<li class="left">
			<a href="memberdb73.html?u=311" class="siteicon_profile">
				View Profile
			</a>
		</li>
		
		<li class="right">
			<a href="search9737.html?do=finduser&amp;userid=311&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">
				View Forum Posts
			</a>
		</li>
		
		
		<li class="left">
			<a href="private1fcf.html?do=newpm&amp;u=311" class="siteicon_message" rel="nofollow">
				Private Message
			</a>
		</li>
		
		
		
		<li class="right">
			<a href="blogdb73.html?u=311" class="siteicon_blog" rel="nofollow">
				View Blog Entries
			</a>
		</li>
		
		
		
		
		
		<li class="right">
			<a href="list1ee8.html?r=author/311-c0d3inj3cT" class="siteicon_article" rel="nofollow">
				View Articles
			</a>
		</li>
		

		

		
		
	</ul>
</div>
				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.html" alt="c0d3inj3cT is offline" border="0" />

			
			</div>
			<span class="usertitle">
				Garage Member
			</span>
			
			
			
				<span class="postbit_reputation" id="repdisplay_5985_311" title="c0d3inj3cT will become famous soon enough">
					
						<img class="repimg" src="images/reputation/reputation_pos.html" alt="" />
					
						<img class="repimg" src="images/reputation/reputation_pos.html" alt="" />
					
				</span>
			
			 
			
				<hr />
				<dl class="userinfo_extra">
					<dt>Join Date</dt> <dd>Dec 2010</dd>
					
					
					<dt>Posts</dt> <dd>67</dd>	
					<dt>Blog Entries</dt><dd><a href="blogdb73.html?u=311">2</a></dd>
				</dl>
				
				
				<div class="imlinks">
					    
				</div>
			
		</div>
		<div class="postbody">
			<div class="postrow">
				
				


						
						
				<div class="content">
					<div id="post_message_5985">
						<blockquote class="postcontent restore ">
							You're welcome.<br />
<br />
I was born when the first Master Boot Record Virus was developed ))
						</blockquote>
					</div>

					
				</div>
			</div>
			
			<div class="cleardiv"></div>
		</div>
	</div>
		<div class="postfoot">
			<!-- <div class="postfoot_container"> -->
			<div class="textcontrols floatcontainer">
				<span class="postcontrols">
					<img style="display:none" id="progress_5985" src="images/misc/progress.html" alt="" />
					
					
					
						<a id="qrwq_5985" class="newreply" href="newreplyf92c.html?do=newreply&amp;p=5985" rel="nofollow" title="Reply With Quote"><img id="quoteimg_5985" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> 
					
					
					
				</span>
				<span class="postlinking">
					
						
					

					
					
					
					

					
					

					
					
					
					
					
				</span>
			<!-- </div> -->
			</div>
		</div>
	<hr />
</li>

<li class="postbitlegacy postbitim postcontainer old" id="post_5993">
<!-- see bottom of postbit.css for .userinfo .popupmenu styles -->

	<div class="posthead">
			<span class="postdate old">
				
					<span class="date">10-14-2011,&nbsp;<span class="time">02:37 PM</span></span>
				
			</span>
			<span class="nodecontrols">
				
					<a name="post5993" href="showthread1612.html?t=1587&amp;p=5993&amp;viewfull=1#post5993" class="postcounter">#5</a><a id="postcount5993" name="5"></a>
				
				
				
			</span>
	</div>
	<div class="postdetails">
		<div class="userinfo">
			<div class="username_container">
			
				<div class="popupmenu memberaction">
	<a class="username offline popupctrl" href="memberdb73.html?u=311" title="c0d3inj3cT is offline"><strong>c0d3inj3cT</strong></a>
	<ul class="popupbody popuphover memberaction_body">
		<li class="left">
			<a href="memberdb73.html?u=311" class="siteicon_profile">
				View Profile
			</a>
		</li>
		
		<li class="right">
			<a href="search9737.html?do=finduser&amp;userid=311&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">
				View Forum Posts
			</a>
		</li>
		
		
		<li class="left">
			<a href="private1fcf.html?do=newpm&amp;u=311" class="siteicon_message" rel="nofollow">
				Private Message
			</a>
		</li>
		
		
		
		<li class="right">
			<a href="blogdb73.html?u=311" class="siteicon_blog" rel="nofollow">
				View Blog Entries
			</a>
		</li>
		
		
		
		
		
		<li class="right">
			<a href="list1ee8.html?r=author/311-c0d3inj3cT" class="siteicon_article" rel="nofollow">
				View Articles
			</a>
		</li>
		

		

		
		
	</ul>
</div>
				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.html" alt="c0d3inj3cT is offline" border="0" />

			
			</div>
			<span class="usertitle">
				Garage Member
			</span>
			
			
			
				<span class="postbit_reputation" id="repdisplay_5993_311" title="c0d3inj3cT will become famous soon enough">
					
						<img class="repimg" src="images/reputation/reputation_pos.html" alt="" />
					
						<img class="repimg" src="images/reputation/reputation_pos.html" alt="" />
					
				</span>
			
			 
			
				<hr />
				<dl class="userinfo_extra">
					<dt>Join Date</dt> <dd>Dec 2010</dd>
					
					
					<dt>Posts</dt> <dd>67</dd>	
					<dt>Blog Entries</dt><dd><a href="blogdb73.html?u=311">2</a></dd>
				</dl>
				
				
				<div class="imlinks">
					    
				</div>
			
		</div>
		<div class="postbody">
			<div class="postrow">
				
				


						
						
							
						
				<div class="content">
					<div id="post_message_5993">
						<blockquote class="postcontent restore ">
							We have discussed about how the rootkit controls low level disk service during the booting process by hooking the BIOS Interrupt, int 13h.<br />
<br />
However, once the OS has loaded, a security software or anti rootkit can try to read the infected MBR to detect the presence of any MBR rootkits.<br />
<br />
I'll cover a few basic definitions which will help to understand the process better:<br />
<br />
<b>IRP:</b> This is an I/O Request Packet and it is defined as a structure in Windows. It provides a set of members which can be used by drivers to complete the I/O request.<br />
<br />
<b>Major function codes:</b> IRP_MJ_XXX tells the driver what operations the device driver must carry out to satisfy the I/O request. The operation carried out by the driver for a specific function code depends on the underlying device.<br />
<br />
In order to bypass these security mechanisms, the below approach is followed:<br />
<br />
The rootkit identifies unused free space on the disk which is usually the last sector of the disk. It makes a backup copy of the original MBR and places this copy in the last sector. When an antirootkit or a security software tries to read the infected MBR, the rootkit intercepts this request and returns the original MBR from the last sector of the hard disk.<br />
<br />
We'll look in more detail about the process which is used to intercept these calls. Which drivers are patched by the rootkit and the security solutions provided to bypass these hooks.<br />
<br />
The rootkit will patch the disk.sys storage driver to intercept any Disk I/O Operation. To do this, it will patch the disk.sys's dispatch routines which handle the I/O major function codes, IRP_MJ_READ and IRP_MJ_WRITE.<br />
<br />
Every driver for a device from which data can be transferred to the system must have a DispatchRead Routine and every driver for a device to which data can be transferred must have a DispatchWrite routine.<br />
<br />
In the same way, a driver for a device which can both transfer data from and to the system must have a DispatchReadWrite routine.<br />
<br />
DispatchReadWrite routine handles both the major function codes, IRP_MJ_READ and IRP_MJ_WRITE.<br />
<br />
In Windows, the disk.sys's dispatch routines for IRP_MJ_READ and IRP_MJ_WRITE major functions point to the ClassReadWrite function of ClassPnP.sys driver.<br />
<br />
disk.sys's Major Function[IRP_MJ_READ &amp; IRP_MJ_WRITE] = ClassPnP!ClassReadWrite<br />
<br />
This gives an opportunity to antirootkits to read the infected MBR bypassing the rootkit's hooks by finding the pointer to ClassReadWrite function.<br />
<br />
ClassReadWrite function is not exported by classpnp.sys driver. To find out the value of this pointer we need to read the disassembled code of ClassInitialize function which is exported by classpnp.sys driver.<br />
<br />
Using a MOV instruction, the pointer to ClassReadWrite is set in the ClassInitialize function.<br />
<br />
mov eax, offset [ClassPnP]!ClassReadWrite<br />
<br />
antirookit authors made use of this, to get the pointer and read the MBR bypassing rootkit's hook mechanism.<br />
<br />
In the next version of rootkit, changes were made to patch classpnp.sys driver as well.<br />
<br />
The value of the pointer to ClassReadWrite is modified in the ClassInitialize function.<br />
<br />
There's another driver whose dispatch routines point to ClassReadWrite function. This is cdrom.sys driver. So, rootkit authors updated the rootkit to patch the dispatch routines of both disk.sys and cdrom.sys drivers for IRP_MJ_READ and IRP_MJ_WRITE major function codes.<br />
<br />
They even included hooks on dispatch routines of other function codes for Control and Close Functions.<br />
<br />
<b>Patched drivers:</b><br />
<br />
<ul><li style="">disk.sys (dispatch routines for IRP_MJ_READ and IRP_MJ_WRITE)</li><li style="">cdrom.sys (dispatch routines for IRP_MJ_READ and IRP_MJ_WRITE)</li><li style="">classpnp.sys (ClassReadWrite pointer which is set in ClassInitialize Function)</li></ul>
						</blockquote>
					</div>

					
				</div>
			</div>
			
			<div class="cleardiv"></div>
		</div>
	</div>
		<div class="postfoot">
			<!-- <div class="postfoot_container"> -->
			<div class="textcontrols floatcontainer">
				<span class="postcontrols">
					<img style="display:none" id="progress_5993" src="images/misc/progress.html" alt="" />
					
					
					
						<a id="qrwq_5993" class="newreply" href="newreplycab1.html?do=newreply&amp;p=5993" rel="nofollow" title="Reply With Quote"><img id="quoteimg_5993" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> 
					
					
					
				</span>
				<span class="postlinking">
					
						
					

					
					
					
					

					
					

					
					
					
					
					
				</span>
			<!-- </div> -->
			</div>
		</div>
	<hr />
</li>

		</ol>
                <div class="separator"></div>
		<div class="postlistfoot">
			
		</div>

	

</div>

<div id="below_postlist" class="noinlinemod below_postlist">
	
	<div id="pagination_bottom" class="pagination_bottom">
	
		<div class="clear"></div>
<div class="navpopupmenu popupmenu nohovermenu" id="showthread_navpopup">
	
		<span class="shade">Quick Navigation</span>
		<a href="showthreadabdd.html?t=1587" class="popupctrl"><span class="ctrlcontainer">Botnets, Malwares &amp; Rootkits Analysis</span></a>
		<a href="showthread9227.html?t=1587&amp;p=5993#top" class="textcontrol" onclick="document.location.hash='top';return false;">Top</a>
	
	<ul class="navpopupbody popupbody popuphover">
		
		<li class="optionlabel">Site Areas</li>
		<li><a href="usercp.html">Settings</a></li>
		<li><a href="private.html">Private Messages</a></li>
		<li><a href="subscription.html">Subscriptions</a></li>
		<li><a href="online.html">Who's Online</a></li>
		<li><a href="search.html">Search Forums</a></li>
		<li><a href="forum.html">Forums Home</a></li>
		
			<li class="optionlabel">Forums</li>
			
		
			
				<li><a href="forumdisplay58da.html?f=1">Garage Network</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplay12a3.html?f=2">Garage Announcements</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplaye57d.html?f=58">Bravo - Null 2012</a></li>
			
		
			
				<li><a href="forumdisplay0756.html?f=59">Garage Local Chapter Meets</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplay31e6.html?f=4">Garage Rules</a></li>
			
		
			
				<li><a href="forumdisplaye774.html?f=5">Feedback &amp; Suggestions</a></li>
			
		
			
				<li><a href="forumdisplayd42b.html?f=7">Introduce Your Self</a></li>
			
		
			
				<li><a href="forumdisplay2b89.html?f=38">Shout-box</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplaycf19.html?f=6">Garage Lounge</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplay5579.html?f=30">Hacking for Beginners</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplay6ac3.html?f=57">Did You Know?</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplay957d.html?f=8">Security &amp; Hacking News Thread</a></li>
			
		
			
				<li><a href="forumdisplay3215.html?f=36">Career in InfoSec</a></li>
			
		
			
				<li><a href="forumdisplay814c.html?f=29">Request Zone</a></li>
			
		
			
				<li><a href="forumdisplay13b6.html?f=27">Noobs Corner</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplayfdc5.html?f=9">Hacking and Security Discussions</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplayfac0.html?f=55">Tip | Trick of the Day</a></li>
			
		
			
				<li><a href="forumdisplayc4a6.html?f=66">ICS / SCADA Security</a></li>
			
		
			
				<li><a href="forumdisplay6111.html?f=67">Internet of Things - IoT</a></li>
			
		
			
				<li><a href="forumdisplay15ca.html?f=10">Network Vulnerabiltity Assessment &amp; Penetration Testing</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplaya05c.html?f=56">Post Exploitation</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplay8a83.html?f=11">Web Application Penetration Testing</a></li>
			
		
			
				<li><a href="forumdisplay01c9.html?f=12">Wireless and Bluetooth Hacking</a></li>
			
		
			
				<li><a href="forumdisplay48ab.html?f=17">Computer Forensics and Incident Handling</a></li>
			
		
			
				<li><a href="forumdisplay218b.html?f=19">Physical Security and Social Engineering</a></li>
			
		
			
				<li><a href="forumdisplayb09f.html?f=15">General Security &amp; Best Practices</a></li>
			
		
			
				<li><a href="forumdisplay907f.html?f=42">Security and Hacking Videos</a></li>
			
		
			
				<li><a href="forumdisplay9e0d.html?f=54">Mobile Security</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplay9780.html?f=14">General Security Discussions</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplay9df8.html?f=31">Programming</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplay65b9.html?f=35">Assembly</a></li>
			
		
			
				<li><a href="forumdisplayc4f1.html?f=32">C/C++</a></li>
			
		
			
				<li><a href="forumdisplayb0a0.html?f=34">Perl</a></li>
			
		
			
				<li><a href="forumdisplayb8c1.html?f=60">PHP</a></li>
			
		
			
				<li><a href="forumdisplay6c4e.html?f=33">Python</a></li>
			
		
			
				<li><a href="forumdisplay208f.html?f=51">Linux Shell / Bash Programming</a></li>
			
		
			
				<li><a href="forumdisplay3238.html?f=47">Windows Batch Programming</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplayce40.html?f=28">BackTrack and Other Linux Distributions</a></li>
			
		
			
				<li><a href="forumdisplayf2fa.html?f=16">Networks &amp; Networking</a></li>
			
		
			
				<li><a href="forumdisplaya213.html?f=18">Cloud Computing</a></li>
			
		
			
				<li><a href="forumdisplaydfa4.html?f=39">Security Podcast and Videos</a></li>
			
		
			
				<li><a href="forumdisplaya3f5.html?f=40">Miscellanous Thread</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplay30ac.html?f=49">Brush Up Your Skills</a></li>
			
		
			
					</ol>
				</li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplayffeb.html?f=20">Experts Forum</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplaycdba.html?f=48">My Meanest Hacks</a></li>
			
		
			
				<li><a href="forumdisplayf6ac.html?f=37">Hacking &amp; Security Books and Tutorials</a></li>
			
		
			
				<li><a href="forumdisplay8011.html?f=23">Tools &amp; Scripts</a></li>
			
		
			
				<li><a href="forumdisplay8941.html?f=22">Exploitation Techniques</a></li>
			
		
			
				<li><a href="forumdisplay345c.html?f=24">Reverse Engineering and Application Cracking</a></li>
			
		
			
				<li><a href="forumdisplaye8b3.html?f=25">Botnets, Malwares &amp; Rootkits Analysis</a></li>
			
		
			
				<li><a href="forumdisplay107e.html?f=43">Garage4hackers Exploits</a></li>
			
		
			
				<li><a href="forumdisplaye5f3.html?f=64">Browser Fuzzing</a></li>
			
		
			
					</ol>
				</li>
			
		
		
	</ul>
</div>
<div class="clear"></div>
	</div>
</div>










<!-- next / previous links -->
<div class="navlinks">
	
	<strong>&laquo;</strong>
	<a href="showthread4e9e.html?t=1587&amp;goto=nextoldest" rel="nofollow">Previous Thread</a>
	|
	<a href="showthread38f0.html?t=1587&amp;goto=nextnewest" rel="nofollow">Next Thread</a>
	<strong>&raquo;</strong>
	
</div>
<!-- / next / previous links -->

<div id="thread_info" class="thread_info">
	
	
	
	
	<div class="options_block_container">
		
		<div class="options_block">
			<h4 class="collapse">
				<a class="collapse" id="collapse_posting_rules" href="showthread9227.html?t=1587&amp;p=5993#top"><img src="images/buttons/collapse_40b.png" alt="" /></a>
				<span class="optiontitle">Posting Permissions</span>
			</h4>
			<div id="posting_rules" class="thread_info_block">
				
<div id="forumrules" class="info_subblock">

	<ul class="youcandoblock">
		<li>You <strong>may not</strong> post new threads</li>
		<li>You <strong>may not</strong> post replies</li>
		<li>You <strong>may not</strong> post attachments</li>
		<li>You <strong>may not</strong> edit your posts</li>
		<li>&nbsp;</li>
	</ul>
	<div class="bbcodeblock">
		<ul>
			<li><a href="miscaff0.html?do=bbcode" target="_blank">BB code</a> is <strong>On</strong></li>
			<li><a href="misc9712.html?do=showsmilies" target="_blank">Smilies</a> are <strong>On</strong></li>
			<li><a href="miscaff0.html?do=bbcode#imgcode" target="_blank">[IMG]</a> code is <strong>On</strong></li>
			<li><a href="miscaff0.html?do=bbcode#videocode" target="_blank">[VIDEO]</a> code is <strong>On</strong></li>
			<li>HTML code is <strong>Off</strong></li>
		</ul>
	</div>
	<p class="rules_link"><a href="misc17ec.html?do=showrules" target="_blank">Forum Rules</a></p>

</div>

			</div>
		</div>

	</div>

</div>








<div style="clear: left">
  
<div class="google_adsense_footer" style="width:468px; margin:0 auto; padding-top:1em">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6847984837250662";
google_ad_host = "ca-host-pub-2606800903002383";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "text_image";
google_ad_channel = "";
google_color_border = "";
google_color_bg = "";
google_color_link = "";
google_color_text = "";
google_color_url = "";
google_ui_features = "rc:6";
//-->
</script>
<script type="text/javascript"
  src="../pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>

  <div id="ad_global_above_footer"><div align="center">
<script type="text/javascript"><!--
google_ad_client = "pub-6847984837250662";
/* 728x90, created 7/9/10 */
google_ad_slot = "7101394260";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="../pagead2.googlesyndication.com/pagead/show_ads.js">
</script></div>
</div>

<div id="footer" class="floatcontainer footer">

	<form action="../external.html?link=http://garage4hackers.com/forum.php" method="get" id="footer_select" class="footer_select">

		
			<select name="styleid" onchange="switch_id(this, 'style')">
				<optgroup label="Quick Style Chooser"><option class="hidden"></option></optgroup>
				
					
					<optgroup label="&nbsp;Standard Styles">
									
					
	<option value="1" class="" selected="selected">-- Default Style</option>

					
					</optgroup>
										
				
				
					
					<optgroup label="&nbsp;Mobile Styles">
					
					
	<option value="2" class="" >-- Default Mobile Style</option>

					
					</optgroup>
										
				
			</select>	
		
		
		
	</form>

	<ul id="footer_links" class="footer_links">
		<li><a href="sendmessage.html" rel="nofollow" accesskey="9">Contact Us</a></li>
		<li><a href="index.html">Garage4hackers</a></li>
		
		
		<li><a href="archive/index.html">Archive</a></li>
		<li><a href="../external.html?link=http://glowhost.com/" target="_blank">Web Hosting</a></li>
		
		
		<li><a href="showthread9227.html?t=1587&amp;p=5993#top" onclick="document.location.hash='top'; return false;">Top</a></li>
	</ul>
	
	
	
	
	<script type="text/javascript">
	<!--
		// Main vBulletin Javascript Initialization
		vBulletin_init();
		function md5hash(B,A,E,C){if(navigator.userAgent.indexOf("Mozilla/index.html")==1&&parseInt(navigator.appVersion)>=4){var D=hex_md5(str_to_ent(trim(B.value)));A.value=D;if(E){D=hex_md5(trim(B.value));E.value=D}if(!C){B.value=""}}return true};
	//-->
	</script>
        
</div>
</div> <!-- closing div for body_wrapper -->

<div class="below_body">
<div id="footer_time" class="shade footer_time">All times are GMT +5.5. The time now is <span class="time">05:53 PM</span>.</div>

<div id="footer_copyright" class="shade footer_copyright">
	<!-- Do not remove this copyright notice -->
	Powered by <a href="../external.html?link=https://www.vbulletin.com/" id="vbulletinlink">vBulletin&reg;</a> Version 4.2.1 <br />Copyright &copy; 2020 vBulletin Solutions, Inc. All rights reserved. 
	<!-- Do not remove this copyright notice -->	
</div>
<div id="footer_morecopyright" class="shade footer_morecopyright">
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	Copyright 2010 - 2017, Garage4Hackers
	
</div>
 

	<div id="fb-root"></div>
<script type="text/javascript" src="clientscript/vbulletin_facebook6719.js?v=421"></script>

<script type="text/javascript">
<!--
	loadFacebookAPI('en_US');
	function fbAsyncInit()
	{
		vBfb = new vB_Facebook({
			appid : "170793809601191",
			connected : 0,
			active : 0,
			autoreg : 0,
			feed_newthread : 1,
			feed_postreply : 1,
			feed_blogentry : 1,
			feed_blogcomment : 1,
			feed_newarticle : 1,
			feed_articlecomment : 1
		});
	}
// -->
</script>

</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker('UA-17311051-3');
pageTracker._trackPageview();
} catch(err) {}</script>
</body>
</html>