<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://www.facebook.com/2008/fbml" dir="ltr" lang="en">

<!-- Mirrored from garage4hackers.com/entry.php?b=3084 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 12:37:04 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=ISO-8859-1" /><!-- /Added by HTTrack -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta id="e_vb_meta_bburl" name="vb_meta_bburl" content="index.html" />
<base  /><!--[if IE]></base><![endif]-->
<meta name="generator" content="vBulletin 4.2.1" />
<meta http-equiv="X-UA-Compatible" content="IE=9" />

	<link rel="Shortcut Icon" href="favicon.ico" type="image/x-icon" />


		<meta name="keywords" content="asp.net, asp.net vulnerabilties, hacking, pen test, sql, sql injection, Preventing SQL Injection attack ASP.NET PART I, ethical hacking,exploits,webapplication,penetration testing,wireless,information security,virus,exploit coding,vbulletin,forum,bbs,discussion,bulletin board,indian hackers" />
		<meta name="description" content="Preventing SQL Injection attack ASP.NET PART I mayurlohite" />



	<meta property="fb:app_id" content="170793809601191" />
<meta property="og:site_name" content="Garage4hackers Forum" />
<meta property="og:description" content="Preventing SQL Injection attack ASP.NET PART I mayurlohite" />
<meta property="og:url" content="entryb0c1.html?b=3084" />
<meta property="og:type" content="article" />




	
		<script type="text/javascript" src="../yui.yahooapis.com/comboaa66?2.9.0/build/yuiloader-dom-event/yuiloader-dom-event.js&amp;2.9.0/build/connection/connection-min.js"></script>
	

<script type="text/javascript">
<!--
	if (typeof YAHOO === 'undefined') // Load ALL YUI Local
	{
		document.write('<script type="text/javascript" src="clientscript/yui/yuiloader-dom-event/yuiloader-dom-event6719.html?v=421"><\/script>');
		document.write('<script type="text/javascript" src="clientscript/yui/connection/connection-min6719.html?v=421"><\/script>');
		var yuipath = 'clientscript/yui';
		var yuicombopath = '';
		var remoteyui = false;
	}
	else	// Load Rest of YUI remotely (where possible)
	{
		var yuipath = '../external.html?link=http://yui.yahooapis.com/2.9.0/build';
		var yuicombopath = '../external.html?link=http://yui.yahooapis.com/combo';
		var remoteyui = true;
		if (!yuicombopath)
		{
			document.write('<script type="text/javascript" src="../yui.yahooapis.com/2.9.0/build/connection/connection-min6719.js?v=421"><\/script>');
		}
	}
	var SESSIONURL = "";
	var SECURITYTOKEN = "guest";
	var IMGDIR_MISC = "images/misc";
	var IMGDIR_BUTTON = "images/buttons";
	var vb_disable_ajax = parseInt("0", 10);
	var SIMPLEVERSION = "421";
	var BBURL = "index.html";
	var LOGGEDIN = 0 > 0 ? true : false;
	var THIS_SCRIPT = "entry";
	var RELPATH = "entryb0c1.html?b=3084";
	var PATHS = {
		forum : "",
		cms   : "",
		blog  : ""
	};
	var AJAXBASEURL = "index.html";
// -->
</script>
<script type="text/javascript" src="clientscript/vbulletin-core6719.js?v=421"></script>



	<link rel="alternate" type="application/rss+xml" title="Garage4hackers Forum RSS Feed" href="external9476.php?type=RSS2" />
	



	<link rel="stylesheet" type="text/css" href="css30f2.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=bbcode.css,editor.css,popupmenu.css,reset-fonts.css,vbulletin.css,vbulletin-chrome.css,vbulletin-formcontrols.css," />

	<!--[if lt IE 8]>
	<link rel="stylesheet" type="text/css" href="css.php?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=popupmenu-ie.css,vbulletin-ie.css,vbulletin-chrome-ie.css,vbulletin-formcontrols-ie.css,editor-ie.css" />
	<![endif]-->


	
		
			<link rel="alternate" type="application/rss+xml" title="mayurlohite - Garage4hackers Forum Blog RSS Feed" href="blog_external18e1.php?type=RSS2&amp;bloguserid=8326" />
		
		<link rel="alternate" type="application/rss+xml" title="Garage4hackers Forum - Blog RSS Feed" href="blog_external9476.php?type=RSS2" />
	
	<link rel="pingback" href="forum.html" />
	
		<!--
			<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
				xmlns:dc="http://purl.org/dc/elements/1.1/"
				xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
			<rdf:Description
				rdf:about="http://garage4hackers.com/entry.php?b=3084"
				dc:identifier="http://garage4hackers.com/entry.php?b=3084"
				dc:title="Preventing SQL Injection attack ASP.NET PART I"
				trackback:ping="http://garage4hackers.com/blog_callback.php?b=3084" />
			</rdf:RDF>
		-->
	
	
		<link rel="stylesheet" type="text/css" href="css68b4.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=postbit-lite.css,blog.css,lightbox.css,attachment.css" />
	
	<!--[if lt IE 8]>
	<script type="text/javascript" src="clientscript/vbulletin-threadlist-ie.js?v=421"></script>
	<link rel="stylesheet" type="text/css" href="css.php?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=postbit-lite-ie.css,blog-ie.css" />
	<![endif]-->
	
	
	
	
		<script type="text/javascript">
		<!--
			vBulletin.register_control("vB_Blog_Userid", "8326");
		//-->
		</script>
	
<script type="text/javascript" src="clientscript/vbulletin_ajax_suggest6719.js?v=421"></script>
	
		<title>Preventing SQL Injection attack ASP.NET PART I - Blogs - Garage4hackers Forum</title>
	
	<link rel="stylesheet" type="text/css" href="css657d.css?styleid=1&amp;langid=1&amp;d=1410988287&amp;td=ltr&amp;sheet=additional.css" />

</head>
<body >
<div class="above_body"> <!-- closing tag is in template navbar -->
<div id="header" class="floatcontainer doc_header">
	<div><a name="top" href="forum.html" class="logo-image"><img src="images/misc/vbulletin4_logo.html" alt="Garage4hackers Forum" /></a></div>
	<div id="toplinks" class="toplinks">
		
			<ul class="nouser">
			
				<li><a href="register.html" rel="nofollow">Register</a></li>
			
				<li><a rel="help" href="faq.html">Help</a></li>
				<li>
			<script type="text/javascript" src="clientscript/vbulletin_md56719.html?v=421"></script>
			<form id="navbar_loginform" action="../external.html?link=http://garage4hackers.com/login.php?do=login" method="post" onsubmit="md5hash(vb_login_password, vb_login_md5password, vb_login_md5password_utf, 0)">
				<fieldset id="logindetails" class="logindetails">
					<div>
						<div>
					<input type="text" class="textbox default-value" name="vb_login_username" id="navbar_username" size="10" accesskey="u" tabindex="101" value="User Name" />
					<input type="password" class="textbox" tabindex="102" name="vb_login_password" id="navbar_password" size="10" />
					<input type="text" class="textbox default-value" tabindex="102" name="vb_login_password_hint" id="navbar_password_hint" size="10" value="Password" style="display:none;" />
					<input type="submit" class="loginbutton" tabindex="104" value="Log in" title="Enter your username and password in the boxes provided to login, or click the 'register' button to create a profile for yourself." accesskey="s" />
						</div>
					</div>
				</fieldset>
				<div id="remember" class="remember">
					<label for="cb_cookieuser_navbar"><input type="checkbox" name="cookieuser" value="1" id="cb_cookieuser_navbar" class="cb_cookieuser_navbar" accesskey="c" tabindex="103" /> Remember Me?</label>
				</div>

				<input type="hidden" name="s" value="" />
				<input type="hidden" name="securitytoken" value="guest" />
				<input type="hidden" name="do" value="login" />
				<input type="hidden" name="vb_login_md5password" />
				<input type="hidden" name="vb_login_md5password_utf" />
			</form>
			<script type="text/javascript">
			YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "inline");
			YAHOO.util.Dom.setStyle('navbar_password', "display", "none");
			vB_XHTML_Ready.subscribe(function()
			{
			//
				YAHOO.util.Event.on('navbar_username', "focus", navbar_username_focus);
				YAHOO.util.Event.on('navbar_username', "blur", navbar_username_blur);
				YAHOO.util.Event.on('navbar_password_hint', "focus", navbar_password_hint);
				YAHOO.util.Event.on('navbar_password', "blur", navbar_password);
			});
			
			function navbar_username_focus(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				if (textbox.value == 'User Name')
				{
				//
					textbox.value='';
					textbox.style.color='#000000';
				}
			}

			function navbar_username_blur(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				if (textbox.value == '')
				{
				//
					textbox.value='User Name';
					textbox.style.color='#777777';
				}
			}
			
			function navbar_password_hint(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				
				YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "none");
				YAHOO.util.Dom.setStyle('navbar_password', "display", "inline");
				YAHOO.util.Dom.get('navbar_password').focus();
			}

			function navbar_password(e)
			{
			//
				var textbox = YAHOO.util.Event.getTarget(e);
				
				if (textbox.value == '')
				{
					YAHOO.util.Dom.setStyle('navbar_password_hint', "display", "inline");
					YAHOO.util.Dom.setStyle('navbar_password', "display", "none");
				}
			}
			</script>
				</li>
				
					<li id="fb_headerbox" class="hidden">

	<a id="fb_loginbtn" href="#"><img src="images/misc/facebook_login.html" alt="The Facebook Platform" /></a>

</li>

				
			</ul>
		
	</div>
	<div class="ad_global_header">
		 
		 
	</div>
	<hr />
</div>
<div id="navbar" class="navbar">
	<ul id="navtabs" class="navtabs floatcontainer">
		
		
	
		<li  id="vbtab_whatsnew">
			<a class="navtab" href="activity.html">What's New?</a>
		</li>
		
		

	
		<li  id="vbtab_cms">
			<a class="navtab" href="content.html">Articles</a>
		</li>
		
		

	
		<li  id="vbtab_forum">
			<a class="navtab" href="forum.html">Forum</a>
		</li>
		
		

	
		<li class="selected" id="vbtab_blog">
			<a class="navtab" href="blog.html">Blogs</a>
		</li>
		
		
			<ul class="floatcontainer">
				
					
						
							<li id="vbblog_recent"><a href="blog2d60.html?do=list">Recent Entries</a></li>
						
					
				
					
						
							<li id="vbblog_popular"><a href="blog7e3c.html?do=list&amp;blogtype=best">Most Popular</a></li>
						
					
				
					
						
							<li id="vbblog_member"><a href="blogd08d.html?do=bloglist">Member Blogs</a></li>
						
					
				
			</ul>
		

	
		<li  id="tab_nja4_357">
			<a class="navtab" href="pages7b82.html?pageid=2">G4H Team</a>
		</li>
		
		

	
		<li  id="tab_nta0_579">
			<a class="navtab" href="pages8782.html?pageid=3">IRC</a>
		</li>
		
		

	
		<li  id="tab_nta0_442">
			<a class="navtab" href="pagesdbe0.html?pageid=4">Ranchoddas</a>
		</li>
		
		

		<li>
            <a class="navtab" href="pages.html">Events and Conferences</a></li>
	</ul>
	
		<div id="globalsearch" class="globalsearch">
			<form action="../external.html?link=http://garage4hackers.com/search.php?do=process" method="post" id="navbar_search" class="navbar_search">
				
				<input type="hidden" name="securitytoken" value="guest" />
				<input type="hidden" name="do" value="process" />
				<span class="textboxcontainer"><span><input type="text" value="" name="query" class="textbox" tabindex="99"/></span></span>
				<span class="buttoncontainer"><span><input type="image" class="searchbutton" src="images/buttons/search.html" name="submit" onclick="document.getElementById('navbar_search').submit;" tabindex="100"/></span></span>
			</form>
			<ul class="navbar_advanced_search">
				<li><a href="search.html" accesskey="4">Advanced Search</a></li>
				
			</ul>
		</div>
	
</div>
</div><!-- closing div for above_body -->

<div class="body_wrapper">
<div id="breadcrumb" class="breadcrumb">
	<ul class="floatcontainer">
		<li class="navbithome"><a href="content.html" accesskey="1"><img src="images/misc/navbit-home.html" alt="Home" /></a></li>
		
	<li class="navbit"><a href="blog.html">Blogs</a></li>

	<li class="navbit"><a href="blogcdca.html?u=8326">mayurlohite</a></li>

		
	<li class="navbit lastnavbit"><span>Preventing SQL Injection attack ASP.NET PART I</span></li>

	</ul>
	<hr />
</div>


<div style="width:728px; margin:0 auto; padding-bottom:1em">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6847984837250662";
google_ad_host = "ca-host-pub-2606800903002383";
google_ad_width = 728;
google_ad_height = 15;
google_ad_format = "728x15_0ads_al_s";
google_ad_channel = "";
google_color_border = "";
google_color_bg = "";
google_color_link = "";
google_color_text = "";
google_color_url = "";
google_ui_features = "rc:6";
//-->
</script>
<script type="text/javascript"
  src="../pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>

<div id="ad_global_below_navbar"><script async src="../pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- garage1 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:728px;height:90px"
     data-ad-client="ca-pub-6847984837250662"
     data-ad-slot="4036513682"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>


	<form action="../external.html?link=http://garage4hackers.com/profile.php?do=dismissnotice" method="post" id="notices" class="notices">
		<input type="hidden" name="do" value="dismissnotice" />
		<input type="hidden" name="s" value="" />
		<input type="hidden" name="securitytoken" value="guest" />
		<input type="hidden" id="dismiss_notice_hidden" name="dismiss_noticeid" value="" />
		<input type="hidden" name="url" value="" />
		<ol>
			<li class="restore" id="navbar_notice_2">
	
	<html>
<h2>
The forum is <a href="showthread1180.html?t=7049&amp;p=14985#post14985">frozen forever</a> - but it won't die; it'll stay for long in search engine results and we hope it would keep helping newbies in some way or other - cheers! 


</h2>

<!-- Mirrored from garage4hackers.com/entry.php?b=3084 by HTTraQt Website Copier/1.x [Karbofos 2012-2017] Sun, 22 Mar 2020 12:37:06 GMT -->
</html>
</li>
		</ol>
	</form>



<div id="usercss" class="blog">
	<div class="cleardiv"></div>

	
	
	<div id="content_container">
		<div id="content">
			<div id="content_inner" class="blockrow restrain_container">
			<!-- main content -->
			<div id="pagetitle">
	
	<a id="rssicon" href="blog_external18e1.php?type=RSS2&amp;bloguserid=8326" rel="nofollow"><img src="images/misc/rss_40b.html" border="0" class="inlineimg" alt="View RSS Feed" /></a>
	
	<h1>mayurlohite</h1>
</div>




<div id="ad_blogshowentry_before"><script type="text/javascript"><!--
google_ad_client = "pub-6847984837250662";
/* 728x90, created 7/11/10 blog entry */
google_ad_slot = "0606213533";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="../pagead2.googlesyndication.com/pagead/show_ads.js">
</script></div>
<div id="above_blogentry">
	
</div>
<div class="block blogentrybit" id="entry3084">
	<h4 id="blog_title" class="blog_header">
		Preventing SQL Injection attack ASP.NET PART I
		
		
	</h4>
	<div class="fly">
		
			<div class="popupmenu" id="blograting">
				<h6><a class="popupctrl" href="javascript://" id="blograting_current"><img class="inlineimg" src="images/rating/rating-15_5.html" alt="Rating: 464 votes, 4.98 average." /></a></h6>
				<form action="../external.html?link=http://garage4hackers.com/blog.php" method="post" id="blog_blograte_form">
					<div class="popupbody popuphover">
						<ul>
							
								<li><label for="r5"><span class="rating r5">
									<input type="radio" name="vote" value="5" id="r5"  /> Excellent
								</span></label></li>
								<li><label for="r4"><span class="rating r4_right">
									<input type="radio" name="vote" value="4" id="r4"  /> Good
								</span></label></li>
								<li><label for="r3"><span class="rating r3_right">
									<input type="radio" name="vote" value="3" id="r3"  /> Average
								</span></label></li>
								<li><label for="r2"><span class="rating r2_right">
									<input type="radio" name="vote" value="2" id="r2"  /> Bad
								</span></label></li>
								<li><label for="r1"><span class="rating r1_right">
									<input type="radio" name="vote" value="1" id="r1"  /> Terrible
								</span></label></li>
								<li class="formsubmit"><input type="submit" class="button" value="Vote Now" /></li>
							
						</ul>
						<input type="hidden" name="s" value="" />
						<input type="hidden" name="securitytoken" value="guest" />
						<input type="hidden" name="do" value="rate" />
						<input type="hidden" name="b" value="3084" />
					</div>
				</form>
				<script type="text/javascript" src="clientscript/blog_ajax_rate6719.html?v=421"></script>
				<script type="text/javascript">
				<!--
					var blogid = 3084;
					vB_AJAX_BlogRate_Init('blog_blograte_form');
				//-->
				</script>
			</div>
		
	</div>
	<div class="block blogbit">
		<div class="bloghead">
			<div class="fly">
				
<a href="entryb0c1.html?b=3084#comments" class="comments">0 Comments</a>
				
				
			</div>
			<div class="blog_date">
				by <div class="popupmenu memberaction">
	<a class="username offline popupctrl" href="membercdca.html?u=8326" title="mayurlohite is offline"><strong>mayurlohite</strong></a>
	<ul class="popupbody popuphover memberaction_body">
		<li class="left">
			<a href="membercdca.html?u=8326" class="siteicon_profile">
				View Profile
			</a>
		</li>
		
		<li class="right">
			<a href="searchcf08.html?do=finduser&amp;userid=8326&amp;contenttype=vBForum_Post&amp;showposts=1" class="siteicon_forum" rel="nofollow">
				View Forum Posts
			</a>
		</li>
		
		
		<li class="left">
			<a href="private9498.html?do=newpm&amp;u=8326" class="siteicon_message" rel="nofollow">
				Private Message
			</a>
		</li>
		
		
		
		<li class="right">
			<a href="blogcdca.html?u=8326" class="siteicon_blog" rel="nofollow">
				View Blog Entries
			</a>
		</li>
		
		
		
		<li class="left">
			<a href="../external.html?link=http://mayurlohite.com/" class="siteicon_homepage">
				Visit Homepage
			</a>
		</li>
		
		
		
		<li class="right">
			<a href="list458d.html?r=author/8326-mayurlohite" class="siteicon_article" rel="nofollow">
				View Articles
			</a>
		</li>
		

		

		
		
	</ul>
</div>, 09-02-2014 at 12:18 PM  (429 Views)
			</div>
		</div>
		
			
<fb:like href="entryb0c1.html?b=3084" font="tahoma" layout="standard" show_faces="false" width="260" action="../external.html?link=http://garage4hackers.com/like" colorscheme="light"></fb:like>
		
		<div class="blogbody postcontainer">
			<div id="entry_text_3084">
				<blockquote class="blogcontent restore floatcontainer">
					<b><br />
Introduction</b><br />
<br />
          Security is the most important attribute for any system.  Providing secure experience is one of the key principles in the process  of gaining customer confidence for a system. Now days, almost all the  websites are asking to store user’s personal information in servers to  understand the customer and serve better. It’s the responsibility of an  organization to confirm that customer’s data is safe and accessed in a  secured manner.          Security in web application is always big headache to developer  but providing secure environments is one of the key principles in the  process of gaining customer confidence for a system. In this era of web  application almost all websites are dynamic i.e. database driven and  large data will accepts from user.<br />
  SQL Injection flaws are introduced when software developers create  dynamic database queries that include user supplied input. This article  explains how SQL Injection is prevented in ASP.NET.<br />
<br />
 <b>Background</b><br />
<br />
          What is Actually SQL Injection attack?<br />
        SQL Injection is a attack used to inject unintended SQL commands  (statements) in a database by accepting malicious, unsecured,  un-validated user input. Injected SQL commands can alter SQL statement  and compromise the security of a web application. If you want to know  SQL Injection attack in detail please visit following link:<br />
 <a href="../external.html?link=https://www.owasp.org/index.php/SQL_Injection" target="_blank">https://www.owasp.org/index.php/SQL_Injection</a><br />
<br />
 <b>Methods of exploit SQL Injection</b><br />
<br />
          Methods of exploits:<br />
        1. Input boxes<br />
        2. Query Strings [GET]     <br />
<br />
 <b>How to exploit?</b><br />
<br />
          In today’s dynamic web applications world its necessary to get  user input and process it so we have to write the various types of SQL  queries to process the data according to user input. Consider the  following query.<br />
Table – user_info, Columns – userID,name,email,password.<br />
        SELECT name,email FROM user_info WHERE userID = 1<br />
        We can devide this query into 2 parts.<br />
        PART-1: Query Part – SELECT userID,email FROM user_info<br />
        PART-2: Input Part – userID=1     <br />
          A hacker usually not interested in PART-1 , he just interested ,  how he can insert malicious query in your PART-2. Let’s take an example  how SQL injection will be exploits.     <br />
<br />
 <b>Using the code</b><br />
<br />
          1. Suppose we have table user_info with some data. Following is the Script.     <br />
 <div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:216px;">CREATE TABLE [dbo].[user_info](
    [userID] [int] IDENTITY(1,1) NOT NULL,
    [name] [nvarchar](200) NULL,
    [email] [nvarchar](200) NULL,
    [password] [nvarchar](50) NULL,
 CONSTRAINT [PK_user_info] PRIMARY KEY CLUSTERED 
(
    [userID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
SET IDENTITY_INSERT [dbo].[user_info] ON
INSERT [dbo].[user_info] ([userID], [name], [email], [password]) VALUES (1, N'Mayur Lohite', N'mayur@mayur.com', N'123456')
INSERT [dbo].[user_info] ([userID], [name], [email], [password]) VALUES (2, N'John Doe', N'john@john.com', N'654321')
INSERT [dbo].[user_info] ([userID], [name], [email], [password]) VALUES (3, N'Hacker', N'hack@hack.com', N'789123')
SET IDENTITY_INSERT [dbo].[user_info] OFF</pre>
</div>         2. create a new empty ASP.NET website project. Add following two pages into it. I. Default.aspx II. viewuser.aspx<br />
          3. Code for Default.aspx     <br />
 <div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:372px;">&lt;%@ page language=&quot;&quot;C#&quot;&quot; autoeventwireup=&quot;&quot;true&quot;&quot; codefile=&quot;&quot;Default.aspx.cs&quot;&quot;
    inherits=&quot;&quot;_Default&quot;&quot; %&gt;

&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd &quot;&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
&lt;head runat=&quot;server&quot;&gt;
    &lt;title&gt;SQL Injection Demo&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form id=&quot;form1&quot; runat=&quot;server&quot;&gt;
    &lt;div style=&quot;width: 50%; margin: 0 auto; text-align: center;&quot;&gt;
        &lt;table&gt;
            &lt;tr&gt;
                &lt;td colspan=&quot;2&quot;&gt;
                    &lt;h2&gt;
                        SQL Injection Demo&lt;/h2&gt;
                &lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td&gt;
                    Search by userid
                    &lt;asp:textbox id=&quot;txtUserID&quot; runat=&quot;server&quot;&gt;
                    &lt;/asp:textbox&gt;
                &lt;/td&gt;
                &lt;td&gt;
                    &lt;asp:button id=&quot;btnSubmit&quot; onclick=&quot;BtnSubmit_Click&quot; runat=&quot;server&quot; text=&quot;Search&quot; /&gt;
                &lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;asp:gridview id=&quot;gvUserInfo&quot; width=&quot;100%&quot; runat=&quot;server&quot; datakeynames=&quot;userID&quot; autogeneratecolumns=&quot;false&quot;&gt;
                    &lt;Columns&gt;
                        &lt;asp:BoundField DataField=&quot;userID&quot; HeaderText=&quot;userID&quot; /&gt;
                        &lt;asp:BoundField DataField=&quot;name&quot; HeaderText=&quot;name&quot; /&gt;
                        &lt;asp:BoundField DataField=&quot;email&quot; HeaderText=&quot;email&quot; /&gt;
                        &lt;asp:HyperLinkField DataNavigateUrlFields=&quot;userID&quot; DataNavigateUrlFormatString=&quot;viewuser.aspx?userid={0}&quot;
                            Text=&quot;View User&quot; HeaderText=&quot;action&quot; /&gt;
                    &lt;/Columns&gt;
                &lt;/asp:gridview&gt;
            &lt;/tr&gt;
        &lt;/table&gt;
    &lt;/div&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
</div>         4. Code for Default.aspx.cs<br />
 <div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:372px;">public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
            DataSet dset = new DataSet();
            SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings[&quot;MyExpConnectionString&quot;].ToString());
            using (conn)
            {
                conn.Open();
                SqlDataAdapter adapter = new SqlDataAdapter();
                SqlCommand cmd = new SqlCommand(&quot;SELECT userID, name, email FROM user_info&quot;, conn);
                cmd.CommandType = CommandType.Text;
                adapter.SelectCommand = cmd;
                adapter.Fill(dset);
                gvUserInfo.DataSource = dset;
                gvUserInfo.DataBind();

            }
               
        }
    }

    protected void BtnSubmit_Click(object sender, EventArgs e)
    {
        DataSet dset = new DataSet();
        SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings[&quot;MyExpConnectionString&quot;].ToString());
        using (conn)
        {
            conn.Open();
            SqlDataAdapter adapter = new SqlDataAdapter();
            string sqlQuery = string.Format(&quot;SELECT userID, name, email FROM user_info WHERE userID={0}&quot;, txtUserID.Text);
            SqlCommand cmd = new SqlCommand(sqlQuery, conn);
            cmd.CommandType = CommandType.Text;
            adapter.SelectCommand = cmd;
            adapter.Fill(dset);
            gvUserInfo.DataSource = dset;
            gvUserInfo.DataBind();

        }
       
    }
}</pre>
</div>         Default page screen shot     <br />
     <a href="attachment1a78.jpg?attachmentid=783&amp;d=1409648720" id="attachment783" rel="Lightbox_3084" ><img src="attachment3775.jpg?attachmentid=783&amp;d=1409639618" border="0" alt="Click image for larger version.&nbsp;

Name:	default.jpg&nbsp;
Views:	975&nbsp;
Size:	32.3 KB&nbsp;
ID:	783" class="size_large" /></a><br />
          5. Code for viewuser.aspx     <br />
 <div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:372px;">&lt;%@ Page Language=&quot;C#&quot; AutoEventWireup=&quot;true&quot; CodeFile=&quot;viewuser.aspx.cs&quot; Inherits=&quot;viewuser&quot; %&gt;

&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
&lt;head runat=&quot;server&quot;&gt;
    &lt;title&gt;SQL Injection Demo&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form id=&quot;form1&quot; runat=&quot;server&quot;&gt;
    &lt;div style=&quot;width: 50%; margin: 0 auto; text-align: center;&quot;&gt;
        &lt;table&gt;
            &lt;tr&gt;
                &lt;td colspan=&quot;2&quot;&gt;
                    &lt;h2&gt;
                        SQL Injection Demo&lt;/h2&gt;
                &lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td&gt;
                    &lt;h3&gt;
                        Welcome
                        &lt;asp:Label ID=&quot;lblDetails&quot; runat=&quot;server&quot;&gt;&lt;/asp:Label&gt;
                    &lt;/h3&gt;
                &lt;/td&gt;
            &lt;/tr&gt;
        &lt;/table&gt;
    &lt;/div&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
</div>         6. Code for viewuser.aspx.cs     <br />
 <div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:336px;">public partial class viewuser : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        if (Request.QueryString[&quot;userid&quot;] != null)
        {
            DataSet dset = new DataSet();
            SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings[&quot;MyExpConnectionString&quot;].ToString());
            using (conn)
            {
                conn.Open();
                SqlDataAdapter adapter = new SqlDataAdapter();
                string sqlQuery = string.Format(&quot;SELECT name FROM user_info WHERE userID={0}&quot;, Request.QueryString[&quot;userid&quot;]);
                SqlCommand cmd = new SqlCommand(sqlQuery, conn);
                cmd.CommandType = CommandType.Text;
                adapter.SelectCommand = cmd;
                adapter.Fill(dset);
                if (dset.Tables[0].Rows.Count &gt; 0)
                {
                    lblDetails.Text = dset.Tables[0].Rows[0][&quot;name&quot;].ToString(); ;
                }
                
            }
        }
    }
}</pre>
</div>         viewuser page screen shot     <br />
     <a href="attachmentbbe9.jpg?attachmentid=782&amp;d=1409648720" id="attachment782" rel="Lightbox_3084" ><img src="attachmentb964.jpg?attachmentid=782&amp;d=1409639704" border="0" alt="Click image for larger version.&nbsp;

Name:	viewuser.jpg&nbsp;
Views:	855&nbsp;
Size:	11.2 KB&nbsp;
ID:	782" class="size_large" /></a><br />
 <b>Exploitation</b><br />
<br />
          <b>Approach 1: By Input Boxes.</b><br />
<br />
          A-1. First Consider the Default Page, we have One TextBox, One  Button and One GridView. On form load all data will be displayed on grid  view. We have functionality to search user by their ID. Suppose I enter  1 to textbox and press button it will display the record associated  with userID = 1.<br />
          A-2. Now if we take look at above code in Default.aspx.cs there is button click event i.e.<br />
         <div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:36px;">protected void BtnSubmit_Click(object sender, EventArgs e)</pre>
</div>                  The query is written as a string and user input is concatenated with it.     <br />
         <div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:36px;">string sqlQuery = string.Format(&quot;SELECT userID, name, email FROM user_info WHERE userID={0}&quot;, txtUserID.Text);</pre>
</div>                  A-3.suppose , the user input is not validate properly then  hacker or attacker can concatenate any malicious query with it. In this  scenario I am concatenating another SELECT statement with help of UNION  to txtUserID.Text     <br />
          A-4. I have entered the following text on textbox (txtUserID)  without quotes “1 UNION SELECT userID,email,password FROM user_info”<br />
          A-5. Now complete query becomes:     <br />
             <div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:36px;">string sqlQuery = SELECT userID, name, email FROM user_info WHERE userID=1 UNION SELECT userID,email,password FROM user_info</pre>
</div>                  A-6. If I hit click on button the gridview display combination  of both SELECT QUERY and the user password is revealed. If the query  used with user input concatenation without any input validations then  code is always vulnerable for SQL Injection Attack.<br />
          Note: I have increased the size of textbox to understand the query better.<br />
     <a href="attachment21b0.jpg?attachmentid=781&amp;d=1409648720" id="attachment781" rel="Lightbox_3084" ><img src="attachment714c.jpg?attachmentid=781&amp;d=1409639765" border="0" alt="Click image for larger version.&nbsp;

Name:	defaultsqli.jpg&nbsp;
Views:	1053&nbsp;
Size:	61.3 KB&nbsp;
ID:	781" class="size_large" /></a><br />
          <b>Approach 2: Query Strings [GET]</b>     <br />
<br />
          B-1. Now please go to default.aspx and click on viewuser link on  GridView. The page will redirect to viewuser.aspx with userid query  string parameter.<br />
          B-2. The page welcomes the user by their name. The name will founded by userid from query string value.<br />
          B-3. Now if we take look at above code in viewuser.aspx.cs Form_Load event      <br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:36px;">protected void Page_Load(object sender, EventArgs e)</pre>
</div>                  The query is written as a string and the query string is concatenated with it.     <br />
         <div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:36px;">string sqlQuery = string.Format(&quot;SELECT name FROM user_info WHERE userID={0}&quot;, Request.QueryString[&quot;userid&quot;]);</pre>
</div>                  B-4. Now Suppose I append the malicious Select query to  Request.QueryString[&quot;userid&quot;] as same as the above approach the URL  becomes<br />
         <div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:36px;"><a href="../external.html?link=http://mayurlohite.com/viewsuer.aspx?userid=1" target="_blank">http://mayurlohite.com/viewsuer.aspx?userid=1</a> UNION SELECT password FROM user_info WHERE userID = 1</pre>
</div>                   B-5. If I hit enter then the label will display the password associated with userID = 1<br />
<br />
     <a href="attachment81fa.jpg?attachmentid=780&amp;d=1409648691" id="attachment780" rel="Lightbox_3084" ><img src="attachment9ced.jpg?attachmentid=780&amp;d=1409639807" border="0" alt="Click image for larger version.&nbsp;

Name:	viewusersqli.jpg&nbsp;
Views:	873&nbsp;
Size:	25.4 KB&nbsp;
ID:	780" class="size_large" /></a><br />
 <b><br />
Why this happens?</b><br />
<br />
          In above both approaches the query is concatenated with user  input and the user input is not validating properly. So the attacker  take advantage of it and concatenate the malicious query with it and  Attacker can get the passwords , install the backdoor. Attacker can  manipulate the whole database from sysobject.     <br />
<br />
 <b>How to prevent</b><br />
<br />
          1. Validate the user input properly<br />
        2. Use parameterized SQL queries (sqlParameter) with stored procedures.     <br />
<br />
          <b>1. Validate user input:</b><br />
        If your input take only ids or integers add some validations for accept only numbers.<br />
        If inputs are complicated then use the regex patterns to identify the correct inputs.     <br />
<br />
          <b>2. Parametrized SQL query &amp; Stored Procedure:</b><br />
Parametrized queries do proper substitution of arguments prior  to running the SQL query. It completely removes the possibility of  “dirty” input changing the meaning of your query, with parametrized  queries, in addition to general injection, you get all the data types  handled, numbers (int and float), strings (with embedded quotes), dates  and times (no formatting problems or localization issues when  .ToString() is not called with the invariant culture and your client  moves to a machine with and unexpected date format).     <br />
<br />
          <b>I have rewritten the above code safe from SQL Inection. Please take a look at it.</b><br />
<br />
          1. Code for ConnectionManager.cs Class<br />
 <div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:144px;">public class ConnectionManager
{
    public static SqlConnection GetDatabaseConnection()
    {
        SqlConnection connection = new SqlConnection(Convert.ToString(ConfigurationManager.ConnectionStrings[&quot;MyExpConnectionString&quot;]));
        connection.Open();

        return connection;
    }
}</pre>
</div>2. Code for DataAccessLayer.cs Class<br />
<div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:372px;"> public class DataAccessLayer
{
    public static DataSet DisplayAllUsers()
    {
        DataSet dSet = new DataSet();
        using (SqlConnection connection = ConnectionManager.GetDatabaseConnection())
        {
            try
            {
                SqlCommand command = new SqlCommand(&quot;spDisplayUserAll&quot;, connection);
                command.CommandType = CommandType.StoredProcedure;
                SqlDataAdapter adapter = new SqlDataAdapter();
                adapter.SelectCommand = command;
                adapter.Fill(dSet);
            }
            catch (Exception ex)
            {
                throw;
            }
            return dSet;
        }
    }

    public static DataSet DisplayUserByID(int userID)
    {
        DataSet dSet = new DataSet();
        using (SqlConnection connection = ConnectionManager.GetDatabaseConnection())
        {
            try
            {
                SqlCommand command = new SqlCommand(&quot;spDisplayUserByID&quot;, connection);
                command.CommandType = CommandType.StoredProcedure;
                command.Parameters.Add(&quot;@userID&quot;, SqlDbType.Int).Value = userID;
                SqlDataAdapter adapter = new SqlDataAdapter();
                adapter.SelectCommand = command;
                adapter.Fill(dSet);
            }
            catch (Exception ex)
            {
                throw;
            }
            return dSet;
        }
    }
}</pre>
</div>         3. Code for Default.aspx<br />
 <div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:372px;">&lt;%@ Page Language=&quot;C#&quot; AutoEventWireup=&quot;true&quot; CodeFile=&quot;Default.aspx.cs&quot; Inherits=&quot;_Default&quot; %&gt;

&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
&lt;head runat=&quot;server&quot;&gt;
    &lt;title&gt;SQL Injection Demo&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form id=&quot;form1&quot; runat=&quot;server&quot;&gt;
    &lt;div style=&quot;width: 50%; margin: 0 auto; text-align: center;&quot;&gt;
        &lt;table&gt;
            &lt;tr&gt;
                &lt;td colspan=&quot;2&quot;&gt;
                    &lt;h2&gt;
                        SQL Injection Demo&lt;/h2&gt;
                &lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td&gt;
                    Search by userid
                    &lt;asp:TextBox ID=&quot;txtUserID&quot; runat=&quot;server&quot;&gt;
                    &lt;/asp:TextBox&gt;
                    &lt;&lt;asp:RequiredFieldValidator ID=&quot;rfvUserID&quot; ControlToValidate=&quot;txtUserID&quot; Display=&quot;Dynamic&quot;
                        runat=&quot;server&quot; ErrorMessage=&quot;Required&quot;&gt;&lt;/asp:RequiredFieldValidator&gt;
                    &lt;asp:RegularExpressionValidator ID=&quot;revUserID&quot; runat=&quot;server&quot; ErrorMessage=&quot;Numbers Only&quot;
                        ValidationExpression=&quot;[0-9]+&quot; ControlToValidate=&quot;txtUserID&quot; Display=&quot;Dynamic&quot;&gt;&lt;/asp:RegularExpressionValidator&gt;
                &lt;/td&gt;
                &lt;td&gt;
                    &lt;asp:Button ID=&quot;btnSubmit&quot; OnClick=&quot;BtnSubmit_Click&quot; runat=&quot;server&quot; Text=&quot;Search&quot; /&gt;
                &lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;asp:GridView ID=&quot;gvUserInfo&quot; Width=&quot;100%&quot; runat=&quot;server&quot; DataKeyNames=&quot;userID&quot; AutoGenerateColumns=&quot;false&quot;&gt;
                    &lt;Columns&gt;
                        &lt;asp:BoundField DataField=&quot;userID&quot; HeaderText=&quot;userID&quot; /&gt;
                        &lt;asp:BoundField DataField=&quot;name&quot; HeaderText=&quot;name&quot; /&gt;
                        &lt;asp:BoundField DataField=&quot;email&quot; HeaderText=&quot;email&quot; /&gt;
                        &lt;asp:HyperLinkField DataNavigateUrlFields=&quot;userID&quot; DataNavigateUrlFormatString=&quot;viewuser.aspx?userid={0}&quot;
                            Text=&quot;View User&quot; HeaderText=&quot;action&quot; /&gt;
                    &lt;/Columns&gt;
                &lt;/asp:GridView&gt;
            &lt;/tr&gt;
        &lt;/table&gt;
    &lt;/div&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
</div>         4. Code for Default.aspx.cs<br />
 <div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:360px;">public partial class _Default : System.Web.UI.Page
{

    protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
            DataSet dset = DataAccessLayer.DisplayAllUsers();
            if (dset.Tables[0].Rows.Count &gt; 0)
            {
                gvUserInfo.DataSource = dset;
                gvUserInfo.DataBind();
            }
            
        }
    }

    protected void BtnSubmit_Click(object sender, EventArgs e)
    {
        int userID = Convert.ToInt32(txtUserID.Text);
        DataSet dSet = DataAccessLayer.DisplayUserByID(userID);
        if (dSet.Tables[0].Rows.Count &gt; 0)
        {
            gvUserInfo.DataSource = dSet;
            gvUserInfo.DataBind();
        }
    }
}</pre>
</div>         5. Code for viewuser.aspx<br />
 <div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:372px;">&lt;%@ Page Language=&quot;C#&quot; AutoEventWireup=&quot;true&quot; CodeFile=&quot;viewuser.aspx.cs&quot; Inherits=&quot;viewuser&quot; %&gt;

&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
&lt;head runat=&quot;server&quot;&gt;
    &lt;title&gt;SQL Injection Demo&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form id=&quot;form1&quot; runat=&quot;server&quot;&gt;
    &lt;div style=&quot;width: 50%; margin: 0 auto; text-align: center;&quot;&gt;
        &lt;table&gt;
            &lt;tr&gt;
                &lt;td colspan=&quot;2&quot;&gt;
                    &lt;h2&gt;
                        SQL Injection Demo&lt;/h2&gt;
                &lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
                &lt;td&gt;
                    &lt;h3&gt;
                        Welcome
                        &lt;asp:Label ID=&quot;lblDetails&quot; runat=&quot;server&quot;&gt;&lt;/asp:Label&gt;
                    &lt;/h3&gt;
                &lt;/td&gt;
            &lt;/tr&gt;
        &lt;/table&gt;
    &lt;/div&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
</div>         6. Code for viewuser.aspx.cs<br />
 <div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:204px;">public partial class viewuser : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        if (Request.QueryString[&quot;userid&quot;] != null)
        {
            int userID = Convert.ToInt32(Request.QueryString[&quot;userID&quot;]);
            DataSet dSet = DataAccessLayer.DisplayUserByID(userID);
            if (dSet.Tables[0].Rows.Count &gt; 0)
            {
                lblDetails.Text = Convert.ToString(dSet.Tables[0].Rows[0][&quot;name&quot;]);
            }
        }
    }
}</pre>
</div>         7. Stored Procedure: spDisplayUserAll     <br />
 <div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:108px;">CREATE PROCEDURE spDisplayUserAll
AS
BEGIN
    SET NOCOUNT ON;
    SELECT userID, name, email 
    FROM user_info
END</pre>
</div>         8. Stored Procedure: spDisplayUserByID     <br />
 <div class="bbcode_container">
	<div class="bbcode_description">Code:</div>
	<pre class="bbcode_code"style="height:132px;">CREATE PROCEDURE spDisplayUserByID 
    @userID int = 0
AS
BEGIN
    SET NOCOUNT ON;
    SELECT userID, name, email 
    FROM user_info
    WHERE userID = @userID
END</pre>
</div><b>Points of Interest</b><br />
<br />
          The SQL Injection is most common security vulnerability known in  web applications. The dynamic webpages without handling validations and  improper handling of code may lead to SQLI but by knowing proper code  standred and tricks we will successfully prevent it.     <br />
<br />
<b>Article<br />
</b><a href="../external.html?link=http://mayurlohite.com/preventing-sql-injection-attack-asp-net-part-i/" target="_blank">http://mayurlohite.com/preventing-sq...sp-net-part-i/</a><br />
<a href="../external.html?link=http://codeproject.com/Articles/813965/Preventing-SQL-Injection-Attack-ASP-NET-Part-I" target="_blank">http://codeproject.com/Articles/8139...ASP-NET-Part-I</a><br />
<br />
<b>Download Source Code</b><br />
<br />
<ul><li style=""><a href="../external.html?link=https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f813965%2fcode%2fvulnerable_code.zip&amp;download=true" target="_blank">Download SQLI Vulnerable code - 6.1 KB </a></li><li style=""><a href="../external.html?link=https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f813965%2fcode%2fsafe_code.zip&amp;download=true" target="_blank">Download SQLI Safe code - 8.2 KB</a></li><li style=""><a href="../external.html?link=https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f813965%2fcode%2fdatabase_script.zip&amp;download=true" target="_blank">Download database script - 1.8 KB</a><a href="../external.html?link=https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f813965%2fcode%2fdatabase_script.zip&amp;download=true" target="_blank"><br />
</a> </li></ul>

					
				</blockquote>
			</div>
				


				<div class="blogcontrol fly">
					
				</div>

				<div class="blogmeta">
					
					<p class="lastedited">
						<span class="shade">Updated 09-02-2014 at 03:14 PM by</span> <a href="membercdca.html?u=8326">mayurlohite</a>
						
					</p>
					

					
					<div class="tags" id="blogtagcontainer_3084">
							Tags:
							<span id="blogtaglist_3084">
								
								<a href="blog7df5.html?u=8326&amp;tag=asp.net">asp.net</a>, 
	

	
		<a href="blog2d3b.html?u=8326&amp;tag=asp.net+vulnerabilties">asp.net vulnerabilties</a>, 
	

	
		<a href="blog907d.html?u=8326&amp;tag=hacking">hacking</a>, 
	

	
		<a href="blog9f31.html?u=8326&amp;tag=pen+test">pen test</a>, 
	

	
		<a href="blog4013.html?u=8326&amp;tag=sql">sql</a>, 
	

	
		<a href="blog1b2e.html?u=8326&amp;tag=sql+injection">sql injection</a>
								
							</span>
							
								<span id="blogtagmenu_3084"><a href="threadtag798b.html?do=manage&amp;contenttype=vBBlog_BlogEntry&amp;contentid=3084"><img src="images/misc/blog/tag_edit.html" border="0" class="inlineimg" id="blogtag_3084" alt="Add / Edit Tags" /></a></span>
							
					</div>
					
				
					
					<dl class="blogcategory stats">
						<dt class="shade">Categories</dt>
						<dd>

	
		<a href="blog47cb.html?u=8326&amp;blogcategoryid=-1">Uncategorized</a>
	
</dd>
					</dl>
					
				</div>
				<ul class="entrycontrols">
					
					
					
					
					
				</ul>

		</div>
	</div>

</div>

<div id="navlinks">
	<!-- top navlinks -->
	
		&laquo; <a href="blog7755.html?b=3084&amp;goto=prev">Prev</a>
		&nbsp;&nbsp;&nbsp;
	
	<a href="blogcdca.html?u=8326">Main</a>
		
			&nbsp;&nbsp;&nbsp;
			<a href="blog8cff.html?b=3084&amp;goto=next">Next</a> &raquo;
		
	<!-- end top navlinks -->
</div>




<!-- lightbox scripts -->
	<script type="text/javascript" src="clientscript/vbulletin_lightbox6719.html?v=421"></script>
	<script type="text/javascript">
	<!--
	vBulletin.register_control("vB_Lightbox_Container", "entry3084", 1);
	//-->
	</script>
<!-- / lightbox scripts -->




<h2 id="comments_heading" class="commentsheader"><a name="comments"></a>Comments</h2>

<div id="above_comments" class="floatcontainer">
	
	
		
</div>

<form action="../external.html?link=http://garage4hackers.com/blog_inlinemod.php?b=3084" method="post" id="commentform" class="block">
	

	<div id="below_comments" class="floatcontainer">
		
	</div>

	<input type="hidden" name="s" value="" />
	<input type="hidden" name="securitytoken" value="guest" />
	<input type="hidden" name="b" value="3084" />
	<input type="hidden" name="bt" value="" />
	<input type="hidden" name="url" value="" />
	<input type="hidden" name="userid" value="8326" />
</form>








	
		<!-- Editor Scripts -->
<script type="text/javascript">
<!--

var CKEDITOR_BASEPATH = getBaseUrl() + 'clientscript/ckeditor/';

var ltr = 'left';



var ignorequotechars = 1;
var allowbasicbbcode = false;

// vB Phrases
vbphrase["must_enter_subject"]           = "You must enter a title / subject!";
vbphrase["message_too_short"]            = "The message you have entered is too short. Please lengthen your message to at least %1$s characters.";
vbphrase["click_quick_reply_icon"]       = "";
vbphrase["all_files"]                    = "All Files";
vbphrase["file_is_too_large"]            = "File is too Large";
vbphrase["invalid_file"]                 = "Invalid File";
vbphrase["maximum_number_of_attachments_reached"] = "Maximum number of attachments reached";

//-->
</script>
<!-- / Editor Scripts -->
		<script type="text/javascript" src="clientscript/ckeditor/ckeditor14ad.html?t=A7HG4HT&amp;v=421"></script><script type="text/javascript" src="clientscript/vbulletin_textedit6719.html?v=421"></script>
	
<div id="ajax_post_errors" class="hidden">
	<div class="block">
		<div class="blockhead floatcontainer">
			<span class="blockhead_info"><input type="button" class="button" value=" X " id="quick_edit_errors_hide" /></span>
			<h2>vBulletin Message</h2>
		</div>
		<div class="blockbody">
			<div id="ajax_post_errors_message" class="blockrow">&nbsp;</div>
		</div>
		<div class="blockfoot">
			<a href="#" id="quick_edit_errors_cancel" class="textcontrol">Cancel Changes</a>
		</div>
	</div>
</div>
	<script type="text/javascript" src="clientscript/blog_quick_edit6719.html?v=421"></script>
	




	

	<h2 id="trackbacks_heading" class="commentsheader"><a name="trackbacks"></a>Trackbacks</h2>

	<div class="trackbacks_block">
		<span class="shade">Total Trackbacks</span> 0
	
		<div class="shade">
			<a href="entryb0c1.html?b=3084" title="Trackback URL" class="shade">No other blogs currently reference this blog entry</a>
		</div>
	

		
		
		<div id="trackbackurl">
			Trackback URL: <input type="text" value="http://garage4hackers.com/blog_callback.php?b=3084" onmouseover="this.select();" />
		</div>
		
	</div>

	


<script type="text/javascript">
<!--
	vBulletin.register_control("vB_QuickEdit_Blog_Entry", "3084");
    extra = {
    //
    };

    extra.userid = "8326";

    vBulletin.register_control("vB_AJAX_TagEditor", "vBBlog_BlogEntry", "3084", "blog", extra);
//-->
</script>
<script type="text/javascript" src="clientscript/vbulletin_menu6719.html?v=421"></script>
<script type="text/javascript" src="clientscript/vbulletin_ajax_tageditor6719.html?v=421"></script>
			<!-- End main content -->
		        </div>
		</div>
	</div>
	<div id="sidebar_container"><h6 class="actionbutton_container">
	
		<a class="pagetitleinfo textcontrol" href="register.html" rel="nofollow"><span>+</span> Create Blog</a>
	
	</h6>

<div id="blog_user_sidebar">
	

	<div class="block mainblock">
		<div class="blocksubhead"><a class="username offline" href="membercdca.html?u=8326">mayurlohite</a></div>
		<div id="userinfoblock" class="floatcontainer">
			
			<a class="avatar" href="membercdca.html?u=8326" title="mayurlohite's Avatar">
				<span class="avatarcontainer"><img src="images/misc/unknown.html" alt="mayurlohite's Avatar" /></span>
			</a>
			
				
			<ul class="list_no_decoration" id="usermenu">
				
					<li>
						<a href="membercdca.html?u=8326"><img src="images/site_icons/profile.html" alt="Go to Profile" /> Go to Profile</a>
					</li>
				
				
				

				
				
				<li>
					<a href="blog186f.html?u=8326&amp;do=markread&amp;readhash=" rel="nofollow"><img src="images/site_icons/markasread.html" alt="Mark as Read" /> Mark as Read</a>
				</li>
				
				
			</ul>
		</div>

		<div class="blockbody">
			<div class="blockrow">
				<div id="userstats">
					
					<dl class="stats">
						<dt>Join Date</dt>
						<dd>Mar 2014</dd>
					</dl>
					
					
					
					<dl class="stats">
						<dt>Posts</dt>
						<dd>0</dd>
					</dl>
					<dl class="stats">
						<dt>Blog Entries</dt>
						<dd>1</dd>
					</dl>
					
					
					
					
					
				</div>

				
			</div>		
		</div>
	</div>
	<div class="underblock"></div>

	

	

	

	<ul id="moveable_blocks">
		
		
		
		
		
		
		
		
	<li id="block_category">
		<div class="block categoryblock" id="block_category_div">
			<div class="blocksubhead smaller moveable"  id="block_category_handle">
				<a href="#top" id="collapse_c_blog_categories" class="collapse"><img src="images/buttons/collapse_40b.png" alt="" /></a>
				
				Blog Categories
			</div>
			<div class="blockbody" id="c_blog_categories">
				<div class="blockrow">
					
					
						<h2 class="local">Local Categories</h2>
						<ul class="folderlist hideoverflow">
							
<li>
	<img src="images/misc/blog/folder.html" class="inlineimg" alt="Uncategorized" border="0" />
	
		
			<a href="blog47cb.html?u=8326&amp;blogcategoryid=-1" title="Uncategorized">Uncategorized</a>
		
	
</li>
						</ul>
					
				</div>
			</div>
		</div>
		<div class="underblock"></div>
	</li>

	<li id="block_entries">
		<div class="block smaller moveable" id="block_entries_div">
			<div class="blocksubhead"  id="block_entries_handle">
				<a href="#top" id="collapse_c_blog_entries" class="collapse"><img id="collapseimg_blog_entries" src="images/buttons/collapse_40b.png" alt="" /></a>
				<a href="blogcdca.html?u=8326">Recent Blog Posts</a>
			</div>
			<div class="blockbody" id="c_blog_entries">
				<ul class="blockrow">
					<li class="avatarcontent floatcontainer">
	<a class="smallavatar">
		
		<img width="30" alt="" src="images/misc/unknown.html" title=""/>
		
	</a>
	<div class="smallavatartext">
		
		<a href="entryb0c1.html?b=3084">Preventing SQL Injection attack ASP.NET PART I</a>
		
		<br />
		
		09-02-2014 <span class="time">12:18 PM</span>
	</div>
</li>
				</ul>
			</div>
		</div>
		<div class="underblock"></div>
	</li>

<li id="block_visitors">
	<div class="block" id="block_visitors_div">
		<div class="blocksubhead" id="block_visitors_handle">
			<a href="#top" id="collapse_c_blog_visitors" class="collapse"><img id="collapseimg_blog_visitors" src="images/buttons/collapse_40b.png" alt="" border="0" /></a>
			Recent Visitors
		</div>
		<div class="blockbody" id="c_blog_visitors">
			<div class="blockrow">
				<ul id="recent_visitors_list" class="commalist">
					
						<li><a class="username" href="membera9c4.html?u=23987">arvinth4</a>, </li>
					
						<li><a class="username" href="memberc79f.html?u=3283">c0dist</a>, </li>
					
						<li><a class="username" href="membere81f.html?u=8">fb1h2s</a></li>
					
				</ul>
			</div>
		</div>
	</div>
	<div class="underblock"></div>
</li>
<li id="block_archive">
	<div class="block blogusermenu" id="vb_blogcalendar">
		<div id="block_archive_div" class="calendar mini">
	<h4 class="blocksubhead smaller moveable" id="block_archive_handle">
		<a href="#top" id="collapse_c_blog_calendar" class="collapse"><img src="images/buttons/collapse_40b.png" alt="" /></a>
		Archive
	</h4>
	<div class="blockbody" id="c_blog_calendar">
		<table width="100%" class="blockrow">
			<tr>
				
					<th class="blocksubhead" align="center" id="vb_blogcalendar_prevmonth" prevmonth="9" prevyear="2014">
						&nbsp;
						
							<a href="blogf04a.html?u=8326&amp;m=9&amp;y=2014">&lt;</a>
						
						&nbsp;
					</th>
									
				<th class="blocksubhead" colspan="5" align="center" id="vb_blogcalendar_currentmonth">
					
						<a href="blogbca4.html?u=8326&amp;m=3&amp;y=2020">March 2020</a>
					
				</th>
				
					<th class="blocksubhead">
						&nbsp;&nbsp;&nbsp;
					</th>
 				
         		</tr>
			<tr align="center">
				<td class="blogsubheader">Su</td>
				<td class="blogsubheader">Mo</td>
				<td class="blogsubheader">Tu</td>
				<td class="blogsubheader">We</td>
				<td class="blogsubheader">Th</td>
				<td class="blogsubheader">Fr</td>
				<td class="blogsubheader">Sa</td>
			</tr>
			<tr><td class="othermonth">
	
		<span class="simpleday">23</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">24</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">25</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">26</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">27</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">28</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">29</span>
	
</td></tr><tr><td>
	
		<span class="simpleday">1</span>
	
</td><td>
	
		<span class="simpleday">2</span>
	
</td><td>
	
		<span class="simpleday">3</span>
	
</td><td>
	
		<span class="simpleday">4</span>
	
</td><td>
	
		<span class="simpleday">5</span>
	
</td><td>
	
		<span class="simpleday">6</span>
	
</td><td>
	
		<span class="simpleday">7</span>
	
</td></tr><tr><td>
	
		<span class="simpleday">8</span>
	
</td><td>
	
		<span class="simpleday">9</span>
	
</td><td>
	
		<span class="simpleday">10</span>
	
</td><td>
	
		<span class="simpleday">11</span>
	
</td><td>
	
		<span class="simpleday">12</span>
	
</td><td>
	
		<span class="simpleday">13</span>
	
</td><td>
	
		<span class="simpleday">14</span>
	
</td></tr><tr><td>
	
		<span class="simpleday">15</span>
	
</td><td>
	
		<span class="simpleday">16</span>
	
</td><td>
	
		<span class="simpleday">17</span>
	
</td><td>
	
		<span class="simpleday">18</span>
	
</td><td>
	
		<span class="simpleday">19</span>
	
</td><td>
	
		<span class="simpleday">20</span>
	
</td><td>
	
		<span class="simpleday">21</span>
	
</td></tr><tr><td class="today" title="Today">
	
		<span class="simpleday">22</span>
	
</td><td>
	
		<span class="simpleday">23</span>
	
</td><td>
	
		<span class="simpleday">24</span>
	
</td><td>
	
		<span class="simpleday">25</span>
	
</td><td>
	
		<span class="simpleday">26</span>
	
</td><td>
	
		<span class="simpleday">27</span>
	
</td><td>
	
		<span class="simpleday">28</span>
	
</td></tr><tr><td>
	
		<span class="simpleday">29</span>
	
</td><td>
	
		<span class="simpleday">30</span>
	
</td><td>
	
		<span class="simpleday">31</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">1</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">2</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">3</span>
	
</td><td class="othermonth">
	
		<span class="simpleday">4</span>
	
</td></tr>
		</table>
	</div>
</div>
	</div>
	<div class="underblock"></div>
	<script type="text/javascript" src="clientscript/blog_ajax_calendar6719.js?v=421"></script>
	<script type="text/javascript">
	<!--
		blogCalendar = new vB_AJAX_BlogCalendar('blogCalendar', 'vb_blogcalendar', 3, 2020, 8326);
	//-->
	</script>
</li>
	</ul>
	
	
</div></div>
	
	<div class="cleardiv"></div>
</div>


<div style="clear: left">
  
<div class="google_adsense_footer" style="width:468px; margin:0 auto; padding-top:1em">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-6847984837250662";
google_ad_host = "ca-host-pub-2606800903002383";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "text_image";
google_ad_channel = "";
google_color_border = "";
google_color_bg = "";
google_color_link = "";
google_color_text = "";
google_color_url = "";
google_ui_features = "rc:6";
//-->
</script>
<script type="text/javascript"
  src="../pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>

  <div id="ad_global_above_footer"><div align="center">
<script type="text/javascript"><!--
google_ad_client = "pub-6847984837250662";
/* 728x90, created 7/9/10 */
google_ad_slot = "7101394260";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="../pagead2.googlesyndication.com/pagead/show_ads.js">
</script></div>
</div>

<div id="footer" class="floatcontainer footer">

	<form action="../external.html?link=http://garage4hackers.com/forum.php" method="get" id="footer_select" class="footer_select">

		
			<select name="styleid" onchange="switch_id(this, 'style')">
				<optgroup label="Quick Style Chooser"><option class="hidden"></option></optgroup>
				
					
					<optgroup label="&nbsp;Standard Styles">
									
					
	<option value="1" class="" selected="selected">-- Default Style</option>

					
					</optgroup>
										
				
				
					
					<optgroup label="&nbsp;Mobile Styles">
					
					
	<option value="2" class="" >-- Default Mobile Style</option>

					
					</optgroup>
										
				
			</select>	
		
		
		
	</form>

	<ul id="footer_links" class="footer_links">
		<li><a href="sendmessage.html" rel="nofollow" accesskey="9">Contact Us</a></li>
		<li><a href="index.html">Garage4hackers</a></li>
		
		
		<li><a href="archive/index.html">Archive</a></li>
		<li><a href="../external.html?link=http://glowhost.com/" target="_blank">Web Hosting</a></li>
		
		
		<li><a href="entryb0c1.html?b=3084#top" onclick="document.location.hash='top'; return false;">Top</a></li>
	</ul>
	
	
	
	
	<script type="text/javascript">
	<!--
		// Main vBulletin Javascript Initialization
		vBulletin_init();
		function md5hash(B,A,E,C){if(navigator.userAgent.indexOf("Mozilla/index.html")==1&&parseInt(navigator.appVersion)>=4){var D=hex_md5(str_to_ent(trim(B.value)));A.value=D;if(E){D=hex_md5(trim(B.value));E.value=D}if(!C){B.value=""}}return true};
	//-->
	</script>
        
</div>
</div> <!-- closing div for body_wrapper -->

<div class="below_body">
<div id="footer_time" class="shade footer_time">All times are GMT +5.5. The time now is <span class="time">04:09 PM</span>.</div>

<div id="footer_copyright" class="shade footer_copyright">
	<!-- Do not remove this copyright notice -->
	Powered by <a href="../external.html?link=https://www.vbulletin.com/" id="vbulletinlink">vBulletin&reg;</a> Version 4.2.1 <br />Copyright &copy; 2020 vBulletin Solutions, Inc. All rights reserved. 
	<!-- Do not remove this copyright notice -->	
</div>
<div id="footer_morecopyright" class="shade footer_morecopyright">
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	
	<!-- Do not remove cronimage or your scheduled tasks will cease to function -->
	Copyright 2010 - 2017, Garage4Hackers
	
</div>
 

	<div id="fb-root"></div>
<script type="text/javascript" src="clientscript/vbulletin_facebook6719.js?v=421"></script>

<script type="text/javascript">
<!--
	loadFacebookAPI('en_US');
	function fbAsyncInit()
	{
		vBfb = new vB_Facebook({
			appid : "170793809601191",
			connected : 0,
			active : 0,
			autoreg : 0,
			feed_newthread : 1,
			feed_postreply : 1,
			feed_blogentry : 1,
			feed_blogcomment : 1,
			feed_newarticle : 1,
			feed_articlecomment : 1
		});
	}
// -->
</script>

</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker('UA-17311051-3');
pageTracker._trackPageview();
} catch(err) {}</script>
</body>
</html>